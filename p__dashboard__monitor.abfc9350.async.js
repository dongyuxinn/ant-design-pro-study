(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{"+VLl":function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n("lSNA"),i=n.n(r),o=n("J4zp"),a=n.n(o),s=n("Hel2"),u=Math.PI/3,c=[0,u,2*u,3*u,4*u,5*u];function l(t){return t[0]}function f(t){return t[1]}var p=function(){var t,e,n,r=0,i=0,o=1,a=1,s=l,p=f;function h(t){var r,i={},o=[],a=t.length;for(r=0;r<a;++r)if(!isNaN(c=+s.call(null,u=t[r],r,t))&&!isNaN(l=+p.call(null,u,r,t))){var u,c,l,f=Math.round(l/=n),h=Math.round(c=c/e-(1&f)/2),d=l-f;if(3*Math.abs(d)>1){var m=c-h,v=h+(c<h?-1:1)/2,g=f+(l<f?-1:1),y=c-v,_=l-g;m*m+d*d>y*y+_*_&&(h=v+(1&f?1:-1)/2,f=g)}var b=h+"-"+f,x=i[b];x?x.push(u):(o.push(x=i[b]=[u]),x.x=(h+(1&f)/2)*e,x.y=f*n)}return o}function d(t){var e=0,n=0;return c.map((function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,a=i-e,s=o-n;return e=i,n=o,[a,s]}))}return h.hexagon=function(e){return"m"+d(null==e?t:+e).join("l")+"z"},h.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/e),l=u*n;l<a+t;l+=n,++u)for(var f=c*e+(1&u)*e/2;f<o+e/2;f+=e)s.push([f,l]);return s},h.mesh=function(){var e=d(t).slice(0,4).join("l");return h.centers().map((function(t){return"M"+t+"m"+e})).join("")},h.x=function(t){return arguments.length?(s=t,h):s},h.y=function(t){return arguments.length?(p=t,h):p},h.radius=function(r){return arguments.length?(t=+r,e=2*t*Math.sin(u),n=1.5*t,h):t},h.size=function(t){return arguments.length?(r=i=0,o=+t[0],a=+t[1],h):[o-r,a-i]},h.extent=function(t){return arguments.length?(r=+t[0][0],i=+t[0][1],o=+t[1][0],a=+t[1][1],h):[[r,i],[o,a]]},h.radius(1)};function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=6378e3;function v(t,e){var n=t.dataArray,r=e.size,o=void 0===r?10:r,u=e.method,c=void 0===u?"sum":u,l=o/(2*Math.PI*m)*(256<<20)/2,f=n.map((function(t){var e=Object(s["d"])(t.coordinates),n=a()(e,2),r=n[0],i=n[1];return d(d({},t),{},{coordinates:[r,i]})})),h=p().radius(l).x((function(t){return t.coordinates[0]})).y((function(t){return t.coordinates[1]})),v=h(f),g={dataArray:v.map((function(t,n){var r;if(e.field&&c){var o=s["c"].getColumn(t,e.field);t[c]=s["c"].statMap[c](o)}return r={},i()(r,e.method,t[c]),i()(r,"count",t.length),i()(r,"rawData",t),i()(r,"coordinates",[t.x,t.y]),i()(r,"_id",n),r})),radius:l,xOffset:l,yOffset:l,type:"hexagon"};return g}},"+em5":function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r,i,o,a,s,u,c=n("lSNA"),l=n.n(c),f=n("yG8O"),p=n.n(f),h=n("lwsE"),d=n.n(h),m=n("W8MJ"),v=n.n(m),g=n("U+yc"),y=n.n(g),_=(n("1ABj"),n("gQMU")),b=n.n(_),x=n("J2iB"),w=n.n(x),S=n("u6S6"),E=n.n(S),T=n("4cb6"),A=n("h1nZ"),C=n("bB6j"),k=n("bPkA");function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",O=(r=Object(T["injectable"])(),i=Object(T["inject"])(C["a"].IShaderModuleService),r((u=function(){function t(){d()(this,t),p()(this,"shaderModuleService",s,this),this.rendererService=void 0,this.config=void 0,this.quad=I,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return v()(t,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return k["a"].PostProcessing}},{key:"init",value:function(t,e){this.config=e,this.rendererService=t.getContainer().get(C["a"].IRendererService);var n=this.rendererService,r=n.createAttribute,i=n.createBuffer,o=n.createModel,a=this.setupShaders(),s=a.vs,u=a.fs,c=a.uniforms;this.model=o({vs:s,fs:u,attributes:{a_Position:r({buffer:i({data:[-4,-4,4,-4,0,4],type:A["gl"].FLOAT}),size:2})},uniforms:M(M({u_Texture:null},c),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(t){var e=this,n=t.multiPassRenderer.getPostProcessor(),r=this.rendererService,i=r.useFramebuffer,o=r.getViewportSize,a=r.clear,s=o(),u=s.width,c=s.height;i(this.renderToScreen?null:n.getWriteFBO(),(function(){a({framebuffer:n.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),e.model.draw({uniforms:M({u_Texture:n.getReadFBO(),u_ViewportSize:[u,c]},e.convertOptionsToUniforms(e.optionsToUpdate))})}))}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=M(M({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var e={};return Object.keys(t).forEach((function(n){w()(t[n])||(e["u_".concat(b()(E()(n)))]=t[n])})),e}}]),t}(),a=u,s=y()(a.prototype,"shaderModuleService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=a))||o)},"/33/":function(t,e){},"/Uc5":function(t,e){},"/rf6":function(t,e,n){"use strict";function r(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function i(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return o(e).geometry;case"LineString":return c(e).geometry;case"Polygon":return s(e).geometry;case"MultiPoint":return h(e).geometry;case"MultiLineString":return p(e).geometry;case"MultiPolygon":return d(e).geometry;default:throw new Error(t+" is invalid")}}function o(t,e,n){void 0===n&&(n={});var i={type:"Point",coordinates:t};return r(i,e,n)}function a(t,e,n){return void 0===n&&(n={}),f(t.map((function(t){return o(t,e)})),n)}function s(t,e,n){void 0===n&&(n={});for(var i=0,o=t;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:t};return r(u,e,n)}function u(t,e,n){return void 0===n&&(n={}),f(t.map((function(t){return s(t,e)})),n)}function c(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:t};return r(i,e,n)}function l(t,e,n){return void 0===n&&(n={}),f(t.map((function(t){return c(t,e)})),n)}function f(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function p(t,e,n){void 0===n&&(n={});var i={type:"MultiLineString",coordinates:t};return r(i,e,n)}function h(t,e,n){void 0===n&&(n={});var i={type:"MultiPoint",coordinates:t};return r(i,e,n)}function d(t,e,n){void 0===n&&(n={});var i={type:"MultiPolygon",coordinates:t};return r(i,e,n)}function m(t,e,n){void 0===n&&(n={});var i={type:"GeometryCollection",geometries:t};return r(i,e,n)}function v(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function g(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function y(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function _(t,e){return x(y(t,e))}function b(t){var e=t%360;return e<0&&(e+=360),e}function x(t){var e=t%(2*Math.PI);return 180*e/Math.PI}function w(t){var e=t%360;return e*Math.PI/180}function S(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return g(y(t,e),n)}function E(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[n];if(!i)throw new Error("invalid original units");var o=e.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o}function T(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}function A(t){return!!t&&t.constructor===Object}function C(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!T(t))throw new Error("bbox must only contain numbers")}))}function k(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function P(){throw new Error("method has been renamed to `radiansToDegrees`")}function M(){throw new Error("method has been renamed to `degreesToRadians`")}function I(){throw new Error("method has been renamed to `lengthToDegrees`")}function O(){throw new Error("method has been renamed to `lengthToRadians`")}function L(){throw new Error("method has been renamed to `radiansToLength`")}function R(){throw new Error("method has been renamed to `bearingToAzimuth`")}function D(){throw new Error("method has been renamed to `convertLength`")}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=r,e.geometry=i,e.point=o,e.points=a,e.polygon=s,e.polygons=u,e.lineString=c,e.lineStrings=l,e.featureCollection=f,e.multiLineString=p,e.multiPoint=h,e.multiPolygon=d,e.geometryCollection=m,e.round=v,e.radiansToLength=g,e.lengthToRadians=y,e.lengthToDegrees=_,e.bearingToAzimuth=b,e.radiansToDegrees=x,e.degreesToRadians=w,e.convertLength=S,e.convertArea=E,e.isNumber=T,e.isObject=A,e.validateBBox=C,e.validateId=k,e.radians2degrees=P,e.degrees2radians=M,e.distanceToDegrees=I,e.distanceToRadians=O,e.radiansToDistance=L,e.bearingToAngle=R,e.convertDistance=D},"0eqD":function(t,e){},"0gSV":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("GXnB"),i=n("Ztfv");function o(t,e){return function(n,o,a){var s=new r.Metadata(t,e);"number"===typeof a?i.tagParameter(n,o,a,s):i.tagProperty(n,o,s)}}e.tagged=o},"1+5i":function(t,e,n){var r=n("w/wX"),i=n("sEf8"),o=n("mdPL"),a=o&&o.isSet,s=a?i(a):r;t.exports=s},"1ABj":function(t,e){function n(t,e){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}t.exports=n},"1XEM":function(t,e,n){t.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(t,e){t.exports=function(t){return t&&"object"===typeof t&&"function"===typeof t.copy&&"function"===typeof t.fill&&"function"===typeof t.readUInt8}},"1jvM":function(t,e){},2:function(t,e){},"2ajD":function(t,e){function n(t){return t!==t}t.exports=n},"3DfO":function(t,e){function n(t){return null==t}t.exports=n},"3cYt":function(t,e){function n(t){return function(e){return null==t?void 0:t[e]}}t.exports=n},"406g":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("z4Hk"),i=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new r.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=i},"4U9+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,i.default)((0,l.default)(t)&&t.length>=1,"Must merge at least 1 JSON schema."),a.default.apply(void 0,[{}].concat(v(t),[function(t,e,n){if(!(0,u.default)(t)){if("required"===n)return(0,p.default)(t.concat(e));if((0,d.default)(t)){if(!(0,d.default)(e))throw new Error('Failed to merge schemas because "'+n+'" has different values.')}else i.default.deepEqual(t,e,'Failed to merge schemas because "'+n+'" has different values: '+JSON.stringify(t)+" and "+JSON.stringify(e)+".")}}]))};var r=n("9lTW"),i=m(r),o=n("qd8s"),a=m(o),s=n("3DfO"),u=m(s),c=n("WFAs"),l=m(c),f=n("w26f"),p=m(f),h=n("zZPE"),d=m(h);function m(t){return t&&t.__esModule?t:{default:t}}function v(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}t.exports=e["default"]},"4ZJM":function(t,e,n){(function(e,n){t.exports=n()})(0,(function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),n=i(a),"undefined"!==typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=i;else t=i}return r(["exports"],(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=r;function r(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var n,r,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var a="undefined"!=typeof self?self:{};function s(t,e,r,i){var o=new n(t,e,r,i);return function(t){return o.solve(t)}}var u=s(.25,.1,.25,1);function c(t,e,n){return Math.min(n,Math.max(e,t))}function l(t,e,n){var r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function f(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}var p=1;function h(){return p++}function d(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function m(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function v(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function g(t,e){return-1!==t.indexOf(e,t.length-e.length)}function y(t,e,n){var r={};for(var i in t)r[i]=e.call(n||this,t[i],i,t);return r}function _(t,e,n){var r={};for(var i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function b(t){return Array.isArray(t)?t.map(b):"object"==typeof t&&t?y(t,b):t}var x={};function w(t){x[t]||("undefined"!=typeof console&&console.warn(t),x[t]=!0)}function S(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function E(t){for(var e=0,n=0,r=t.length,i=r-1,o=void 0,a=void 0;n<r;i=n++)e+=((a=t[i]).x-(o=t[n]).x)*(o.y+a.y);return e}function T(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function A(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,r,i){var o=r||i;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}var C=null;function k(t){if(null==C){var e=t.navigator?t.navigator.userAgent:null;C=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return C}function P(t){try{var e=a[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var M,I,O,L,R=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now.bind(Date),D=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,z=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame,j={now:R,frame:function(t){var e=D(t);return{cancel:function(){return z(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var n=a.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return M||(M=a.document.createElement("a")),M.href=t,M.href},hardwareConcurrency:a.navigator&&a.navigator.hardwareConcurrency||4,get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==I&&(I=a.matchMedia("(prefers-reduced-motion: reduce)")),I.matches)}},N={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(t){!B&&L&&(U?V(t):O=t)}},B=!1,U=!1;function V(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,L),t.isContextLost())return;F.supported=!0}catch(t){}t.deleteTexture(e),B=!0}a.document&&((L=a.document.createElement("img")).onload=function(){O&&V(O),O=null,U=!0},L.onerror=function(){B=!0,O=null},L.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var G="01",q=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Z(t){return 0===t.indexOf("mapbox:")}q.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",G,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},q.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},q.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},q.prototype.normalizeStyleURL=function(t,e){if(!Z(t))return t;var n=Y(t);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},q.prototype.normalizeGlyphsURL=function(t,e){if(!Z(t))return t;var n=Y(t);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},q.prototype.normalizeSourceURL=function(t,e){if(!Z(t))return t;var n=Y(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)},q.prototype.normalizeSpriteURL=function(t,e,n,r){var i=Y(t);return Z(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+n,this._makeAPIURL(i,this._customAccessToken||r)):(i.path+=""+e+n,K(i))},q.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Z(t))return t;var n=Y(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,(j.devicePixelRatio>=2||512===e?"@2x":"")+(F.supported?".webp":"$1")),n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/v4"+n.path;var r=this._customAccessToken||function(t){for(var e=0,n=t;e<n.length;e+=1){var r=n[e].match(/^access_token=(.*)$/);if(r)return r[1]}return null}(n.params)||N.ACCESS_TOKEN;return N.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&n.params.push("sku="+this._skuToken),this._makeAPIURL(n,r)},q.prototype.canonicalizeTileURL=function(t,e){var n=Y(t);if(!n.path.match(/(^\/v4\/)/)||!n.path.match(/\.[\w]+$/))return t;var r="mapbox://tiles/";r+=n.path.replace("/v4/","");var i=n.params;return e&&(i=i.filter((function(t){return!t.match(/^access_token=/)}))),i.length&&(r+="?"+i.join("&")),r},q.prototype.canonicalizeTileset=function(t,e){for(var n=!!e&&Z(e),r=[],i=0,o=t.tiles||[];i<o.length;i+=1){var a=o[i];W(a)?r.push(this.canonicalizeTileURL(a,n)):r.push(a)}return r},q.prototype._makeAPIURL=function(t,e){var n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=Y(N.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!N.REQUIRE_ACCESS_TOKEN)return K(t);if(!(e=e||N.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),K(t)};var H=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function W(t){return H.test(t)}var X=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Y(t){var e=t.match(X);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function K(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function J(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(t){return null}}var Q=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Q.prototype.getStorageKey=function(t){var e,n=J(N.ACCESS_TOKEN);return e=n&&n.u?a.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))):N.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},Q.prototype.fetchEventData=function(){var t=P("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{var r=a.localStorage.getItem(e);r&&(this.eventData=JSON.parse(r));var i=a.localStorage.getItem(n);i&&(this.anonId=i)}catch(t){w("Unable to read from LocalStorage")}},Q.prototype.saveEventData=function(){var t=P("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{a.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&a.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){w("Unable to write to LocalStorage")}},Q.prototype.processRequests=function(t){},Q.prototype.postEvent=function(t,e,n,r){var i=this;if(N.EVENTS_URL){var o=Y(N.EVENTS_URL);o.params.push("access_token="+(r||N.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.11.1",skuId:G,userId:this.anonId},s=e?f(a,e):a,u={url:K(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=bt(u,(function(t){i.pendingRequest=null,n(t),i.saveEventData(),i.processRequests(r)}))}},Q.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var $,tt,et=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(t,e,n,r){this.skuToken=n,(N.EVENTS_URL&&r||N.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||W(t)})))&&this.queueRequest({id:e,timestamp:Date.now()},r)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),r=n.id,i=n.timestamp;r&&this.success[r]||(this.anonId||this.fetchEventData(),m(this.anonId)||(this.anonId=d()),this.postEvent(i,{skuToken:this.skuToken},(function(t){t||r&&(e.success[r]=!0)}),t))}},e}(Q),nt=new(function(t){function e(e){t.call(this,"appUserTurnstile"),this._customAccessToken=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(t,e){N.EVENTS_URL&&N.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||W(t)}))&&this.queueRequest(Date.now(),e)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=J(N.ACCESS_TOKEN),r=n?n.u:N.ACCESS_TOKEN,i=r!==this.eventData.tokenU;m(this.anonId)||(this.anonId=d(),i=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),u=(o-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||a.getDate()!==s.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=r)}),t)}},e}(Q)),rt=nt.postTurnstileEvent.bind(nt),it=new et,ot=it.postMapLoadEvent.bind(it),at=500,st=50;function ut(){a.caches&&!$&&($=a.caches.open("mapbox-tiles"))}function ct(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var lt,ft=1/0;function pt(){return null==lt&&(lt=a.OffscreenCanvas&&new a.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.createImageBitmap),lt}var ht={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ht);var dt,mt,vt=function(t){function e(e,n,r){401===n&&W(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,e),this.status=n,this.url=r,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),gt=T()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===a.location.protocol?a.parent:a).location.href},yt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(gt())&&!/^\w+:/.test(n))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(t,e){var n,r=new a.AbortController,i=new a.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:gt(),signal:r.signal}),o=!1,s=!1,u=(n=i.url).indexOf("sku=")>0&&W(n);"json"===t.type&&i.headers.set("Accept","application/json");var c=function(n,r,o){if(!s){if(n&&"SecurityError"!==n.message&&w(n),r&&o)return l(r);var c=Date.now();a.fetch(i).then((function(n){if(n.ok){var r=u?n.clone():null;return l(n,r,c)}return e(new vt(n.statusText,n.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}},l=function(n,r,u){("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((function(t){s||(r&&u&&function(t,e,n){if(ut(),$){var r={status:e.status,statusText:e.statusText,headers:new a.Headers};e.headers.forEach((function(t,e){return r.headers.set(e,t)}));var i=A(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===tt)try{new Response(new ReadableStream),tt=!0}catch(t){tt=!1}tt?e(t.body):t.blob().then(e)}(e,(function(e){var n=new a.Response(e,r);ut(),$&&$.then((function(e){return e.put(ct(t.url),n)})).catch((function(t){return w(t.message)}))})))}}(i,r,u),o=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(t){s||e(new Error(t.message))}))};return u?function(t,e){if(ut(),!$)return e(null);var n=ct(t.url);$.then((function(t){t.match(n).then((function(r){var i=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),n=A(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(r);t.delete(n),i&&t.put(n,r.clone()),e(null,r,i)})).catch(e)})).catch(e)}(i,c):c(null,null),{cancel:function(){s=!0,o||r.abort()}}}(t,e);if(T()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){var n=new a.XMLHttpRequest;for(var r in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(r,t.headers[r]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new vt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:function(){return n.abort()}}}(t,e)},_t=function(t,e){return yt(f(t,{type:"arrayBuffer"}),e)},bt=function(t,e){return yt(f(t,{method:"POST"}),e)};dt=[],mt=0;var xt=function t(e,n){if(F.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),mt>=N.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return dt.push(r),r}mt++;var i=!1,o=function(){if(!i)for(i=!0,mt--;dt.length&&mt<N.MAX_PARALLEL_IMAGE_REQUESTS;){var e=dt.shift();e.cancelled||(e.cancel=t(e.requestParameters,e.callback).cancel)}},s=_t(e,(function(t,e,r,i){o(),t?n(t):e&&(pt()?function(t,e){var n=new a.Blob([new Uint8Array(t)],{type:"image/png"});a.createImageBitmap(n).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(e,n):function(t,e,n,r){var i=new a.Image,o=a.URL;i.onload=function(){e(null,i),o.revokeObjectURL(i.src)},i.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new a.Blob([new Uint8Array(t)],{type:"image/png"});i.cacheControl=n,i.expires=r,i.src=t.byteLength?o.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(e,n,r,i))}));return{cancel:function(){s.cancel(),o()}}};function wt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function St(t,e,n){if(n&&n[t]){var r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}var Et=function(t,e){void 0===e&&(e={}),f(this,e),this.type=t},Tt=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",f({error:e},n))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Et),At=function(){};At.prototype.on=function(t,e){return this._listeners=this._listeners||{},wt(t,e,this._listeners),this},At.prototype.off=function(t,e){return St(t,e,this._listeners),St(t,e,this._oneTimeListeners),this},At.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},wt(t,e,this._oneTimeListeners),this},At.prototype.fire=function(t,e){"string"==typeof t&&(t=new Et(t,e||{}));var n=t.type;if(this.listens(n)){t.target=this;for(var r=0,i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];r<i.length;r+=1)i[r].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];o<a.length;o+=1){var s=a[o];St(n,s,this._oneTimeListeners),s.call(this,t)}var u=this._eventedParent;u&&(f(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),u.fire(t))}else t instanceof Tt&&console.error(t.error);return this},At.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},At.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var Ct={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},kt=function(t,e,n,r){this.message=(t?t+": ":"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)};function Pt(t){var e=t.value;return e?[new kt(t.key,e,"constants have been deprecated as of v8")]:[]}function Mt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}function It(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ot(t){if(Array.isArray(t))return t.map(Ot);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var n in t)e[n]=Ot(t[n]);return e}return It(t)}var Lt=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),Rt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,r=e;n<r.length;n+=1){var i=r[n];this.bindings[i[0]]=i[1]}};Rt.prototype.concat=function(t){return new Rt(this,t)},Rt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Rt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Dt={kind:"null"},zt={kind:"number"},jt={kind:"string"},Nt={kind:"boolean"},Ft={kind:"color"},Bt={kind:"object"},Ut={kind:"value"},Vt={kind:"collator"},Gt={kind:"formatted"},qt={kind:"resolvedImage"};function Zt(t,e){return{kind:"array",itemType:t,N:e}}function Ht(t){if("array"===t.kind){var e=Ht(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Wt=[Dt,zt,jt,Nt,Ft,Gt,Bt,Zt(Ut),qt];function Xt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Xt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,r=Wt;n<r.length;n+=1)if(!Xt(r[n],e))return null}return"Expected "+Ht(t)+" but found "+Ht(e)+" instead."}function Yt(t,e){return e.some((function(e){return e.kind===t.kind}))}function Kt(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var Jt=e((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return r("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function a(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,s=t.replace(/ /g,"").toLowerCase();if(s in n)return n[s].slice();if("#"===s[0])return 4===s.length?(e=parseInt(s.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===s.length&&(e=parseInt(s.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=s.indexOf("("),c=s.indexOf(")");if(-1!==u&&c+1===s.length){var l=s.substr(0,u),f=s.substr(u+1,c-(u+1)).split(","),p=1;switch(l){case"rgba":if(4!==f.length)return null;p=o(f.pop());case"rgb":return 3!==f.length?null:[i(f[0]),i(f[1]),i(f[2]),p];case"hsla":if(4!==f.length)return null;p=o(f.pop());case"hsl":if(3!==f.length)return null;var h=(parseFloat(f[0])%360+360)%360/360,d=o(f[1]),m=o(f[2]),v=m<=.5?m*(d+1):m+d-m*d,g=2*m-v;return[r(255*a(g,v,h+1/3)),r(255*a(g,v,h)),r(255*a(g,v,h-1/3)),p];default:return null}}return null}}catch(t){}})).parseCSSColor,Qt=function(t,e,n,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=n,this.a=r};Qt.parse=function(t){if(t){if(t instanceof Qt)return t;if("string"==typeof t){var e=Jt(t);if(e)return new Qt(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Qt.prototype.toString=function(){var t=this.toArray(),e=t[1],n=t[2],r=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(n)+","+r+")"},Qt.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);var $t=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};$t.prototype.compare=function(t,e){return this.collator.compare(t,e)},$t.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var te=function(t,e,n,r,i){this.text=t,this.image=e,this.scale=n,this.fontStack=r,this.textColor=i},ee=function(t){this.sections=t};ee.fromString=function(t){return new ee([new te(t,null,null,null,null)])},ee.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},ee.factory=function(t){return t instanceof ee?t:ee.fromString(t)},ee.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},ee.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];if(r.image)t.push(["image",r.image.name]);else{t.push(r.text);var i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),r.textColor&&(i["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(i)}}return t};var ne=function(t){this.name=t.name,this.available=t.available};function re(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[t,e,n,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ie(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Qt)return!0;if(t instanceof $t)return!0;if(t instanceof ee)return!0;if(t instanceof ne)return!0;if(Array.isArray(t)){for(var e=0,n=t;e<n.length;e+=1)if(!ie(n[e]))return!1;return!0}if("object"==typeof t){for(var r in t)if(!ie(t[r]))return!1;return!0}return!1}function oe(t){if(null===t)return Dt;if("string"==typeof t)return jt;if("boolean"==typeof t)return Nt;if("number"==typeof t)return zt;if(t instanceof Qt)return Ft;if(t instanceof $t)return Vt;if(t instanceof ee)return Gt;if(t instanceof ne)return qt;if(Array.isArray(t)){for(var e,n=t.length,r=0,i=t;r<i.length;r+=1){var o=oe(i[r]);if(e){if(e===o)continue;e=Ut;break}e=o}return Zt(e||Ut,n)}return Bt}function ae(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Qt||t instanceof ee||t instanceof ne?t.toString():JSON.stringify(t)}ne.prototype.toString=function(){return this.name},ne.fromString=function(t){return t?new ne({name:t,available:!1}):null},ne.prototype.serialize=function(){return["image",this.name]};var se=function(t,e){this.type=t,this.value=e};se.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!ie(t[1]))return e.error("invalid value");var n=t[1],r=oe(n),i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new se(r,n)},se.prototype.evaluate=function(){return this.value},se.prototype.eachChild=function(){},se.prototype.outputDefined=function(){return!0},se.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Qt?["rgba"].concat(this.value.toArray()):this.value instanceof ee?this.value.serialize():this.value};var ue=function(t){this.name="ExpressionEvaluationError",this.message=t};ue.prototype.toJSON=function(){return this.message};var ce={string:jt,number:zt,boolean:Nt,object:Bt},le=function(t,e){this.type=t,this.args=e};le.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,r=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in ce)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=ce[s],r++}else o=Ut;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}n=Zt(o,a)}else n=ce[i];for(var u=[];r<t.length;r++){var c=e.parse(t[r],r,Ut);if(!c)return null;u.push(c)}return new le(n,u)},le.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Xt(this.type,oe(n)))return n;if(e===this.args.length-1)throw new ue("Expected value to be of type "+Ht(this.type)+", but found "+Ht(oe(n))+" instead.")}return null},le.prototype.eachChild=function(t){this.args.forEach(t)},le.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},le.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var fe=function(t){this.type=Gt,this.sections=t};fe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var r=[],i=!1,o=1;o<=t.length-1;++o){var a=t[o];if(i&&"object"==typeof a&&!Array.isArray(a)){i=!1;var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,zt)))return null;var u=null;if(a["text-font"]&&!(u=e.parse(a["text-font"],1,Zt(jt))))return null;var c=null;if(a["text-color"]&&!(c=e.parse(a["text-color"],1,Ft)))return null;var l=r[r.length-1];l.scale=s,l.font=u,l.textColor=c}else{var f=e.parse(t[o],1,Ut);if(!f)return null;var p=f.type.kind;if("string"!==p&&"value"!==p&&"null"!==p&&"resolvedImage"!==p)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:f,scale:null,font:null,textColor:null})}}return new fe(r)},fe.prototype.evaluate=function(t){return new ee(this.sections.map((function(e){var n=e.content.evaluate(t);return oe(n)===qt?new te("",n,null,null,null):new te(ae(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},fe.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}},fe.prototype.outputDefined=function(){return!1},fe.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.content.serialize());var i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),r.textColor&&(i["text-color"]=r.textColor.serialize()),t.push(i)}return t};var pe=function(t){this.type=qt,this.input=t};pe.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,jt);return n?new pe(n):e.error("No image name provided.")},pe.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=ne.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n},pe.prototype.eachChild=function(t){t(this.input)},pe.prototype.outputDefined=function(){return!1},pe.prototype.serialize=function(){return["image",this.input.serialize()]};var he={"to-boolean":Nt,"to-color":Ft,"to-number":zt,"to-string":jt},de=function(t,e){this.type=t,this.args=e};de.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var r=he[n],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Ut);if(!a)return null;i.push(a)}return new de(r,i)},de.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,r=0,i=this.args;r<i.length;r+=1){if(n=null,(e=i[r].evaluate(t))instanceof Qt)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":re(e[0],e[1],e[2],e[3])))return new Qt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ue(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new ue("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?ee.fromString(ae(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?ne.fromString(ae(this.args[0].evaluate(t))):ae(this.args[0].evaluate(t))},de.prototype.eachChild=function(t){this.args.forEach(t)},de.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},de.prototype.serialize=function(){if("formatted"===this.type.kind)return new fe([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new pe(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var me=["Unknown","Point","LineString","Polygon"],ve=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ve.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ve.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?me[this.feature.type]:this.feature.type:null},ve.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ve.prototype.canonicalID=function(){return this.canonical},ve.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ve.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Qt.parse(t)),e};var ge=function(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r};ge.prototype.evaluate=function(t){return this._evaluate(t,this.args)},ge.prototype.eachChild=function(t){this.args.forEach(t)},ge.prototype.outputDefined=function(){return!1},ge.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},ge.parse=function(t,e){var n,r=t[0],i=ge.definitions[r];if(!i)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),u=null,c=0,l=s;c<l.length;c+=1){var f=l[c],p=f[0],h=f[1];u=new Fe(e.registry,e.path,null,e.scope);for(var d=[],m=!1,v=1;v<t.length;v++){var g=t[v],y=Array.isArray(p)?p[v-1]:p.type,_=u.parse(g,1+d.length,y);if(!_){m=!0;break}d.push(_)}if(!m)if(Array.isArray(p)&&p.length!==d.length)u.error("Expected "+p.length+" arguments, but found "+d.length+" instead.");else{for(var b=0;b<d.length;b++){var x=Array.isArray(p)?p[b]:p.type,w=d[b];u.concat(b+1).checkSubtype(x,w.type)}if(0===u.errors.length)return new ge(r,o,h,d)}}if(1===s.length)(n=e.errors).push.apply(n,u.errors);else{for(var S=(s.length?s:a).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Ht).join(", ")+")":"("+Ht(e.type)+"...)"})).join(" | "),E=[],T=1;T<t.length;T++){var A=e.parse(t[T],1+E.length);if(!A)return null;E.push(Ht(A.type))}e.error("Expected arguments of type "+S+", but found ("+E.join(", ")+") instead.")}return null},ge.register=function(t,e){for(var n in ge.definitions=e,e)t[n]=ge};var ye=function(t,e,n){this.type=Vt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function _e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function be(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function xe(t,e){var n=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return[Math.round(n*i*8192),Math.round(r*i*8192)]}function we(t,e,n){return e[1]>t[1]!=n[1]>t[1]&&t[0]<(n[0]-e[0])*(t[1]-e[1])/(n[1]-e[1])+e[0]}function Se(t,e){for(var n,r,i,o,a,s,u,c=!1,l=0,f=e.length;l<f;l++)for(var p=e[l],h=0,d=p.length;h<d-1;h++){if((o=(n=t)[0]-(r=p[h])[0])*(u=n[1]-(i=p[h+1])[1])-(s=n[0]-i[0])*(a=n[1]-r[1])==0&&o*s<=0&&a*u<=0)return!1;we(t,p[h],p[h+1])&&(c=!c)}return c}function Ee(t,e){for(var n=0;n<e.length;n++)if(Se(t,e[n]))return!0;return!1}function Te(t,e,n,r){var i=r[0]-n[0],o=r[1]-n[1],a=(t[0]-n[0])*o-i*(t[1]-n[1]),s=(e[0]-n[0])*o-i*(e[1]-n[1]);return a>0&&s<0||a<0&&s>0}function Ae(t,e,n){for(var r=0,i=n;r<i.length;r+=1)for(var o=i[r],a=0;a<o.length-1;++a)if(0!=(f=[(l=o[a+1])[0]-(c=o[a])[0],l[1]-c[1]])[0]*(p=[(u=e)[0]-(s=t)[0],u[1]-s[1]])[1]-f[1]*p[0]&&Te(s,u,c,l)&&Te(c,l,s,u))return!0;var s,u,c,l,f,p;return!1}function Ce(t,e){for(var n=0;n<t.length;++n)if(!Se(t[n],e))return!1;for(var r=0;r<t.length-1;++r)if(Ae(t[r],t[r+1],e))return!1;return!0}function ke(t,e){for(var n=0;n<e.length;n++)if(Ce(t,e[n]))return!0;return!1}function Pe(t,e,n){for(var r=[],i=0;i<t.length;i++){for(var o=[],a=0;a<t[i].length;a++){var s=xe(t[i][a],n);_e(e,s),o.push(s)}r.push(o)}return r}function Me(t,e,n){for(var r=[],i=0;i<t.length;i++){var o=Pe(t[i],e,n);r.push(o)}return r}function Ie(t,e,n,r){if(t[0]<n[0]||t[0]>n[2]){var i=.5*r,o=t[0]-n[0]>i?-r:n[0]-t[0]>i?r:0;0===o&&(o=t[0]-n[2]>i?-r:n[2]-t[0]>i?r:0),t[0]+=o}_e(e,t)}function Oe(t,e,n,r){for(var i=8192*Math.pow(2,r.z),o=[8192*r.x,8192*r.y],a=[],s=0,u=t;s<u.length;s+=1)for(var c=0,l=u[s];c<l.length;c+=1){var f=l[c],p=[f.x+o[0],f.y+o[1]];Ie(p,e,n,i),a.push(p)}return a}function Le(t,e,n,r){for(var i,o=8192*Math.pow(2,r.z),a=[8192*r.x,8192*r.y],s=[],u=0,c=t;u<c.length;u+=1){for(var l=[],f=0,p=c[u];f<p.length;f+=1){var h=p[f],d=[h.x+a[0],h.y+a[1]];_e(e,d),l.push(d)}s.push(l)}if(e[2]-e[0]<=o/2){(i=e)[0]=i[1]=1/0,i[2]=i[3]=-1/0;for(var m=0,v=s;m<v.length;m+=1)for(var g=0,y=v[m];g<y.length;g+=1)Ie(y[g],e,n,o)}return s}ye.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Nt);if(!r)return null;var i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Nt);if(!i)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,jt))?null:new ye(r,i,o)},ye.prototype.evaluate=function(t){return new $t(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},ye.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},ye.prototype.outputDefined=function(){return!1},ye.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Re=function(t,e){this.type=Nt,this.geojson=t,this.geometries=e};function De(t){if(t instanceof ge){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Re)return!1;var e=!0;return t.eachChild((function(t){e&&!De(t)&&(e=!1)})),e}function ze(t){if(t instanceof ge&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!ze(t)&&(e=!1)})),e}function je(t,e){if(t instanceof ge&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!je(t,e)&&(n=!1)})),n}Re.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(ie(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var r=0;r<n.features.length;++r){var i=n.features[r].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Re(n,n.features[r].geometry)}else if("Feature"===n.type){var o=n.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Re(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new Re(n,n)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Re.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=Pe(e.coordinates,r,i),a=Oe(t.geometry(),n,r,i);if(!be(n,r))return!1;for(var s=0,u=a;s<u.length;s+=1)if(!Se(u[s],o))return!1}if("MultiPolygon"===e.type){var c=Me(e.coordinates,r,i),l=Oe(t.geometry(),n,r,i);if(!be(n,r))return!1;for(var f=0,p=l;f<p.length;f+=1)if(!Ee(p[f],c))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=Pe(e.coordinates,r,i),a=Le(t.geometry(),n,r,i);if(!be(n,r))return!1;for(var s=0,u=a;s<u.length;s+=1)if(!Ce(u[s],o))return!1}if("MultiPolygon"===e.type){var c=Me(e.coordinates,r,i),l=Le(t.geometry(),n,r,i);if(!be(n,r))return!1;for(var f=0,p=l;f<p.length;f+=1)if(!ke(p[f],c))return!1}return!0}(t,this.geometries)}return!1},Re.prototype.eachChild=function(){},Re.prototype.outputDefined=function(){return!0},Re.prototype.serialize=function(){return["within",this.geojson]};var Ne=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Ne.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Ne(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Ne.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Ne.prototype.eachChild=function(){},Ne.prototype.outputDefined=function(){return!1},Ne.prototype.serialize=function(){return["var",this.name]};var Fe=function(t,e,n,r,i){void 0===e&&(e=[]),void 0===r&&(r=new Rt),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=r,this.errors=i,this.expectedType=n};function Be(t,e){for(var n,r=t.length-1,i=0,o=r,a=0;i<=o;)if((n=t[a=Math.floor((i+o)/2)])<=e){if(a===r||e<t[a+1])return a;i=a+1}else{if(!(n>e))throw new ue("Input is not a number.");o=a-1}return 0}Fe.prototype.parse=function(t,e,n,r,i){return void 0===i&&(i={}),e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)},Fe.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new le(e,[t]):"coerce"===n?new de(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[r];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof se)&&"resolvedImage"!==o.type.kind&&function t(e){if(e instanceof Ne)return t(e.boundExpression);if(e instanceof ge&&"error"===e.name)return!1;if(e instanceof ye)return!1;if(e instanceof Re)return!1;var n=e instanceof de||e instanceof le,r=!0;return e.eachChild((function(e){r=n?r&&t(e):r&&e instanceof se})),!!r&&De(e)&&je(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var u=new ve;try{o=new se(o.type,o.evaluate(u))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},Fe.prototype.concat=function(t,e,n){var r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new Fe(this.registry,r,e||null,i,this.errors)},Fe.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Lt(r,t))},Fe.prototype.checkSubtype=function(t,e){var n=Xt(t,e);return n&&this.error(n),n};var Ue=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var r=0,i=n;r<i.length;r+=1){var o=i[r],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};function Ve(t,e,n){return t*(1-n)+e*n}Ue.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,zt);if(!n)return null;var r=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],u=o,c=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var l=e.parse(s,c,i);if(!l)return null;i=i||l.type,r.push([a,l])}return new Ue(i,n,r)},Ue.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[Be(e,r)].evaluate(t)},Ue.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Ue.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Ue.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Ge=Object.freeze({__proto__:null,number:Ve,color:function(t,e,n){return new Qt(Ve(t.r,e.r,n),Ve(t.g,e.g,n),Ve(t.b,e.b,n),Ve(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,r){return Ve(t,e[r],n)}))}}),qe=6/29*3*(6/29),Ze=Math.PI/180,He=180/Math.PI;function We(t){return t>.008856451679035631?Math.pow(t,1/3):t/qe+4/29}function Xe(t){return t>6/29?t*t*t:qe*(t-4/29)}function Ye(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ke(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Je(t){var e=Ke(t.r),n=Ke(t.g),r=Ke(t.b),i=We((.4124564*e+.3575761*n+.1804375*r)/.95047),o=We((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-We((.0193339*e+.119192*n+.9503041*r)/1.08883)),alpha:t.a}}function Qe(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=1*Xe(e),n=.95047*Xe(n),r=1.08883*Xe(r),new Qt(Ye(3.2404542*n-1.5371385*e-.4985314*r),Ye(-.969266*n+1.8760108*e+.041556*r),Ye(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function $e(t,e,n){var r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}var tn={forward:Je,reverse:Qe,interpolate:function(t,e,n){return{l:Ve(t.l,e.l,n),a:Ve(t.a,e.a,n),b:Ve(t.b,e.b,n),alpha:Ve(t.alpha,e.alpha,n)}}},en={forward:function(t){var e=Je(t),n=e.l,r=e.a,i=e.b,o=Math.atan2(i,r)*He;return{h:o<0?o+360:o,c:Math.sqrt(r*r+i*i),l:n,alpha:t.a}},reverse:function(t){var e=t.h*Ze,n=t.c;return Qe({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:$e(t.h,e.h,n),c:Ve(t.c,e.c,n),l:Ve(t.l,e.l,n),alpha:Ve(t.alpha,e.alpha,n)}}},nn=Object.freeze({__proto__:null,lab:tn,hcl:en}),rn=function(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[1];this.labels.push(s[0]),this.outputs.push(u)}};function on(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}rn.interpolationFactor=function(t,e,r,i){var o=0;if("exponential"===t.name)o=on(e,t.base,r,i);else if("linear"===t.name)o=on(e,1,r,i);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new n(a[0],a[1],a[2],a[3]).solve(on(e,1,r,i))}return o},rn.parse=function(t,e){var n=t[0],r=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,zt)))return null;var u=[],c=null;"interpolate-hcl"===n||"interpolate-lab"===n?c=Ft:e.expectedType&&"value"!==e.expectedType.kind&&(c=e.expectedType);for(var l=0;l<o.length;l+=2){var f=o[l],p=o[l+1],h=l+3,d=l+4;if("number"!=typeof f)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(u.length&&u[u.length-1][0]>=f)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',h);var m=e.parse(p,d,c);if(!m)return null;c=c||m.type,u.push([f,m])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new rn(c,n,r,i,u):e.error("Type "+Ht(c)+" is not interpolatable.")},rn.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);var o=Be(e,r),a=rn.interpolationFactor(this.interpolation,r,e[o],e[o+1]),s=n[o].evaluate(t),u=n[o+1].evaluate(t);return"interpolate"===this.operator?Ge[this.type.kind.toLowerCase()](s,u,a):"interpolate-hcl"===this.operator?en.reverse(en.interpolate(en.forward(s),en.forward(u),a)):tn.reverse(tn.interpolate(tn.forward(s),tn.forward(u),a))},rn.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},rn.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},rn.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var an=function(t,e){this.type=t,this.args=e};an.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,r=e.expectedType;r&&"value"!==r.kind&&(n=r);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=e.parse(a[o],1+i.length,n,void 0,{typeAnnotation:"omit"});if(!s)return null;n=n||s.type,i.push(s)}var u=r&&i.some((function(t){return Xt(r,t.type)}));return new an(u?Ut:n,i)},an.prototype.evaluate=function(t){for(var e,n=null,r=0,i=0,o=this.args;i<o.length&&(r++,(n=o[i].evaluate(t))&&n instanceof ne&&!n.available&&(e||(e=n.name),n=null,r===this.args.length&&(n=e)),null===n);i+=1);return n},an.prototype.eachChild=function(t){this.args.forEach(t)},an.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},an.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var sn=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};sn.prototype.evaluate=function(t){return this.result.evaluate(t)},sn.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},sn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],r=1;r<t.length-1;r+=2){var i=t[r];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return a?new sn(n,a):null},sn.prototype.outputDefined=function(){return this.result.outputDefined()},sn.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var r=n[e];t.push(r[0],r[1].serialize())}return t.push(this.result.serialize()),t};var un=function(t,e,n){this.type=t,this.index=e,this.input=n};un.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,zt),r=e.parse(t[2],2,Zt(e.expectedType||Ut));return n&&r?new un(r.type.itemType,n,r):null},un.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ue("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new ue("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new ue("Array index must be an integer, but found "+e+" instead.");return n[e]},un.prototype.eachChild=function(t){t(this.index),t(this.input)},un.prototype.outputDefined=function(){return!1},un.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cn=function(t,e){this.type=Nt,this.needle=t,this.haystack=e};cn.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Ut),r=e.parse(t[2],2,Ut);return n&&r?Yt(n.type,[Nt,jt,zt,Dt,Ut])?new cn(n,r):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(n.type)+" instead"):null},cn.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!Kt(e,["boolean","string","number","null"]))throw new ue("Expected first argument to be of type boolean, string, number or null, but found "+Ht(oe(e))+" instead.");if(!Kt(n,["string","array"]))throw new ue("Expected second argument to be of type array or string, but found "+Ht(oe(n))+" instead.");return n.indexOf(e)>=0},cn.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},cn.prototype.outputDefined=function(){return!0},cn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ln=function(t,e,n){this.type=zt,this.needle=t,this.haystack=e,this.fromIndex=n};ln.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Ut),r=e.parse(t[2],2,Ut);if(!n||!r)return null;if(!Yt(n.type,[Nt,jt,zt,Dt,Ut]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(n.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,zt);return i?new ln(n,r,i):null}return new ln(n,r)},ln.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Kt(e,["boolean","string","number","null"]))throw new ue("Expected first argument to be of type boolean, string, number or null, but found "+Ht(oe(e))+" instead.");if(!Kt(n,["string","array"]))throw new ue("Expected second argument to be of type array or string, but found "+Ht(oe(n))+" instead.");if(this.fromIndex){var r=this.fromIndex.evaluate(t);return n.indexOf(e,r)}return n.indexOf(e)},ln.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},ln.prototype.outputDefined=function(){return!1},ln.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fn=function(t,e,n,r,i,o){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o};fn.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],u=t[a+1];Array.isArray(s)||(s=[s]);var c=e.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var l=0,f=s;l<f.length;l+=1){var p=f[l];if("number"!=typeof p&&"string"!=typeof p)return c.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,oe(p)))return null}else n=oe(p);if(void 0!==i[String(p)])return c.error("Branch labels must be unique.");i[String(p)]=o.length}var h=e.parse(u,a,r);if(!h)return null;r=r||h.type,o.push(h)}var d=e.parse(t[1],1,Ut);if(!d)return null;var m=e.parse(t[t.length-1],t.length-1,r);return m?"value"!==d.type.kind&&e.concat(1).checkSubtype(n,d.type)?null:new fn(n,r,d,i,o,m):null},fn.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(oe(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},fn.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},fn.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},fn.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],r={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i];void 0===(f=r[this.cases[a]])?(r[this.cases[a]]=n.length,n.push([this.cases[a],[a]])):n[f][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,c=n;u<c.length;u+=1){var l=c[u],f=l[0],p=l[1];e.push(1===p.length?s(p[0]):p.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var pn=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};pn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var r=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,Nt);if(!o)return null;var a=e.parse(t[i+1],i+1,n);if(!a)return null;r.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new pn(n,r,s):null},pn.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[1];if(r[0].evaluate(t))return i.evaluate(t)}return this.otherwise.evaluate(t)},pn.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[1];t(r[0]),t(i)}t(this.otherwise)},pn.prototype.outputDefined=function(){return this.branches.every((function(t){return t[1].outputDefined()}))&&this.otherwise.outputDefined()},pn.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var hn=function(t,e,n,r){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=r};function dn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function mn(t,e,n,r){return 0===r.compare(e,n)}function vn(t,e,n){var r="=="!==t&&"!="!==t;return function(){function i(t,e,n){this.type=Nt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,Ut);if(!o)return null;if(!dn(n,o.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Ht(o.type)+"'.");var a=e.parse(t[2],2,Ut);if(!a)return null;if(!dn(n,a.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Ht(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+Ht(o.type)+"' and '"+Ht(a.type)+"'.");r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new le(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new le(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Vt)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var s=oe(o),u=oe(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new ue('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var c=oe(o),l=oe(a);if("string"!==c.kind||"string"!==l.kind)return e(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},i}()}hn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Ut),r=e.parse(t[2],2,zt);if(!n||!r)return null;if(!Yt(n.type,[Zt(Ut),jt,Ut]))return e.error("Expected first argument to be of type array or string, but found "+Ht(n.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,zt);return i?new hn(n.type,n,r,i):null}return new hn(n.type,n,r)},hn.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Kt(e,["string","array"]))throw new ue("Expected first argument to be of type array or string, but found "+Ht(oe(e))+" instead.");if(this.endIndex){var r=this.endIndex.evaluate(t);return e.slice(n,r)}return e.slice(n)},hn.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},hn.prototype.outputDefined=function(){return!1},hn.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var gn=vn("==",(function(t,e,n){return e===n}),mn),yn=vn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!mn(0,e,n,r)})),_n=vn("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),bn=vn(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),xn=vn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),wn=vn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0})),Sn=function(t,e,n,r,i){this.type=jt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i};Sn.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,zt);if(!n)return null;var r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");var i=null;if(r.locale&&!(i=e.parse(r.locale,1,jt)))return null;var o=null;if(r.currency&&!(o=e.parse(r.currency,1,jt)))return null;var a=null;if(r["min-fraction-digits"]&&!(a=e.parse(r["min-fraction-digits"],1,zt)))return null;var s=null;return r["max-fraction-digits"]&&!(s=e.parse(r["max-fraction-digits"],1,zt))?null:new Sn(n,i,o,a,s)},Sn.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Sn.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Sn.prototype.outputDefined=function(){return!1},Sn.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var En=function(t){this.type=zt,this.input=t};En.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Ht(n.type)+" instead."):new En(n):null},En.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ue("Expected value to be of type string or array, but found "+Ht(oe(e))+" instead.")},En.prototype.eachChild=function(t){t(this.input)},En.prototype.outputDefined=function(){return!1},En.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Tn={"==":gn,"!=":yn,">":bn,"<":_n,">=":wn,"<=":xn,array:le,at:un,boolean:le,case:pn,coalesce:an,collator:ye,format:fe,image:pe,in:cn,"index-of":ln,interpolate:rn,"interpolate-hcl":rn,"interpolate-lab":rn,length:En,let:sn,literal:se,match:fn,number:le,"number-format":Sn,object:le,slice:hn,step:Ue,string:le,"to-boolean":de,"to-color":de,"to-number":de,"to-string":de,var:Ne,within:Re};function An(t,e){var n=e[0],r=e[1],i=e[2],o=e[3];n=n.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=re(n,r,i,a);if(s)throw new ue(s);return new Qt(n/255*a,r/255*a,i/255*a,a)}function Cn(t,e){return t in e}function kn(t,e){var n=e[t];return void 0===n?null:n}function Pn(t){return{type:t}}function Mn(t){return{result:"success",value:t}}function In(t){return{result:"error",value:t}}function On(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Ln(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Rn(t){return!!t.expression&&t.expression.interpolated}function Dn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function zn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function jn(t){return t}function Nn(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Fn(t,e,n,r,i){return Nn(typeof n===i?r[n]:void 0,t.default,e.default)}function Bn(t,e,n){if("number"!==Dn(n))return Nn(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var i=Be(t.stops.map((function(t){return t[0]})),n);return t.stops[i][1]}function Un(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==Dn(n))return Nn(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var o=Be(t.stops.map((function(t){return t[0]})),n),a=function(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],u=t.stops[o+1][1],c=Ge[e.type]||jn;if(t.colorSpace&&"rgb"!==t.colorSpace){var l=nn[t.colorSpace];c=function(t,e){return l.reverse(l.interpolate(l.forward(t),l.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),r=u.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return c(n,r,a)}}:c(s,u,a)}function Vn(t,e,n){return"color"===e.type?n=Qt.parse(n):"formatted"===e.type?n=ee.fromString(n.toString()):"resolvedImage"===e.type?n=ne.fromString(n.toString()):Dn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Nn(n,t.default,e.default)}ge.register(Tn,{error:[{kind:"error"},[jt],function(t,e){throw new ue(e[0].evaluate(t))}],typeof:[jt,[Ut],function(t,e){return Ht(oe(e[0].evaluate(t)))}],"to-rgba":[Zt(zt,4),[Ft],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Ft,[zt,zt,zt],An],rgba:[Ft,[zt,zt,zt,zt],An],has:{type:Nt,overloads:[[[jt],function(t,e){return Cn(e[0].evaluate(t),t.properties())}],[[jt,Bt],function(t,e){var n=e[1];return Cn(e[0].evaluate(t),n.evaluate(t))}]]},get:{type:Ut,overloads:[[[jt],function(t,e){return kn(e[0].evaluate(t),t.properties())}],[[jt,Bt],function(t,e){var n=e[1];return kn(e[0].evaluate(t),n.evaluate(t))}]]},"feature-state":[Ut,[jt],function(t,e){return kn(e[0].evaluate(t),t.featureState||{})}],properties:[Bt,[],function(t){return t.properties()}],"geometry-type":[jt,[],function(t){return t.geometryType()}],id:[Ut,[],function(t){return t.id()}],zoom:[zt,[],function(t){return t.globals.zoom}],"heatmap-density":[zt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[zt,[],function(t){return t.globals.lineProgress||0}],accumulated:[Ut,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[zt,Pn(zt),function(t,e){for(var n=0,r=0,i=e;r<i.length;r+=1)n+=i[r].evaluate(t);return n}],"*":[zt,Pn(zt),function(t,e){for(var n=1,r=0,i=e;r<i.length;r+=1)n*=i[r].evaluate(t);return n}],"-":{type:zt,overloads:[[[zt,zt],function(t,e){var n=e[1];return e[0].evaluate(t)-n.evaluate(t)}],[[zt],function(t,e){return-e[0].evaluate(t)}]]},"/":[zt,[zt,zt],function(t,e){var n=e[1];return e[0].evaluate(t)/n.evaluate(t)}],"%":[zt,[zt,zt],function(t,e){var n=e[1];return e[0].evaluate(t)%n.evaluate(t)}],ln2:[zt,[],function(){return Math.LN2}],pi:[zt,[],function(){return Math.PI}],e:[zt,[],function(){return Math.E}],"^":[zt,[zt,zt],function(t,e){var n=e[1];return Math.pow(e[0].evaluate(t),n.evaluate(t))}],sqrt:[zt,[zt],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[zt,[zt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[zt,[zt],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[zt,[zt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[zt,[zt],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[zt,[zt],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[zt,[zt],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[zt,[zt],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[zt,[zt],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[zt,[zt],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[zt,Pn(zt),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[zt,Pn(zt),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[zt,[zt],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[zt,[zt],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[zt,[zt],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[zt,[zt],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Nt,[jt,Ut],function(t,e){var n=e[0],r=e[1];return t.properties()[n.value]===r.value}],"filter-id-==":[Nt,[Ut],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Nt,[jt],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Nt,[jt,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<o}],"filter-id-<":[Nt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[Nt,[jt,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>o}],"filter-id->":[Nt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[Nt,[jt,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[Nt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[Nt,[jt,Ut],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[Nt,[Ut],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[Nt,[Ut],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Nt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Nt,[Zt(jt)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Nt,[Zt(Ut)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Nt,[jt,Zt(Ut)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Nt,[jt,Zt(Ut)],function(t,e){var n=e[0],r=e[1];return function(t,e,n,r){for(;n<=r;){var i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:Nt,overloads:[[[Nt,Nt],function(t,e){var n=e[1];return e[0].evaluate(t)&&n.evaluate(t)}],[Pn(Nt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(!r[n].evaluate(t))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],function(t,e){var n=e[1];return e[0].evaluate(t)||n.evaluate(t)}],[Pn(Nt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(r[n].evaluate(t))return!0;return!1}]]},"!":[Nt,[Nt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Nt,[jt],function(t,e){var n=t.globals&&t.globals.isSupportedScript;return!n||n(e[0].evaluate(t))}],upcase:[jt,[jt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[jt,[jt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[jt,Pn(Ut),function(t,e){return e.map((function(e){return ae(e.evaluate(t))})).join("")}],"resolved-locale":[jt,[Vt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Gn=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new ve,this._defaultValue=e?function(t){return"color"===t.type&&zn(t.default)?new Qt(0,0,0,0):"color"===t.type?Qt.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null};function qn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Tn}function Zn(t,e){var n=new Fe(Tn,[],e?function(t){var e={color:Ft,string:jt,number:zt,enum:jt,boolean:Nt,formatted:Gt,resolvedImage:qt};return"array"===t.type?Zt(e[t.value]||Ut,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Mn(new Gn(r,e)):In(n.errors)}Gn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},Gn.prototype.evaluate=function(t,e,n,r,i,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ue("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Hn=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!ze(e.expression)};Hn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)},Hn.prototype.evaluate=function(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)};var Wn=function(t,e,n,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!ze(e.expression),this.interpolationType=r};function Xn(t,e){if("error"===(t=Zn(t,e)).result)return t;var n=t.value.expression,r=De(n);if(!r&&!On(e))return In([new Lt("","data expressions not supported")]);var i=je(n,["zoom"]);if(!i&&!Ln(e))return In([new Lt("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof sn)n=t(e.result);else if(e instanceof an)for(var r=0,i=e.args;r<i.length&&!(n=t(i[r]));r+=1);else(e instanceof Ue||e instanceof rn)&&e.input instanceof ge&&"zoom"===e.input.name&&(n=e);return n instanceof Lt||e.eachChild((function(e){var r=t(e);r instanceof Lt?n=r:!n&&r?n=new Lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new Lt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}(n);return o||i?o instanceof Lt?In([o]):o instanceof rn&&!Rn(e)?In([new Lt("",'"interpolate" expressions cannot be used with this property')]):Mn(o?new Wn(r?"camera":"composite",t.value,o.labels,o instanceof rn?o.interpolation:void 0):new Hn(r?"constant":"source",t.value)):In([new Lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Wn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)},Wn.prototype.evaluate=function(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)},Wn.prototype.interpolationFactor=function(t,e,n){return this.interpolationType?rn.interpolationFactor(this.interpolationType,t,e,n):0};var Yn=function(t,e){this._parameters=t,this._specification=e,Mt(this,function t(e,n){var r,i,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],u=s||!(s||void 0!==e.property),c=e.type||(Rn(n)?"exponential":"interval");if(a&&((e=Mt({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],Qt.parse(t[1])]}))),e.default=Qt.parse(e.default?e.default:n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!nn[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)r=Un;else if("interval"===c)r=Bn;else if("categorical"===c){r=Fn,i=Object.create(null);for(var l=0,f=e.stops;l<f.length;l+=1){var p=f[l];i[p[0]]=p[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');r=Vn}if(s){for(var h={},d=[],m=0;m<e.stops.length;m++){var v=e.stops[m],g=v[0].zoom;void 0===h[g]&&(h[g]={zoom:g,type:e.type,property:e.property,default:e.default,stops:[]},d.push(g)),h[g].stops.push([v[0].value,v[1]])}for(var y=[],_=0,b=d;_<b.length;_+=1){var x=b[_];y.push([h[x].zoom,t(h[x],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:rn.interpolationFactor.bind(void 0,w),zoomStops:y.map((function(t){return t[0]})),evaluate:function(t,r){var i=t.zoom;return Un({stops:y,base:e.base},n,i).evaluate(i,r)}}}if(u){var S="exponential"===c?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:rn.interpolationFactor.bind(void 0,S),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){return r(e,n,t.zoom,i,o)}}}return{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Nn(e.default,n.default):r(e,n,s,i,o)}}}(this._parameters,this._specification))};function Kn(t){var e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],u=Dn(n);if("object"!==u)return[new kt(e,n,"object expected, "+u+" found")];for(var c in n){var l=c.split(".")[0],f=r[l]||r["*"],p=void 0;if(i[l])p=i[l];else if(r[l])p=xr;else if(i["*"])p=i["*"];else{if(!r["*"]){s.push(new kt(e,n[c],'unknown property "'+c+'"'));continue}p=xr}s=s.concat(p({key:(e?e+".":e)+c,value:n[c],valueSpec:f,style:o,styleSpec:a,object:n,objectKey:c},n))}for(var h in r)i[h]||r[h].required&&void 0===r[h].default&&void 0===n[h]&&s.push(new kt(e,n,'missing required property "'+h+'"'));return s}function Jn(t){var e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||xr;if("array"!==Dn(e))return[new kt(o,e,"array expected, "+Dn(e)+" found")];if(n.length&&e.length!==n.length)return[new kt(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new kt(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value,values:n.values};i.$version<7&&(s.function=n.function),"object"===Dn(n.value)&&(s=n.value);for(var u=[],c=0;c<e.length;c++)u=u.concat(a({array:e,arrayIndex:c,value:e[c],valueSpec:s,style:r,styleSpec:i,key:o+"["+c+"]"}));return u}function Qn(t){var e=t.key,n=t.value,r=t.valueSpec,i=Dn(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new kt(e,n,"number expected, "+i+" found")]:"minimum"in r&&n<r.minimum?[new kt(e,n,n+" is less than the minimum value "+r.minimum)]:"maximum"in r&&n>r.maximum?[new kt(e,n,n+" is greater than the maximum value "+r.maximum)]:[]}function $n(t){var e,n,r,i=t.valueSpec,o=It(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,u=!s,c="array"===Dn(t.value.stops)&&"array"===Dn(t.value.stops[0])&&"object"===Dn(t.value.stops[0][0]),l=Kn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new kt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(Jn({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:f})),"array"===Dn(n)&&0===n.length&&e.push(new kt(t.key,n,"array must have at least one stop")),e},default:function(t){return xr({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&l.push(new kt(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||l.push(new kt(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!Rn(t.valueSpec)&&l.push(new kt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!On(t.valueSpec)?l.push(new kt(t.key,t.value,"property functions not supported")):s&&!Ln(t.valueSpec)&&l.push(new kt(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==t.value.property||l.push(new kt(t.key,t.value,'"property" property is required')),l;function f(t){var e=[],o=t.value,s=t.key;if("array"!==Dn(o))return[new kt(s,o,"array expected, "+Dn(o)+" found")];if(2!==o.length)return[new kt(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==Dn(o[0]))return[new kt(s,o,"object expected, "+Dn(o[0])+" found")];if(void 0===o[0].zoom)return[new kt(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new kt(s,o,"object stop key must have value")];if(r&&r>It(o[0].zoom))return[new kt(s,o[0].zoom,"stop zoom values must appear in ascending order")];It(o[0].zoom)!==r&&(r=It(o[0].zoom),n=void 0,a={}),e=e.concat(Kn({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Qn,value:p}}))}else e=e.concat(p({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return qn(Ot(o[1]))?e.concat([new kt(s+"[1]",o[1],"expressions are not allowed in function stops.")]):e.concat(xr({key:s+"[1]",value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function p(t,r){var s=Dn(t.value),u=It(t.value),c=null!==t.value?t.value:r;if(e){if(s!==e)return[new kt(t.key,c,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new kt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var l="number expected, "+s+" found";return On(i)&&void 0===o&&(l+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(t.key,c,l)]}return"categorical"!==o||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==o&&"number"===s&&void 0!==n&&u<n?[new kt(t.key,c,"stop domain values must appear in ascending order")]:(n=u,"categorical"===o&&u in a?[new kt(t.key,c,"stop domain values must be unique")]:(a[u]=!0,[])):[new kt(t.key,c,"integer expected, found "+u)]}}function tr(t){var e=("property"===t.expressionContext?Xn:Zn)(Ot(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new kt(""+t.key+e.key,t.value,e.message)}));var n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new kt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!ze(n))return[new kt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!ze(n))return[new kt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!je(n,["zoom","feature-state"]))return[new kt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!De(n))return[new kt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function er(t){var e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(It(n))&&i.push(new kt(e,n,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(r.values).indexOf(It(n))&&i.push(new kt(e,n,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}function nr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var r=n[e];if(!nr(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}Yn.deserialize=function(t){return new Yn(t._parameters,t._specification)},Yn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var rr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ir(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};nr(t)||(t=ar(t));var e=Zn(t,rr);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return{filter:function(t,n,r){return e.value.evaluate(t,n,{},r)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var n=1;n<e.length;n++)if(t(e[n]))return!0;return!1}(t)}}function or(t,e){return t<e?-1:t>e?1:0}function ar(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?sr(t[1],t[2],"=="):"!="===n?lr(sr(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?sr(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(ar))):"all"===n?["all"].concat(t.slice(1).map(ar)):"none"===n?["all"].concat(t.slice(1).map(ar).map(lr)):"in"===n?ur(t[1],t.slice(2)):"!in"===n?lr(ur(t[1],t.slice(2))):"has"===n?cr(t[1]):"!has"===n?lr(cr(t[1])):"within"!==n||t}function sr(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function ur(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(or)]]:["filter-in-small",t,["literal",e]]}}function cr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function lr(t){return["!",t]}function fr(t){return nr(Ot(t.value))?tr(Mt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,r=e.key;if("array"!==Dn(n))return[new kt(r,n,"array expected, "+Dn(n)+" found")];var i,o=e.styleSpec,a=[];if(n.length<1)return[new kt(r,n,"filter array must have at least 1 element")];switch(a=a.concat(er({key:r+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),It(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===It(n[1])&&a.push(new kt(r,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new kt(r,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(i=Dn(n[1]))&&a.push(new kt(r+"[1]",n[1],"string expected, "+i+" found"));for(var s=2;s<n.length;s++)i=Dn(n[s]),"$type"===It(n[1])?a=a.concat(er({key:r+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new kt(r+"["+s+"]",n[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var u=1;u<n.length;u++)a=a.concat(t({key:r+"["+u+"]",value:n[u],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Dn(n[1]),2!==n.length?a.push(new kt(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new kt(r+"[1]",n[1],"string expected, "+i+" found"));break;case"within":i=Dn(n[1]),2!==n.length?a.push(new kt(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"object"!==i&&a.push(new kt(r+"[1]",n[1],"object expected, "+i+" found"))}return a}(t)}function pr(t,e){var n=t.key,r=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var u=a.match(/^(.*)-transition$/);if("paint"===e&&u&&s[u[1]]&&s[u[1]].transition)return xr({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});var c,l=t.valueSpec||s[a];if(!l)return[new kt(n,o,'unknown property "'+a+'"')];if("string"===Dn(o)&&On(l)&&!l.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new kt(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var f=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&f.push(new kt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&zn(Ot(o))&&"identity"===It(o.type)&&f.push(new kt(n,o,'"text-font" does not support identity functions'))),f.concat(xr({key:t.key,value:o,valueSpec:l,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function hr(t){return pr(t,"paint")}function dr(t){return pr(t,"layout")}function mr(t){var e=[],n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new kt(r,n,'either "type" or "ref" is required'));var a,s=It(n.type),u=It(n.ref);if(n.id)for(var c=It(n.id),l=0;l<t.arrayIndex;l++){var f=i.layers[l];It(f.id)===c&&e.push(new kt(r,n.id,'duplicate layer id "'+n.id+'", previously used at line '+f.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new kt(r,n[t],'"'+t+'" is prohibited for ref layers'))})),i.layers.forEach((function(t){It(t.id)===u&&(a=t)})),a?a.ref?e.push(new kt(r,n.ref,"ref cannot reference another ref layer")):s=It(a.type):e.push(new kt(r,n.ref,'ref layer "'+u+'" not found'));else if("background"!==s)if(n.source){var p=i.sources&&i.sources[n.source],h=p&&It(p.type);p?"vector"===h&&"raster"===s?e.push(new kt(r,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===h&&"raster"!==s?e.push(new kt(r,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==h||n["source-layer"]?"raster-dem"===h&&"hillshade"!==s?e.push(new kt(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===h&&p.lineMetrics||e.push(new kt(r,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new kt(r,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new kt(r,n.source,'source "'+n.source+'" not found'))}else e.push(new kt(r,n,'missing required property "source"'));return e=e.concat(Kn({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return xr({key:r+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:fr,layout:function(t){return Kn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return dr(Mt({layerType:s},t))}}})},paint:function(t){return Kn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return hr(Mt({layerType:s},t))}}})}}}))}function vr(t){var e=t.value,n=t.key,r=Dn(e);return"string"!==r?[new kt(n,e,"string expected, "+r+" found")]:[]}var gr={promoteId:function(t){var e=t.key,n=t.value;if("string"===Dn(n))return vr({key:e,value:n});var r=[];for(var i in n)r.push.apply(r,vr({key:e+"."+i,value:n[i]}));return r}};function yr(t){var e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new kt(n,e,'"type" is required')];var o,a=It(e.type);switch(a){case"vector":case"raster":case"raster-dem":return Kn({key:n,value:e,valueSpec:r["source_"+a.replace("-","_")],style:t.style,styleSpec:r,objectElementValidators:gr});case"geojson":if(o=Kn({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r,objectElementValidators:gr}),e.cluster)for(var s in e.clusterProperties){var u=e.clusterProperties[s],c=u[0],l="string"==typeof c?[c,["accumulated"],["get",s]]:c;o.push.apply(o,tr({key:n+"."+s+".map",value:u[1],expressionContext:"cluster-map"})),o.push.apply(o,tr({key:n+"."+s+".reduce",value:l,expressionContext:"cluster-reduce"}))}return o;case"video":return Kn({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return Kn({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new kt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return er({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function _r(t){var e=t.value,n=t.styleSpec,r=n.light,i=t.style,o=[],a=Dn(e);if(void 0===e)return o;if("object"!==a)return o.concat([new kt("light",e,"object expected, "+a+" found")]);for(var s in e){var u=s.match(/^(.*)-transition$/);o=o.concat(u&&r[u[1]]&&r[u[1]].transition?xr({key:s,value:e[s],valueSpec:n.transition,style:i,styleSpec:n}):r[s]?xr({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n}):[new kt(s,e[s],'unknown property "'+s+'"')])}return o}var br={"*":function(){return[]},array:Jn,boolean:function(t){var e=t.value,n=t.key,r=Dn(e);return"boolean"!==r?[new kt(n,e,"boolean expected, "+r+" found")]:[]},number:Qn,color:function(t){var e=t.key,n=t.value,r=Dn(n);return"string"!==r?[new kt(e,n,"color expected, "+r+" found")]:null===Jt(n)?[new kt(e,n,'color expected, "'+n+'" found')]:[]},constants:Pt,enum:er,filter:fr,function:$n,layer:mr,object:Kn,source:yr,light:_r,string:vr,formatted:function(t){return 0===vr(t).length?[]:tr(t)},resolvedImage:function(t){return 0===vr(t).length?[]:tr(t)}};function xr(t){var e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&zn(It(e))?$n(t):n.expression&&qn(Ot(e))?tr(t):n.type&&br[n.type]?br[n.type](t):Kn(Mt({},t,{valueSpec:n.type?r[n.type]:n}))}function wr(t){var e=t.value,n=t.key,r=vr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new kt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new kt(n,e,'"glyphs" url must include a "{range}" token'))),r}function Sr(t,e){void 0===e&&(e=Ct);var n=[];return n=n.concat(xr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:wr,"*":function(){return[]}}})),t.constants&&(n=n.concat(Pt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Er(n)}function Er(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function Tr(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return Er(t.apply(this,e))}}Sr.source=Tr(yr),Sr.light=Tr(_r),Sr.layer=Tr(mr),Sr.filter=Tr(fr),Sr.paintProperty=Tr(hr),Sr.layoutProperty=Tr(dr);var Ar=Sr,Cr=Ar.light,kr=Ar.paintProperty,Pr=Ar.layoutProperty;function Mr(t,e){var n=!1;if(e&&e.length)for(var r=0,i=e;r<i.length;r+=1)t.fire(new Tt(new Error(i[r].message))),n=!0;return n}var Ir=Or;function Or(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],this.d=(e=i[1])+2*(n=i[2]);for(var o=0;o<this.d*this.d;o++){var a=i[3+o],s=i[3+o+1];r.push(a===s?null:i.subarray(a,s))}var u=i[3+r.length+1];this.keys=i.subarray(i[3+r.length],u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var l=n/e*t;this.min=-l,this.max=t+l}Or.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Or.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Or.prototype._insertCell=function(t,e,n,r,i,o){this.cells[i].push(o)},Or.prototype.query=function(t,e,n,r,i){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=n&&a<=r&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,n,r,this._queryCell,s,{},i),s},Or.prototype._queryCell=function(t,e,n,r,i,o,a,s){var u=this.cells[i];if(null!==u)for(var c=this.keys,l=this.bboxes,f=0;f<u.length;f++){var p=u[f];if(void 0===a[p]){var h=4*p;(s?s(l[h+0],l[h+1],l[h+2],l[h+3]):t<=l[h+2]&&e<=l[h+3]&&n>=l[h+0]&&r>=l[h+1])?(a[p]=!0,o.push(c[p])):a[p]=!1}}},Or.prototype._forEachCell=function(t,e,n,r,i,o,a,s){for(var u=this._convertToCellCoord(t),c=this._convertToCellCoord(e),l=this._convertToCellCoord(n),f=this._convertToCellCoord(r),p=u;p<=l;p++)for(var h=c;h<=f;h++){var d=this.d*h+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(h),this._convertFromCellCoord(p+1),this._convertFromCellCoord(h+1)))&&i.call(this,t,e,n,r,d,o,a,s))return}},Or.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Or.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Or.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+t.length]=o,i.set(this.keys,o),i[3+t.length+1]=o+=this.keys.length,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var Lr=a.ImageData,Rr=a.ImageBitmap,Dr={};function zr(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Dr[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var jr in zr("Object",Object),Ir.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Ir.deserialize=function(t){return new Ir(t.buffer)},zr("Grid",Ir),zr("Color",Qt),zr("Error",Error),zr("ResolvedImage",ne),zr("StylePropertyFunction",Yn),zr("StyleExpression",Gn,{omit:["_evaluator"]}),zr("ZoomDependentExpression",Wn),zr("ZoomConstantExpression",Hn),zr("CompoundExpression",ge,{omit:["_evaluate"]}),Tn)Tn[jr]._classRegistryKey||zr("Expression_"+jr,Tn[jr]);function Nr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Fr(t){return Rr&&t instanceof Rr}function Br(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Nr(t)||Fr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Lr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var r=[],i=0,o=t;i<o.length;i+=1)r.push(Br(o[i],e));return r}if("object"==typeof t){var a=t.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var u=a.serialize?a.serialize(t,e):{};if(!a.serialize){for(var c in t)if(t.hasOwnProperty(c)&&!(Dr[s].omit.indexOf(c)>=0)){var l=t[c];u[c]=Dr[s].shallow.indexOf(c)>=0?l:Br(l,e)}t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof t)}function Ur(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Nr(t)||Fr(t)||ArrayBuffer.isView(t)||t instanceof Lr)return t;if(Array.isArray(t))return t.map(Ur);if("object"==typeof t){var e=t.$name||"Object",n=Dr[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var r=Object.create(n.prototype),i=0,o=Object.keys(t);i<o.length;i+=1){var a=o[i];if("$name"!==a){var s=t[a];r[a]=Dr[e].shallow.indexOf(a)>=0?s:Ur(s)}}return r}throw new Error("can't deserialize object of type "+typeof t)}var Vr=function(){this.first=!0};Vr.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var Gr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function qr(t){for(var e=0,n=t;e<n.length;e+=1)if(Zr(n[e].charCodeAt(0)))return!0;return!1}function Zr(t){return!(746!==t&&747!==t&&(t<4352||!(Gr["Bopomofo Extended"](t)||Gr.Bopomofo(t)||Gr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Gr["CJK Compatibility Ideographs"](t)||Gr["CJK Compatibility"](t)||Gr["CJK Radicals Supplement"](t)||Gr["CJK Strokes"](t)||!(!Gr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Gr["CJK Unified Ideographs Extension A"](t)||Gr["CJK Unified Ideographs"](t)||Gr["Enclosed CJK Letters and Months"](t)||Gr["Hangul Compatibility Jamo"](t)||Gr["Hangul Jamo Extended-A"](t)||Gr["Hangul Jamo Extended-B"](t)||Gr["Hangul Jamo"](t)||Gr["Hangul Syllables"](t)||Gr.Hiragana(t)||Gr["Ideographic Description Characters"](t)||Gr.Kanbun(t)||Gr["Kangxi Radicals"](t)||Gr["Katakana Phonetic Extensions"](t)||Gr.Katakana(t)&&12540!==t||!(!Gr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Gr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Gr["Unified Canadian Aboriginal Syllabics"](t)||Gr["Unified Canadian Aboriginal Syllabics Extended"](t)||Gr["Vertical Forms"](t)||Gr["Yijing Hexagram Symbols"](t)||Gr["Yi Syllables"](t)||Gr["Yi Radicals"](t))))}function Hr(t){return!(Zr(t)||function(t){return!!(Gr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Gr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Gr["Letterlike Symbols"](t)||Gr["Number Forms"](t)||Gr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Gr["Control Pictures"](t)&&9251!==t||Gr["Optical Character Recognition"](t)||Gr["Enclosed Alphanumerics"](t)||Gr["Geometric Shapes"](t)||Gr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Gr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Gr["CJK Symbols and Punctuation"](t)||Gr.Katakana(t)||Gr["Private Use Area"](t)||Gr["CJK Compatibility Forms"](t)||Gr["Small Form Variants"](t)||Gr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Wr(t){return t>=1424&&t<=2303||Gr["Arabic Presentation Forms-A"](t)||Gr["Arabic Presentation Forms-B"](t)}function Xr(t,e){return!(!e&&Wr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Gr.Khmer(t))}function Yr(t){for(var e=0,n=t;e<n.length;e+=1)if(Wr(n[e].charCodeAt(0)))return!0;return!1}var Kr=null,Jr="unavailable",Qr=null,$r=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Jr="error"),Kr&&Kr(t)};function ti(){ei.fire(new Et("pluginStateChange",{pluginStatus:Jr,pluginURL:Qr}))}var ei=new At,ni=function(){return Jr},ri=function(){if("deferred"!==Jr||!Qr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Jr="loading",ti(),Qr&&_t({url:Qr},(function(t){t?$r(t):(Jr="loaded",ti())}))},ii={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Jr||null!=ii.applyArabicShaping},isLoading:function(){return"loading"===Jr},setState:function(t){Jr=t.pluginStatus,Qr=t.pluginURL},isParsed:function(){return null!=ii.applyArabicShaping&&null!=ii.processBidirectionalText&&null!=ii.processStyledBidirectionalText},getPluginURL:function(){return Qr}},oi=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Vr,this.transition={})};oi.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,r=t;n<r.length;n+=1)if(!Xr(r[n].charCodeAt(0),e))return!1;return!0}(t,ii.isLoaded())},oi.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},oi.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var ai=function(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(zn(t))return new Yn(t,e);if(qn(t)){var n=Xn(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return t.key+": "+t.message})).join(", "));return n.value}var r=t;return"string"==typeof t&&"color"===e.type&&(r=Qt.parse(t)),{kind:"constant",evaluate:function(){return r}}}(void 0===e?t.specification.default:e,t.specification)};ai.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ai.prototype.possiblyEvaluate=function(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)};var si=function(t){this.property=t,this.value=new ai(t,void 0)};si.prototype.transitioned=function(t,e){return new ci(this.property,this.value,e,f({},t.transition,this.transition),t.now)},si.prototype.untransitioned=function(){return new ci(this.property,this.value,null,{},0)};var ui=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};ui.prototype.getValue=function(t){return b(this._values[t].value.value)},ui.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new si(this._values[t].property)),this._values[t].value=new ai(this._values[t].property,null===e?void 0:b(e))},ui.prototype.getTransition=function(t){return b(this._values[t].transition)},ui.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new si(this._values[t].property)),this._values[t].transition=b(e)||void 0},ui.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i);var o=this.getTransition(r);void 0!==o&&(t[r+"-transition"]=o)}return t},ui.prototype.transitioned=function(t,e){for(var n=new li(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},ui.prototype.untransitioned=function(){for(var t=new li(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e];t._values[r]=this._values[r].untransitioned()}return t};var ci=function(t,e,n,r,i){this.property=t,this.value=e,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)};ci.prototype.possiblyEvaluate=function(t,e,n){var r=t.now||0,i=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return o.possiblyEvaluate(t,e,n);var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),i,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(a))}return i};var li=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};li.prototype.possiblyEvaluate=function(t,e,n){for(var r=new hi(this._properties),i=0,o=Object.keys(this._values);i<o.length;i+=1){var a=o[i];r._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return r},li.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var fi=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};fi.prototype.getValue=function(t){return b(this._values[t].value)},fi.prototype.setValue=function(t,e){this._values[t]=new ai(this._values[t].property,null===e?void 0:b(e))},fi.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i)}return t},fi.prototype.possiblyEvaluate=function(t,e,n){for(var r=new hi(this._properties),i=0,o=Object.keys(this._values);i<o.length;i+=1){var a=o[i];r._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return r};var pi=function(t,e,n){this.property=t,this.value=e,this.parameters=n};pi.prototype.isConstant=function(){return"constant"===this.value.kind},pi.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},pi.prototype.evaluate=function(t,e,n,r){return this.property.evaluate(this.value,this.parameters,t,e,n,r)};var hi=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};hi.prototype.get=function(t){return this._values[t]};var di=function(t){this.specification=t};di.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},di.prototype.interpolate=function(t,e,n){var r=Ge[this.specification.type];return r?r(t,e,n):t};var mi=function(t,e){this.specification=t,this.overrides=e};mi.prototype.possiblyEvaluate=function(t,e,n,r){return new pi(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,r)}:t.expression,e)},mi.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new pi(this,{kind:"constant",value:void 0},t.parameters);var r=Ge[this.specification.type];return r?new pi(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t},mi.prototype.evaluate=function(t,e,n,r,i,o){return"constant"===t.kind?t.value:t.evaluate(e,n,r,i,o)};var vi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(t,e,n,r){if(void 0===t.value)return new pi(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},n,r),o="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,a=this._calculate(o,o,o,e);return new pi(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){var s=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new pi(this,{kind:"constant",value:s},e)}return new pi(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,r,i,o){if("source"===t.kind){var a=t.evaluate(e,n,r,i,o);return this._calculate(a,a,a,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value},e.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}(mi),gi=function(t){this.specification=t};gi.prototype.possiblyEvaluate=function(t,e,n,r){if(void 0!==t.value){if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},n,r);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new oi(Math.floor(e.zoom-1),e)),t.expression.evaluate(new oi(Math.floor(e.zoom),e)),t.expression.evaluate(new oi(Math.floor(e.zoom+1),e)),e)}},gi.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},gi.prototype.interpolate=function(t){return t};var yi=function(t){this.specification=t};yi.prototype.possiblyEvaluate=function(t,e,n,r){return!!t.expression.evaluate(e,null,{},n,r)},yi.prototype.interpolate=function(){return!1};var _i=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var n=t[e];n.specification.overridable&&this.overridableProperties.push(e);var r=this.defaultPropertyValues[e]=new ai(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new si(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}};zr("DataDrivenProperty",mi),zr("DataConstantProperty",di),zr("CrossFadedDataDrivenProperty",vi),zr("CrossFadedProperty",gi),zr("ColorRampProperty",yi);var bi=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new fi(n.layout)),n.paint)){for(var r in this._transitionablePaint=new ui(n.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hi(n.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){void 0===n&&(n={}),null!=e&&this._validate(Pr,"layers."+this.id+".layout."+t,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},e.prototype.getPaintProperty=function(t){return g(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(void 0===n&&(n={}),null!=e&&this._validate(kr,"layers."+this.id+".paint."+t,t,e,n))return!1;if(g(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var r=this._transitionablePaint._values[t],i="cross-faded-data-driven"===r.property.specification["property-type"],o=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var s=this._transitionablePaint._values[t].value;return s.isDataDriven()||o||i||this._handleOverridablePaintPropertyUpdate(t,a,s)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype._handleOverridablePaintPropertyUpdate=function(t,e,n){return!1},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),_(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,n,r,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&Mr(this,t.call(Ar,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:Ct,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof pi&&On(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(At),xi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},wi=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Si=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ei(t,e){void 0===e&&(e=1);var n=0,r=0;return{members:t.map((function(t){var i=xi[t.type].BYTES_PER_ELEMENT,o=n=Ti(n,Math.max(e,i)),a=t.components||1;return r=Math.max(r,i),n+=i*a,{name:t.name,type:t.type,components:a,offset:o}})),size:Ti(n,Math.max(r,e)),alignment:e}}function Ti(t,e){return Math.ceil(t/e)*e}Si.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Si.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Si.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Si.prototype.clear=function(){this.length=0},Si.prototype.resize=function(t){this.reserve(t),this.length=t},Si.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Si.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ai=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t},e}(Si);Ai.prototype.bytesPerElement=4,zr("StructArrayLayout2i4",Ai);var Ci=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t},e}(Si);Ci.prototype.bytesPerElement=8,zr("StructArrayLayout4i8",Ci);var ki=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(Si);ki.prototype.bytesPerElement=12,zr("StructArrayLayout2i4i12",ki);var Pi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=4*t,u=8*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.uint8[u+4]=r,this.uint8[u+5]=i,this.uint8[u+6]=o,this.uint8[u+7]=a,t},e}(Si);Pi.prototype.bytesPerElement=8,zr("StructArrayLayout2i4ub8",Pi);var Mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c){var l=this.length;return this.resize(l+1),this.emplace(l,t,e,n,r,i,o,a,s,u,c)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l){var f=10*t;return this.uint16[f+0]=e,this.uint16[f+1]=n,this.uint16[f+2]=r,this.uint16[f+3]=i,this.uint16[f+4]=o,this.uint16[f+5]=a,this.uint16[f+6]=s,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=l,t},e}(Si);Mi.prototype.bytesPerElement=20,zr("StructArrayLayout10ui20",Mi);var Ii=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f){var p=this.length;return this.resize(p+1),this.emplace(p,t,e,n,r,i,o,a,s,u,c,l,f)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,p){var h=12*t;return this.int16[h+0]=e,this.int16[h+1]=n,this.int16[h+2]=r,this.int16[h+3]=i,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=u,this.int16[h+8]=c,this.int16[h+9]=l,this.int16[h+10]=f,this.int16[h+11]=p,t},e}(Si);Ii.prototype.bytesPerElement=24,zr("StructArrayLayout4i4ui4i24",Ii);var Oi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t},e}(Si);Oi.prototype.bytesPerElement=12,zr("StructArrayLayout3f12",Oi);var Li=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint32[1*t+0]=e,t},e}(Si);Li.prototype.bytesPerElement=4,zr("StructArrayLayout1ul4",Li);var Ri=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,r,i,o,a,s,u)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c){var l=10*t,f=5*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=r,this.int16[l+3]=i,this.int16[l+4]=o,this.int16[l+5]=a,this.uint32[f+3]=s,this.uint16[l+8]=u,this.uint16[l+9]=c,t},e}(Si);Ri.prototype.bytesPerElement=20,zr("StructArrayLayout6i1ul2ui20",Ri);var Di=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(Si);Di.prototype.bytesPerElement=12,zr("StructArrayLayout2i2i2i12",Di);var zi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r,i)},e.prototype.emplace=function(t,e,n,r,i,o){var a=4*t,s=8*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=r,this.int16[s+6]=i,this.int16[s+7]=o,t},e}(Si);zi.prototype.bytesPerElement=16,zr("StructArrayLayout2f1f2i16",zi);var ji=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[a+1]=r,this.float32[a+2]=i,t},e}(Si);ji.prototype.bytesPerElement=12,zr("StructArrayLayout2ub2f12",ji);var Ni=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t},e}(Si);Ni.prototype.bytesPerElement=6,zr("StructArrayLayout3ui6",Ni);var Fi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v){var g=this.length;return this.resize(g+1),this.emplace(g,t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v,g){var y=24*t,_=12*t,b=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=r,this.uint16[y+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[y+10]=u,this.uint16[y+11]=c,this.uint16[y+12]=l,this.float32[_+7]=f,this.float32[_+8]=p,this.uint8[b+36]=h,this.uint8[b+37]=d,this.uint8[b+38]=m,this.uint32[_+10]=v,this.int16[y+22]=g,t},e}(Si);Fi.prototype.bytesPerElement=48,zr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Fi);var Bi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v,g,y,_,b,x,w,S,E,T,A,C){var k=this.length;return this.resize(k+1),this.emplace(k,t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v,g,y,_,b,x,w,S,E,T,A,C)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v,g,y,_,b,x,w,S,E,T,A,C,k){var P=34*t,M=17*t;return this.int16[P+0]=e,this.int16[P+1]=n,this.int16[P+2]=r,this.int16[P+3]=i,this.int16[P+4]=o,this.int16[P+5]=a,this.int16[P+6]=s,this.int16[P+7]=u,this.uint16[P+8]=c,this.uint16[P+9]=l,this.uint16[P+10]=f,this.uint16[P+11]=p,this.uint16[P+12]=h,this.uint16[P+13]=d,this.uint16[P+14]=m,this.uint16[P+15]=v,this.uint16[P+16]=g,this.uint16[P+17]=y,this.uint16[P+18]=_,this.uint16[P+19]=b,this.uint16[P+20]=x,this.uint16[P+21]=w,this.uint16[P+22]=S,this.uint32[M+12]=E,this.float32[M+13]=T,this.float32[M+14]=A,this.float32[M+15]=C,this.float32[M+16]=k,t},e}(Si);Bi.prototype.bytesPerElement=68,zr("StructArrayLayout8i15ui1ul4f68",Bi);var Ui=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.float32[1*t+0]=e,t},e}(Si);Ui.prototype.bytesPerElement=4,zr("StructArrayLayout1f4",Ui);var Vi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t},e}(Si);Vi.prototype.bytesPerElement=6,zr("StructArrayLayout3i6",Vi);var Gi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=4*t;return this.uint32[2*t+0]=e,this.uint16[i+2]=n,this.uint16[i+3]=r,t},e}(Si);Gi.prototype.bytesPerElement=8,zr("StructArrayLayout1ul2ui8",Gi);var qi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t},e}(Si);qi.prototype.bytesPerElement=4,zr("StructArrayLayout2ui4",qi);var Zi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint16[1*t+0]=e,t},e}(Si);Zi.prototype.bytesPerElement=2,zr("StructArrayLayout1ui2",Zi);var Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t},e}(Si);Hi.prototype.bytesPerElement=8,zr("StructArrayLayout2f8",Hi);var Wi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t},e}(Si);Wi.prototype.bytesPerElement=16,zr("StructArrayLayout4f16",Wi);var Xi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(wi);Xi.prototype.size=20;var Yi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Xi(this,t)},e}(Ri);zr("CollisionBoxArray",Yi);var Ki=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},n.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},n.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,n),e}(wi);Ki.prototype.size=48;var Ji=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Ki(this,t)},e}(Fi);zr("PlacedSymbolArray",Ji);var Qi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},n.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},n.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},n.key.get=function(){return this._structArray.uint16[this._pos2+8]},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},n.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},n.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},n.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},n.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},n.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},n.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},n.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},n.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},n.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},n.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},n.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,n),e}(wi);Qi.prototype.size=68;var $i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Qi(this,t)},e}(Bi);zr("SymbolInstanceArray",$i);var to=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e}(Ui);zr("GlyphOffsetArray",to);var eo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e}(Vi);zr("SymbolLineVertexArray",eo);var no=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,n),e}(wi);no.prototype.size=8;var ro=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new no(this,t)},e}(Gi);zr("FeatureIndexArray",ro);var io=Ei([{name:"a_pos",components:2,type:"Int16"}],4).members,oo=function(t){void 0===t&&(t=[]),this.segments=t};function ao(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)}oo.prototype.prepareSegment=function(t,e,n,r){var i=this.segments[this.segments.length-1];return t>oo.MAX_VERTEX_ARRAY_LENGTH&&w("Max vertices per segment is "+oo.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!i||i.vertexLength+t>oo.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i},oo.prototype.get=function(){return this.segments},oo.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var r in n.vaos)n.vaos[r].destroy()}},oo.simpleSegment=function(t,e,n,r){return new oo([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])},oo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zr("SegmentVector",oo);var so=Ei([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),uo=e((function(t){t.exports=function(t,e){var n,r,i,o,a,s,u,c;for(r=t.length-(n=3&t.length),i=e,a=3432918353,s=461845907,c=0;c<r;)u=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,n){case 3:u^=(255&t.charCodeAt(c+2))<<16;case 2:u^=(255&t.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&t.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),co=e((function(t){t.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),lo=uo,fo=co;lo.murmur3=uo,lo.murmur2=fo;var po=function(){this.ids=[],this.positions=[],this.indexed=!1};po.prototype.add=function(t,e,n,r){this.ids.push(mo(t)),this.positions.push(e,n,r)},po.prototype.getPositions=function(t){for(var e=mo(t),n=0,r=this.ids.length-1;n<r;){var i=n+r>>1;this.ids[i]>=e?r=i:n=i+1}for(var o=[];this.ids[n]===e;)o.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return o},po.serialize=function(t,e){var n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,n,r,i){for(;r<i;){for(var o=e[r+i>>1],a=r-1,s=i+1;;){do{a++}while(e[a]<o);do{s--}while(e[s]>o);if(a>=s)break;vo(e,a,s),vo(n,3*a,3*s),vo(n,3*a+1,3*s+1),vo(n,3*a+2,3*s+2)}s-r<i-s?(t(e,n,r,s),r=s+1):(t(e,n,s+1,i),i=s)}}(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}},po.deserialize=function(t){var e=new po;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var ho=Math.pow(2,53)-1;function mo(t){var e=+t;return!isNaN(e)&&e<=ho?e:lo(String(t))}function vo(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}zr("FeaturePositionMap",po);var go=function(t,e){this.gl=t.gl,this.location=e},yo=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(go),_o=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(go),bo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(go),xo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(go),wo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(go),So=function(t){function e(e,n){t.call(this,e,n),this.current=Qt.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(go),Eo=new Float32Array(16),To=function(t){function e(e,n){t.call(this,e,n),this.current=Eo}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(go);function Ao(t){return[ao(255*t.r,255*t.g),ao(255*t.b,255*t.a)]}var Co=function(t,e,n){this.value=t,this.uniformNames=e.map((function(t){return"u_"+t})),this.type=n};Co.prototype.setUniform=function(t,e,n){t.set(n.constantOr(this.value))},Co.prototype.getBinding=function(t,e,n){return"color"===this.type?new So(t,e):new _o(t,e)};var ko=function(t,e){this.uniformNames=e.map((function(t){return"u_"+t})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ko.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},ko.prototype.setUniform=function(t,e,n,r){var i="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&t.set(i)},ko.prototype.getBinding=function(t,e,n){return"u_pattern"===n.substr(0,9)?new wo(t,e):new _o(t,e)};var Po=function(t,e,n,r){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new r};Po.prototype.populatePaintArray=function(t,e,n,r,i){var o=this.paintVertexArray.length,a=this.expression.evaluate(new oi(0),e,{},r,[],i);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)},Po.prototype.updatePaintArray=function(t,e,n,r){var i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(t,e,i)},Po.prototype._setPaintValue=function(t,e,n){if("color"===this.type)for(var r=Ao(n),i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}},Po.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Po.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Mo=function(t,e,n,r,i,o){this.expression=t,this.uniformNames=e.map((function(t){return"u_"+t+"_t"})),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new o};Mo.prototype.populatePaintArray=function(t,e,n,r,i){var o=this.expression.evaluate(new oi(this.zoom),e,{},r,[],i),a=this.expression.evaluate(new oi(this.zoom+1),e,{},r,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)},Mo.prototype.updatePaintArray=function(t,e,n,r){var i=this.expression.evaluate({zoom:this.zoom},n,r),o=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(t,e,i,o)},Mo.prototype._setPaintValue=function(t,e,n,r){if("color"===this.type)for(var i=Ao(n),o=Ao(r),a=t;a<e;a++)this.paintVertexArray.emplace(a,i[0],i[1],o[0],o[1]);else{for(var s=t;s<e;s++)this.paintVertexArray.emplace(s,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}},Mo.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Mo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Mo.prototype.setUniform=function(t,e){var n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=c(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(r)},Mo.prototype.getBinding=function(t,e,n){return new _o(t,e)};var Io=function(t,e,n,r,i,o){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=r,this.layerId=o,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i};Io.prototype.populatePaintArray=function(t,e,n){var r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],n)},Io.prototype.updatePaintArray=function(t,e,n,r,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)},Io.prototype._setPaintValues=function(t,e,n,r){if(r&&n){var i=r[n.min],o=r[n.mid],a=r[n.max];if(i&&o&&a)for(var s=t;s<e;s++)this.zoomInPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],o.pixelRatio,i.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},Io.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,so.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,so.members,this.expression.isStateDependent))},Io.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Oo=function(t,e,n){this.binders={},this._buffers=[];var r=[];for(var i in t.paint._values)if(n(i)){var o=t.paint.get(i);if(o instanceof pi&&On(o.property.specification)){var a=Ro(i,t.type),s=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,l=o.property.specification["property-type"],f="cross-faded"===l||"cross-faded-data-driven"===l;if("constant"===s.kind)this.binders[i]=f?new ko(s.value,a):new Co(s.value,a,u),r.push("/u_"+i);else if("source"===s.kind||f){var p=Do(i,u,"source");this.binders[i]=f?new Io(s,u,c,e,p,t.id):new Po(s,a,u,p),r.push("/a_"+i)}else{var h=Do(i,u,"composite");this.binders[i]=new Mo(s,a,u,c,e,h),r.push("/z_"+i)}}}this.cacheKey=r.sort().join("")};Oo.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof Po||e instanceof Mo?e.maxValue:0},Oo.prototype.populatePaintArrays=function(t,e,n,r,i){for(var o in this.binders){var a=this.binders[o];(a instanceof Po||a instanceof Mo||a instanceof Io)&&a.populatePaintArray(t,e,n,r,i)}},Oo.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders){var r=this.binders[n];r instanceof ko&&r.setConstantPatternPositions(t,e)}},Oo.prototype.updatePaintArrays=function(t,e,n,r,i){var o=!1;for(var a in t)for(var s=0,u=e.getPositions(a);s<u.length;s+=1){var c=u[s],l=n.feature(c.index);for(var f in this.binders){var p=this.binders[f];if((p instanceof Po||p instanceof Mo||p instanceof Io)&&!0===p.expression.isStateDependent){var h=r.paint.get(f);p.expression=h.value,p.updatePaintArray(c.start,c.end,l,t[a],i),o=!0}}}return o},Oo.prototype.defines=function(){var t=[];for(var e in this.binders){var n=this.binders[e];(n instanceof Co||n instanceof ko)&&t.push.apply(t,n.uniformNames.map((function(t){return"#define HAS_UNIFORM_"+t})))}return t},Oo.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Po||n instanceof Mo)for(var r=0;r<n.paintVertexAttributes.length;r++)t.push(n.paintVertexAttributes[r].name);else if(n instanceof Io)for(var i=0;i<so.members.length;i++)t.push(so.members[i].name)}return t},Oo.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Co||n instanceof ko||n instanceof Mo)for(var r=0,i=n.uniformNames;r<i.length;r+=1)t.push(i[r])}return t},Oo.prototype.getPaintVertexBuffers=function(){return this._buffers},Oo.prototype.getUniforms=function(t,e){var n=[];for(var r in this.binders){var i=this.binders[r];if(i instanceof Co||i instanceof ko||i instanceof Mo)for(var o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var u=i.getBinding(t,e[s],s);n.push({name:s,property:r,binding:u})}}}return n},Oo.prototype.setUniforms=function(t,e,n,r){for(var i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.name,u=a.property;this.binders[u].setUniform(a.binding,r,n.get(u),s)}},Oo.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var n=this.binders[e];if(t&&n instanceof Io){var r=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(n instanceof Po||n instanceof Mo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}},Oo.prototype.upload=function(t){for(var e in this.binders){var n=this.binders[e];(n instanceof Po||n instanceof Mo||n instanceof Io)&&n.upload(t)}this.updatePaintBuffers()},Oo.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Po||e instanceof Mo||e instanceof Io)&&e.destroy()}};var Lo=function(t,e,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var r=0,i=t;r<i.length;r+=1){var o=i[r];this.programConfigurations[o.id]=new Oo(o,e,n)}this.needsUpload=!1,this._featureMap=new po,this._bufferOffset=0};function Ro(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Do(t,e,n){var r={color:{source:Hi,composite:Wi},number:{source:Ui,composite:Hi}},i=function(t){return{"line-pattern":{source:Mi,composite:Mi},"fill-pattern":{source:Mi,composite:Mi},"fill-extrusion-pattern":{source:Mi,composite:Mi}}[t]}(t);return i&&i[n]||r[e][n]}Lo.prototype.populatePaintArrays=function(t,e,n,r,i,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,r,i,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Lo.prototype.updatePaintArrays=function(t,e,n,r){for(var i=0,o=n;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,r)||this.needsUpload}},Lo.prototype.get=function(t){return this.programConfigurations[t]},Lo.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Lo.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},zr("ConstantBinder",Co),zr("CrossFadedConstantBinder",ko),zr("SourceExpressionBinder",Po),zr("CrossFadedCompositeBinder",Io),zr("CompositeExpressionBinder",Mo),zr("ProgramConfiguration",Oo,{omit:["_buffers"]}),zr("ProgramConfigurationSet",Lo);var zo=Math.pow(2,14)-1,jo=-zo-1;function No(t){for(var e=8192/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],o=0;o<i.length;o++){var a=i[o],s=Math.round(a.x*e),u=Math.round(a.y*e);a.x=c(s,jo,zo),a.y=c(u,jo,zo),(s<a.x||s>a.x+1||u<a.y||u>a.y+1)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function Fo(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}var Bo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ai,this.indexArray=new Ni,this.segments=new oo,this.programConfigurations=new Lo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function Uo(t,e){for(var n=0;n<t.length;n++)if(Ko(e,t[n]))return!0;for(var r=0;r<e.length;r++)if(Ko(t,e[r]))return!0;return!!Zo(t,e)}function Vo(t,e,n){return!!Ko(t,e)||!!Wo(e,t,n)}function Go(t,e){if(1===t.length)return Yo(e,t[0]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.length;i++)if(Ko(t,r[i]))return!0;for(var o=0;o<t.length;o++)if(Yo(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(Zo(t,e[a]))return!0;return!1}function qo(t,e,n){if(t.length>1){if(Zo(t,e))return!0;for(var r=0;r<e.length;r++)if(Wo(e[r],t,n))return!0}for(var i=0;i<t.length;i++)if(Wo(t[i],e,n))return!0;return!1}function Zo(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var r=t[n],i=t[n+1],o=0;o<e.length-1;o++)if(Ho(r,i,e[o],e[o+1]))return!0;return!1}function Ho(t,e,n,r){return S(t,n,r)!==S(e,n,r)&&S(t,e,n)!==S(t,e,r)}function Wo(t,e,n){var r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(var i=1;i<e.length;i++)if(Xo(t,e[i-1],e[i])<r)return!0;return!1}function Xo(t,e,n){var r=e.distSqr(n);if(0===r)return t.distSqr(e);var i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return t.distSqr(i<0?e:i>1?n:n.sub(e)._mult(i)._add(e))}function Yo(t,e){for(var n,r,i,o=!1,a=0;a<t.length;a++)for(var s=0,u=(n=t[a]).length-1;s<n.length;u=s++)(r=n[s]).y>e.y!=(i=n[u]).y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o);return o}function Ko(t,e){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function Jo(t,e,n){var r=n[0],i=n[2];if(t.x<r.x&&e.x<r.x||t.x>i.x&&e.x>i.x||t.y<r.y&&e.y<r.y||t.y>i.y&&e.y>i.y)return!1;var o=S(t,e,n[0]);return o!==S(t,e,n[1])||o!==S(t,e,n[2])||o!==S(t,e,n[3])}function Qo(t,e,n){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).getMaxValue(t)}function $o(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ta(t,e,n,r,o){if(!e[0]&&!e[1])return t;var a=i.convert(e)._mult(o);"viewport"===n&&a._rotate(-r);for(var s=[],u=0;u<t.length;u++)s.push(t[u].sub(a));return s}Bo.prototype.populate=function(t,e,n){var r=this.layers[0],i=[],o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));for(var a=0,s=t;a<s.length;a+=1){var u=s[a],c=u.feature,l=u.id,f=u.index,p=u.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:c.type,id:l,properties:c.properties,geometry:h?No(c):[]};if(this.layers[0]._featureFilter.filter(new oi(this.zoom),d,n)){h||(d.geometry=No(c));var m=o?o.evaluate(d,{},n):void 0;i.push({id:l,properties:c.properties,type:c.type,sourceLayerIndex:p,index:f,geometry:d.geometry,patterns:{},sortKey:m})}}o&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var v=0,g=i;v<g.length;v+=1){var y=g[v],_=y.geometry,b=y.index,x=y.sourceLayerIndex,w=t[b].feature;this.addFeature(y,_,b,n),e.featureIndex.insert(w,_,b,x,this.index)}},Bo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Bo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Bo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Bo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,io),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Bo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Bo.prototype.addFeature=function(t,e,n,r){for(var i=0,o=e;i<o.length;i+=1)for(var a=0,s=o[i];a<s.length;a+=1){var u=s[a],c=u.x,l=u.y;if(!(c<0||c>=8192||l<0||l>=8192)){var f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),p=f.vertexLength;Fo(this.layoutVertexArray,c,l,-1,-1),Fo(this.layoutVertexArray,c,l,1,-1),Fo(this.layoutVertexArray,c,l,1,1),Fo(this.layoutVertexArray,c,l,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),f.vertexLength+=4,f.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},r)},zr("CircleBucket",Bo,{omit:["layers"]});var ea=new _i({"circle-sort-key":new mi(Ct.layout_circle["circle-sort-key"])}),na={paint:new _i({"circle-radius":new mi(Ct.paint_circle["circle-radius"]),"circle-color":new mi(Ct.paint_circle["circle-color"]),"circle-blur":new mi(Ct.paint_circle["circle-blur"]),"circle-opacity":new mi(Ct.paint_circle["circle-opacity"]),"circle-translate":new di(Ct.paint_circle["circle-translate"]),"circle-translate-anchor":new di(Ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new di(Ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new di(Ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mi(Ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mi(Ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mi(Ct.paint_circle["circle-stroke-opacity"])}),layout:ea},ra="undefined"!=typeof Float32Array?Float32Array:Array;function ia(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oa(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],m=e[12],v=e[13],g=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*s+x*f+w*m,t[1]=_*i+b*u+x*p+w*v,t[2]=_*o+b*c+x*h+w*g,t[3]=_*a+b*l+x*d+w*y,t[4]=(_=n[4])*r+(b=n[5])*s+(x=n[6])*f+(w=n[7])*m,t[5]=_*i+b*u+x*p+w*v,t[6]=_*o+b*c+x*h+w*g,t[7]=_*a+b*l+x*d+w*y,t[8]=(_=n[8])*r+(b=n[9])*s+(x=n[10])*f+(w=n[11])*m,t[9]=_*i+b*u+x*p+w*v,t[10]=_*o+b*c+x*h+w*g,t[11]=_*a+b*l+x*d+w*y,t[12]=(_=n[12])*r+(b=n[13])*s+(x=n[14])*f+(w=n[15])*m,t[13]=_*i+b*u+x*p+w*v,t[14]=_*o+b*c+x*h+w*g,t[15]=_*a+b*l+x*d+w*y,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,n=arguments.length;n--;)e+=t[n]*t[n];return Math.sqrt(e)});var aa,sa=oa;function ua(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}aa=new ra(3),ra!=Float32Array&&(aa[0]=0,aa[1]=0,aa[2]=0),function(){var t=new ra(4);ra!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var ca=(function(){var t=new ra(2);ra!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(e){t.call(this,e,na)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new Bo(t)},e.prototype.queryRadius=function(t){var e=t;return Qo("circle-radius",this,e)+Qo("circle-stroke-width",this,e)+$o(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a,s){for(var u=ta(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),l="map"===this.paint.get("circle-pitch-alignment"),f=l?u:function(t,e){return t.map((function(t){return la(t,e)}))}(u,s),p=l?c*a:c,h=0,d=r;h<d.length;h+=1)for(var m=0,v=d[h];m<v.length;m+=1){var g=v[m],y=l?g:la(g,s),_=p,b=ua([],[g.x,g.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),Vo(f,y,_))return!0}return!1},e}(bi));function la(t,e){var n=ua([],[t.x,t.y,0,1],e);return new i(n[0]/n[3],n[1]/n[3])}var fa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Bo);function pa(t,e,n,r){var i=e.width,o=e.height;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return t.width=i,t.height=o,t.data=r,t}function ha(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var o=pa({},{width:r,height:i},n);da(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=o.data}}function da(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,u=0;u<i.height;u++)for(var c=((n.y+u)*t.width+n.x)*o,l=((r.y+u)*e.width+r.x)*o,f=0;f<i.width*o;f++)s[l+f]=a[c+f];return e}zr("HeatmapBucket",fa,{omit:["layers"]});var ma=function(t,e){pa(this,t,1,e)};ma.prototype.resize=function(t){ha(this,t,1)},ma.prototype.clone=function(){return new ma({width:this.width,height:this.height},new Uint8Array(this.data))},ma.copy=function(t,e,n,r,i){da(t,e,n,r,i,1)};var va=function(t,e){pa(this,t,4,e)};va.prototype.resize=function(t){ha(this,t,4)},va.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},va.prototype.clone=function(){return new va({width:this.width,height:this.height},new Uint8Array(this.data))},va.copy=function(t,e,n,r,i){da(t,e,n,r,i,4)},zr("AlphaImage",ma),zr("RGBAImage",va);var ga={paint:new _i({"heatmap-radius":new mi(Ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mi(Ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new di(Ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yi(Ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new di(Ct.paint_heatmap["heatmap-opacity"])})};function ya(t,e){for(var n=new Uint8Array(1024),r={},i=0,o=0;i<256;i++,o+=4){r[e]=i/255;var a=t.evaluate(r);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new va({width:256,height:1},n)}var _a=function(t){function e(e){t.call(this,e,ga),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new fa(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=ya(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(bi),ba={paint:new _i({"hillshade-illumination-direction":new di(Ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new di(Ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new di(Ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new di(Ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new di(Ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new di(Ct.paint_hillshade["hillshade-accent-color"])})},xa=function(t){function e(e){t.call(this,e,ba)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(bi),wa=Ei([{name:"a_pos",components:2,type:"Int16"}],4).members,Sa=Ta,Ea=Ta;function Ta(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,f=l?e[0]*n:t.length,p=Aa(t,0,f,n,!0),h=[];if(!p||p.next===p.prev)return h;if(l&&(p=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=Aa(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(ja(a));for(s.sort(La),i=0;i<s.length;i++)Ra(s[i],n),n=Ca(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<f;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return ka(p,h,n,r,i,c),h}function Aa(t,e,n,r,i){var o,a;if(i===Ka(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Wa(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Wa(o,t[o],t[o+1],a);return a&&Ua(a,a.next)&&(Xa(a),a=a.next),a}function Ca(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Ua(r,r.next)&&0!==Ba(r.prev,r,r.next))r=r.next;else{if(Xa(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function ka(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=za(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?Ma(t,r,i,o):Pa(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Xa(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?ka(t=Ia(Ca(t),e,n),e,n,r,i,o,2):2===a&&Oa(t,e,n,r,i,o):ka(Ca(t),e,n,r,i,o,1);break}}}function Pa(t){var e=t.prev,n=t,r=t.next;if(Ba(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Na(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Ba(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ma(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Ba(i,o,a)>=0)return!1;for(var s=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,u=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,c=za(i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,e,n,r),l=za(s,u,e,n,r),f=t.prevZ,p=t.nextZ;f&&f.z>=c&&p&&p.z<=l;){if(f!==t.prev&&f!==t.next&&Na(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Ba(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&Na(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ba(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&Na(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Ba(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=l;){if(p!==t.prev&&p!==t.next&&Na(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ba(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Ia(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Ua(i,o)&&Va(i,r,r.next,o)&&Za(i,o)&&Za(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Xa(r),Xa(r.next),r=t=o),r=r.next}while(r!==t);return Ca(r)}function Oa(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Fa(a,s)){var u=Ha(a,s);return a=Ca(a,a.next),u=Ca(u,u.next),ka(a,e,n,r,i,o),void ka(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function La(t,e){return t.x-e.x}function Ra(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,f=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&Na(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),Za(r,t)&&(u<p||u===p&&(r.x>n.x||r.x===n.x&&Da(n,r)))&&(n=r,p=u)),r=r.next}while(r!==c);return n}(t,e)){var n=Ha(e,t);Ca(e,e.next),Ca(n,n.next)}}function Da(t,e){return Ba(t.prev,t,e.prev)<0&&Ba(e.next,t,t.next)<0}function za(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ja(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Na(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Fa(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Va(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Za(t,e)&&Za(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Ba(t.prev,t,e.prev)||Ba(t,e.prev,e))||Ua(t,e)&&Ba(t.prev,t,t.next)>0&&Ba(e.prev,e,e.next)>0)}function Ba(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ua(t,e){return t.x===e.x&&t.y===e.y}function Va(t,e,n,r){var i=qa(Ba(t,e,n)),o=qa(Ba(t,e,r)),a=qa(Ba(n,r,t)),s=qa(Ba(n,r,e));return i!==o&&a!==s||!(0!==i||!Ga(t,n,e))||!(0!==o||!Ga(t,r,e))||!(0!==a||!Ga(n,t,r))||!(0!==s||!Ga(n,e,r))}function Ga(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function qa(t){return t>0?1:t<0?-1:0}function Za(t,e){return Ba(t.prev,t,t.next)<0?Ba(t,e,t.next)>=0&&Ba(t,t.prev,e)>=0:Ba(t,e,t.prev)<0||Ba(t,t.next,e)<0}function Ha(t,e){var n=new Ya(t.i,t.x,t.y),r=new Ya(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Wa(t,e,n,r){var i=new Ya(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Xa(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ya(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ka(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function Ja(t,e,n,r,i){!function t(e,n,r,i,o){for(;i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*c/a+l)),Math.min(i,Math.floor(n+(a-s)*c/a+l)),o)}var f=e[n],p=r,h=i;for(Qa(e,r,n),o(e[i],f)>0&&Qa(e,r,i);p<h;){for(Qa(e,p,h),p++,h--;o(e[p],f)<0;)p++;for(;o(e[h],f)>0;)h--}0===o(e[r],f)?Qa(e,r,h):Qa(e,++h,i),h<=n&&(r=h+1),n<=h&&(i=h-1)}}(t,e,n||0,r||t.length-1,i||$a)}function Qa(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function $a(t,e){return t<e?-1:t>e?1:0}function ts(t,e){var n=t.length;if(n<=1)return[t];for(var r,i,o=[],a=0;a<n;a++){var s=E(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(r&&o.push(r),r=[t[a]]):r.push(t[a]))}if(r&&o.push(r),e>1)for(var u=0;u<o.length;u++)o[u].length<=e||(Ja(o[u],e,1,o[u].length-1,es),o[u]=o[u].slice(0,e));return o}function es(t,e){return e.area-t.area}function ns(t,e,n){for(var r=n.patternDependencies,i=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,r[u.to]=!0,r[u.from]=!0)}return i}function rs(t,e,n,r,i){for(var o=i.patternDependencies,a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.paint.get(t+"-pattern").value;if("constant"!==c.kind){var l=c.evaluate({zoom:r-1},n,{},i.availableImages),f=c.evaluate({zoom:r},n,{},i.availableImages),p=c.evaluate({zoom:r+1},n,{},i.availableImages);f=f&&f.name?f.name:f,p=p&&p.name?p.name:p,o[l=l&&l.name?l.name:l]=!0,o[f]=!0,o[p]=!0,n.patterns[u.id]={min:l,mid:f,max:p}}}return n}Ta.deviation=function(t,e,n,r){var i=e&&e.length,o=Math.abs(Ka(t,0,i?e[0]*n:t.length,n));if(i)for(var a=0,s=e.length;a<s;a++)o-=Math.abs(Ka(t,e[a]*n,a<s-1?e[a+1]*n:t.length,n));var u=0;for(a=0;a<r.length;a+=3){var c=r[a]*n,l=r[a+1]*n,f=r[a+2]*n;u+=Math.abs((t[c]-t[f])*(t[l+1]-t[c+1])-(t[c]-t[l])*(t[f+1]-t[c+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},Ta.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&n.holes.push(r+=t[i-1].length)}return n},Sa.default=Ea;var is=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ai,this.indexArray=new Ni,this.indexArray2=new qi,this.programConfigurations=new Lo(t.layers,t.zoom),this.segments=new oo,this.segments2=new oo,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};is.prototype.populate=function(t,e,n){this.hasPattern=ns("fill",this.layers,e);for(var r=this.layers[0].layout.get("fill-sort-key"),i=[],o=0,a=t;o<a.length;o+=1){var s=a[o],u=s.feature,c=s.id,l=s.index,f=s.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,h={type:u.type,id:c,properties:u.properties,geometry:p?No(u):[]};if(this.layers[0]._featureFilter.filter(new oi(this.zoom),h,n)){p||(h.geometry=No(u));var d=r?r.evaluate(h,{},n,e.availableImages):void 0;i.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:f,index:l,geometry:h.geometry,patterns:{},sortKey:d})}}r&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,v=i;m<v.length;m+=1){var g=v[m],y=g.geometry,_=g.index,b=g.sourceLayerIndex;if(this.hasPattern){var x=rs("fill",this.layers,g,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(g,y,_,n,{});e.featureIndex.insert(t[_].feature,y,_,b,this.index)}},is.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},is.prototype.addFeatures=function(t,e,n){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var o=i[r];this.addFeature(o,o.geometry,o.index,e,n)}},is.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},is.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},is.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wa),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},is.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},is.prototype.addFeature=function(t,e,n,r,i){for(var o=0,a=ts(e,500);o<a.length;o+=1){for(var s=a[o],u=0,c=0,l=s;c<l.length;c+=1)u+=l[c].length;for(var f=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray),p=f.vertexLength,h=[],d=[],m=0,v=s;m<v.length;m+=1){var g=v[m];if(0!==g.length){g!==s[0]&&d.push(h.length/2);var y=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),_=y.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(_+g.length-1,_),h.push(g[0].x),h.push(g[0].y);for(var b=1;b<g.length;b++)this.layoutVertexArray.emplaceBack(g[b].x,g[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),h.push(g[b].x),h.push(g[b].y);y.vertexLength+=g.length,y.primitiveLength+=g.length}}for(var x=Sa(h,d),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(p+x[w],p+x[w+1],p+x[w+2]);f.vertexLength+=u,f.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)},zr("FillBucket",is,{omit:["layers","patternFeatures"]});var os=new _i({"fill-sort-key":new mi(Ct.layout_fill["fill-sort-key"])}),as={paint:new _i({"fill-antialias":new di(Ct.paint_fill["fill-antialias"]),"fill-opacity":new mi(Ct.paint_fill["fill-opacity"]),"fill-color":new mi(Ct.paint_fill["fill-color"]),"fill-outline-color":new mi(Ct.paint_fill["fill-outline-color"]),"fill-translate":new di(Ct.paint_fill["fill-translate"]),"fill-translate-anchor":new di(Ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new vi(Ct.paint_fill["fill-pattern"])}),layout:os},ss=function(t){function e(e){t.call(this,e,as)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new is(t)},e.prototype.queryRadius=function(){return $o(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a){return Go(ta(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)},e.prototype.isTileClipped=function(){return!0},e}(bi),us=Ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,cs=ls;function ls(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(fs,this,e)}function fs(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function ps(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)r+=((n=t[a]).x-(e=t[i]).x)*(e.y+n.y);return r}ls.types=["Unknown","Point","LineString","Polygon"],ls.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,o=0,a=0,s=0,u=[];t.pos<n;){if(o<=0){var c=t.readVarint();r=7&c,o=c>>3}if(o--,1===r||2===r)a+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&u.push(e),e=[]),e.push(new i(a,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&u.push(e),u},ls.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},ls.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,u=this.loadGeometry(),c=ls.types[this.type];function l(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(r=0;r<u.length;r++)f[r]=u[r][0];l(u=f);break;case 2:for(r=0;r<u.length;r++)l(u[r]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=ps(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(u),r=0;r<u.length;r++)for(i=0;i<u[r].length;i++)l(u[r][i])}1===u.length?u=u[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(p.id=this.id),p};var hs=ds;function ds(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ms,this,e),this.length=this._features.length}function ms(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}function vs(t,e,n){if(3===t){var r=new hs(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}ds.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new cs(this._pbf,e,this.extent,this._keys,this._values)};var gs={VectorTile:function(t,e){this.layers=t.readFields(vs,{},e)},VectorTileFeature:cs,VectorTileLayer:hs},ys=gs.VectorTileFeature.types,_s=Math.pow(2,13);function bs(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,2*Math.floor(r*_s)+a,i*_s*2,o*_s*2,Math.round(s))}var xs=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ki,this.indexArray=new Ni,this.programConfigurations=new Lo(t.layers,t.zoom),this.segments=new oo,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function ws(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}xs.prototype.populate=function(t,e,n){this.features=[],this.hasPattern=ns("fill-extrusion",this.layers,e);for(var r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.feature,s=o.id,u=o.index,c=o.sourceLayerIndex,l=this.layers[0]._featureFilter.needGeometry,f={type:a.type,id:s,properties:a.properties,geometry:l?No(a):[]};if(this.layers[0]._featureFilter.filter(new oi(this.zoom),f,n)){var p={id:s,sourceLayerIndex:c,index:u,geometry:l?f.geometry:No(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(p.id=a.id),this.hasPattern?this.features.push(rs("fill-extrusion",this.layers,p,this.zoom,e)):this.addFeature(p,p.geometry,u,n,{}),e.featureIndex.insert(a,p.geometry,u,c,this.index,!0)}}},xs.prototype.addFeatures=function(t,e,n){for(var r=0,i=this.features;r<i.length;r+=1){var o=i[r];this.addFeature(o,o.geometry,o.index,e,n)}},xs.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},xs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xs.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,us),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},xs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xs.prototype.addFeature=function(t,e,n,r,i){for(var o=0,a=ts(e,500);o<a.length;o+=1){for(var s=a[o],u=0,c=0,l=s;c<l.length;c+=1)u+=l[c].length;for(var f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),p=0,h=s;p<h.length;p+=1){var d=h[p];if(0!==d.length&&!((O=d).every((function(t){return t.x<0}))||O.every((function(t){return t.x>8192}))||O.every((function(t){return t.y<0}))||O.every((function(t){return t.y>8192}))))for(var m=0,v=0;v<d.length;v++){var g=d[v];if(v>=1){var y=d[v-1];if(!ws(g,y)){f.vertexLength+4>oo.MAX_VERTEX_ARRAY_LENGTH&&(f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=g.sub(y)._perp()._unit(),b=y.dist(g);m+b>32768&&(m=0),bs(this.layoutVertexArray,g.x,g.y,_.x,_.y,0,0,m),bs(this.layoutVertexArray,g.x,g.y,_.x,_.y,0,1,m),bs(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,m+=b),bs(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,m);var x=f.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),f.vertexLength+=4,f.primitiveLength+=2}}}}if(f.vertexLength+u>oo.MAX_VERTEX_ARRAY_LENGTH&&(f=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),"Polygon"===ys[t.type]){for(var w=[],S=[],E=f.vertexLength,T=0,A=s;T<A.length;T+=1){var C=A[T];if(0!==C.length){C!==s[0]&&S.push(w.length/2);for(var k=0;k<C.length;k++){var P=C[k];bs(this.layoutVertexArray,P.x,P.y,0,0,1,1,0),w.push(P.x),w.push(P.y)}}}for(var M=Sa(w,S),I=0;I<M.length;I+=3)this.indexArray.emplaceBack(E+M[I],E+M[I+2],E+M[I+1]);f.primitiveLength+=M.length/3,f.vertexLength+=u}}var O;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)},zr("FillExtrusionBucket",xs,{omit:["layers","features"]});var Ss={paint:new _i({"fill-extrusion-opacity":new di(Ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mi(Ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new di(Ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new di(Ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vi(Ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mi(Ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mi(Ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new di(Ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Es=function(t){function e(e){t.call(this,e,Ss)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new xs(t)},e.prototype.queryRadius=function(){return $o(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(t,e,n,r,o,a,s,u){var c=ta(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),l=this.paint.get("fill-extrusion-height").evaluate(e,n),f=this.paint.get("fill-extrusion-base").evaluate(e,n),p=function(t,e,n,r){for(var o=[],a=0,s=t;a<s.length;a+=1){var u=s[a],c=[u.x,u.y,0,1];ua(c,c,e),o.push(new i(c[0]/c[3],c[1]/c[3]))}return o}(c,u),h=function(t,e,n,r){for(var o=[],a=[],s=r[8]*e,u=r[9]*e,c=r[10]*e,l=r[11]*e,f=r[8]*n,p=r[9]*n,h=r[10]*n,d=r[11]*n,m=0,v=t;m<v.length;m+=1){for(var g=[],y=[],_=0,b=v[m];_<b.length;_+=1){var x=b[_],w=x.x,S=x.y,E=r[0]*w+r[4]*S+r[12],T=r[1]*w+r[5]*S+r[13],A=r[2]*w+r[6]*S+r[14],C=r[3]*w+r[7]*S+r[15],k=A+c,P=C+l,M=E+f,I=T+p,O=A+h,L=C+d,R=new i((E+s)/P,(T+u)/P);R.z=k/P,g.push(R);var D=new i(M/L,I/L);D.z=O/L,y.push(D)}o.push(g),a.push(y)}return[o,a]}(r,f,l,u);return function(t,e,n){var r=1/0;Go(n,e)&&(r=As(n,e[0]));for(var i=0;i<e.length;i++)for(var o=e[i],a=t[i],s=0;s<o.length-1;s++){var u=o[s],c=[u,o[s+1],a[s+1],a[s],u];Uo(n,c)&&(r=Math.min(r,As(n,c)))}return r!==1/0&&r}(h[0],h[1],p)},e}(bi);function Ts(t,e){return t.x*e.x+t.y*e.y}function As(t,e){if(1===t.length){for(var n,r=0,i=e[r++];!n||i.equals(n);)if(!(n=e[r++]))return 1/0;for(;r<e.length;r++){var o=e[r],a=t[0],s=n.sub(i),u=o.sub(i),c=a.sub(i),l=Ts(s,s),f=Ts(s,u),p=Ts(u,u),h=Ts(c,s),d=Ts(c,u),m=l*p-f*f,v=(p*h-f*d)/m,g=(l*d-f*h)/m,y=i.z*(1-v-g)+n.z*v+o.z*g;if(isFinite(y))return y}return 1/0}for(var _=1/0,b=0,x=e;b<x.length;b+=1)_=Math.min(_,x[b].z);return _}var Cs=Ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ks=gs.VectorTileFeature.types,Ps=Math.cos(Math.PI/180*37.5),Ms=Math.pow(2,14)/.5,Is=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Pi,this.indexArray=new Ni,this.programConfigurations=new Lo(t.layers,t.zoom),this.segments=new oo,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};Is.prototype.populate=function(t,e,n){this.hasPattern=ns("line",this.layers,e);for(var r=this.layers[0].layout.get("line-sort-key"),i=[],o=0,a=t;o<a.length;o+=1){var s=a[o],u=s.feature,c=s.id,l=s.index,f=s.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,h={type:u.type,id:c,properties:u.properties,geometry:p?No(u):[]};if(this.layers[0]._featureFilter.filter(new oi(this.zoom),h,n)){p||(h.geometry=No(u));var d=r?r.evaluate(h,{},n):void 0;i.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:f,index:l,geometry:h.geometry,patterns:{},sortKey:d})}}r&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,v=i;m<v.length;m+=1){var g=v[m],y=g.geometry,_=g.index,b=g.sourceLayerIndex;if(this.hasPattern){var x=rs("line",this.layers,g,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(g,y,_,n,{});e.featureIndex.insert(t[_].feature,y,_,b,this.index)}},Is.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Is.prototype.addFeatures=function(t,e,n){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var o=i[r];this.addFeature(o,o.geometry,o.index,e,n)}},Is.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Is.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Is.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Cs),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Is.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Is.prototype.addFeature=function(t,e,n,r,i){for(var o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap"),u=o.get("line-miter-limit"),c=o.get("line-round-limit"),l=0,f=e;l<f.length;l+=1)this.addLine(f[l],t,a,s,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)},Is.prototype.addLine=function(t,e,n,r,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var a=0;a<t.length-1;a++)this.totalDistance+=t[a].dist(t[a+1]);this.updateScaledDistance()}for(var s="Polygon"===ks[e.type],u=t.length;u>=2&&t[u-1].equals(t[u-2]);)u--;for(var c=0;c<u-1&&t[c].equals(t[c+1]);)c++;if(!(u<(s?3:2))){"bevel"===n&&(i=1.05);var l,f=this.overscaling<=16?122880/(512*this.overscaling):0,p=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray),h=void 0,d=void 0,m=void 0,v=void 0;this.e1=this.e2=-1,s&&(v=t[c].sub(l=t[u-2])._unit()._perp());for(var g=c;g<u;g++)if(!(d=g===u-1?s?t[c+1]:void 0:t[g+1])||!t[g].equals(d)){v&&(m=v),l&&(h=l),l=t[g],v=d?d.sub(l)._unit()._perp():m;var y=(m=m||v).add(v);0===y.x&&0===y.y||y._unit();var _=m.x*v.x+m.y*v.y,b=y.x*v.x+y.y*v.y,x=0!==b?1/b:1/0,w=2*Math.sqrt(2-2*b),S=b<Ps&&h&&d,E=m.x*v.y-m.y*v.x>0;if(S&&g>c){var T=l.dist(h);if(T>2*f){var A=l.sub(l.sub(h)._mult(f/T)._round());this.updateDistance(h,A),this.addCurrentVertex(A,m,0,0,p),h=A}}var C=h&&d,k=C?n:s?"butt":r;if(C&&"round"===k&&(x<o?k="miter":x<=2&&(k="fakeround")),"miter"===k&&x>i&&(k="bevel"),"bevel"===k&&(x>2&&(k="flipbevel"),x<i&&(k="miter")),h&&this.updateDistance(h,l),"miter"===k)y._mult(x),this.addCurrentVertex(l,y,0,0,p);else if("flipbevel"===k){if(x>100)y=v.mult(-1);else{var P=x*m.add(v).mag()/m.sub(v).mag();y._perp()._mult(P*(E?-1:1))}this.addCurrentVertex(l,y,0,0,p),this.addCurrentVertex(l,y.mult(-1),0,0,p)}else if("bevel"===k||"fakeround"===k){var M=-Math.sqrt(x*x-1),I=E?M:0,O=E?0:M;if(h&&this.addCurrentVertex(l,m,I,O,p),"fakeround"===k)for(var L=Math.round(180*w/Math.PI/20),R=1;R<L;R++){var D=R/L;if(.5!==D){var z=D-.5;D+=D*z*(D-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*z*z+(.848013+_*(.215638*_-1.06021)))}var j=v.sub(m)._mult(D)._add(m)._unit()._mult(E?-1:1);this.addHalfVertex(l,j.x,j.y,!1,E,0,p)}d&&this.addCurrentVertex(l,v,-I,-O,p)}else if("butt"===k)this.addCurrentVertex(l,y,0,0,p);else if("square"===k){var N=h?1:-1;this.addCurrentVertex(l,y,N,N,p)}else"round"===k&&(h&&(this.addCurrentVertex(l,m,0,0,p),this.addCurrentVertex(l,m,1,1,p,!0)),d&&(this.addCurrentVertex(l,v,-1,-1,p,!0),this.addCurrentVertex(l,v,0,0,p)));if(S&&g<u-1){var F=l.dist(d);if(F>2*f){var B=l.add(d.sub(l)._mult(f/F)._round());this.updateDistance(l,B),this.addCurrentVertex(B,v,0,0,p),l=B}}}}},Is.prototype.addCurrentVertex=function(t,e,n,r,i,o){void 0===o&&(o=!1);var a=e.y*r-e.x,s=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,i),this.addHalfVertex(t,a,s,o,!0,-r,i),this.distance>Ms/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,r,i,o))},Is.prototype.addHalfVertex=function(t,e,n,r,i,o,a){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((t.x<<1)+(r?1:0),(t.y<<1)+(i?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&s)<<2,s>>6);var u=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),a.primitiveLength++),i?this.e2=u:this.e1=u},Is.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ms-1):this.distance},Is.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},zr("LineBucket",Is,{omit:["layers","patternFeatures"]});var Os=new _i({"line-cap":new di(Ct.layout_line["line-cap"]),"line-join":new mi(Ct.layout_line["line-join"]),"line-miter-limit":new di(Ct.layout_line["line-miter-limit"]),"line-round-limit":new di(Ct.layout_line["line-round-limit"]),"line-sort-key":new mi(Ct.layout_line["line-sort-key"])}),Ls={paint:new _i({"line-opacity":new mi(Ct.paint_line["line-opacity"]),"line-color":new mi(Ct.paint_line["line-color"]),"line-translate":new di(Ct.paint_line["line-translate"]),"line-translate-anchor":new di(Ct.paint_line["line-translate-anchor"]),"line-width":new mi(Ct.paint_line["line-width"]),"line-gap-width":new mi(Ct.paint_line["line-gap-width"]),"line-offset":new mi(Ct.paint_line["line-offset"]),"line-blur":new mi(Ct.paint_line["line-blur"]),"line-dasharray":new gi(Ct.paint_line["line-dasharray"]),"line-pattern":new vi(Ct.paint_line["line-pattern"]),"line-gradient":new yi(Ct.paint_line["line-gradient"])}),layout:Os},Rs=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new oi(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,r,i){return n=f({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,r,i)},e}(mi))(Ls.paint.properties["line-width"].specification);Rs.useIntegerZoom=!0;var Ds=function(t){function e(e){t.call(this,e,Ls)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){this.gradient=ya(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n),this.paint._values["line-floorwidth"]=Rs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Is(t)},e.prototype.queryRadius=function(t){var e=t,n=zs(Qo("line-width",this,e),Qo("line-gap-width",this,e)),r=Qo("line-offset",this,e);return n/2+Math.abs(r)+$o(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,o,a,s){var u=ta(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*zs(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(r=function(t,e){for(var n=[],r=new i(0,0),o=0;o<t.length;o++){for(var a=t[o],s=[],u=0;u<a.length;u++){var c=a[u],l=a[u+1],f=0===u?r:c.sub(a[u-1])._unit()._perp(),p=u===a.length-1?r:l.sub(c)._unit()._perp(),h=f._add(p)._unit();h._mult(1/(h.x*p.x+h.y*p.y)),s.push(h._mult(e)._add(c))}n.push(s)}return n}(r,l*s)),function(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];if(t.length>=3)for(var o=0;o<i.length;o++)if(Ko(t,i[o]))return!0;if(qo(t,i,n))return!0}return!1}(u,r,c)},e.prototype.isTileClipped=function(){return!0},e}(bi);function zs(t,e){return e>0?e+2*t:t}var js=Ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ns=Ei([{name:"a_projected_pos",components:3,type:"Float32"}],4),Fs=(Ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Bs=(Ei([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Us=Ei([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vs(t,e,n){return t.sections.forEach((function(t){t.text=function(t,e,n){var r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),ii.applyArabicShaping&&(t=ii.applyArabicShaping(t)),t}(t.text,e,n)})),t}Ei([{name:"triangle",components:3,type:"Uint16"}]),Ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ei([{type:"Float32",name:"offsetX"}]),Ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Gs={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},qs=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,p=n?-1:1,h=t[e+f];for(f+=p,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=p,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=p,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=c}return(h?-1:1)*a*Math.pow(2,o-r)},Zs=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?p/u:p*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+h]=255&s,h+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+h]=255&a,h+=d,a/=256,c-=8);t[n+h-d]|=128*m},Hs=Ws;function Ws(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ws.Varint=0,Ws.Fixed64=1,Ws.Bytes=2,Ws.Fixed32=5;var Xs="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ys(t){return t.type===Ws.Bytes?t.readVarint()+t.pos:t.pos+1}function Ks(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Js(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Qs(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function $s(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function tu(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function eu(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function nu(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function ru(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function iu(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function ou(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function au(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function su(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function uu(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function cu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function lu(t,e,n){1===t&&n.readMessage(fu,e)}function fu(t,e,n){if(3===t){var r=n.readMessage(pu,{}),i=r.width,o=r.height,a=r.left,s=r.top,u=r.advance;e.push({id:r.id,bitmap:new ma({width:i+6,height:o+6},r.bitmap),metrics:{width:i,height:o,left:a,top:s,advance:u}})}}function pu(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function hu(t){for(var e=0,n=0,r=0,i=t;r<i.length;r+=1){var o=i[r];e+=o.w*o.h,n=Math.max(n,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],s=0,u=0,c=0,l=t;c<l.length;c+=1)for(var f=l[c],p=a.length-1;p>=0;p--){var h=a[p];if(!(f.w>h.w||f.h>h.h)){if(f.x=h.x,f.y=h.y,u=Math.max(u,f.y+f.h),s=Math.max(s,f.x+f.w),f.w===h.w&&f.h===h.h){var d=a.pop();p<a.length&&(a[p]=d)}else f.h===h.h?(h.x+=f.w,h.w-=f.w):f.w===h.w?(h.y+=f.h,h.h-=f.h):(a.push({x:h.x+f.w,y:h.y,w:h.w-f.w,h:f.h}),h.y+=f.h,h.h-=f.h);break}}return{w:s,h:u,fill:e/(s*u)||0}}Ws.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=su(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=cu(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=su(this.buf,this.pos)+4294967296*su(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=su(this.buf,this.pos)+4294967296*cu(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=qs(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=qs(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return Ks(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return Ks(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return Ks(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return Ks(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return Ks(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return Ks(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Xs?function(t,e,n){return Xs.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(a=t[i+2],128==(192&(o=t[i+1]))&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(a=t[i+2],s=t[i+3],128==(192&(o=t[i+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ws.Bytes)return t.push(this.readVarint(e));var n=Ys(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ws.Bytes)return t.push(this.readSVarint());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ws.Bytes)return t.push(this.readBoolean());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ws.Bytes)return t.push(this.readFloat());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ws.Bytes)return t.push(this.readDouble());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ws.Bytes)return t.push(this.readFixed32());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ws.Bytes)return t.push(this.readSFixed32());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ws.Bytes)return t.push(this.readFixed64());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ws.Bytes)return t.push(this.readSFixed64());var e=Ys(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ws.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ws.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ws.Fixed32)this.pos+=4;else{if(e!==Ws.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),uu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),uu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),uu(this.buf,-1&t,this.pos),uu(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),uu(this.buf,-1&t,this.pos),uu(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Js(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Zs(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Zs(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Js(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Ws.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Qs,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,$s,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,nu,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,tu,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,eu,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,ru,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,iu,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,ou,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,au,e)},writeBytesField:function(t,e){this.writeTag(t,Ws.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ws.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ws.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ws.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ws.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ws.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ws.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ws.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ws.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ws.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var du=function(t,e){var n=e.pixelRatio,r=e.version,i=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=n,this.stretchX=i,this.stretchY=o,this.content=a,this.version=r},mu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};mu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},mu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},mu.tlbr.get=function(){return this.tl.concat(this.br)},mu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(du.prototype,mu);var vu=function(t,e){var n={},r={};this.haveRenderCallbacks=[];var i=[];this.addImages(t,n,i),this.addImages(e,r,i);var o=hu(i),a=new va({width:o.w||1,height:o.h||1});for(var s in t){var u=t[s],c=n[s].paddedRect;va.copy(u.data,a,{x:0,y:0},{x:c.x+1,y:c.y+1},u.data)}for(var l in e){var f=e[l],p=r[l].paddedRect,h=p.x+1,d=p.y+1,m=f.data.width,v=f.data.height;va.copy(f.data,a,{x:0,y:0},{x:h,y:d},f.data),va.copy(f.data,a,{x:0,y:v-1},{x:h,y:d-1},{width:m,height:1}),va.copy(f.data,a,{x:0,y:0},{x:h,y:d+v},{width:m,height:1}),va.copy(f.data,a,{x:m-1,y:0},{x:h-1,y:d},{width:1,height:v}),va.copy(f.data,a,{x:0,y:0},{x:h+m,y:d},{width:1,height:v})}this.image=a,this.iconPositions=n,this.patternPositions=r};vu.prototype.addImages=function(t,e,n){for(var r in t){var i=t[r],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};n.push(o),e[r]=new du(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},vu.prototype.patchUpdatedImages=function(t,e){for(var n in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)},vu.prototype.patchUpdatedImage=function(t,e,n){if(t&&e&&t.version!==e.version){t.version=e.version;var r=t.tl;n.update(e.data,void 0,{x:r[0],y:r[1]})}},zr("ImagePosition",du),zr("ImageAtlas",vu);var gu={horizontal:1,vertical:2,horizontalOnly:3},yu=function(){this.scale=1,this.fontStack="",this.imageName=null};yu.forText=function(t,e){var n=new yu;return n.scale=t||1,n.fontStack=e,n},yu.forImage=function(t){var e=new yu;return e.imageName=t,e};var _u=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function bu(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m){var v,g=_u.fromFeature(t,i);f===gu.vertical&&g.verticalizePunctuation();var y=ii.processBidirectionalText,_=ii.processStyledBidirectionalText;if(y&&1===g.sections.length){v=[];for(var b=0,x=y(g.toString(),Cu(g,c,o,e,r,h,d));b<x.length;b+=1){var w=x[b],S=new _u;S.text=w,S.sections=g.sections;for(var E=0;E<w.length;E++)S.sectionIndex.push(0);v.push(S)}}else if(_){v=[];for(var T=0,A=_(g.text,g.sectionIndex,Cu(g,c,o,e,r,h,d));T<A.length;T+=1){var C=A[T],k=new _u;k.text=C[0],k.sectionIndex=C[1],k.sections=g.sections,v.push(k)}}else v=function(t,e){for(var n=[],r=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];n.push(t.substring(i,s)),i=s}return i<r.length&&n.push(t.substring(i,r.length)),n}(g,Cu(g,c,o,e,r,h,d));var P=[],M={positionedLines:P,text:g.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:f,iconsInText:!1,verticalizable:!1};return function(t,e,n,r,i,o,a,s,u,c,l,f){for(var p=0,h=-17,d=0,m=0,v="right"===s?1:"left"===s?0:.5,g=0,y=0,_=i;y<_.length;y+=1){var b=_[y];b.trim();var x=b.getMaxScale(),w=24*(x-1),S={positionedGlyphs:[],lineOffset:0};t.positionedLines[g]=S;var E=S.positionedGlyphs,T=0;if(b.length()){for(var A=0;A<b.length();A++){var C=b.getSection(A),k=b.getSectionIndex(A),P=b.getCharCode(A),M=0,I=null,O=null,L=null,R=24,D=!(u===gu.horizontal||!l&&!Zr(P)||l&&(xu[P]||(q=P,Gr.Arabic(q)||Gr["Arabic Supplement"](q)||Gr["Arabic Extended-A"](q)||Gr["Arabic Presentation Forms-A"](q)||Gr["Arabic Presentation Forms-B"](q))));if(C.imageName){var z=r[C.imageName];if(!z)continue;L=C.imageName,t.iconsInText=t.iconsInText||!0,O=z.paddedRect;var j=z.displaySize;C.scale=24*C.scale/f,M=w+(24-j[1]*C.scale),R=(I={width:j[0],height:j[1],left:1,top:-3,advance:D?j[1]:j[0]}).advance;var N=D?j[0]*C.scale-24*x:j[1]*C.scale-24*x;N>0&&N>T&&(T=N)}else{var F=n[C.fontStack],B=F&&F[P];if(B&&B.rect)O=B.rect,I=B.metrics;else{var U=e[C.fontStack],V=U&&U[P];if(!V)continue;I=V.metrics}M=24*(x-C.scale)}D?(t.verticalizable=!0,E.push({glyph:P,imageName:L,x:p,y:h+M,vertical:D,scale:C.scale,fontStack:C.fontStack,sectionIndex:k,metrics:I,rect:O}),p+=R*C.scale+c):(E.push({glyph:P,imageName:L,x:p,y:h+M,vertical:D,scale:C.scale,fontStack:C.fontStack,sectionIndex:k,metrics:I,rect:O}),p+=I.advance*C.scale+c)}0!==E.length&&(d=Math.max(p-c,d),Pu(E,0,E.length-1,v,T)),p=0;var G=o*x+T;S.lineOffset=Math.max(T,w),h+=G,m=Math.max(G,m),++g}else h+=o,++g}var q,Z=h- -17,H=ku(a),W=H.horizontalAlign,X=H.verticalAlign;(function(t,e,n,r,i,o,a,s,u){var c,l=(e-n)*i;c=o!==a?-s*r- -17:(-r*u+.5)*a;for(var f=0,p=t;f<p.length;f+=1)for(var h=0,d=p[f].positionedGlyphs;h<d.length;h+=1){var m=d[h];m.x+=l,m.y+=c}})(t.positionedLines,v,W,X,d,m,o,Z,i.length),t.top+=-X*Z,t.bottom=t.top+Z,t.left+=-W*d,t.right=t.left+d}(M,e,n,r,v,a,s,u,f,c,p,m),!function(t){for(var e=0,n=t;e<n.length;e+=1)if(0!==n[e].positionedGlyphs.length)return!1;return!0}(P)&&M}_u.fromFeature=function(t,e){for(var n=new _u,r=0;r<t.sections.length;r++){var i=t.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,e)}return n},_u.prototype.length=function(){return this.text.length},_u.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},_u.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},_u.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},_u.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;e+=r&&Hr(r)&&!Gs[t[n+1]]||i&&Hr(i)&&!Gs[t[n-1]]||!Gs[t[n]]?t[n]:Gs[t[n]]}return e}(this.text)},_u.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&xu[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=t&&xu[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},_u.prototype.substring=function(t,e){var n=new _u;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},_u.prototype.toString=function(){return this.text},_u.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,n){return Math.max(e,t.sections[n].scale)}),0)},_u.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(yu.forText(t.scale,t.fontStack||e));for(var n=this.sections.length-1,r=0;r<t.text.length;++r)this.sectionIndex.push(n)},_u.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(yu.forImage(e)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}else w("Can't add FormattedSection with an empty image.")},_u.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var xu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wu={};function Su(t,e,n,r,i,o){if(e.imageName){var a=r[e.imageName];return a?a.displaySize[0]*e.scale*24/o+i:0}var s=n[e.fontStack],u=s&&s[t];return u?u.metrics.advance*e.scale+i:0}function Eu(t,e,n,r){var i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function Tu(t,e,n){var r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Au(t,e,n,r,i,o){for(var a=null,s=Eu(e,n,i,o),u=0,c=r;u<c.length;u+=1){var l=c[u],f=Eu(e-l.x,n,i,o)+l.badness;f<=s&&(a=l,s=f)}return{index:t,x:e,priorBreak:a,badness:s}}function Cu(t,e,n,r,i,o,a){if("point"!==o)return[];if(!t)return[];for(var s,u=[],c=function(t,e,n,r,i,o){for(var a=0,s=0;s<t.length();s++){var u=t.getSection(s);a+=Su(t.getCharCode(s),u,r,i,e,o)}return a/Math.max(1,Math.ceil(a/n))}(t,e,n,r,i,a),l=t.text.indexOf("\u200b")>=0,f=0,p=0;p<t.length();p++){var h=t.getSection(p),d=t.getCharCode(p);if(xu[d]||(f+=Su(d,h,r,i,e,a)),p<t.length()-1){var m=!((s=d)<11904||!(Gr["Bopomofo Extended"](s)||Gr.Bopomofo(s)||Gr["CJK Compatibility Forms"](s)||Gr["CJK Compatibility Ideographs"](s)||Gr["CJK Compatibility"](s)||Gr["CJK Radicals Supplement"](s)||Gr["CJK Strokes"](s)||Gr["CJK Symbols and Punctuation"](s)||Gr["CJK Unified Ideographs Extension A"](s)||Gr["CJK Unified Ideographs"](s)||Gr["Enclosed CJK Letters and Months"](s)||Gr["Halfwidth and Fullwidth Forms"](s)||Gr.Hiragana(s)||Gr["Ideographic Description Characters"](s)||Gr["Kangxi Radicals"](s)||Gr["Katakana Phonetic Extensions"](s)||Gr.Katakana(s)||Gr["Vertical Forms"](s)||Gr["Yi Radicals"](s)||Gr["Yi Syllables"](s)));(wu[d]||m||h.imageName)&&u.push(Au(p+1,f,c,u,Tu(d,t.getCharCode(p+1),m&&l),!1))}}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Au(t.length(),f,c,u,0,!0))}function ku(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Pu(t,e,n,r,i){if(r||i)for(var o=t[n],a=(t[n].x+o.metrics.advance*o.scale)*r,s=e;s<=n;s++)t[s].x-=a,t[s].y+=i}function Mu(t,e,n,r,i,o){var a,s=t.image;if(s.content){var u=s.content,c=s.pixelRatio||1;a=[u[0]/c,u[1]/c,s.displaySize[0]-u[2]/c,s.displaySize[1]-u[3]/c]}var l,f,p,h,d=e.left*o,m=e.right*o;"width"===n||"both"===n?(h=i[0]+d-r[3],f=i[0]+m+r[1]):f=(h=i[0]+(d+m-s.displaySize[0])/2)+s.displaySize[0];var v=e.top*o,g=e.bottom*o;return"height"===n||"both"===n?(l=i[1]+v-r[0],p=i[1]+g+r[2]):p=(l=i[1]+(v+g-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:l,right:f,bottom:p,left:h,collisionPadding:a}}wu[10]=!0,wu[32]=!0,wu[38]=!0,wu[40]=!0,wu[41]=!0,wu[43]=!0,wu[45]=!0,wu[47]=!0,wu[173]=!0,wu[183]=!0,wu[8203]=!0,wu[8208]=!0,wu[8211]=!0,wu[8231]=!0;var Iu=function(t){function e(e,n,r,i){t.call(this,e,n),this.angle=r,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(i);function Ou(t,e){var n=e.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new oi(t+1))};if("source"===n.kind)return{kind:"source"};for(var r=n.zoomStops,i=n.interpolationType,o=0;o<r.length&&r[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<r.length&&r[a]<t+1;)a++;a=Math.min(r.length-1,a);var s=r[o],u=r[a];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:u,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:u,minSize:n.evaluate(new oi(s)),maxSize:n.evaluate(new oi(u)),interpolationType:i}}function Lu(t,e,n){var r=e.uSize,i=n.lowerSize;return"source"===t.kind?i/128:"composite"===t.kind?Ve(i/128,n.upperSize/128,e.uSizeT):r}function Ru(t,e){var n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){var i=t.interpolationType,o=i?c(rn.interpolationFactor(i,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?r=Ve(t.minSize,t.maxSize,o):n=o}return{uSizeT:n,uSize:r}}zr("Anchor",Iu);var Du=Object.freeze({__proto__:null,getSizeData:Ou,evaluateSizeForFeature:Lu,evaluateSizeForZoom:Ru,SIZE_PACK_FACTOR:128});function zu(t,e,n,r,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],c=0;s<n/2;){var l=t[a],f=t[a+1];if(!f)return!1;var p=t[a-1].angleTo(l)-l.angleTo(f);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:p}),c+=p;s-u[0].distance>r;)c-=u.shift().angleDelta;if(c>i)return!1;a++,s+=l.dist(f)}return!0}function ju(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Nu(t,e,n){return t?.6*e*n:0}function Fu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Bu(t,e,n,r,i,o){for(var a=Nu(n,i,o),s=Fu(n,r)*o,u=0,c=ju(t)/2,l=0;l<t.length-1;l++){var f=t[l],p=t[l+1],h=f.dist(p);if(u+h>c){var d=(c-u)/h,m=Ve(f.x,p.x,d),v=Ve(f.y,p.y,d),g=new Iu(m,v,p.angleTo(f),l);return g._round(),!a||zu(t,g,s,a,e)?g:void 0}u+=h}}function Uu(t,e,n,r,i,o,a,s,u){var c=Nu(r,o,a),l=Fu(r,i),f=l*a,p=0===t[0].x||t[0].x===u||0===t[0].y||t[0].y===u;return e-f<e/4&&(e=f+e/4),function t(e,n,r,i,o,a,s,u,c){for(var l=a/2,f=ju(e),p=0,h=n-r,d=[],m=0;m<e.length-1;m++){for(var v=e[m],g=e[m+1],y=v.dist(g),_=g.angleTo(v);h+r<p+y;){var b=((h+=r)-p)/y,x=Ve(v.x,g.x,b),w=Ve(v.y,g.y,b);if(x>=0&&x<c&&w>=0&&w<c&&h-l>=0&&h+l<=f){var S=new Iu(x,w,_,m);S._round(),i&&!zu(e,S,a,i,o)||d.push(S)}}p+=y}return u||d.length||s||(d=t(e,p/2,r,i,o,a,s,!0,c)),d}(t,p?e/2*s%e:(l/2+2*o)*a*s%e,e,c,n,f,p,!1,u)}function Vu(t,e,n,r,o){for(var a=[],s=0;s<t.length;s++)for(var u=t[s],c=void 0,l=0;l<u.length-1;l++){var f=u[l],p=u[l+1];f.x<e&&p.x<e||(f.x<e?f=new i(e,f.y+(e-f.x)/(p.x-f.x)*(p.y-f.y))._round():p.x<e&&(p=new i(e,f.y+(e-f.x)/(p.x-f.x)*(p.y-f.y))._round()),f.y<n&&p.y<n||(f.y<n?f=new i(f.x+(n-f.y)/(p.y-f.y)*(p.x-f.x),n)._round():p.y<n&&(p=new i(f.x+(n-f.y)/(p.y-f.y)*(p.x-f.x),n)._round()),f.x>=r&&p.x>=r||(f.x>=r?f=new i(r,f.y+(r-f.x)/(p.x-f.x)*(p.y-f.y))._round():p.x>=r&&(p=new i(r,f.y+(r-f.x)/(p.x-f.x)*(p.y-f.y))._round()),f.y>=o&&p.y>=o||(f.y>=o?f=new i(f.x+(o-f.y)/(p.y-f.y)*(p.x-f.x),o)._round():p.y>=o&&(p=new i(f.x+(o-f.y)/(p.y-f.y)*(p.x-f.x),o)._round()),c&&f.equals(c[c.length-1])||a.push(c=[f]),c.push(p)))))}return a}function Gu(t,e,n,r){var o=[],a=t.image,s=a.pixelRatio,u=a.paddedRect.w-2,c=a.paddedRect.h-2,l=t.right-t.left,f=t.bottom-t.top,p=a.stretchX||[[0,u]],h=a.stretchY||[[0,c]],d=function(t,e){return t+e[1]-e[0]},m=p.reduce(d,0),v=h.reduce(d,0),g=u-m,y=c-v,_=0,b=m,x=0,w=v,S=0,E=g,T=0,A=y;if(a.content&&r){var C=a.content;_=qu(p,0,C[0]),x=qu(h,0,C[1]),b=qu(p,C[0],C[2]),w=qu(h,C[1],C[3]),S=C[0]-_,T=C[1]-x,E=C[2]-C[0]-b,A=C[3]-C[1]-w}var k=function(r,o,u,c){var p=Hu(r.stretch-_,b,l,t.left),h=Wu(r.fixed-S,E,r.stretch,m),d=Hu(o.stretch-x,w,f,t.top),g=Wu(o.fixed-T,A,o.stretch,v),y=Hu(u.stretch-_,b,l,t.left),C=Wu(u.fixed-S,E,u.stretch,m),k=Hu(c.stretch-x,w,f,t.top),P=Wu(c.fixed-T,A,c.stretch,v),M=new i(p,d),I=new i(y,d),O=new i(y,k),L=new i(p,k),R=new i(h/s,g/s),D=new i(C/s,P/s),z=e*Math.PI/180;if(z){var j=Math.sin(z),N=Math.cos(z),F=[N,-j,j,N];M._matMult(F),I._matMult(F),L._matMult(F),O._matMult(F)}var B=r.stretch+r.fixed,U=o.stretch+o.fixed;return{tl:M,tr:I,bl:L,br:O,tex:{x:a.paddedRect.x+1+B,y:a.paddedRect.y+1+U,w:u.stretch+u.fixed-B,h:c.stretch+c.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:D,minFontScaleX:E/s/l,minFontScaleY:A/s/f,isSDF:n}};if(r&&(a.stretchX||a.stretchY))for(var P=Zu(p,g,m),M=Zu(h,y,v),I=0;I<P.length-1;I++)for(var O=P[I],L=P[I+1],R=0;R<M.length-1;R++)o.push(k(O,M[R],L,M[R+1]));else o.push(k({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:c+1}));return o}function qu(t,e,n){for(var r=0,i=0,o=t;i<o.length;i+=1){var a=o[i];r+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]))}return r}function Zu(t,e,n){for(var r=[{fixed:-1,stretch:0}],i=0,o=t;i<o.length;i+=1){var a=o[i],s=a[0],u=a[1],c=r[r.length-1];r.push({fixed:s-c.stretch,stretch:c.stretch}),r.push({fixed:s-c.stretch,stretch:c.stretch+(u-s)})}return r.push({fixed:e+1,stretch:n}),r}function Hu(t,e,n,r){return t/e*n+r}function Wu(t,e,n,r){return t-e*n/r}var Xu=function(t,e,n,r,o,a,s,u,c,l){if(this.boxStartIndex=t.length,c){var f=a.top,p=a.bottom,h=a.collisionPadding;h&&(f-=h[1],p+=h[3]);var d=p-f;d>0&&(d=Math.max(10,d),this.circleDiameter=d)}else{var m=a.top*s-u,v=a.bottom*s+u,g=a.left*s-u,y=a.right*s+u,_=a.collisionPadding;if(_&&(g-=_[0]*s,m-=_[1]*s,y+=_[2]*s,v+=_[3]*s),l){var b=new i(g,m),x=new i(y,m),w=new i(g,v),S=new i(y,v),E=l*Math.PI/180;b._rotate(E),x._rotate(E),w._rotate(E),S._rotate(E),g=Math.min(b.x,x.x,w.x,S.x),y=Math.max(b.x,x.x,w.x,S.x),m=Math.min(b.y,x.y,w.y,S.y),v=Math.max(b.y,x.y,w.y,S.y)}t.emplaceBack(e.x,e.y,g,m,y,v,n,r,o)}this.boxEndIndex=t.length},Yu=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Ku),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function Ku(t,e){return t<e?-1:t>e?1:0}function Ju(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var r=1/0,o=1/0,a=-1/0,s=-1/0,u=t[0],c=0;c<u.length;c++){var l=u[c];(!c||l.x<r)&&(r=l.x),(!c||l.y<o)&&(o=l.y),(!c||l.x>a)&&(a=l.x),(!c||l.y>s)&&(s=l.y)}var f=Math.min(a-r,s-o),p=f/2,h=new Yu([],Qu);if(0===f)return new i(r,o);for(var d=r;d<a;d+=f)for(var m=o;m<s;m+=f)h.push(new $u(d+p,m+p,p,t));for(var v=function(t){for(var e=0,n=0,r=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var u=i[o],c=i[s],l=u.x*c.y-c.x*u.y;n+=(u.x+c.x)*l,r+=(u.y+c.y)*l,e+=3*l}return new $u(n/e,r/e,0,t)}(t),g=h.length;h.length;){var y=h.pop();(y.d>v.d||!v.d)&&(v=y,n&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,g)),y.max-v.d<=e||(h.push(new $u(y.p.x-(p=y.h/2),y.p.y-p,p,t)),h.push(new $u(y.p.x+p,y.p.y-p,p,t)),h.push(new $u(y.p.x-p,y.p.y+p,p,t)),h.push(new $u(y.p.x+p,y.p.y+p,p,t)),g+=4)}return n&&(console.log("num probes: "+g),console.log("best distance: "+v.d)),v.p}function Qu(t,e){return e.max-t.max}function $u(t,e,n,r){this.p=new i(t,e),this.h=n,this.d=function(t,e){for(var n=!1,r=1/0,i=0;i<e.length;i++)for(var o=e[i],a=0,s=o.length,u=s-1;a<s;u=a++){var c=o[a],l=o[u];c.y>t.y!=l.y>t.y&&t.x<(l.x-c.x)*(t.y-c.y)/(l.y-c.y)+c.x&&(n=!n),r=Math.min(r,Xo(t,c,l))}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}Yu.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Yu.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},Yu.prototype.peek=function(){return this.data[0]},Yu.prototype._up=function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r},Yu.prototype._down=function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),n(a,i)>=0)break;e[t]=a,t=o}e[t]=i};var tc=Number.POSITIVE_INFINITY;function ec(t,e){return e[1]!==tc?function(t,e,n){var r=0,i=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":i=n-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-n}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,i]}(t,e[0],e[1]):function(t,e){var n=0,r=0;e<0&&(e=0);var i=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=i-7;break;case"bottom-right":case"bottom-left":r=7-i;break;case"bottom":r=7-e;break;case"top":r=e-7}switch(t){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=e;break;case"right":n=-e}return[n,r]}(t,e[0])}function nc(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rc(t,e,n,r,o,a,s,u,c,l,f,p,h,d,m){var v=function(t,e,n,r,o,a,s,u){for(var c=r.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,l=[],f=0,p=e.positionedLines;f<p.length;f+=1)for(var h=p[f],d=0,m=h.positionedGlyphs;d<m.length;d+=1){var v=m[d];if(v.rect){var g=v.rect||{},y=4,_=!0,b=1,x=0,w=(o||u)&&v.vertical,S=v.metrics.advance*v.scale/2;if(u&&e.verticalizable&&(x=h.lineOffset/2-(v.imageName?-(24-v.metrics.width*v.scale)/2:24*(v.scale-1))),v.imageName){var E=s[v.imageName];_=E.sdf,y=1/(b=E.pixelRatio)}var T=o?[v.x+S,v.y]:[0,0],A=o?[0,0]:[v.x+S+n[0],v.y+n[1]-x],C=[0,0];w&&(C=A,A=[0,0]);var k=(v.metrics.left-y)*v.scale-S+A[0],P=(-v.metrics.top-y)*v.scale+A[1],M=k+g.w*v.scale/b,I=P+g.h*v.scale/b,O=new i(k,P),L=new i(M,P),R=new i(k,I),D=new i(M,I);if(w){var z=new i(-S,S- -17),j=-Math.PI/2,N=12-S,F=new i(22-N,-(v.imageName?N:0)),B=new(Function.prototype.bind.apply(i,[null].concat(C)));O._rotateAround(j,z)._add(F)._add(B),L._rotateAround(j,z)._add(F)._add(B),R._rotateAround(j,z)._add(F)._add(B),D._rotateAround(j,z)._add(F)._add(B)}if(c){var U=Math.sin(c),V=Math.cos(c),G=[V,-U,U,V];O._matMult(G),L._matMult(G),R._matMult(G),D._matMult(G)}var q=new i(0,0),Z=new i(0,0);l.push({tl:O,tr:L,bl:R,br:D,tex:g,writingMode:e.writingMode,glyphOffset:T,sectionIndex:v.sectionIndex,isSDF:_,pixelOffsetTL:q,pixelOffsetBR:Z,minFontScaleX:0,minFontScaleY:0})}}return l}(0,n,u,o,a,s,r,t.allowVerticalPlacement),g=t.textSizeData,y=null;"source"===g.kind?(y=[128*o.layout.get("text-size").evaluate(s,{})])[0]>32640&&w(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===g.kind&&((y=[128*d.compositeTextSizes[0].evaluate(s,{},m),128*d.compositeTextSizes[1].evaluate(s,{},m)])[0]>32640||y[1]>32640)&&w(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,v,y,u,a,s,l,e,c.lineStartIndex,c.lineLength,h,m);for(var _=0,b=f;_<b.length;_+=1)p[b[_]]=t.text.placedSymbolArray.length-1;return 4*v.length}function ic(t){for(var e in t)return t[e];return null}function oc(t,e,n,r){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(r.dist(o[a])<n)return!0}else i[e]=[];return i[e].push(r),!1}var ac=gs.VectorTileFeature.types,sc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function uc(t,e,n,r,i,o,a,s,u,c,l,f,p){var h=s?Math.min(32640,Math.round(s[0])):0,d=s?Math.min(32640,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),o,a,(h<<1)+(u?1:0),d,16*c,16*l,256*f,256*p)}function cc(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function lc(t){for(var e=0,n=t.sections;e<n.length;e+=1)if(Yr(n[e].text))return!0;return!1}var fc=function(t){this.layoutVertexArray=new Ii,this.indexArray=new Ni,this.programConfigurations=t,this.segments=new oo,this.dynamicLayoutVertexArray=new Oi,this.opacityVertexArray=new Li,this.placedSymbolArray=new Ji};fc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},fc.prototype.upload=function(t,e,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,js.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ns.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,sc,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t))},fc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},zr("SymbolBuffers",fc);var pc=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new oo,this.collisionVertexArray=new ji};pc.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Fs.members,!0)},pc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},zr("CollisionBuffers",pc);var hc=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ia([]),this.placementViewportMatrix=ia([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ou(this.zoom,e["text-size"]),this.iconSizeData=Ou(this.zoom,e["icon-size"]);var n=this.layers[0].layout,r=n.get("symbol-sort-key"),i=n.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==i&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((function(t){return gu[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID};hc.prototype.createArrays=function(){this.text=new fc(new Lo(this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new fc(new Lo(this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new to,this.lineVertexArray=new eo,this.symbolInstances=new $i},hc.prototype.calculateGlyphDependencies=function(t,e,n,r,i){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||r)&&i){var a=Gs[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},hc.prototype.populate=function(t,e,n){var r=this.layers[0],i=r.layout,o=i.get("text-font"),a=i.get("text-field"),s=i.get("icon-image"),u=("constant"!==a.value.kind||a.value.value instanceof ee&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,l=i.get("symbol-sort-key");if(this.features=[],u||c){for(var f=e.iconDependencies,p=e.glyphDependencies,h=e.availableImages,d=new oi(this.zoom),m=0,v=t;m<v.length;m+=1){var g=v[m],y=g.feature,_=g.id,b=g.index,x=g.sourceLayerIndex,w=r._featureFilter.needGeometry,S={type:y.type,id:_,properties:y.properties,geometry:w?No(y):[]};if(r._featureFilter.filter(d,S,n)){w||(S.geometry=No(y));var E=void 0;if(u){var T=r.getValueAndResolveTokens("text-field",S,n,h),A=ee.factory(T);lc(A)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ni()||this.hasRTLText&&ii.isParsed())&&(E=Vs(A,r,S))}var C=void 0;if(c){var k=r.getValueAndResolveTokens("icon-image",S,n,h);C=k instanceof ne?k:ne.fromString(k)}if(E||C){var P=this.sortFeaturesByKey?l.evaluate(S,{},n):void 0,M={id:_,text:E,icon:C,index:b,sourceLayerIndex:x,geometry:No(y),properties:y.properties,type:ac[y.type],sortKey:P};if(this.features.push(M),C&&(f[C.name]=!0),E){var I=o.evaluate(S,{},n).join(","),O="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(gu.vertical)>=0;for(var L=0,R=E.sections;L<R.length;L+=1){var D=R[L];if(D.image)f[D.image.name]=!0;else{var z=qr(E.toString()),j=D.fontStack||I,N=p[j]=p[j]||{};this.calculateGlyphDependencies(D.text,N,O,this.allowVerticalPlacement,z)}}}}}}"line"===i.get("symbol-placement")&&(this.features=function(t){var e={},n={},r=[],i=0;function o(e){r.push(t[e]),i++}function a(t,e,i){var o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(t,n,i){var o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function u(t,e,n){var r=n?e[0][e[0].length-1]:e[0][0];return t+":"+r.x+":"+r.y}for(var c=0;c<t.length;c++){var l=t[c],f=l.geometry,p=l.text?l.text.toString():null;if(p){var h=u(p,f),d=u(p,f,!0);if(h in n&&d in e&&n[h]!==e[d]){var m=s(h,d,f),v=a(h,d,r[m].geometry);delete e[h],delete n[d],n[u(p,r[v].geometry,!0)]=v,r[m].geometry=null}else h in n?a(h,d,f):d in e?s(h,d,f):(o(c),e[h]=i-1,n[d]=i-1)}else o(c)}return r.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},hc.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},hc.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},hc.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hc.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hc.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},hc.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},hc.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:r},a<e.length-1&&(r+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var u=0;u<e.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},hc.prototype.addSymbols=function(t,e,n,r,i,o,a,s,u,c,l,f){for(var p=t.indexArray,h=t.layoutVertexArray,d=t.segments.prepareSegment(4*e.length,h,p,o.sortKey),m=this.glyphOffsetArray.length,v=d.vertexLength,g=this.allowVerticalPlacement&&a===gu.vertical?Math.PI/2:0,y=o.text&&o.text.sections,_=0;_<e.length;_++){var b=e[_],x=b.tl,w=b.tr,S=b.bl,E=b.br,T=b.tex,A=b.pixelOffsetTL,C=b.pixelOffsetBR,k=b.minFontScaleX,P=b.minFontScaleY,M=b.glyphOffset,I=b.isSDF,O=b.sectionIndex,L=d.vertexLength,R=M[1];uc(h,s.x,s.y,x.x,R+x.y,T.x,T.y,n,I,A.x,A.y,k,P),uc(h,s.x,s.y,w.x,R+w.y,T.x+T.w,T.y,n,I,C.x,A.y,k,P),uc(h,s.x,s.y,S.x,R+S.y,T.x,T.y+T.h,n,I,A.x,C.y,k,P),uc(h,s.x,s.y,E.x,R+E.y,T.x+T.w,T.y+T.h,n,I,C.x,C.y,k,P),cc(t.dynamicLayoutVertexArray,s,g),p.emplaceBack(L,L+1,L+2),p.emplaceBack(L+1,L+2,L+3),d.vertexLength+=4,d.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(M[0]),_!==e.length-1&&O===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(h.length,o,o.index,{},f,y&&y[O])}t.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,v,u,c,s.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],a,0,!1,0,l)},hc.prototype._addCollisionDebugVertex=function(t,e,n,r,i,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))},hc.prototype.addCollisionDebugVertices=function(t,e,n,r,o,a,s){var u=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),c=u.vertexLength,l=o.layoutVertexArray,f=o.collisionVertexArray,p=s.anchorX,h=s.anchorY;this._addCollisionDebugVertex(l,f,a,p,h,new i(t,e)),this._addCollisionDebugVertex(l,f,a,p,h,new i(n,e)),this._addCollisionDebugVertex(l,f,a,p,h,new i(n,r)),this._addCollisionDebugVertex(l,f,a,p,h,new i(t,r)),u.vertexLength+=4;var d=o.indexArray;d.emplaceBack(c,c+1),d.emplaceBack(c+1,c+2),d.emplaceBack(c+2,c+3),d.emplaceBack(c+3,c),u.primitiveLength+=4},hc.prototype.addDebugCollisionBoxes=function(t,e,n,r){for(var i=t;i<e;i++){var o=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,r?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n)}},hc.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pc(Di,Bs.members,qi),this.iconCollisionBox=new pc(Di,Bs.members,qi);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},hc.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,r,i,o,a,s,u){for(var c={},l=e;l<n;l++){var f=t.get(l);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(var p=r;p<i;p++){var h=t.get(p);c.verticalTextBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},c.verticalTextFeatureIndex=h.featureIndex;break}for(var d=o;d<a;d++){var m=t.get(d);c.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},c.iconFeatureIndex=m.featureIndex;break}for(var v=s;v<u;v++){var g=t.get(v);c.verticalIconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},c.verticalIconFeatureIndex=g.featureIndex;break}return c},hc.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}},hc.prototype.hasTextData=function(){return this.text.segments.get().length>0},hc.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hc.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},hc.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},hc.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},hc.prototype.addIndicesForPlacedSymbol=function(t,e){for(var n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs,i=n.vertexStartIndex;i<r;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)},hc.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),n=Math.cos(t),r=[],i=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);r.push(0|Math.round(e*s.anchorX+n*s.anchorY)),i.push(s.featureIndex)}return o.sort((function(t,e){return r[t]-r[e]||i[e]-i[t]})),o},hc.prototype.addToSortKeyRanges=function(t,e){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},hc.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var n=0,r=this.symbolInstanceIndexes;n<r.length;n+=1){var i=this.symbolInstances.get(r[n]);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((function(t,n,r){t>=0&&r.indexOf(t)===n&&e.addIndicesForPlacedSymbol(e.text,t)})),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},zr("SymbolBucket",hc,{omit:["layers","collisionBoxArray","features","compareText"]}),hc.MAX_GLYPHS=65535,hc.addDynamicAttributes=cc;var dc=new _i({"symbol-placement":new di(Ct.layout_symbol["symbol-placement"]),"symbol-spacing":new di(Ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new di(Ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mi(Ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new di(Ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new di(Ct.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new di(Ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new di(Ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new di(Ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new mi(Ct.layout_symbol["icon-size"]),"icon-text-fit":new di(Ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new di(Ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new mi(Ct.layout_symbol["icon-image"]),"icon-rotate":new mi(Ct.layout_symbol["icon-rotate"]),"icon-padding":new di(Ct.layout_symbol["icon-padding"]),"icon-keep-upright":new di(Ct.layout_symbol["icon-keep-upright"]),"icon-offset":new mi(Ct.layout_symbol["icon-offset"]),"icon-anchor":new mi(Ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new di(Ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new di(Ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new di(Ct.layout_symbol["text-rotation-alignment"]),"text-field":new mi(Ct.layout_symbol["text-field"]),"text-font":new mi(Ct.layout_symbol["text-font"]),"text-size":new mi(Ct.layout_symbol["text-size"]),"text-max-width":new mi(Ct.layout_symbol["text-max-width"]),"text-line-height":new di(Ct.layout_symbol["text-line-height"]),"text-letter-spacing":new mi(Ct.layout_symbol["text-letter-spacing"]),"text-justify":new mi(Ct.layout_symbol["text-justify"]),"text-radial-offset":new mi(Ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new di(Ct.layout_symbol["text-variable-anchor"]),"text-anchor":new mi(Ct.layout_symbol["text-anchor"]),"text-max-angle":new di(Ct.layout_symbol["text-max-angle"]),"text-writing-mode":new di(Ct.layout_symbol["text-writing-mode"]),"text-rotate":new mi(Ct.layout_symbol["text-rotate"]),"text-padding":new di(Ct.layout_symbol["text-padding"]),"text-keep-upright":new di(Ct.layout_symbol["text-keep-upright"]),"text-transform":new mi(Ct.layout_symbol["text-transform"]),"text-offset":new mi(Ct.layout_symbol["text-offset"]),"text-allow-overlap":new di(Ct.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new di(Ct.layout_symbol["text-ignore-placement"]),"text-optional":new di(Ct.layout_symbol["text-optional"])}),mc={paint:new _i({"icon-opacity":new mi(Ct.paint_symbol["icon-opacity"]),"icon-color":new mi(Ct.paint_symbol["icon-color"]),"icon-halo-color":new mi(Ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new mi(Ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mi(Ct.paint_symbol["icon-halo-blur"]),"icon-translate":new di(Ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new di(Ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new mi(Ct.paint_symbol["text-opacity"]),"text-color":new mi(Ct.paint_symbol["text-color"],{runtimeType:Ft,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new mi(Ct.paint_symbol["text-halo-color"]),"text-halo-width":new mi(Ct.paint_symbol["text-halo-width"]),"text-halo-blur":new mi(Ct.paint_symbol["text-halo-blur"]),"text-translate":new di(Ct.paint_symbol["text-translate"]),"text-translate-anchor":new di(Ct.paint_symbol["text-translate-anchor"])}),layout:dc},vc=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Dt,this.defaultValue=t};vc.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},vc.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},vc.prototype.outputDefined=function(){return!1},vc.prototype.serialize=function(){return null},zr("FormatSectionOverride",vc,{omit:["defaultValue"]});var gc=function(t){function e(e){t.call(this,e,mc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){if(t.prototype.recalculate.call(this,e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],o=0,a=r;o<a.length;o+=1){var s=a[o];i.indexOf(s)<0&&i.push(s)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(t,e,n,r){var i=this.layout.get(t).evaluate(e,{},n,r),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||qn(o.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?String(t[n]):""}))}(e.properties,i)},e.prototype.createBucket=function(t){return new hc(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var t=0,n=mc.paint.overridableProperties;t<n.length;t+=1){var r=n[t];if(e.hasPaintOverride(this.layout,r)){var i,o=this.paint.get(r),a=new vc(o),s=new Gn(a,o.property.specification);i="constant"===o.value.kind||"source"===o.value.kind?new Hn("source",s):new Wn("composite",s,o.value.zoomStops,o.value._interpolationType),this.paint._values[r]=new pi(o.property,i,o.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(t,n,r){return!(!this.layout||n.isDataDriven()||r.isDataDriven())&&e.hasPaintOverride(this.layout,t)},e.hasPaintOverride=function(t,e){var n=t.get("text-field"),r=mc.paint.properties[e],i=!1,o=function(t){for(var e=0,n=t;e<n.length;e+=1)if(r.overrides&&r.overrides.hasOverride(n[e]))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof ee)o(n.value.value.sections);else if("source"===n.value.kind){var a=function t(e){i||(e instanceof se&&oe(e.value)===Gt?o(e.value.sections):e instanceof fe?o(e.sections):e.eachChild(t))},s=n.value;s._styleExpression&&a(s._styleExpression.expression)}return i},e}(bi),yc={paint:new _i({"background-color":new di(Ct.paint_background["background-color"]),"background-pattern":new gi(Ct.paint_background["background-pattern"]),"background-opacity":new di(Ct.paint_background["background-opacity"])})},_c=function(t){function e(e){t.call(this,e,yc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(bi),bc={paint:new _i({"raster-opacity":new di(Ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new di(Ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new di(Ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new di(Ct.paint_raster["raster-brightness-max"]),"raster-saturation":new di(Ct.paint_raster["raster-saturation"]),"raster-contrast":new di(Ct.paint_raster["raster-contrast"]),"raster-resampling":new di(Ct.paint_raster["raster-resampling"]),"raster-fade-duration":new di(Ct.paint_raster["raster-fade-duration"])})},xc=function(t){function e(e){t.call(this,e,bc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(bi),wc=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},e}(bi),Sc={circle:ca,heatmap:_a,hillshade:xa,fill:ss,"fill-extrusion":Es,line:Ds,symbol:gc,background:_c,raster:xc},Ec=a.HTMLImageElement,Tc=a.HTMLCanvasElement,Ac=a.HTMLVideoElement,Cc=a.ImageData,kc=a.ImageBitmap,Pc=function(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)};Pc.prototype.update=function(t,e,n){var r=t.width,i=t.height,o=!(this.size&&this.size[0]===r&&this.size[1]===i||n),a=this.context,s=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[r,i],t instanceof Ec||t instanceof Tc||t instanceof Ac||t instanceof Cc||kc&&t instanceof kc?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,r,i,0,this.format,s.UNSIGNED_BYTE,t.data);else{var u=n||{x:0,y:0},c=u.x,l=u.y;t instanceof Ec||t instanceof Tc||t instanceof Ac||t instanceof Cc||kc&&t instanceof kc?s.texSubImage2D(s.TEXTURE_2D,0,c,l,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,c,l,r,i,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},Pc.prototype.bind=function(t,e,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)},Pc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Pc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Mc=function(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Mc.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},Mc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ic=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},v(["receive","process"],this),this.invoker=new Mc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=T()?t:a};function Oc(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}Ic.prototype.send=function(t,e,n,r,i){var o=this;void 0===i&&(i=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[a]=n);var s=k(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:Br(e,s)},s),{cancel:function(){n&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:o.mapId})}}},Ic.prototype.receive=function(t){var e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];var r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r()}else T()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)},Ic.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Ic.prototype.processTask=function(t,e){var n=this;if("<response>"===e.type){var r=this.callbacks[t];delete this.callbacks[t],r&&(e.error?r(Ur(e.error)):r(null,Ur(e.data)))}else{var i=!1,o=k(this.globalScope)?void 0:[],a=e.hasCallback?function(e,r){i=!0,delete n.cancelCallbacks[t],n.target.postMessage({id:t,type:"<response>",sourceMapId:n.mapId,error:e?Br(e):null,data:Br(r,o)},o)}:function(t){i=!0},s=null,u=Ur(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){var c=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,c[0],u.source)[c[1]](u,a)}else a(new Error("Could not find function "+e.type));!i&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}},Ic.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Lc=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Lc.prototype.setNorthEast=function(t){return this._ne=t instanceof Rc?new Rc(t.lng,t.lat):Rc.convert(t),this},Lc.prototype.setSouthWest=function(t){return this._sw=t instanceof Rc?new Rc(t.lng,t.lat):Rc.convert(t),this},Lc.prototype.extend=function(t){var e,n,r=this._sw,i=this._ne;if(t instanceof Rc)e=t,n=t;else{if(!(t instanceof Lc))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Lc.convert(t)):this.extend(Rc.convert(t)):this;if(n=t._ne,!(e=t._sw)||!n)return this}return r||i?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new Rc(e.lng,e.lat),this._ne=new Rc(n.lng,n.lat)),this},Lc.prototype.getCenter=function(){return new Rc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Lc.prototype.getSouthWest=function(){return this._sw},Lc.prototype.getNorthEast=function(){return this._ne},Lc.prototype.getNorthWest=function(){return new Rc(this.getWest(),this.getNorth())},Lc.prototype.getSouthEast=function(){return new Rc(this.getEast(),this.getSouth())},Lc.prototype.getWest=function(){return this._sw.lng},Lc.prototype.getSouth=function(){return this._sw.lat},Lc.prototype.getEast=function(){return this._ne.lng},Lc.prototype.getNorth=function(){return this._ne.lat},Lc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Lc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Lc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Lc.prototype.contains=function(t){var e=Rc.convert(t),n=e.lng,r=e.lat,i=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&i},Lc.convert=function(t){return!t||t instanceof Lc?t:new Lc(t)};var Rc=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Rc.prototype.wrap=function(){return new Rc(l(this.lng,-180,180),this.lat)},Rc.prototype.toArray=function(){return[this.lng,this.lat]},Rc.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Rc.prototype.distanceTo=function(t){var e=Math.PI/180,n=this.lat*e,r=t.lat*e,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(i,1))},Rc.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Lc(new Rc(this.lng-n,this.lat-e),new Rc(this.lng+n,this.lat+e))},Rc.convert=function(t){if(t instanceof Rc)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Rc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Rc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Dc=2*Math.PI*6371008.8;function zc(t){return Dc*Math.cos(t*Math.PI/180)}function jc(t){return(180+t)/360}function Nc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Fc(t,e){return t/zc(e)}function Bc(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var Uc=function(t,e,n){void 0===n&&(n=0),this.x=+t,this.y=+e,this.z=+n};Uc.fromLngLat=function(t,e){void 0===e&&(e=0);var n=Rc.convert(t);return new Uc(jc(n.lng),Nc(n.lat),Fc(e,n.lat))},Uc.prototype.toLngLat=function(){return new Rc(360*this.x-180,Bc(this.y))},Uc.prototype.toAltitude=function(){return this.z*zc(Bc(this.y))},Uc.prototype.meterInMercatorCoordinateUnits=function(){return 1/Dc*(t=Bc(this.y),1/Math.cos(t*Math.PI/180));var t};var Vc=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Zc(0,t,t,e,n)};Vc.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Vc.prototype.url=function(t,e){var n,r,i,o,a,s=(r=this.y,i=this.z,o=Oc(256*(n=this.x),256*(r=Math.pow(2,i)-r-1),i),a=Oc(256*(n+1),256*(r+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),u=function(t,e,n){for(var r,i="",o=t;o>0;o--)i+=(e&(r=1<<o-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)},Vc.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new i(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Vc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Gc=function(t,e){this.wrap=t,this.canonical=e,this.key=Zc(t,e.z,e.z,e.x,e.y)},qc=function(t,e,n,r,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Vc(n,+r,+i),this.key=Zc(e,t,n,r,i)};function Zc(t,e,n,r,i){(t*=2)<0&&(t=-1*t-1);var o=1<<n;return(o*o*t+o*i+r).toString(36)+n.toString(36)+e.toString(36)}qc.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},qc.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new qc(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qc(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},qc.prototype.calculateScaledKey=function(t,e){var n=this.canonical.z-t;return t>this.canonical.z?Zc(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Zc(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)},qc.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},qc.prototype.children=function(t){if(this.overscaledZ>=t)return[new qc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new qc(e,this.wrap,e,n,r),new qc(e,this.wrap,e,n+1,r),new qc(e,this.wrap,e,n,r+1),new qc(e,this.wrap,e,n+1,r+1)]},qc.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},qc.prototype.wrapped=function(){return new qc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},qc.prototype.unwrapTo=function(t){return new qc(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},qc.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},qc.prototype.toUnwrapped=function(){return new Gc(this.wrap,this.canonical)},qc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},qc.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Uc(t.x-this.wrap,t.y))},zr("CanonicalTileID",Vc),zr("OverscaledTileID",qc,{omit:["posMatrix"]});var Hc=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return w('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var r=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox";for(var i=0;i<r;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(r,i)]=this.data[this._idx(r-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,r)]=this.data[this._idx(i,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)]};Hc.prototype.get=function(t,e){var n=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])},Hc.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hc.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Hc.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},Hc.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},Hc.prototype.getPixels=function(){return new va({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hc.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,u=-n*this.dim,c=o;c<a;c++)for(var l=r;l<i;l++)this.data[this._idx(l,c)]=t.data[this._idx(l+s,c+u)]},zr("DEMData",Hc);var Wc=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};Wc.prototype.encode=function(t){return this._stringToNumber[t]},Wc.prototype.decode=function(t){return this._numberToString[t]};var Xc=function(t,e,n,r,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,this.id=i},Yc={geometry:{configurable:!0}};Yc.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Yc.geometry.set=function(t){this._geometry=t},Xc.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Xc.prototype,Yc);var Kc=function(){this.state={},this.stateChanges={},this.deletedStates={}};Kc.prototype.updateState=function(t,e,n){var r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},f(this.stateChanges[t][r],n),null===this.deletedStates[t])for(var i in this.deletedStates[t]={},this.state[t])i!==r&&(this.deletedStates[t][i]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][r])for(var o in this.deletedStates[t][r]={},this.state[t][r])n[o]||(this.deletedStates[t][r][o]=null);else for(var a in n)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][a]&&delete this.deletedStates[t][r][a]},Kc.prototype.removeFeatureState=function(t,e,n){if(null!==this.deletedStates[t]){var r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}},Kc.prototype.getState=function(t,e){var n=String(e),r=f({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var i=this.deletedStates[t][e];if(null===i)return{};for(var o in i)delete r[o]}return r},Kc.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Kc.prototype.coalesceChanges=function(t,e){var n={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var i={};for(var o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),f(this.state[r][o],this.stateChanges[r][o]),i[o]=this.state[r][o];n[r]=i}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var u in this.state[a])s[u]={},this.state[a][u]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var l=0,p=Object.keys(this.deletedStates[a][c]);l<p.length;l+=1)delete this.state[a][c][p[l]];s[c]=this.state[a][c]}n[a]=n[a]||{},f(n[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var h in t)t[h].setFeatureState(n,e)};var Jc=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ir(8192,16,0),this.grid3D=new Ir(8192,16,0),this.featureIndexArray=new ro,this.promoteId=e};function Qc(t,e,n,r,i){return y(t,(function(t,o){var a=e instanceof hi?e.get(o):null;return a&&a.evaluate?a.evaluate(n,r,i):a}))}function $c(t){for(var e=1/0,n=1/0,r=-1/0,i=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),n=Math.min(n,s.y),r=Math.max(r,s.x),i=Math.max(i,s.y)}return{minX:e,minY:n,maxX:r,maxY:i}}function tl(t,e){return e-t}Jc.prototype.insert=function(t,e,n,r,i,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var s=o?this.grid3D:this.grid,u=0;u<e.length;u++){for(var c=e[u],l=[1/0,1/0,-1/0,-1/0],f=0;f<c.length;f++){var p=c[f];l[0]=Math.min(l[0],p.x),l[1]=Math.min(l[1],p.y),l[2]=Math.max(l[2],p.x),l[3]=Math.max(l[3],p.y)}l[0]<8192&&l[1]<8192&&l[2]>=0&&l[3]>=0&&s.insert(a,l[0],l[1],l[2],l[3])}},Jc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new gs.VectorTile(new Hs(this.rawTileData)).layers,this.sourceLayerCoder=new Wc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Jc.prototype.query=function(t,e,n,r){var o=this;this.loadVTLayers();for(var a=t.params||{},s=8192/t.tileSize/t.scale,u=ir(a.filter),c=t.queryGeometry,l=t.queryPadding*s,f=$c(c),p=this.grid.query(f.minX-l,f.minY-l,f.maxX+l,f.maxY+l),h=$c(t.cameraQueryGeometry),d=this.grid3D.query(h.minX-l,h.minY-l,h.maxX+l,h.maxY+l,(function(e,n,r,o){return function(t,e,n,r,o){for(var a=0,s=t;a<s.length;a+=1){var u=s[a];if(e<=u.x&&n<=u.y&&r>=u.x&&o>=u.y)return!0}var c=[new i(e,n),new i(e,o),new i(r,o),new i(r,n)];if(t.length>2)for(var l=0,f=c;l<f.length;l+=1)if(Ko(t,f[l]))return!0;for(var p=0;p<t.length-1;p++)if(Jo(t[p],t[p+1],c))return!0;return!1}(t.cameraQueryGeometry,e-l,n-l,r+l,o+l)})),m=0,v=d;m<v.length;m+=1)p.push(v[m]);p.sort(tl);for(var g,y={},_=function(i){var l=p[i];if(l!==g){g=l;var f=o.featureIndexArray.get(l),h=null;o.loadMatchingFeature(y,f.bucketIndex,f.sourceLayerIndex,f.featureIndex,u,a.layers,a.availableImages,e,n,r,(function(e,n,r){return h||(h=No(e)),n.queryIntersectsFeature(c,e,r,h,o.z,t.transform,s,t.pixelPosMatrix)}))}},b=0;b<p.length;b++)_(b);return y},Jc.prototype.loadMatchingFeature=function(t,e,n,r,i,o,a,s,u,c,l){var f=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,f)){var p=this.sourceLayerCoder.decode(n),h=this.vtLayers[p].feature(r);if(i.filter(new oi(this.tileID.overscaledZ),h))for(var d=this.getId(h,p),m=0;m<f.length;m++){var v=f[m];if(!(o&&o.indexOf(v)<0)){var g=s[v];if(g){var y={};void 0!==d&&c&&(y=c.getState(g.sourceLayer||"_geojsonTileLayer",d));var _=u[v];_.paint=Qc(_.paint,g.paint,h,y,a),_.layout=Qc(_.layout,g.layout,h,y,a);var b=!l||l(h,g,y);if(b){var x=new Xc(h,this.z,this.x,this.y,d);x.layer=_;var w=t[v];void 0===w&&(w=t[v]=[]),w.push({featureIndex:r,feature:x,intersectionZ:b})}}}}}},Jc.prototype.lookupSymbolFeatures=function(t,e,n,r,i,o,a,s){var u={};this.loadVTLayers();for(var c=ir(i),l=0,f=t;l<f.length;l+=1)this.loadMatchingFeature(u,n,r,f[l],c,o,a,s,e);return u},Jc.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var r=0,i=n[e];r<i.length;r+=1)if(t===i[r])return!0;return!1},Jc.prototype.getId=function(t,e){var n=t.id;return this.promoteId&&"boolean"==typeof(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(n=Number(n)),n},zr("FeatureIndex",Jc,{omit:["rawTileData","sourceLayerCoder"]});var el=function(t,e){this.tileID=t,this.uid=h(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};el.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<j.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},el.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},el.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var r in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var r=function(){var t=o[i],r=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==r.length){t.layers=r,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return r.filter((function(e){return e.id===t}))[0]})));for(var a=0,s=r;a<s.length;a+=1)n[s[a].id]=t}},i=0,o=t;i<o.length;i+=1)r();return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[r];if(i instanceof hc){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof hc&&a.hasRTLText){this.hasRTLText=!0,ii.isLoading()||ii.isLoaded()||"deferred"!==ni()||ri();break}}for(var s in this.queryPadding=0,this.buckets){var u=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(s).queryRadius(u))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Yi},el.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},el.prototype.getBucket=function(t){return this.buckets[t.id]},el.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pc(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pc(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},el.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},el.prototype.queryRenderedFeatures=function(t,e,n,r,i,o,a,s,u,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*u},t,e,n):{}},el.prototype.querySourceFeatures=function(t,e){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var r=n.loadVTLayers(),i=e?e.sourceLayer:"",o=r._geojsonTileLayer||r[i];if(o)for(var a=ir(e&&e.filter),s=this.tileID.canonical,u=s.z,c=s.x,l=s.y,f={z:u,x:c,y:l},p=0;p<o.length;p++){var h=o.feature(p);if(a.filter(new oi(this.tileID.overscaledZ),h)){var d=n.getId(h,i),m=new Xc(h,u,c,l,d);m.tile=f,t.push(m)}}}},el.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},el.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},el.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=A(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),i=!1;if(this.expirationTime>r)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var o=this.expirationTime-e;o?this.expirationTime=r+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},el.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},el.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets)if(e.style.hasLayer(r)){var i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];if(a&&s&&0!==Object.keys(s).length){i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var u=e&&e.style&&e.style.getLayer(r);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(i)))}}}},el.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},el.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()},el.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},el.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=j.now()+t},el.prototype.setDependencies=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1)n[i[r]]=!0;this.dependencies[t]=n},el.prototype.hasDependency=function(t,e){for(var n=0,r=t;n<r.length;n+=1){var i=this.dependencies[r[n]];if(i)for(var o=0,a=e;o<a.length;o+=1)if(i[a[o]])return!0}return!1};var nl=a.performance,rl=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},nl.mark(this._marks.start)};rl.prototype.finish=function(){nl.mark(this._marks.end);var t=nl.getEntriesByName(this._marks.measure);return 0===t.length&&(nl.measure(this._marks.measure,this._marks.start,this._marks.end),t=nl.getEntriesByName(this._marks.measure),nl.clearMarks(this._marks.start),nl.clearMarks(this._marks.end),nl.clearMeasures(this._marks.measure)),t},t.Actor=Ic,t.AlphaImage=ma,t.CanonicalTileID=Vc,t.CollisionBoxArray=Yi,t.Color=Qt,t.DEMData=Hc,t.DataConstantProperty=di,t.DictionaryCoder=Wc,t.EXTENT=8192,t.ErrorEvent=Tt,t.EvaluationParameters=oi,t.Event=Et,t.Evented=At,t.FeatureIndex=Jc,t.FillBucket=is,t.FillExtrusionBucket=xs,t.ImageAtlas=vu,t.ImagePosition=du,t.LineBucket=Is,t.LngLat=Rc,t.LngLatBounds=Lc,t.MercatorCoordinate=Uc,t.ONE_EM=24,t.OverscaledTileID=qc,t.Point=i,t.Point$1=i,t.Properties=_i,t.Protobuf=Hs,t.RGBAImage=va,t.RequestManager=q,t.RequestPerformance=rl,t.ResourceType=ht,t.SegmentVector=oo,t.SourceFeatureState=Kc,t.StructArrayLayout1ui2=Zi,t.StructArrayLayout2f1f2i16=zi,t.StructArrayLayout2i4=Ai,t.StructArrayLayout3ui6=Ni,t.StructArrayLayout4i8=Ci,t.SymbolBucket=hc,t.Texture=Pc,t.Tile=el,t.Transitionable=ui,t.Uniform1f=_o,t.Uniform1i=yo,t.Uniform2f=bo,t.Uniform3f=xo,t.Uniform4f=wo,t.UniformColor=So,t.UniformMatrix4f=To,t.UnwrappedTileID=Gc,t.ValidationError=kt,t.WritingMode=gu,t.ZoomHistory=Vr,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=cc,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var r=t.length,i=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),i[a]=e,0==--r&&n(o,i)}))}))},t.bezier=s,t.bindAll=v,t.browser=j,t.cacheEntryPossiblyAdded=function(t){++ft>st&&(t.getActor().send("enforceCacheSizeLimit",at),ft=0)},t.clamp=c,t.clearTileCache=function(t){var e=a.caches.delete("mapbox-tiles");t&&e.catch(t).then((function(){return t()}))},t.clipLine=Vu,t.clone=function(t){var e=new ra(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=b,t.clone$2=function(t){var e=new ra(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=Us,t.config=N,t.create=function(){var t=new ra(16);return ra!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new ra(9);return ra!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new ra(4);return ra!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Zn,t.createLayout=Ei,t.createStyleLayer=function(t){return"custom"===t.type?new wc(t):new Sc[t.type](t)},t.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t},t.deepEqual=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var i in e)if(!t(e[i],n[i]))return!1;return!0}return e===n},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=u,t.emitValidationErrors=Mr,t.endsWith=g,t.enforceCacheSizeLimit=function(t){ut(),$&&$.then((function(e){e.keys().then((function(n){for(var r=0;r<n.length-t;r++)e.delete(n[r])}))}))},t.evaluateSizeForFeature=Lu,t.evaluateSizeForZoom=Ru,t.evaluateVariableOffset=ec,t.evented=ei,t.extend=f,t.featureFilter=ir,t.filterObject=_,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=ku,t.getAnchorJustification=nc,t.getArrayBuffer=_t,t.getImage=xt,t.getJSON=function(t,e){return yt(f(t,{type:"json"}),e)},t.getRTLTextPluginStatus=ni,t.getReferrer=gt,t.getVideo=function(t,e){var n,r,i=a.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var o=0;o<t.length;o++){var s=a.document.createElement("source");n=t[o],r=void 0,(r=a.document.createElement("a")).href=n,(r.protocol!==a.document.location.protocol||r.host!==a.document.location.host)&&(i.crossOrigin="Anonymous"),s.src=t[o],i.appendChild(s)}return{cancel:function(){}}},t.identity=ia,t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],h=e[11],d=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,S=i*c-o*u,E=l*m-f*d,T=l*v-p*d,A=l*g-h*d,C=f*v-p*m,k=f*g-h*m,P=p*g-h*v,M=y*P-_*k+b*C+x*A-w*T+S*E;return M?(t[0]=(s*P-u*k+c*C)*(M=1/M),t[1]=(i*k-r*P-o*C)*M,t[2]=(m*S-v*w+g*x)*M,t[3]=(p*w-f*S-h*x)*M,t[4]=(u*A-a*P-c*T)*M,t[5]=(n*P-i*A+o*T)*M,t[6]=(v*b-d*S-g*_)*M,t[7]=(l*S-p*b+h*_)*M,t[8]=(a*k-s*A+c*E)*M,t[9]=(r*A-n*k-o*E)*M,t[10]=(d*w-m*b+g*y)*M,t[11]=(f*b-l*w-h*y)*M,t[12]=(s*T-a*C-u*E)*M,t[13]=(n*C-r*T+i*E)*M,t[14]=(m*_-d*x-v*y)*M,t[15]=(l*x-f*_+p*y)*M,t):null},t.isChar=Gr,t.isMapboxURL=Z,t.keysDifference=function(t,e){var n=[];for(var r in t)r in e||n.push(r);return n},t.makeRequest=yt,t.mapObject=y,t.mercatorXfromLng=jc,t.mercatorYfromLat=Nc,t.mercatorZfromAltitude=Fc,t.mul=sa,t.multiply=oa,t.mvt=gs,t.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=Ve,t.offscreenCanvasSupported=pt,t.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t},t.parseGlyphPBF=function(t){return new Hs(t).readFields(lu,[])},t.pbf=Hs,t.performSymbolLayout=function(t,e,n,r,i,o,a){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var s=t.layers[0].layout,u=t.layers[0]._unevaluatedLayout._values,c={};if("composite"===t.textSizeData.kind){var l=t.textSizeData,f=l.maxZoom;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new oi(l.minZoom),a),u["text-size"].possiblyEvaluate(new oi(f),a)]}if("composite"===t.iconSizeData.kind){var p=t.iconSizeData,h=p.maxZoom;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new oi(p.minZoom),a),u["icon-size"].possiblyEvaluate(new oi(h),a)]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new oi(t.zoom+1),a),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new oi(t.zoom+1),a),c.textMaxSize=u["text-size"].possiblyEvaluate(new oi(18));for(var d=24*s.get("text-line-height"),m="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),v=s.get("text-keep-upright"),g=s.get("text-size"),y=function(){var o=b[_],u=s.get("text-font").evaluate(o,{},a).join(","),l=g.evaluate(o,{},a),f=c.layoutTextSize.evaluate(o,{},a),p=c.layoutIconSize.evaluate(o,{},a),h={horizontal:{},vertical:void 0},y=o.text,x=[0,0];if(y){var S=y.toString(),E=24*s.get("text-letter-spacing").evaluate(o,{},a),T=function(t){for(var e=0,n=t;e<n.length;e+=1)if(r=n[e].charCodeAt(0),Gr.Arabic(r)||Gr["Arabic Supplement"](r)||Gr["Arabic Extended-A"](r)||Gr["Arabic Presentation Forms-A"](r)||Gr["Arabic Presentation Forms-B"](r))return!1;var r;return!0}(S)?E:0,A=s.get("text-anchor").evaluate(o,{},a),C=s.get("text-variable-anchor");if(!C){var k=s.get("text-radial-offset").evaluate(o,{},a);x=k?ec(A,[24*k,tc]):s.get("text-offset").evaluate(o,{},a).map((function(t){return 24*t}))}var P=m?"center":s.get("text-justify").evaluate(o,{},a),M=s.get("symbol-placement"),I="point"===M?24*s.get("text-max-width").evaluate(o,{},a):0,O=function(){t.allowVerticalPlacement&&qr(S)&&(h.vertical=bu(y,e,n,i,u,I,d,A,"left",T,x,gu.vertical,!0,M,f,l))};if(!m&&C){for(var L="auto"===P?C.map((function(t){return nc(t)})):[P],R=!1,D=0;D<L.length;D++){var z=L[D];if(!h.horizontal[z])if(R)h.horizontal[z]=h.horizontal[0];else{var j=bu(y,e,n,i,u,I,d,"center",z,T,x,gu.horizontal,!1,M,f,l);j&&(h.horizontal[z]=j,R=1===j.positionedLines.length)}}O()}else{"auto"===P&&(P=nc(A));var N=bu(y,e,n,i,u,I,d,A,P,T,x,gu.horizontal,!1,M,f,l);N&&(h.horizontal[P]=N),O(),qr(S)&&m&&v&&(h.vertical=bu(y,e,n,i,u,I,d,A,P,T,x,gu.vertical,!1,M,f,l))}}var F=void 0,B=!1;if(o.icon&&o.icon.name){var U=r[o.icon.name];U&&(F=function(t,e,n){var r=ku(n),i=e[0]-t.displaySize[0]*r.horizontalAlign,o=e[1]-t.displaySize[1]*r.verticalAlign;return{image:t,top:o,bottom:o+t.displaySize[1],left:i,right:i+t.displaySize[0]}}(i[o.icon.name],s.get("icon-offset").evaluate(o,{},a),s.get("icon-anchor").evaluate(o,{},a)),B=U.sdf,void 0===t.sdfIcons?t.sdfIcons=U.sdf:t.sdfIcons!==U.sdf&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(U.pixelRatio!==t.pixelRatio||0!==s.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var V=ic(h.horizontal)||h.vertical;t.iconsInText=!!V&&V.iconsInText,(V||F)&&function(t,e,n,r,i,o,a,s,u,c,l){var f=o.textMaxSize.evaluate(e,{});void 0===f&&(f=a);var p,h=t.layers[0].layout,d=h.get("icon-offset").evaluate(e,{},l),m=ic(n.horizontal),v=a/24,g=t.tilePixelRatio*v,y=t.tilePixelRatio*f/24,_=t.tilePixelRatio*s,b=t.tilePixelRatio*h.get("symbol-spacing"),x=h.get("text-padding")*t.tilePixelRatio,S=h.get("icon-padding")*t.tilePixelRatio,E=h.get("text-max-angle")/180*Math.PI,T="map"===h.get("text-rotation-alignment")&&"point"!==h.get("symbol-placement"),A="map"===h.get("icon-rotation-alignment")&&"point"!==h.get("symbol-placement"),C=h.get("symbol-placement"),k=b/2,P=h.get("icon-text-fit");r&&"none"!==P&&(t.allowVerticalPlacement&&n.vertical&&(p=Mu(r,n.vertical,P,h.get("icon-text-fit-padding"),d,v)),m&&(r=Mu(r,m,P,h.get("icon-text-fit-padding"),d,v)));var M=function(s,f){f.x<0||f.x>=8192||f.y<0||f.y>=8192||function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v,g,y,_,b,x,S,E,T){var A,C,k,P,M,I=t.addToLineVertexArray(e,n),O=0,L=0,R=0,D=0,z=-1,j=-1,N={},F=lo(""),B=0,U=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(B=(A=s.layout.get("text-offset").evaluate(b,{},E).map((function(t){return 24*t})))[0],U=A[1]):(B=24*s.layout.get("text-radial-offset").evaluate(b,{},E),U=tc),t.allowVerticalPlacement&&r.vertical){var V=s.layout.get("text-rotate").evaluate(b,{},E)+90;P=new Xu(u,e,c,l,f,r.vertical,p,h,d,V),a&&(M=new Xu(u,e,c,l,f,a,v,g,d,V))}if(i){var G=s.layout.get("icon-rotate").evaluate(b,{}),q="none"!==s.layout.get("icon-text-fit"),Z=Gu(i,G,S,q),H=a?Gu(a,G,S,q):void 0;k=new Xu(u,e,c,l,f,i,v,g,!1,G),O=4*Z.length;var W=t.iconSizeData,X=null;"source"===W.kind?(X=[128*s.layout.get("icon-size").evaluate(b,{})])[0]>32640&&w(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===W.kind&&((X=[128*x.compositeIconSizes[0].evaluate(b,{},E),128*x.compositeIconSizes[1].evaluate(b,{},E)])[0]>32640||X[1]>32640)&&w(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,Z,X,_,y,b,!1,e,I.lineStartIndex,I.lineLength,-1,E),z=t.icon.placedSymbolArray.length-1,H&&(L=4*H.length,t.addSymbols(t.icon,H,X,_,y,b,gu.vertical,e,I.lineStartIndex,I.lineLength,-1,E),j=t.icon.placedSymbolArray.length-1)}for(var Y in r.horizontal){var K=r.horizontal[Y];if(!C){F=lo(K.text);var J=s.layout.get("text-rotate").evaluate(b,{},E);C=new Xu(u,e,c,l,f,K,p,h,d,J)}var Q=1===K.positionedLines.length;if(R+=rc(t,e,K,o,s,d,b,m,I,r.vertical?gu.horizontal:gu.horizontalOnly,Q?Object.keys(r.horizontal):[Y],N,z,x,E),Q)break}r.vertical&&(D+=rc(t,e,r.vertical,o,s,d,b,m,I,gu.vertical,["vertical"],N,j,x,E));var $=C?C.boxStartIndex:t.collisionBoxArray.length,tt=C?C.boxEndIndex:t.collisionBoxArray.length,et=P?P.boxStartIndex:t.collisionBoxArray.length,nt=P?P.boxEndIndex:t.collisionBoxArray.length,rt=k?k.boxStartIndex:t.collisionBoxArray.length,it=k?k.boxEndIndex:t.collisionBoxArray.length,ot=M?M.boxStartIndex:t.collisionBoxArray.length,at=M?M.boxEndIndex:t.collisionBoxArray.length,st=-1,ut=function(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e};st=ut(C,st),st=ut(P,st),st=ut(k,st);var ct=(st=ut(M,st))>-1?1:0;ct&&(st*=T/24),t.glyphOffsetArray.length>=hc.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,N.right>=0?N.right:-1,N.center>=0?N.center:-1,N.left>=0?N.left:-1,N.vertical||-1,z,j,F,$,tt,et,nt,rt,it,ot,at,c,R,D,O,L,ct,0,p,B,U,st)}(t,f,s,n,r,i,p,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,g,x,T,u,_,S,A,d,e,o,c,l,a)};if("line"===C)for(var I=0,O=Vu(e.geometry,0,0,8192,8192);I<O.length;I+=1)for(var L=O[I],R=0,D=Uu(L,b,E,n.vertical||m,r,24,y,t.overscaling,8192);R<D.length;R+=1){var z=D[R];m&&oc(t,m.text,k,z)||M(L,z)}else if("line-center"===C)for(var j=0,N=e.geometry;j<N.length;j+=1){var F=N[j];if(F.length>1){var B=Bu(F,E,n.vertical||m,r,24,y);B&&M(F,B)}}else if("Polygon"===e.type)for(var U=0,V=ts(e.geometry,0);U<V.length;U+=1){var G=V[U],q=Ju(G,16);M(G[0],new Iu(q.x,q.y,0))}else if("LineString"===e.type)for(var Z=0,H=e.geometry;Z<H.length;Z+=1){var W=H[Z];M(W,new Iu(W[0].x,W[0].y,0))}else if("Point"===e.type)for(var X=0,Y=e.geometry;X<Y.length;X+=1)for(var K=0,J=Y[X];K<J.length;K+=1){var Q=J[K];M([Q],new Iu(Q.x,Q.y,0))}}(t,o,h,F,r,c,f,p,x,B,a)},_=0,b=t.features;_<b.length;_+=1)y();o&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+r)*(o=1/(r-i)),t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r];i in t&&(n[i]=t[i])}return n},t.plugin=ii,t.polygonIntersectsPolygon=Uo,t.postMapLoadEvent=ot,t.postTurnstileEvent=rt,t.potpack=hu,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=zr,t.registerForPluginStateChange=function(t){return t({pluginStatus:Jr,pluginURL:Qr}),ei.on("pluginStateChange",t),t},t.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+p*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=p*i-u*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+p*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=p*i-u*r,t},t.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.setCacheLimits=function(t,e){at=t,st=e},t.setRTLTextPlugin=function(t,e,n){if(void 0===n&&(n=!1),"deferred"===Jr||"loading"===Jr||"loaded"===Jr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Qr=j.resolveURL(t),Jr="deferred",Kr=e,ti(),n||ri()},t.sphericalToCartesian=function(t){var e=t[0],n=t[1],r=t[2];return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(r),y:e*Math.sin(n)*Math.sin(r),z:e*Math.cos(r)}},t.sqrLen=function(t){var e=t[0],n=t[1];return e*e+n*n},t.styleSpec=Ct,t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.symbolSize=Du,t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.transformMat4=ua,t.translate=function(t,e,n){var r,i,o,a,s,u,c,l,f,p,h,d,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],t[0]=r=e[0],t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=p,t[10]=h,t[11]=d,t[12]=r*m+s*v+f*g+e[12],t[13]=i*m+u*v+p*g+e[13],t[14]=o*m+c*v+h*g+e[14],t[15]=a*m+l*v+d*g+e[15]),t},t.triggerPluginCompletionEvent=$r,t.uniqueId=h,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Cr,t.validateStyle=Ar,t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.vectorTile=gs,t.version="1.11.1",t.warnOnce=w,t.webpSupported=F,t.window=a,t.wrap=l})),r(["./shared"],(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",i=0,o=t;i<o.length;i+=1)r+=e(o[i])+",";return r+"]"}for(var a=Object.keys(t).sort(),s="{",u=0;u<a.length;u++)s+=JSON.stringify(a[u])+":"+e(t[a[u]])+",";return s+"}"}function n(n){for(var r="",i=0,o=t.refProperties;i<o.length;i+=1)r+="/"+e(n[o[i]]);return r}var r=function(t){this.keyCache={},t&&this.replace(t)};r.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},r.prototype.update=function(e,r){for(var i=this,o=0,a=e;o<a.length;o+=1){var s=a[o];this._layerConfigs[s.id]=s;var u=this._layers[s.id]=t.createStyleLayer(s);u._featureFilter=t.featureFilter(u.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0,l=r;c<l.length;c+=1){var f=l[c];delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f]}this.familiesBySource={};for(var p=0,h=function(t,e){for(var r={},i=0;i<t.length;i++){var o=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=o);var a=r[o];a||(a=r[o]=[]),a.push(t[i])}var s=[];for(var u in r)s.push(r[u]);return s}(t.values(this._layerConfigs),this.keyCache);p<h.length;p+=1){var d=h[p].map((function(t){return i._layers[t.id]})),m=d[0];if("none"!==m.visibility){var v=m.source||"",g=this.familiesBySource[v];g||(g=this.familiesBySource[v]={});var y=m.sourceLayer||"_geojsonTileLayer",_=g[y];_||(_=g[y]=[]),_.push(d)}}};var i=function(e){var n={},r=[];for(var i in e){var o=e[i],a=n[i]={};for(var s in o){var u=o[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};r.push(c),a[s]={rect:c,metrics:u.metrics}}}}var l=t.potpack(r),f=new t.AlphaImage({width:l.w||1,height:l.h||1});for(var p in e){var h=e[p];for(var d in h){var m=h[+d];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var v=n[p][d].rect;t.AlphaImage.copy(m.bitmap,f,{x:0,y:0},{x:v.x+1,y:v.y+1},m.bitmap)}}}this.image=f,this.positions=n};t.register("GlyphAtlas",i);var o=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId};function a(e,n,r){for(var i=new t.EvaluationParameters(n),o=0,a=e;o<a.length;o+=1)a[o].recalculate(i,r)}function s(e,n){var r=t.getArrayBuffer(e.request,(function(e,r,i,o){e?n(e):r&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(r)),rawData:r,cacheControl:i,expires:o})}));return function(){r.cancel(),n()}}o.prototype.parse=function(e,n,r,o,s){var u=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var c=new t.DictionaryCoder(Object.keys(e.layers).sort()),l=new t.FeatureIndex(this.tileID,this.promoteId);l.bucketLayerIDs=[];var f,p,h,d,m={},v={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},g=n.familiesBySource[this.source];for(var y in g){var _=e.layers[y];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+y+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=c.encode(y),x=[],w=0;w<_.length;w++){var S=_.feature(w),E=l.getId(S,y);x.push({feature:S,id:E,index:w,sourceLayerIndex:b})}for(var T=0,A=g[y];T<A.length;T+=1){var C=A[T],k=C[0];k.minzoom&&this.zoom<Math.floor(k.minzoom)||k.maxzoom&&this.zoom>=k.maxzoom||"none"!==k.visibility&&(a(C,this.zoom,r),(m[k.id]=k.createBucket({index:l.bucketLayerIDs.length,layers:C,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(x,v,this.tileID.canonical),l.bucketLayerIDs.push(C.map((function(t){return t.id}))))}}}var P=t.mapObject(v.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(P).length?o.send("getGlyphs",{uid:this.uid,stacks:P},(function(t,e){f||(f=t,p=e,O.call(u))})):p={};var M=Object.keys(v.iconDependencies);M.length?o.send("getImages",{icons:M,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){f||(f=t,h=e,O.call(u))})):h={};var I=Object.keys(v.patternDependencies);function O(){if(f)return s(f);if(p&&h&&d){var e=new i(p),n=new t.ImageAtlas(h,d);for(var o in m){var u=m[o];u instanceof t.SymbolBucket?(a(u.layers,this.zoom,r),t.performSymbolLayout(u,p,e.positions,h,n.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):u.hasPattern&&(u instanceof t.LineBucket||u instanceof t.FillBucket||u instanceof t.FillExtrusionBucket)&&(a(u.layers,this.zoom,r),u.addFeatures(v,this.tileID.canonical,n.patternPositions))}this.status="done",s(null,{buckets:t.values(m).filter((function(t){return!t.isEmpty()})),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?h:null,glyphPositions:this.returnDependencies?e.positions:null})}}I.length?o.send("getImages",{icons:I,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){f||(f=t,d=e,O.call(u))})):d={},O.call(this)};var u=function(t,e,n,r){this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||s,this.loading={},this.loaded={}};u.prototype.loadTile=function(e,n){var r=this,i=e.uid;this.loading||(this.loading={});var a=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),s=this.loading[i]=new o(e);s.abort=this.loadVectorData(e,(function(e,o){if(delete r.loading[i],e||!o)return s.status="done",r.loaded[i]=s,n(e);var u=o.rawData,c={};o.expires&&(c.expires=o.expires),o.cacheControl&&(c.cacheControl=o.cacheControl);var l={};if(a){var f=a.finish();f&&(l.resourceTiming=JSON.parse(JSON.stringify(f)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,r.layerIndex,r.availableImages,r.actor,(function(e,r){if(e||!r)return n(e);n(null,t.extend({rawTileData:u.slice(0)},r,c,l))})),r.loaded=r.loaded||{},r.loaded[i]=s}))},u.prototype.reloadTile=function(t,e){var n=this,r=this.loaded,i=t.uid,o=this;if(r&&r[i]){var a=r[i];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,r){var i=a.reloadCallback;i&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,i)),e(t,r)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},u.prototype.abortTile=function(t,e){var n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()},u.prototype.removeTile=function(t,e){var n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()};var c=t.window.ImageBitmap,l=function(){this.loaded={}};function f(t,e){if(0!==t.length){p(t[0],e);for(var n=1;n<t.length;n++)p(t[n],!e)}}function p(t,e){for(var n=0,r=0,i=t.length,o=i-1;r<i;o=r++)n+=(t[r][0]-t[o][0])*(t[o][1]+t[r][1]);n>=0!=!!e&&t.reverse()}l.prototype.loadTile=function(e,n){var r=e.uid,i=e.encoding,o=e.rawImageData,a=c&&o instanceof c?this.getImageData(o):o,s=new t.DEMData(r,a,i);this.loaded=this.loaded||{},this.loaded[r]=s,n(null,s)},l.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var n=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)},l.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var h=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,d=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};d.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,r=this._feature.geometry;n<r.length;n+=1){var i=r[n];e.push([new t.Point$1(i[0],i[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var u=[],c=0,l=s[a];c<l.length;c+=1){var f=l[c];u.push(new t.Point$1(f[0],f[1]))}o.push(u)}return o},d.prototype.toGeoJSON=function(t,e,n){return h.call(this,t,e,n)};var m=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};m.prototype.feature=function(t){return new d(this._features[t])};var v=t.vectorTile.VectorTileFeature,g=y;function y(t,e){this.options=e||{},this.features=t,this.length=t.length}function _(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}y.prototype.feature=function(t){return new _(this.features[t],this.options.extent)},_.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++)i.push(new t.Point$1(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),n=Math.max(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.y)}return[e,r,n,i]},_.prototype.toGeoJSON=v.prototype.toGeoJSON;var b=w,x=g;function w(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,S,t.layers[n])}(e,n),n.finish()}function S(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,E,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,P,o[n])}function E(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,T,t),e.writeVarintField(3,n.type),e.writeMessage(4,k,n)}function T(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var u=o[s];void 0===u&&(r.push(s),o[s]=u=r.length-1),e.writeVarint(u);var c=n.properties[s],l=typeof c;"string"!==l&&"boolean"!==l&&"number"!==l&&(c=JSON.stringify(c));var f=l+":"+c,p=a[f];void 0===p&&(i.push(c),a[f]=p=i.length-1),e.writeVarint(p)}}function A(t,e){return(e<<3)+(7&t)}function C(t){return t<<1^t>>31}function k(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,a=n.length,s=0;s<a;s++){var u=n[s],c=1;1===r&&(c=u.length),e.writeVarint(A(1,c));for(var l=3===r?u.length-1:u.length,f=0;f<l;f++){1===f&&1!==r&&e.writeVarint(A(2,l-1));var p=u[f].x-i,h=u[f].y-o;e.writeVarint(C(p)),e.writeVarint(C(h)),i+=p,o+=h}3===r&&e.writeVarint(A(7,1))}}function P(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function M(t,e,n,r){I(t,n,r),I(e,2*n,2*r),I(e,2*n+1,2*r+1)}function I(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function O(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}b.fromVectorTileJs=w,b.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new g(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return w({layers:n})},b.GeoJSONWrapper=x;var L=function(t){return t[0]},R=function(t){return t[1]},D=function(t,e,n,r,i){void 0===e&&(e=L),void 0===n&&(n=R),void 0===r&&(r=64),void 0===i&&(i=Float64Array),this.nodeSize=r,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new i(2*t.length),u=0;u<t.length;u++)a[u]=u,s[2*u]=e(t[u]),s[2*u+1]=n(t[u]);!function t(e,n,r,i,o,a){if(!(o-i<=r)){var s=i+o>>1;!function t(e,n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);t(e,n,r,Math.max(i,Math.floor(r-u*l/s+f)),Math.min(o,Math.floor(r+(s-u)*l/s+f)),a)}var p=n[2*r+a],h=i,d=o;for(M(e,n,i,r),n[2*o+a]>p&&M(e,n,i,o);h<d;){for(M(e,n,h,d),h++,d--;n[2*h+a]<p;)h++;for(;n[2*d+a]>p;)d--}n[2*i+a]===p?M(e,n,i,d):M(e,n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(e,n,s,i,o,a%2),t(e,n,r,i,s-1,a+1),t(e,n,r,s+1,o,a+1)}}(a,s,r,0,a.length-1,0)};D.prototype.range=function(t,e,n,r){return function(t,e,n,r,i,o,a){for(var s,u,c=[0,t.length-1,0],l=[];c.length;){var f=c.pop(),p=c.pop(),h=c.pop();if(p-h<=a)for(var d=h;d<=p;d++)u=e[2*d+1],(s=e[2*d])>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var m=Math.floor((h+p)/2);u=e[2*m+1],(s=e[2*m])>=n&&s<=i&&u>=r&&u<=o&&l.push(t[m]);var v=(f+1)%2;(0===f?n<=s:r<=u)&&(c.push(h),c.push(m-1),c.push(v)),(0===f?i>=s:o>=u)&&(c.push(m+1),c.push(p),c.push(v))}}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)},D.prototype.within=function(t,e,n){return function(t,e,n,r,i,o){for(var a=[0,t.length-1,0],s=[],u=i*i;a.length;){var c=a.pop(),l=a.pop(),f=a.pop();if(l-f<=o)for(var p=f;p<=l;p++)O(e[2*p],e[2*p+1],n,r)<=u&&s.push(t[p]);else{var h=Math.floor((f+l)/2),d=e[2*h],m=e[2*h+1];O(d,m,n,r)<=u&&s.push(t[h]);var v=(c+1)%2;(0===c?n-i<=d:r-i<=m)&&(a.push(f),a.push(h-1),a.push(v)),(0===c?n+i>=d:r+i>=m)&&(a.push(h+1),a.push(l),a.push(v))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)};var z={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},j=function(t){this.options=q(Object.create(z),t),this.trees=new Array(this.options.maxZoom+1)};function N(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function F(t,e){var n=t.geometry.coordinates,r=n[1];return{x:V(n[0]),y:G(r),zoom:1/0,index:e,parentId:-1}}function B(t){return{type:"Feature",id:t.id,properties:U(t),geometry:{type:"Point",coordinates:[(r=t.x,360*(r-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,r}function U(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return q(q({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function V(t){return t/360+.5}function G(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function q(t,e){for(var n in e)t[n]=e[n];return t}function Z(t){return t.x}function H(t){return t.y}function W(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((t-n)*a+(e-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return(a=t-n)*a+(s=e-r)*s}function X(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Y(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)Y(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)Y(t,e[r][i])}(i),i}function Y(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function K(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)J(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)J(i[c],s);else if("LineString"===o)Q(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<i.length;c++)Q(i[c],s=[],a,!1),t.push(X(u,"LineString",s,e.properties));return}$(i,s,a,!1)}else if("Polygon"===o)$(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)K(t,{id:u,geometry:e.geometry.geometries[c],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];$(i[c],l,a,!0),s.push(l)}}t.push(X(u,o,s,e.properties))}}function J(t,e){e.push(tt(t[0])),e.push(et(t[1])),e.push(0)}function Q(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var u=tt(t[s][0]),c=et(t[s][1]);e.push(u),e.push(c),e.push(0),s>0&&(a+=r?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=e.length-3;e[2]=1,function t(e,n,r,i){for(var o,a=i,s=r-n>>1,u=r-n,c=e[n],l=e[n+1],f=e[r],p=e[r+1],h=n+3;h<r;h+=3){var d=W(e[h],e[h+1],c,l,f,p);if(d>a)o=h,a=d;else if(d===a){var m=Math.abs(h-s);m<u&&(o=h,u=m)}}a>i&&(o-n>3&&t(e,n,o,i),e[o+2]=a,r-o>3&&t(e,o,r,i))}(e,0,l,n),e[l+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function $(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];Q(t[i],o,n,r),e.push(o)}}function tt(t){return t/360+.5}function et(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function nt(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var u=[],c=0;c<t.length;c++){var l=t[c],f=l.geometry,p=l.type,h=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(h>=n&&d<r)u.push(l);else if(!(d<n||h>=r)){var m=[];if("Point"===p||"MultiPoint"===p)rt(f,m,n,r,i);else if("LineString"===p)it(f,m,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===p)at(f,m,n,r,i,!1);else if("Polygon"===p)at(f,m,n,r,i,!0);else if("MultiPolygon"===p)for(var v=0;v<f.length;v++){var g=[];at(f[v],g,n,r,i,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(v=0;v<m.length;v++)u.push(X(l.id,p,m[v],l.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),u.push(X(l.id,p,m,l.tags))}}}return u.length?u:null}function rt(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function it(t,e,n,r,i,o,a){for(var s,u,c=ot(t),l=0===i?ut:ct,f=t.start,p=0;p<t.length-3;p+=3){var h=t[p],d=t[p+1],m=t[p+2],v=t[p+3],g=t[p+4],y=0===i?h:d,_=0===i?v:g,b=!1;a&&(s=Math.sqrt(Math.pow(h-v,2)+Math.pow(d-g,2))),y<n?_>n&&(u=l(c,h,d,v,g,n),a&&(c.start=f+s*u)):y>r?_<r&&(u=l(c,h,d,v,g,r),a&&(c.start=f+s*u)):st(c,h,d,m),_<n&&y>=n&&(u=l(c,h,d,v,g,n),b=!0),_>r&&y<=r&&(u=l(c,h,d,v,g,r),b=!0),!o&&b&&(a&&(c.end=f+s*u),e.push(c),c=ot(t)),a&&(f+=s)}var x=t.length-3;h=t[x],d=t[x+1],m=t[x+2],(y=0===i?h:d)>=n&&y<=r&&st(c,h,d,m),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&st(c,c[0],c[1],c[2]),c.length&&e.push(c)}function ot(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function at(t,e,n,r,i,o){for(var a=0;a<t.length;a++)it(t[a],e,n,r,i,o,!1)}function st(t,e,n,r){t.push(e),t.push(n),t.push(r)}function ut(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function ct(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function lt(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=ft(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(ft(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(ft(o.geometry[s][c],e));i.push(u)}n.push(X(o.id,a,i,o.tags))}return n}function ft(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function pt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(r=0;r<c.length;r+=2)u.geometry.push(ht(c[r],c[r+1],e,o,a,s));else for(r=0;r<c.length;r++){var f=[];for(i=0;i<c[r].length;i+=2)f.push(ht(c[r][i],c[r][i+1],e,o,a,s));u.geometry.push(f)}}return t.transformed=!0,t}function ht(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function dt(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,mt(a,t[s],o,i);var u=t[s].minX,c=t[s].minY,l=t[s].maxX,f=t[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),f>a.maxY&&(a.maxY=f)}return a}function mt(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)vt(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)vt(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)vt(a,c[s],t,n,!0,0===s)}if(a.length){var l=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var f in l={},e.tags)l[f]=e.tags[f];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==e.id&&(p.id=e.id),t.features.push(p)}}function vt(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===r||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function gt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)K(n,t.features[r],e,r);else K(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,i=nt(t,1,-1-n,n,0,-1,2,e),o=nt(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=nt(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=lt(i,1).concat(r)),o&&(r=r.concat(lt(o,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function yt(t,e,n){return 32*((1<<t)*n+e)+t}function _t(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);var i=new m(r.features),o=b(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}j.prototype.load=function(t){var e=this.options,n=e.log,r=e.minZoom,i=e.maxZoom,o=e.nodeSize;n&&console.time("total time");var a="prepare "+t.length+" points";n&&console.time(a),this.points=t;for(var s=[],u=0;u<t.length;u++)t[u].geometry&&s.push(F(t[u],u));this.trees[i+1]=new D(s,Z,H,o,Float32Array),n&&console.timeEnd(a);for(var c=i;c>=r;c--){var l=+Date.now();s=this._cluster(s,c),this.trees[c]=new D(s,Z,H,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",c,s.length,+Date.now()-l)}return n&&console.timeEnd("total time"),this},j.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],c=[],l=0,f=u.range(V(n),G(o),V(i),G(r));l<f.length;l+=1){var p=u.points[f[l]];c.push(p.numPoints?B(p):this.points[p.index])}return c},j.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],u=0,c=i.within(o.x,o.y,a);u<c.length;u+=1){var l=i.points[c[u]];l.parentId===t&&s.push(l.numPoints?B(l):this.points[l.index])}if(0===s.length)throw new Error(r);return s},j.prototype.getLeaves=function(t,e,n){var r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r},j.prototype.getTile=function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options,a=o.radius/o.extent,s=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,s,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,s,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,s,a/i,u),r.points,-1,n,i,c),c.features.length?c:null},j.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},j.prototype._appendLeaves=function(t,e,n,r,i){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],u=s.properties;if(u&&u.cluster?i+u.point_count<=r?i+=u.point_count:i=this._appendLeaves(t,u.cluster_id,n,r,i):i<r?i++:t.push(s),t.length===n)break}return i},j.prototype._addTileFeatures=function(t,e,n,r,i,o){for(var a=0,s=t;a<s.length;a+=1){var u=e[s[a]],c=u.numPoints,l={type:1,geometry:[[Math.round(this.options.extent*(u.x*i-n)),Math.round(this.options.extent*(u.y*i-r))]],tags:c?U(u):this.points[u.index].properties},f=void 0;c?f=u.id:this.options.generateId?f=u.index:this.points[u.index].id&&(f=this.points[u.index].id),void 0!==f&&(l.id=f),o.features.push(l)}},j.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},j.prototype._cluster=function(t,e){for(var n=[],r=this.options,i=r.reduce,o=r.minPoints,a=r.radius/(r.extent*Math.pow(2,e)),s=0;s<t.length;s++){var u=t[s];if(!(u.zoom<=e)){u.zoom=e;for(var c=this.trees[e+1],l=c.within(u.x,u.y,a),f=u.numPoints||1,p=f,h=0,d=l;h<d.length;h+=1){var m=c.points[d[h]];m.zoom>e&&(p+=m.numPoints||1)}if(p>=o){for(var v=u.x*f,g=u.y*f,y=i&&f>1?this._map(u,!0):null,_=(s<<5)+(e+1)+this.points.length,b=0,x=l;b<x.length;b+=1){var w=c.points[x[b]];if(!(w.zoom<=e)){w.zoom=e;var S=w.numPoints||1;v+=w.x*S,g+=w.y*S,w.parentId=_,i&&(y||(y=this._map(u,!0)),i(y,this._map(w)))}}u.parentId=_,n.push(N(v/p,g/p,_,p,y))}else if(n.push(u),p>1)for(var E=0,T=l;E<T.length;E+=1){var A=c.points[T[E]];A.zoom<=e||(A.zoom=e,n.push(A))}}}return n},j.prototype._getOriginId=function(t){return t-this.points.length>>5},j.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},j.prototype._map=function(t,e){if(t.numPoints)return e?q({},t.properties):t.properties;var n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?q({},r):r},gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},gt.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],u=this.options,c=u.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var l=1<<e,f=yt(e,n,r),p=this.tiles[f];if(!p&&(c>1&&console.time("creation"),p=this.tiles[f]=dt(t,e,n,r,u),this.tileCoords.push({z:e,x:n,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var h="z"+e;this.stats[h]=(this.stats[h]||0)+1,this.total++}if(p.source=t,i){if(e===u.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,0!==t.length){c>1&&console.time("clipping");var m,v,g,y,_,b,x=.5*u.buffer/u.extent,w=.5-x,S=.5+x,E=1+x;m=v=g=y=null,_=nt(t,l,n-x,n+S,0,p.minX,p.maxX,u),b=nt(t,l,n+w,n+E,0,p.minX,p.maxX,u),t=null,_&&(m=nt(_,l,r-x,r+S,1,p.minY,p.maxY,u),v=nt(_,l,r+w,r+E,1,p.minY,p.maxY,u),_=null),b&&(g=nt(b,l,r-x,r+S,1,p.minY,p.maxY,u),y=nt(b,l,r+w,r+E,1,p.minY,p.maxY,u),b=null),c>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*r),s.push(v||[],e+1,2*n,2*r+1),s.push(g||[],e+1,2*n+1,2*r),s.push(y||[],e+1,2*n+1,2*r+1)}}},gt.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var a=1<<t,s=yt(t,e=(e%a+a)%a,n);if(this.tiles[s])return pt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var u,c=t,l=e,f=n;!u&&c>0;)c--,l=Math.floor(l/2),f=Math.floor(f/2),u=this.tiles[yt(c,l,f)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,f),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,f,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?pt(this.tiles[s],i):null):null};var bt=function(e){function n(t,n,r,i){e.call(this,t,n,r,_t),i&&(this.loadGeoJSON=i)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var n=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var i=!!(r&&r.request&&r.request.collectResourceTiming)&&new t.RequestPerformance(r.request);this.loadGeoJSON(r,(function(o,a){if(o||!a)return n(o);if("object"!=typeof a)return n(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."));!function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)f(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)f(e.coordinates[r],n);return e}(a,!0);try{e._geoJSONIndex=r.cluster?new j(function(e){var n=e.superclusterOptions,r=e.clusterProperties;if(!r||!n)return n;for(var i={},o={},a={accumulated:null,zoom:0},s={properties:null},u=Object.keys(r),c=0,l=u;c<l.length;c+=1){var f=l[c],p=r[f],h=p[0],d=t.createExpression(p[1]),m=t.createExpression("string"==typeof h?[h,["accumulated"],["get",f]]:h);i[f]=d.value,o[f]=m.value}return n.map=function(t){s.properties=t;for(var e={},n=0,r=u;n<r.length;n+=1){var o=r[n];e[o]=i[o].evaluate(a,s)}return e},n.reduce=function(t,e){s.properties=e;for(var n=0,r=u;n<r.length;n+=1){var i=r[n];a.accumulated=t[i],t[i]=o[i].evaluate(a,s)}},n}(r)).load(a.features):function(t,e){return new gt(t,e)}(a,r.geojsonVtOptions)}catch(o){return n(o)}e.loaded={};var s={};if(i){var u=i.finish();u&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(u)))}n(null,s)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var r=this.loaded;return r&&r[t.uid]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},n}(u),xt=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:u,geojson:bt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return xt.prototype.setReferrer=function(t,e){this.referrer=e},xt.prototype.setImages=function(t,e,n){for(var r in this.availableImages[t]=e,this.workerSources[t]){var i=this.workerSources[t][r];for(var o in i)i[o].availableImages=e}n()},xt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},xt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},xt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},xt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},xt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},xt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},xt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},xt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},xt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}},xt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},xt.prototype.syncRTLPluginState=function(e,n,r){try{t.plugin.setState(n);var i=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=i){this.self.importScripts(i);var o=t.plugin.isParsed();r(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+i),o)}}catch(t){r(t.toString())}},xt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||(e=[]),e},xt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e},xt.prototype.getWorkerSource=function(t,e,n){var r=this;return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:function(e,n,i){r.actor.send(e,n,i,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][n]},xt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new l),this.demWorkerSources[t][e]},xt.prototype.enforceCacheSizeLimit=function(e,n){t.enforceCacheSizeLimit(n)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new xt(self)),xt})),r(["./shared"],(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!n(t)}function n(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===r[n=t&&t.failIfMajorPerformanceCaveat]&&(r[n]=function(t){var n=function(t){var n=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",r)||n.probablySupportsContext("experimental-webgl",r):n.supportsContext?n.supportsContext("webgl",r)||n.supportsContext("experimental-webgl",r):n.getContext("webgl",r)||n.getContext("experimental-webgl",r)}(t);if(!n)return!1;var r=n.createShader(n.VERTEX_SHADER);return!(!r||n.isContextLost())&&(n.shaderSource(r,"void main() {}"),n.compileShader(r),!0===n.getShaderParameter(r,n.COMPILE_STATUS))}(n)),r[n]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var n}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=n);var r={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n={create:function(e,n,r){var i=t.window.document.createElement(e);return void 0!==n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},r=t.window.document&&t.window.document.documentElement.style;function i(t){if(!r)return t[0];for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){r&&a&&(o=r[a],r[a]="none")},n.enableDrag=function(){r&&a&&(r[a]=o)};var s=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[s]=e};var u=!1;try{var c=Object.defineProperty({},"passive",{get:function(){u=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){u=!1}n.addEventListener=function(t,e,n,r){void 0===r&&(r={}),t.addEventListener(e,n,"passive"in r&&u?r:r.capture)},n.removeEventListener=function(t,e,n,r){void 0===r&&(r={}),t.removeEventListener(e,n,"passive"in r&&u?r:r.capture)};var l=function e(n){n.preventDefault(),n.stopPropagation(),t.window.removeEventListener("click",e,!0)};function f(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}n.suppressClick=function(){t.window.addEventListener("click",l,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",l,!0)}),0)},n.mousePos=function(e,n){var r=e.getBoundingClientRect();return new t.Point(n.clientX-r.left-e.clientLeft,n.clientY-r.top-e.clientTop)},n.touchPos=function(e,n){for(var r=e.getBoundingClientRect(),i=[],o=0;o<n.length;o++)i.push(new t.Point(n[o].clientX-r.left-e.clientLeft,n[o].clientY-r.top-e.clientTop));return i},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var p=function(e){function n(){e.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isLoaded=function(){return this.loaded},n.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var r=n[e];this._notify(r.ids,r.callback)}this.requestors=[]}},n.prototype.getImage=function(t){return this.images[t]},n.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},n.prototype._validate=function(e,n){var r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),r=!1),r},n.prototype._validateStretch=function(t,e){if(!t)return!0;for(var n=0,r=0,i=t;r<i.length;r+=1){var o=i[r];if(o[0]<n||o[1]<o[0]||e<o[1])return!1;n=o[1]}return!0},n.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},n.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},n.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},n.prototype.listImages=function(){return Object.keys(this.images)},n.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var r=0,i=t;r<i.length;r+=1)this.images[i[r]]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},n.prototype._notify=function(e,n){for(var r={},i=0,o=e;i<o.length;i+=1){var a=o[i];this.images[a]||this.fire(new t.Event("styleimagemissing",{id:a}));var s=this.images[a];s?r[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:t.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}n(null,r)},n.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},n.prototype.getPattern=function(e){var n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new t.ImagePosition(i,r);this.patterns[e]={bin:i,position:o}}return this._updatePatternAtlas(),this.patterns[e].position},n.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},n.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var r=t.potpack(e),i=r.w,o=r.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var u=this.patterns[s].bin,c=u.x+1,l=u.y+1,f=this.images[s].data,p=f.width,h=f.height;t.RGBAImage.copy(f,a,{x:0,y:0},{x:c,y:l},{width:p,height:h}),t.RGBAImage.copy(f,a,{x:0,y:h-1},{x:c,y:l-1},{width:p,height:1}),t.RGBAImage.copy(f,a,{x:0,y:0},{x:c,y:l+h},{width:p,height:1}),t.RGBAImage.copy(f,a,{x:p-1,y:0},{x:c-1,y:l},{width:1,height:h}),t.RGBAImage.copy(f,a,{x:0,y:0},{x:c+p,y:l},{width:1,height:h})}this.dirty=!0},n.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},n.prototype.dispatchRenderCallbacks=function(t){for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(!this.callbackDispatchedThisFrame[r]){this.callbackDispatchedThisFrame[r]=!0;var i=this.images[r];f(i)&&this.updateImage(r,i)}}},n}(t.Evented),h=v,d=v,m=1e20;function v(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function g(t,e,n,r,i,o,a){for(var s=0;s<e;s++){for(var u=0;u<n;u++)r[u]=t[u*e+s];for(y(r,i,o,a,n),u=0;u<n;u++)t[u*e+s]=i[u]}for(u=0;u<n;u++){for(s=0;s<e;s++)r[s]=t[u*e+s];for(y(r,i,o,a,e),s=0;s<e;s++)t[u*e+s]=Math.sqrt(i[s])}}function y(t,e,n,r,i){n[0]=0,r[0]=-m,r[1]=+m;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=+m}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}v.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=e.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?m:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?m:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++)n[r]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[r]-this.gridInner[r])/this.radius+this.cutoff))));return n},h.default=d;var _=function(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}};_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(e,n){var r=this,i=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1)i.push({stack:o,id:s[a]});t.asyncAll(i,(function(t,e){var n=t.stack,i=t.id,o=r.entries[n];o||(o=r.entries[n]={glyphs:{},requests:{},ranges:{}});var a=o.glyphs[i];if(void 0===a){if(a=r._tinySDF(o,n,i))return o.glyphs[i]=a,void e(null,{stack:n,id:i,glyph:a});var s=Math.floor(i/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else if(o.ranges[s])e(null,{stack:n,id:i,glyph:a});else{var u=o.requests[s];u||(u=o.requests[s]=[],_.loadGlyphRange(n,s,r.url,r.requestManager,(function(t,e){if(e){for(var n in e)r._doesCharSupportLocalGlyph(+n)||(o.glyphs[+n]=e[+n]);o.ranges[s]=!0}for(var i=0,a=u;i<a.length;i+=1)(0,a[i])(t,e);delete o.requests[s]}))),u.push((function(t,r){t?e(t):r&&e(null,{stack:n,id:i,glyph:r[i]||null})}))}}else e(null,{stack:n,id:i,glyph:a})}),(function(t,e){if(t)n(t);else if(e){for(var r={},i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.stack,u=a.id,c=a.glyph;(r[s]||(r[s]={}))[u]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}n(null,r)}}))},_.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},_.prototype._tinySDF=function(e,n,r){var i=this.localIdeographFontFamily;if(i&&this._doesCharSupportLocalGlyph(r)){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new _.TinySDF(24,3,8,.25,i,a)}return{id:r,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(e,n,r,i,o){var a=256*n,s=a+255,u=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(u,(function(e,n){if(e)o(e);else if(n){for(var r={},i=0,a=t.parseGlyphPBF(n);i<a.length;i+=1){var s=a[i];r[s.id]=s}o(null,r)}}))},_.TinySDF=h;var b=function(){this.specification=t.styleSpec.light.position};b.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},b.prototype.interpolate=function(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}};var x=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new b,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),w=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(x),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e,n){if(void 0===n&&(n={}),!this._validate(t.validateLight,e,n))for(var r in e){var i=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),i):this._transitionable.setValue(r,i)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),S=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};S.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]},S.prototype.getDashRanges=function(t,e,n){var r=[],i=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,a=!0;r.push({left:i,right:o,isDash:a,zeroLength:0===t[0]});for(var s=t[0],u=1;u<t.length;u++){var c=t[u];r.push({left:i=s*n,right:o=(s+=c)*n,isDash:a=!a,zeroLength:0===c})}return r},S.prototype.addRoundDash=function(t,e,n){for(var r=e/2,i=-n;i<=n;i++)for(var o=this.width*(this.nextRow+n+i),a=0,s=t[a],u=0;u<this.width;u++){u/s.right>1&&(s=t[++a]);var c=Math.abs(u-s.left),l=Math.abs(u-s.right),f=Math.min(c,l),p=void 0,h=i/n*(r+1);if(s.isDash){var d=r-Math.abs(h);p=Math.sqrt(f*f+d*d)}else p=r-Math.sqrt(f*f+h*h);this.data[o+u]=Math.max(0,Math.min(255,p+128))}},S.prototype.addRegularDash=function(t){for(var e=t.length-1;e>=0;--e){var n=t[e],r=t[e+1];n.zeroLength?t.splice(e,1):r&&r.isDash===n.isDash&&(r.left=n.left,t.splice(e,1))}var i=t[0],o=t[t.length-1];i.isDash===o.isDash&&(i.left=o.left-this.width,o.right=i.right+this.width);for(var a=this.width*this.nextRow,s=0,u=t[s],c=0;c<this.width;c++){c/u.right>1&&(u=t[++s]);var l=Math.abs(c-u.left),f=Math.abs(c-u.right),p=Math.min(l,f);this.data[a+c]=Math.max(0,Math.min(255,(u.isDash?p:-p)+128))}},S.prototype.addDash=function(e,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];if(0!==o){var s=this.width/o,u=this.getDashRanges(e,this.width,s);n?this.addRoundDash(u,s,r):this.addRegularDash(u)}var c={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,c},S.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))};var E=function e(n,r){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=new e.Actor(i[o],r,this.id);a.name="Worker "+o,this.actors.push(a)}};function T(e,n,r){var i=function(i,o){if(i)return r(i);if(o){var a=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(t){return t.id}))),a.tiles=n.canonicalizeTileset(a,e.url),r(null,a)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),i):t.browser.frame((function(){return i(null,e)}))}E.prototype.broadcast=function(e,n,r){t.asyncAll(this.actors,(function(t,r){t.send(e,n,r)}),r=r||function(){})},E.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},E.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},E.Actor=t.Actor;var A=function(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24};A.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},A.prototype.contains=function(e){var n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<o&&e.y>=i&&e.y<a};var C=function(e){function n(n,r,i,o){if(e.call(this),this.id=n,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(r,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=T(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new A(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(r,i){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",i,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",i,o.bind(this)))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),k=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=T(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new A(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var r=this,i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){r.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=r.map.painter.context,s=a.gl;e.texture=r.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(r.dispatcher),n(null)}}))},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),P=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function i(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=t.window.ImageBitmap&&o instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported()?o:t.browser.getImageData(o,1),s={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",s,i.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,u={};return u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),u},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},n}(k),M=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(o),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*a,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.EXTENT,radius:(r.clusterRadius||50)*a,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)e.fire(new t.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(r.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",r))}}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)n.fire(new t.ErrorEvent(e));else{var r={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(r.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",r))}})),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},n.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},n.prototype.getClusterLeaves=function(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this},n.prototype._updateWorkerData=function(e){var n=this;this._loaded=!1;var r=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._requestManager.transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this.actor.send(this.type+".loadData",r,(function(t,i){n._removed||i&&i.abandoned||(n._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[n.id]&&(n._resourceTiming=i.resourceTiming[n.id].slice(0)),n.actor.send(n.type+".coalesce",{source:r.source},null),e(t))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.loadTile=function(e,n){var r=this,i=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(i,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(t,o){return delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,r.map.painter,"reloadTile"===i),n(null))}))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},n.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),I=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),O=function(e){function n(t,n,r,i){e.call(this),this.id=t,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(e,n){var r=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(i,o){r._loaded=!0,i?r.fire(new t.ErrorEvent(i)):o&&(r.image=o,e&&(r.coordinates=e),n&&n(),r._finishLoading())}))},n.prototype.loaded=function(){return this._loaded},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){var n=this;this.coordinates=e;var r=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var n=1/0,r=1/0,i=-1/0,o=-1/0,a=0,s=e;a<s.length;a+=1){var u=s[a];n=Math.min(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}var c=Math.max(i-n,o-r),l=Math.max(0,Math.floor(-Math.log(c)/Math.LN2)),f=Math.pow(2,l);return new t.CanonicalTileID(l,Math.floor((n+i)/2*f),Math.floor((r+o)/2*f))}(r),this.minzoom=this.maxzoom=this.tileID.z;var i=r.map((function(t){return n.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),L=function(e){function n(t,n,r,i){e.call(this,t,n,r,i),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1;var n=this.options;this.urls=[];for(var r=0,i=n.urls;r<i.length;r+=1)this.urls.push(this.map._requestManager.transformRequest(i[r],t.ResourceType.Source).url);t.getVideo(this.urls,(function(n,r){e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},n.prototype.pause=function(){this.video&&this.video.pause()},n.prototype.play=function(){this.video&&this.video.play()},n.prototype.seek=function(e){if(this.video){var n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+n.start(0)+" and "+n.end(0)+"-second mark."))):this.video.currentTime=e}},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(O),R=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(O),D={vector:C,raster:k,"raster-dem":P,geojson:M,video:L,image:O,canvas:R};function z(e,n){var r=t.identity([]);return t.translate(r,r,[1,1,0]),t.scale(r,r,[.5*e.width,.5*e.height,1]),t.multiply(r,r,e.calculatePosMatrix(n.toUnwrapped()))}function j(t,e,n,r,i,o){var a=function(t,e,n){if(t)for(var r=0,i=t;r<i.length;r+=1){var o=e[i[r]];if(o&&o.source===n&&"fill-extrusion"===o.type)return!0}else for(var a in e){var s=e[a];if(s.source===n&&"fill-extrusion"===s.type)return!0}return!1}(i&&i.layers,e,t.id),s=o.maxPitchScaleFactor(),u=t.tilesIn(r,s,a);u.sort(N);for(var c=[],l=0,f=u;l<f.length;l+=1){var p=f[l];c.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,n,t._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,i,o,s,z(t.transform,p.tileID))})}var h=function(t){for(var e={},n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.queryResults,s=o.wrappedTileID,u=n[s]=n[s]||{};for(var c in a)for(var l=a[c],f=u[c]=u[c]||{},p=e[c]=e[c]||[],h=0,d=l;h<d.length;h+=1){var m=d[h];f[m.featureIndex]||(f[m.featureIndex]=!0,p.push(m))}}return e}(c);for(var d in h)h[d].forEach((function(e){var n=e.feature,r=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return h}function N(t,e){var n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var F=function(t,e){this.max=t,this.onRemove=e,this.reset()};F.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var r=n[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},F.prototype.add=function(t,e,n){var r=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){r.remove(t,o)}),n)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},F.prototype.has=function(t){return t.wrapped().key in this.data},F.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},F.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},F.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},F.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},F.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this},F.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},F.prototype.filter=function(t){var e=[];for(var n in this.data)for(var r=0,i=this.data[n];r<i.length;r+=1){var o=i[r];t(o.value)||e.push(o)}for(var a=0,s=e;a<s.length;a+=1){var u=s[a];this.remove(u.value.tileID,u)}};var B=function(t,e,n){this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};B.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},B.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},B.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var U={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},V=function(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};V.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},V.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},V.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var r=e.attributes[this.attributes[n].name];void 0!==r&&t.enableVertexAttribArray(r)}},V.prototype.setVertexAttribPointers=function(t,e,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[U[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}},V.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var G=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};G.prototype.get=function(){return this.current},G.prototype.set=function(t){},G.prototype.getDefault=function(){return this.default},G.prototype.setDefault=function(){this.set(this.default)};var q=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(G),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(G),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(G),W=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(G),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(G),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(G),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(G),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(G),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(G),$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(G),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(G),et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(G),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(G),rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(G),it=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(G),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(G),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(G),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(G),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(G),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(G),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(G),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(G),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(G),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(G),dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(G),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(G),vt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(G),gt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(G),yt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(G),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(G),bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(G),xt=function(t){function e(e,n){t.call(this,e),this.context=e,this.parent=n}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(G),wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(xt),St=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(xt),Et=function(t,e,n,r){this.context=t,this.width=e,this.height=n;var i=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new wt(t,i),r&&(this.depthAttachment=new St(t,i))};Et.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n)}t.deleteFramebuffer(this.framebuffer)};var Tt=function(t,e,n){this.func=t,this.mask=e,this.range=n};Tt.ReadOnly=!1,Tt.ReadWrite=!0,Tt.disabled=new Tt(519,Tt.ReadOnly,[0,1]);var At=function(t,e,n,r,i,o){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o};At.disabled=new At({func:519,mask:0},0,0,7680,7680,7680);var Ct=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};Ct.disabled=new Ct(Ct.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),Ct.unblended=new Ct(Ct.Replace,t.Color.transparent,[!0,!0,!0,!0]),Ct.alphaBlended=new Ct([1,771],t.Color.transparent,[!0,!0,!0,!0]);var kt=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};kt.disabled=new kt(!1,1029,2305),kt.backCCW=new kt(!0,1029,2305);var Pt=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new q(this),this.clearDepth=new Z(this),this.clearStencil=new H(this),this.colorMask=new W(this),this.depthMask=new X(this),this.stencilMask=new Y(this),this.stencilFunc=new K(this),this.stencilOp=new J(this),this.stencilTest=new Q(this),this.depthRange=new $(this),this.depthTest=new tt(this),this.depthFunc=new et(this),this.blend=new nt(this),this.blendFunc=new rt(this),this.blendColor=new it(this),this.blendEquation=new ot(this),this.cullFace=new at(this),this.cullFaceSide=new st(this),this.frontFace=new ut(this),this.program=new ct(this),this.activeTexture=new lt(this),this.viewport=new ft(this),this.bindFramebuffer=new pt(this),this.bindRenderbuffer=new ht(this),this.bindTexture=new dt(this),this.bindVertexBuffer=new mt(this),this.bindElementBuffer=new vt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gt(this),this.pixelStoreUnpack=new yt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new bt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")};Pt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pt.prototype.createIndexBuffer=function(t,e){return new B(this,t,e)},Pt.prototype.createVertexBuffer=function(t,e,n){return new V(this,t,e,n)},Pt.prototype.createRenderbuffer=function(t,e,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i},Pt.prototype.createFramebuffer=function(t,e,n){return new Et(this,t,e,n)},Pt.prototype.clear=function(t){var e=t.color,n=t.depth,r=this.gl,i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)},Pt.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},Pt.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Pt.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Pt.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,Ct.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},Pt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Mt=function(e){function n(n,r,i){var o=this;e.call(this),this.id=n,this.dispatcher=i,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),this.on("error",(function(){o._sourceErrored=!0})),this._source=function(e,n,r,i){var o=new D[n.type](e,n,r,i);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o}(n,r,i,this),this._tiles={},this._cache=new F(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}},n.prototype.getIds=function(){return t.values(this._tiles).map((function(t){return t.tileID})).sort(It).map((function(t){return t.key}))},n.prototype.getRenderableIds=function(e){var n=this,r=[];for(var i in this._tiles)this._isIdRenderable(i,e)&&r.push(this._tiles[i]);return e?r.sort((function(e,r){var i=e.tileID,o=r.tileID,a=new t.Point(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((function(t){return t.tileID.key})):r.map((function(t){return t.tileID})).sort(It).map((function(t){return t.key}))},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){var i=this.getTileByID(r);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype._retainLoadedChildren=function(t,e,n,r){for(var i in this._tiles){var o=this._tiles[i];if(!(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var u=a;u.overscaledZ>e;)if(t[(u=u.scaledTo(u.overscaledZ-1)).key]){r[a.key]=a;break}}}},n.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(var r=t.overscaledZ-1;r>=e;r--){var i=t.scaledTo(r),o=this._getLoadedTile(i);if(o)return o}},n.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},n.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*n*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)},n.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var n={};for(var r in this._tiles){var i=this._tiles[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),n[i.tileID.key]=i}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},n.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter((function(t){return r._source.hasTile(t)})))):i=[];var o=e.coveringZoomLevel(this._source),a=Math.max(o-n.maxOverzooming,this._source.minzoom),s=Math.max(o+n.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(i,o);if(Ot(this._source.type)){for(var c={},l={},f=0,p=Object.keys(u);f<p.length;f+=1){var h=p[f],d=u[h],m=this._tiles[h];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var v=this.findLoadedParent(d,a);v&&(this._addTile(v.tileID),c[v.tileID.key]=v.tileID),l[h]=d}}for(var g in this._retainLoadedChildren(l,o,s,u),c)u[g]||(this._coveredTiles[g]=!0,u[g]=c[g])}for(var y in u)this._tiles[y].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,u);_<b.length;_+=1){var x=b[_],w=this._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s={},u=0,c=t;u<c.length;u+=1){var l=c[u],f=this._addTile(l);r[l.key]=l,f.hasData()||e<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,e,a,r);for(var p=0,h=t;p<h.length;p+=1){var d=h[p],m=this._tiles[d.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var v=d.children(this._source.maxzoom)[0],g=this.getTile(v);if(g&&g.hasData()){r[v.key]=v;continue}}else{var y=d.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}for(var _=m.wasRequested(),b=d.overscaledZ-1;b>=o;--b){var x=d.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(m=this.getTile(x))&&_&&(m=this._addTile(x)),m&&(r[x.key]=x,_=m.wasRequested(),m.hasData()))break}}}return r},n.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],n=void 0,r=this._tiles[t].tileID;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}e.push(r.key);var i=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(i))break;r=i}for(var o=0,a=e;o<a.length;o+=1)this._loadedParentTiles[a[o]]=n}},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var r=Boolean(n);return r||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),r))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n,r){var i=this,o=[],a=this.transform;if(!a)return o;for(var s=r?a.getCameraQueryGeometry(e):e,u=e.map((function(t){return a.pointCoordinate(t)})),c=s.map((function(t){return a.pointCoordinate(t)})),l=this.getIds(),f=1/0,p=1/0,h=-1/0,d=-1/0,m=0,v=c;m<v.length;m+=1){var g=v[m];f=Math.min(f,g.x),p=Math.min(p,g.y),h=Math.max(h,g.x),d=Math.max(d,g.y)}for(var y=function(e){var r=i._tiles[l[e]];if(!r.holdingForFade()){var s=r.tileID,m=Math.pow(2,a.zoom-r.tileID.overscaledZ),v=n*r.queryPadding*t.EXTENT/r.tileSize/m,g=[s.getTilePoint(new t.MercatorCoordinate(f,p)),s.getTilePoint(new t.MercatorCoordinate(h,d))];if(g[0].x-v<t.EXTENT&&g[0].y-v<t.EXTENT&&g[1].x+v>=0&&g[1].y+v>=0){var y=u.map((function(t){return s.getTilePoint(t)})),_=c.map((function(t){return s.getTilePoint(t)}));o.push({tile:r,tileID:s,queryGeometry:y,cameraQueryGeometry:_,scale:m})}}},_=0;_<l.length;_++)y(_);return o},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),r=0,i=n;r<i.length;r+=1){var o=i[r];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ot(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)},n.prototype.removeFeatureState=function(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)},n.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},n.prototype.setDependencies=function(t,e,n){var r=this._tiles[t];r&&r.setDependencies(e,n)},n.prototype.reloadTilesForDependencies=function(t,e){for(var n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(t,e)}))},n}(t.Evented);function It(t,e){var n=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Ot(t){return"raster"===t||"image"===t||"video"===t}function Lt(){return new t.window.Worker(Xi.workerUrl)}Mt.maxOverzooming=10,Mt.maxUnderzooming=3;var Rt="mapboxgl_preloaded_worker_pool",Dt=function(){this.active={}};Dt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Lt);return this.active[t]=!0,this.workers.slice()},Dt.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)},Dt.prototype.isPreloaded=function(){return!!this.active[Rt]},Dt.prototype.numActive=function(){return Object.keys(this.active).length};var zt,jt=Math.floor(t.browser.hardwareConcurrency/2);function Nt(){return zt||(zt=new Dt),zt}function Ft(e,n){var r={};for(var i in e)"ref"!==i&&(r[i]=e[i]);return t.refProperties.forEach((function(t){t in n&&(r[t]=n[t])})),r}function Bt(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Ft(t[r],e[t[r].ref]));return t}Dt.workerCount=Math.max(Math.min(jt,6),1);var Ut={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Vt(t,e,n){n.push({command:Ut.addSource,args:[t,e[t]]})}function Gt(t,e,n){e.push({command:Ut.removeSource,args:[t]}),n[t]=!0}function qt(t,e,n,r){Gt(t,n,r),Vt(t,e,n)}function Zt(e,n,r){var i;for(i in e[r])if(e[r].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[r][i],n[r][i]))return!1;return!0}function Ht(e,n,r,i,o,a){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t.deepEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.deepEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}))}function Wt(t){return t.id}function Xt(t,e){return t[e.id]=e,t}var Yt=function(t,e){this.reset(t,e)};Yt.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Yt.prototype.lerp=function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var n=1,r=this._distances[n],i=e*this.paddedLength+this.padding;r<i&&n<this._distances.length;)r=this._distances[++n];var o=n-1,a=this._distances[o],s=r-a,u=s>0?(i-a)/s:0;return this.points[o].mult(1-u).add(this.points[n].mult(u))};var Kt=function(t,e,n){var r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};function Jt(e,n,r,i,o){var a=t.create();return n?(t.scale(a,a,[1/o,1/o,1]),r||t.rotateZ(a,a,i.angle)):t.multiply(a,i.labelPlaneMatrix,e),a}function Qt(e,n,r,i,o){if(n){var a=t.clone(e);return t.scale(a,a,[o,o,1]),r||t.rotateZ(a,a,-i.angle),a}return i.glCoordMatrix}function $t(e,n){var r=[e.x,e.y,0,1];le(r,r,n);var i=r[3];return{point:new t.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function te(t,e){return.5+t/e*.5}function ee(t,e){var n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function ne(e,n,r,i,o,a,s,u){var c=i?e.textSizeData:e.iconSizeData,l=t.evaluateSizeForZoom(c,r.transform.zoom),f=[256/r.width*2+1,256/r.height*2+1],p=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var h=e.lineVertexArray,d=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=r.transform.width/r.transform.height,v=!1,g=0;g<d.length;g++){var y=d.get(g);if(y.hidden||y.writingMode===t.WritingMode.vertical&&!v)ce(y.numGlyphs,p);else{v=!1;var _=[y.anchorX,y.anchorY,0,1];if(t.transformMat4(_,_,n),ee(_,f)){var b=te(r.transform.cameraToCenterDistance,_[3]),x=t.evaluateSizeForFeature(c,l,y),w=s?x/b:x*b,S=new t.Point(y.anchorX,y.anchorY),E=$t(S,o).point,T={},A=oe(y,w,!1,u,n,o,a,e.glyphOffsetArray,h,p,E,S,T,m);v=A.useVertical,(A.notEnoughRoom||v||A.needsFlipping&&oe(y,w,!0,u,n,o,a,e.glyphOffsetArray,h,p,E,S,T,m).notEnoughRoom)&&ce(y.numGlyphs,p)}else ce(y.numGlyphs,p)}}i?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function re(t,e,n,r,i,o,a,s,u,c,l){var f=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,h=s.lineStartIndex+s.lineLength,d=e.getoffsetX(s.glyphStartIndex),m=e.getoffsetX(f-1),v=se(t*d,n,r,i,o,a,s.segment,p,h,u,c,l);if(!v)return null;var g=se(t*m,n,r,i,o,a,s.segment,p,h,u,c,l);return g?{first:v,last:g}:null}function ie(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function oe(e,n,r,i,o,a,s,u,c,l,f,p,h,d){var m,v=n/24,g=e.lineOffsetX*v,y=e.lineOffsetY*v;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=re(v,u,g,y,r,f,p,e,c,a,h);if(!w)return{notEnoughRoom:!0};var S=$t(w.first.point,s).point,E=$t(w.last.point,s).point;if(i&&!r){var T=ie(e.writingMode,S,E,d);if(T)return T}m=[w.first];for(var A=e.glyphStartIndex+1;A<_-1;A++)m.push(se(v*u.getoffsetX(A),g,y,r,f,p,e.segment,b,x,c,a,h));m.push(w.last)}else{if(i&&!r){var C=$t(p,o).point,k=e.lineStartIndex+e.segment+1,P=new t.Point(c.getx(k),c.gety(k)),M=$t(P,o),I=M.signedDistanceFromCamera>0?M.point:ae(p,P,C,1,o),O=ie(e.writingMode,C,I,d);if(O)return O}var L=se(v*u.getoffsetX(e.glyphStartIndex),g,y,r,f,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,h);if(!L)return{notEnoughRoom:!0};m=[L]}for(var R=0,D=m;R<D.length;R+=1){var z=D[R];t.addDynamicAttributes(l,z.point,z.angle)}return{}}function ae(t,e,n,r,i){var o=$t(t.add(t.sub(e)._unit()),i).point,a=n.sub(o);return n.add(a._mult(r/a.mag()))}function se(e,n,r,i,o,a,s,u,c,l,f,p){var h=i?e-n:e+n,d=h>0?1:-1,m=0;i&&(d*=-1,m=Math.PI),d<0&&(m+=Math.PI);for(var v=d>0?u+s:u+s+1,g=o,y=o,_=0,b=0,x=Math.abs(h),w=[];_+b<=x;){if((v+=d)<u||v>=c)return null;if(y=g,w.push(g),void 0===(g=p[v])){var S=new t.Point(l.getx(v),l.gety(v)),E=$t(S,f);if(E.signedDistanceFromCamera>0)g=p[v]=E.point;else{var T=v-d;g=ae(0===_?a:new t.Point(l.getx(T),l.gety(T)),S,y,x-_+1,f)}}_+=b,b=y.dist(g)}var A=(x-_)/b,C=g.sub(y),k=C.mult(A)._add(y);k._add(C._unit()._perp()._mult(r*d));var P=m+Math.atan2(g.y-y.y,g.x-y.x);return w.push(k),{point:k,angle:P,path:w}}Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Kt.prototype.insertCircle=function(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)},Kt.prototype._insertBoxCell=function(t,e,n,r,i,o){this.boxCells[i].push(o)},Kt.prototype._insertCircleCell=function(t,e,n,r,i,o){this.circleCells[i].push(o)},Kt.prototype._query=function(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[3*u],l=this.circles[3*u+1],f=this.circles[3*u+2];a.push({key:this.circleKeys[u],x1:c-f,y1:l-f,x2:c+f,y2:l+f})}return o?a.filter(o):a}return this._forEachCell(t,e,n,r,this._queryCell,a,{hitTest:i,seenUids:{box:{},circle:{}}},o),i?a.length>0:a},Kt.prototype._queryCircle=function(t,e,n,r,i){var o=t-n,a=t+n,s=e-n,u=e+n;if(a<0||o>this.width||u<0||s>this.height)return!r&&[];var c=[];return this._forEachCell(o,s,a,u,this._queryCellCircle,c,{hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},i),r?c.length>0:c},Kt.prototype.query=function(t,e,n,r,i){return this._query(t,e,n,r,!1,i)},Kt.prototype.hitTest=function(t,e,n,r,i){return this._query(t,e,n,r,!0,i)},Kt.prototype.hitTestCircle=function(t,e,n,r){return this._queryCircle(t,e,n,!0,r)},Kt.prototype._queryCell=function(t,e,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var l=this.bboxes,f=0,p=c;f<p.length;f+=1){var h=p[f];if(!u.box[h]){u.box[h]=!0;var d=4*h;if(t<=l[d+2]&&e<=l[d+3]&&n>=l[d+0]&&r>=l[d+1]&&(!s||s(this.boxKeys[h]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[h],x1:l[d],y1:l[d+1],x2:l[d+2],y2:l[d+3]})}}}var m=this.circleCells[i];if(null!==m)for(var v=this.circles,g=0,y=m;g<y.length;g+=1){var _=y[g];if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(v[b],v[b+1],v[b+2],t,e,n,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=v[b],w=v[b+1],S=v[b+2];o.push({key:this.circleKeys[_],x1:x-S,y1:w-S,x2:x+S,y2:w+S})}}}},Kt.prototype._queryCellCircle=function(t,e,n,r,i,o,a,s){var u=a.circle,c=a.seenUids,l=this.boxCells[i];if(null!==l)for(var f=this.bboxes,p=0,h=l;p<h.length;p+=1){var d=h[p];if(!c.box[d]){c.box[d]=!0;var m=4*d;if(this._circleAndRectCollide(u.x,u.y,u.radius,f[m+0],f[m+1],f[m+2],f[m+3])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}var v=this.circleCells[i];if(null!==v)for(var g=this.circles,y=0,_=v;y<_.length;y+=1){var b=_[y];if(!c.circle[b]){c.circle[b]=!0;var x=3*b;if(this._circlesCollide(g[x],g[x+1],g[x+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},Kt.prototype._forEachCell=function(t,e,n,r,i,o,a,s){for(var u=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),l=this._convertToXCellCoord(n),f=this._convertToYCellCoord(r),p=u;p<=l;p++)for(var h=c;h<=f;h++)if(i.call(this,t,e,n,r,this.xCellCount*h+p,o,a,s))return},Kt.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Kt.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Kt.prototype._circlesCollide=function(t,e,n,r,i,o){var a=r-t,s=i-e,u=n+o;return u*u>a*a+s*s},Kt.prototype._circleAndRectCollide=function(t,e,n,r,i,o,a){var s=(o-r)/2,u=Math.abs(t-(r+s));if(u>s+n)return!1;var c=(a-i)/2,l=Math.abs(e-(i+c));if(l>c+n)return!1;if(u<=s||l<=c)return!0;var f=u-s,p=l-c;return f*f+p*p<=n*n};var ue=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ce(t,e){for(var n=0;n<t;n++){var r=e.length;e.resize(r+4),e.float32.set(ue,3*r)}}function le(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}var fe=function(t,e,n){void 0===e&&(e=new Kt(t.width+200,t.height+200,25)),void 0===n&&(n=new Kt(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function pe(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}fe.prototype.placeCollisionBox=function(t,e,n,r,i){var o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,s=t.x1*a+o.point.x,u=t.y1*a+o.point.y,c=t.x2*a+o.point.x,l=t.y2*a+o.point.y;return!this.isInsideGrid(s,u,c,l)||!e&&this.grid.hitTest(s,u,c,l,i)?{box:[],offscreen:!1}:{box:[s,u,c,l],offscreen:this.isOffscreen(s,u,c,l)}},fe.prototype.placeCollisionCircles=function(e,n,r,i,o,a,s,u,c,l,f,p,h){var d=[],m=new t.Point(n.anchorX,n.anchorY),v=$t(m,a),g=te(this.transform.cameraToCenterDistance,v.signedDistanceFromCamera),y=(l?o/g:o*g)/t.ONE_EM,_=$t(m,s).point,b=re(y,i,n.lineOffsetX*y,n.lineOffsetY*y,!1,_,m,n,r,s,{}),x=!1,w=!1,S=!0;if(b){for(var E=.5*p*g+h,T=new t.Point(-100,-100),A=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),C=new Yt,k=b.first,P=b.last,M=[],I=k.path.length-1;I>=1;I--)M.push(k.path[I]);for(var O=1;O<P.path.length;O++)M.push(P.path[O]);var L=2.5*E;if(u){var R=M.map((function(t){return $t(t,u)}));M=R.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:R.map((function(t){return t.point}))}var D=[];if(M.length>0){for(var z=M[0].clone(),j=M[0].clone(),N=1;N<M.length;N++)z.x=Math.min(z.x,M[N].x),z.y=Math.min(z.y,M[N].y),j.x=Math.max(j.x,M[N].x),j.y=Math.max(j.y,M[N].y);D=z.x>=T.x&&j.x<=A.x&&z.y>=T.y&&j.y<=A.y?[M]:j.x<T.x||z.x>A.x||j.y<T.y||z.y>A.y?[]:t.clipLine([M],T.x,T.y,A.x,A.y)}for(var F=0,B=D;F<B.length;F+=1){var U;C.reset(B[F],.25*E),U=C.length<=.5*E?1:Math.ceil(C.paddedLength/L)+1;for(var V=0;V<U;V++){var G=V/Math.max(U-1,1),q=C.lerp(G),Z=q.x+100,H=q.y+100;d.push(Z,H,E,0);var W=Z-E,X=H-E,Y=Z+E,K=H+E;if(S=S&&this.isOffscreen(W,X,Y,K),w=w||this.isInsideGrid(W,X,Y,K),!e&&this.grid.hitTestCircle(Z,H,E,f)&&(x=!0,!c))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!c&&x||!w?[]:d,offscreen:S,collisionDetected:x}},fe.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=e;s<u.length;s+=1){var c=u[s],l=new t.Point(c.x+100,c.y+100);r=Math.min(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y),n.push(l)}for(var f={},p={},h=0,d=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a));h<d.length;h+=1){var m=d[h],v=m.key;if(void 0===f[v.bucketInstanceId]&&(f[v.bucketInstanceId]={}),!f[v.bucketInstanceId][v.featureIndex]){var g=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(n,g)&&(f[v.bucketInstanceId][v.featureIndex]=!0,void 0===p[v.bucketInstanceId]&&(p[v.bucketInstanceId]=[]),p[v.bucketInstanceId].push(v.featureIndex))}}return p},fe.prototype.insertCollisionBox=function(t,e,n,r,i){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:i},t[0],t[1],t[2],t[3])},fe.prototype.insertCollisionCircles=function(t,e,n,r,i){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:i},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},fe.prototype.projectAndGetPerspectiveRatio=function(e,n,r){var i=[n,r,0,1];return le(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},fe.prototype.isOffscreen=function(t,e,n,r){return n<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},fe.prototype.isInsideGrid=function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary},fe.prototype.getViewportMatrix=function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e};var he=function(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n};he.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var de=function(t,e,n,r,i){this.text=new he(t?t.text:null,e,n,i),this.icon=new he(t?t.icon:null,e,r,i)};de.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var me=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},ve=function(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]},ge=function(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i},ye=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};function _e(e,n,r,i,o){var a=t.getAnchorAlignment(e),s=-(a.horizontalAlign-.5)*n,u=-(a.verticalAlign-.5)*r,c=t.evaluateVariableOffset(e,i);return new t.Point(s+c[0]*o,u+c[1]*o)}function be(e,n,r,i,o,a){var s=e.x1,u=e.x2,c=e.y1,l=e.y2,f=e.anchorPointX,p=e.anchorPointY,h=new t.Point(n,r);return i&&h._rotate(o?a:-a),{x1:s+h.x,y1:c+h.y,x2:u+h.x,y2:l+h.y,anchorPointX:f,anchorPointY:p}}ye.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var xe=function(t,e,n,r){this.transform=t.clone(),this.collisionIndex=new fe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ye(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}};function we(t,e,n,r,i){t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0)}xe.prototype.getBucketParts=function(e,n,r,i){var o=r.getBucket(n),a=r.latestFeatureIndex;if(o&&a&&n.id===o.layerIds[0]){var s=r.collisionBoxArray,u=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),l=r.tileSize/t.EXTENT,f=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),p="map"===u.get("text-pitch-alignment"),h="map"===u.get("text-rotation-alignment"),d=pe(r,1,this.transform.zoom),m=Jt(f,p,h,this.transform,d),v=null;if(p){var g=Qt(f,p,h,this.transform,d);v=t.multiply([],this.transform.labelPlaneMatrix,g)}this.retainedQueryData[o.bucketInstanceId]=new ge(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,r.tileID);var y={bucket:o,layout:u,posMatrix:f,textLabelPlaneMatrix:m,labelToScreenMatrix:v,scale:c,textPixelRatio:l,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(var _=0,b=o.sortKeyRanges;_<b.length;_+=1){var x=b[_];e.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:y})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:y})}},xe.prototype.attemptAnchorPlacement=function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d){var m,v=[f.textOffset0,f.textOffset1],g=_e(t,n,r,v,i),y=this.collisionIndex.placeCollisionBox(be(e,g.x,g.y,o,a,this.transform.angle),l,s,u,c.predicate);if(!d||0!==this.collisionIndex.placeCollisionBox(be(d,g.x,g.y,o,a,this.transform.angle),l,s,u,c.predicate).box.length)return y.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID].text&&(m=this.prevPlacement.variableOffsets[f.crossTileID].anchor),this.variableOffsets[f.crossTileID]={textOffset:v,width:n,height:r,anchor:t,textBoxScale:i,prevAnchor:m},this.markUsedJustification(p,t,f,h),p.allowVerticalPlacement&&(this.markUsedOrientation(p,h,f),this.placedOrientations[f.crossTileID]=h),{shift:g,placedGlyphBoxes:y}):void 0},xe.prototype.placeLayerBucketPart=function(e,n,r){var i=this,o=e.parameters,a=o.bucket,s=o.layout,u=o.posMatrix,c=o.textLabelPlaneMatrix,l=o.labelToScreenMatrix,f=o.textPixelRatio,p=o.holdingForFade,h=o.collisionBoxArray,d=o.partiallyEvaluatedTextSize,m=o.collisionGroup,v=s.get("text-optional"),g=s.get("icon-optional"),y=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),b="map"===s.get("text-rotation-alignment"),x="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),E=y&&(_||!a.hasIconData()||g),T=_&&(y||!a.hasTextData()||v);!a.collisionArrays&&h&&a.deserializeCollisionBoxes(h);var A=function(e,o){if(!n[e.crossTileID])if(p)i.placements[e.crossTileID]=new me(!1,!1,!1);else{var h,S=!1,A=!1,C=!0,k=null,P={box:null,offscreen:null},M={box:null,offscreen:null},I=null,O=null,L=0,R=0,D=0;o.textFeatureIndex?L=o.textFeatureIndex:e.useRuntimeCollisionCircles&&(L=e.featureIndex),o.verticalTextFeatureIndex&&(R=o.verticalTextFeatureIndex);var z=o.textBox;if(z){var j=function(n){var r=t.WritingMode.horizontal;if(a.allowVerticalPlacement&&!n&&i.prevPlacement){var o=i.prevPlacement.placedOrientations[e.crossTileID];o&&(i.placedOrientations[e.crossTileID]=o,i.markUsedOrientation(a,r=o,e))}return r},N=function(n,r){if(a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&o.verticalTextBox)for(var i=0,s=a.writingModes;i<s.length&&(s[i]===t.WritingMode.vertical?(P=r(),M=P):P=n(),!(P&&P.box&&P.box.length));i+=1);else P=n()};if(s.get("text-variable-anchor")){var F=s.get("text-variable-anchor");if(i.prevPlacement&&i.prevPlacement.variableOffsets[e.crossTileID]){var B=i.prevPlacement.variableOffsets[e.crossTileID];F.indexOf(B.anchor)>0&&(F=F.filter((function(t){return t!==B.anchor}))).unshift(B.anchor)}var U=function(t,n,r){for(var o=t.x2-t.x1,s=t.y2-t.y1,c=e.textBoxScale,l=w&&!_?n:null,p={box:[],offscreen:!1},h=y?2*F.length:F.length,d=0;d<h;++d){var v=i.attemptAnchorPlacement(F[d%F.length],t,o,s,c,b,x,f,u,m,d>=F.length,e,a,r,l);if(v&&(p=v.placedGlyphBoxes)&&p.box&&p.box.length){S=!0,k=v.shift;break}}return p};N((function(){return U(z,o.iconBox,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&!(P&&P.box&&P.box.length)&&e.numVerticalGlyphVertices>0&&n?U(n,o.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),P&&(S=P.box,C=P.offscreen);var V=j(P&&P.box);if(!S&&i.prevPlacement){var G=i.prevPlacement.variableOffsets[e.crossTileID];G&&(i.variableOffsets[e.crossTileID]=G,i.markUsedJustification(a,G.anchor,e,V))}}else{var q=function(t,n){var r=i.collisionIndex.placeCollisionBox(t,y,f,u,m.predicate);return r&&r.box&&r.box.length&&(i.markUsedOrientation(a,n,e),i.placedOrientations[e.crossTileID]=n),r};N((function(){return q(z,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?q(n,t.WritingMode.vertical):{box:null,offscreen:null}})),j(P&&P.box&&P.box.length)}}if(S=(h=P)&&h.box&&h.box.length>0,C=h&&h.offscreen,e.useRuntimeCollisionCircles){var Z=a.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),H=t.evaluateSizeForFeature(a.textSizeData,d,Z),W=s.get("text-padding");I=i.collisionIndex.placeCollisionCircles(y,Z,a.lineVertexArray,a.glyphOffsetArray,H,u,c,l,r,x,m.predicate,e.collisionCircleDiameter,W),S=y||I.circles.length>0&&!I.collisionDetected,C=C&&I.offscreen}if(o.iconFeatureIndex&&(D=o.iconFeatureIndex),o.iconBox){var X=function(t){var e=w&&k?be(t,k.x,k.y,b,x,i.transform.angle):t;return i.collisionIndex.placeCollisionBox(e,_,f,u,m.predicate)};A=M&&M.box&&M.box.length&&o.verticalIconBox?(O=X(o.verticalIconBox)).box.length>0:(O=X(o.iconBox)).box.length>0,C=C&&O.offscreen}var Y=v||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,K=g||0===e.numIconVertices;if(Y||K?K?Y||(A=A&&S):S=A&&S:A=S=A&&S,S&&h&&h.box&&i.collisionIndex.insertCollisionBox(h.box,s.get("text-ignore-placement"),a.bucketInstanceId,M&&M.box&&R?R:L,m.ID),A&&O&&i.collisionIndex.insertCollisionBox(O.box,s.get("icon-ignore-placement"),a.bucketInstanceId,D,m.ID),I&&(S&&i.collisionIndex.insertCollisionCircles(I.circles,s.get("text-ignore-placement"),a.bucketInstanceId,L,m.ID),r)){var J=a.bucketInstanceId,Q=i.collisionCircleArrays[J];void 0===Q&&(Q=i.collisionCircleArrays[J]=new ve);for(var $=0;$<I.circles.length;$+=4)Q.circles.push(I.circles[$+0]),Q.circles.push(I.circles[$+1]),Q.circles.push(I.circles[$+2]),Q.circles.push(I.collisionDetected?1:0)}i.placements[e.crossTileID]=new me(S||E,A||T,C||a.justReloaded),n[e.crossTileID]=!0}};if(S)for(var C=a.getSortedSymbolIndexes(this.transform.angle),k=C.length-1;k>=0;--k){var P=C[k];A(a.symbolInstances.get(P),a.collisionArrays[P])}else for(var M=e.symbolInstanceStart;M<e.symbolInstanceEnd;M++)A(a.symbolInstances.get(M),a.collisionArrays[M]);if(r&&a.bucketInstanceId in this.collisionCircleArrays){var I=this.collisionCircleArrays[a.bucketInstanceId];t.invert(I.invProjMatrix,u),I.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1},xe.prototype.markUsedJustification=function(e,n,r,i){var o;o=i===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];for(var a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var u=s[a];u>=0&&(e.text.placedSymbolArray.get(u).crossTileID=o>=0&&u!==o?0:r.crossTileID)}},xe.prototype.markUsedOrientation=function(e,n,r){for(var i=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];a<s.length;a+=1)e.text.placedSymbolArray.get(s[a]).placedOrientation=i;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=o)},xe.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var r=e?e.symbolFadeChange(t):1,i=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var u=this.placements[s],c=i[s];c?(this.opacities[s]=new de(c,r,u.text,u.icon),n=n||u.text!==c.text.placed||u.icon!==c.icon.placed):(this.opacities[s]=new de(null,r,u.text,u.icon,u.skipFade),n=n||u.text||u.icon)}for(var l in i){var f=i[l];if(!this.opacities[l]){var p=new de(f,r,!1,!1);p.isHidden()||(this.opacities[l]=p,n=n||f.text.placed||f.icon.placed)}}for(var h in o)this.variableOffsets[h]||!this.opacities[h]||this.opacities[h].isHidden()||(this.variableOffsets[h]=o[h]);for(var d in a)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=a[d]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},xe.prototype.updateLayerOpacities=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1){var o=i[r],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},xe.prototype.updateBucketOpacities=function(e,n,r){var i=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var o=e.layers[0].layout,a=new de(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),u=o.get("icon-allow-overlap"),c=o.get("text-variable-anchor"),l="map"===o.get("text-rotation-alignment"),f="map"===o.get("text-pitch-alignment"),p="none"!==o.get("icon-text-fit"),h=new de(null,0,s&&(u||!e.hasIconData()||o.get("icon-optional")),u&&(s||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);for(var d=function(t,e,n){for(var r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)},m=function(r){var o=e.symbolInstances.get(r),s=o.numHorizontalGlyphVertices,u=o.numVerticalGlyphVertices,m=o.crossTileID,v=i.opacities[m];n[m]?v=a:v||(i.opacities[m]=v=h),n[m]=!0;var g=o.numIconVertices>0,y=i.placedOrientations[o.crossTileID],_=y===t.WritingMode.vertical,b=y===t.WritingMode.horizontal||y===t.WritingMode.horizontalOnly;if(s>0||u>0){var x=Me(v.text);d(e.text,s,_?Ie:x),d(e.text,u,b?Ie:x);var w=v.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),o.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=w||b?1:0);var S=i.variableOffsets[o.crossTileID];S&&i.markUsedJustification(e,S.anchor,o,y);var E=i.placedOrientations[o.crossTileID];E&&(i.markUsedJustification(e,"left",o,E),i.markUsedOrientation(e,E,o))}if(g){var T=Me(v.icon),A=!(p&&o.verticalPlacedIconSymbolIndex&&_);o.placedIconSymbolIndex>=0&&(d(e.icon,o.numIconVertices,A?T:Ie),e.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=v.icon.isHidden()),o.verticalPlacedIconSymbolIndex>=0&&(d(e.icon,o.numVerticalIconVertices,A?Ie:T),e.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=v.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var C=e.collisionArrays[r];if(C){var k=new t.Point(0,0);if(C.textBox||C.verticalTextBox){var P=!0;if(c){var M=i.variableOffsets[m];M?(k=_e(M.anchor,M.width,M.height,M.textOffset,M.textBoxScale),l&&k._rotate(f?i.transform.angle:-i.transform.angle)):P=!1}C.textBox&&we(e.textCollisionBox.collisionVertexArray,v.text.placed,!P||_,k.x,k.y),C.verticalTextBox&&we(e.textCollisionBox.collisionVertexArray,v.text.placed,!P||b,k.x,k.y)}var I=Boolean(!b&&C.verticalIconBox);C.iconBox&&we(e.iconCollisionBox.collisionVertexArray,v.icon.placed,I,p?k.x:0,p?k.y:0),C.verticalIconBox&&we(e.iconCollisionBox.collisionVertexArray,v.icon.placed,!I,p?k.x:0,p?k.y:0)}}},v=0;v<e.symbolInstances.length;v++)m(v);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){var g=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=g.invProjMatrix,e.placementViewportMatrix=g.viewportMatrix,e.collisionCircleArray=g.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}},xe.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},xe.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},xe.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},xe.prototype.stillRecent=function(t,e){var n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t},xe.prototype.setStale=function(){this.stale=!0};var Se=Math.pow(2,25),Ee=Math.pow(2,24),Te=Math.pow(2,17),Ae=Math.pow(2,16),Ce=Math.pow(2,9),ke=Math.pow(2,8),Pe=Math.pow(2,1);function Me(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Se+e*Ee+n*Te+e*Ae+n*Ce+e*ke+n*Pe+e}var Ie=0,Oe=function(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Oe.prototype.continuePlacement=function(t,e,n,r,i){for(var o=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(o,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,i())return!0;return!1};var Le=function(t,e,n,r,i,o,a){this.placement=new xe(t,i,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1};Le.prototype.isDone=function(){return this._done},Le.prototype.continuePlacement=function(e,n,r){for(var i=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[this._currentPlacementIndex]],u=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new Oe(s)),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Le.prototype.commit=function(t){return this.placement.commit(t),this.placement};var Re=512/t.EXTENT/2,De=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<e.length;r++){var i=e.get(r),o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};De.prototype.getScaledCoordinates=function(e,n){var r=Re/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*r),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*r)}},De.prototype.findMatches=function(t,e,n){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var o=t.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),u=0,c=a;u<c.length;u+=1){var l=c[u];if(Math.abs(l.coord.x-s.x)<=r&&Math.abs(l.coord.y-s.y)<=r&&!n[l.crossTileID]){n[l.crossTileID]=!0,o.crossTileID=l.crossTileID;break}}}}};var ze=function(){this.maxCrossTileID=0};ze.prototype.generate=function(){return++this.maxCrossTileID};var je=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};je.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var r=this.indexes[n],i={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[n]=i}this.lng=t},je.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var u=a[s];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,i)}else{var c=a[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,i)}}for(var l=0;l<e.symbolInstances.length;l++){var f=e.symbolInstances.get(l);f.crossTileID||(f.crossTileID=n.generate(),i[f.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new De(t,e.symbolInstances,e.bucketInstanceId),!0},je.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var r=0,i=e.indexedSymbolInstances[n];r<i.length;r+=1)delete this.usedCrossTileIDs[t][i[r].crossTileID]},je.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e};var Ne=function(){this.layerIndexes={},this.crossTileIDs=new ze,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ne.prototype.addLayer=function(t,e,n){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new je);var i=!1,o={};r.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(i=!0),o[c.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i},Ne.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var Fe=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},Be=t.pick(Ut,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ue=t.pick(Ut,["setCenter","setZoom","setBearing","setPitch"]),Ve=function(){var e={},n=t.styleSpec.$version;for(var r in t.styleSpec.$root){var i,o=t.styleSpec.$root[r];o.required&&null!=(i="version"===r?n:"array"===o.type?[]:{})&&(e[r]=i)}return e}(),Ge=function(e){function n(r,i){var o=this;void 0===i&&(i={}),e.call(this),this.map=r,this.dispatcher=new E(Nt(),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new _(r._requestManager,i.localIdeographFontFamily),this.lineAtlas=new S(256,512),this.crossTileSymbolIndex=new Ne,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var a=this;this._rtlTextPluginCallback=n.registerForPluginStateChange((function(e){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,n){if(t.triggerPluginCompletionEvent(e),n&&n.every((function(t){return t})))for(var r in a.sourceCaches)a.sourceCaches[r].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var r in o._layers){var i=o._layers[r];i.source===n.id&&o._validateLayer(i)}}}}))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadURL=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);var o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(function(e,n){r._request=null,e?r.fire(new t.ErrorEvent(e)):n&&r._load(n,i)}))},n.prototype.loadJSON=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){r._request=null,r._load(e,!1!==n.validate)}))},n.prototype.loadEmpty=function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ve,!1)},n.prototype._load=function(e,n){if(!n||!Fe(this,t.validateStyle(e))){for(var r in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(r,e.sources[r],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var i=Bt(this.stylesheet.layers);this._order=i.map((function(t){return t.id})),this._layers={},this._serializedLayers={};for(var o=0,a=i;o<a.length;o+=1){var s=a[o];(s=t.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._loadSprite=function(e){var n=this;this._spriteRequest=function(e,n,r){var i,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",u=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),(function(t,e){u=null,a||(a=t,i=e,l())})),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),(function(t,e){c=null,a||(a=t,o=e,l())}));function l(){if(a)r(a);else if(i&&o){var e=t.browser.getImageData(o),n={};for(var s in i){var u=i[s],c=u.width,l=u.height,f=u.x,p=u.y,h=u.sdf,d=u.pixelRatio,m=u.stretchX,v=u.stretchY,g=u.content,y=new t.RGBAImage({width:c,height:l});t.RGBAImage.copy(e,y,{x:f,y:p},{x:0,y:0},{width:c,height:l}),n[s]={data:y,pixelRatio:d,sdf:h,stretchX:m,stretchY:v,content:g}}r(null,n)}}return{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,(function(e,r){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.fire(new t.Event("data",{dataType:"style"}))}))},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var r=e.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=this._layers[r[n]];"custom"!==i.type&&e.push(i.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){var n=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var o in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}for(var u in this.sourceCaches)this.sourceCaches[u].used=!1;for(var c=0,l=this._order;c<l.length;c+=1){var f=this._layers[l[c]];f.recalculate(e,this._availableImages),!f.isHidden(e.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}},n.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),Fe(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=Bt(e.layers);var r=function(e,n){if(!e)return[{command:Ut.setStyle,args:[n]}];var r=[];try{if(!t.deepEqual(e.version,n.version))return[{command:Ut.setStyle,args:[n]}];t.deepEqual(e.center,n.center)||r.push({command:Ut.setCenter,args:[n.center]}),t.deepEqual(e.zoom,n.zoom)||r.push({command:Ut.setZoom,args:[n.zoom]}),t.deepEqual(e.bearing,n.bearing)||r.push({command:Ut.setBearing,args:[n.bearing]}),t.deepEqual(e.pitch,n.pitch)||r.push({command:Ut.setPitch,args:[n.pitch]}),t.deepEqual(e.sprite,n.sprite)||r.push({command:Ut.setSprite,args:[n.sprite]}),t.deepEqual(e.glyphs,n.glyphs)||r.push({command:Ut.setGlyphs,args:[n.glyphs]}),t.deepEqual(e.transition,n.transition)||r.push({command:Ut.setTransition,args:[n.transition]}),t.deepEqual(e.light,n.light)||r.push({command:Ut.setLight,args:[n.light]});var i={},o=[];!function(e,n,r,i){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||Gt(o,r,i));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.deepEqual(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&Zt(e,n,o)?r.push({command:Ut.setGeoJSONSourceData,args:[o,n[o].data]}):qt(o,n,r,i)):Vt(o,n,r))}(e.sources,n.sources,o,i);var a=[];e.layers&&e.layers.forEach((function(t){i[t.source]?r.push({command:Ut.removeLayer,args:[t.id]}):a.push(t)})),r=r.concat(o),function(e,n,r){n=n||[];var i,o,a,s,u,c,l,f=(e=e||[]).map(Wt),p=n.map(Wt),h=e.reduce(Xt,{}),d=n.reduce(Xt,{}),m=f.slice(),v=Object.create(null);for(i=0,o=0;i<f.length;i++)d.hasOwnProperty(a=f[i])?o++:(r.push({command:Ut.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(i=0,o=0;i<p.length;i++)m[m.length-1-i]!==(a=p[p.length-1-i])&&(h.hasOwnProperty(a)?(r.push({command:Ut.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,r.push({command:Ut.addLayer,args:[d[a],c=m[m.length-i]]}),m.splice(m.length-i,0,a),v[a]=!0);for(i=0;i<p.length;i++)if(s=h[a=p[i]],u=d[a],!v[a]&&!t.deepEqual(s,u))if(t.deepEqual(s.source,u.source)&&t.deepEqual(s["source-layer"],u["source-layer"])&&t.deepEqual(s.type,u.type)){for(l in Ht(s.layout,u.layout,r,a,null,Ut.setLayoutProperty),Ht(s.paint,u.paint,r,a,null,Ut.setPaintProperty),t.deepEqual(s.filter,u.filter)||r.push({command:Ut.setFilter,args:[a,u.filter]}),t.deepEqual(s.minzoom,u.minzoom)&&t.deepEqual(s.maxzoom,u.maxzoom)||r.push({command:Ut.setLayerZoomRange,args:[a,u.minzoom,u.maxzoom]}),s)s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Ht(s[l],u[l],r,a,l.slice(6),Ut.setPaintProperty):t.deepEqual(s[l],u[l])||r.push({command:Ut.setLayerProperty,args:[a,l,u[l]]}));for(l in u)u.hasOwnProperty(l)&&!s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Ht(s[l],u[l],r,a,l.slice(6),Ut.setPaintProperty):t.deepEqual(s[l],u[l])||r.push({command:Ut.setLayerProperty,args:[a,l,u[l]]}))}else r.push({command:Ut.removeLayer,args:[a]}),c=m[m.lastIndexOf(a)+1],r.push({command:Ut.addLayer,args:[u,c]})}(a,n.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:Ut.setStyle,args:[n]}]}return r}(this.serialize(),e).filter((function(t){return!(t.command in Ue)}));if(0===r.length)return!1;var i=r.filter((function(t){return!(t.command in Be)}));if(i.length>0)throw new Error("Unimplemented: "+i.map((function(t){return t.command})).join(", ")+".");return r.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,r){var i=this;if(void 0===r&&(r={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,r))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Mt(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,r){void 0===r&&(r={}),this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var o;if("custom"===e.type){if(Fe(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$1(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[o.id]=o.serialize()}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var r=this._order.indexOf(e);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.hasLayer=function(t){return t in this._layers},n.prototype.setLayerZoomRange=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n,r){void 0===r&&(r={}),this._checkLoaded();var i=this.getLayer(e);if(i){if(!t.deepEqual(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateStyle.filter,"layers."+i.id+".filter",n,null,r)||(i.filter=t.clone$1(n),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,r,i){void 0===i&&(i={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,i),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(e,n){var r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},n.prototype.setPaintProperty=function(e,n,r,i){void 0===i&&(i={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,i)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=e.sourceLayer,o=this.sourceCaches[r];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&i?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||i?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(i,e.id,n)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.removeFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=this.sourceCaches[r];if(void 0!==i){var o=i.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):i.removeFeatureState(a,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,r=e.sourceLayer,i=this.sourceCaches[n];if(void 0!==i){if("vector"!==i.getSource().type||r)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(r,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,n=function(t){return"fill-extrusion"===e._layers[t].type},r={},i=[],o=this._order.length-1;o>=0;o--){var a=this._order[o];if(n(a)){r[a]=o;for(var s=0,u=t;s<u.length;s+=1){var c=u[s][a];if(c)for(var l=0,f=c;l<f.length;l+=1)i.push(f[l])}}}i.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var p=[],h=this._order.length-1;h>=0;h--){var d=this._order[h];if(n(d))for(var m=i.length-1;m>=0;m--){var v=i[m].feature;if(r[v.layer.id]<h)break;p.push(v),i.pop()}else for(var g=0,y=t;g<y.length;g+=1){var _=y[g][d];if(_)for(var b=0,x=_;b<x.length;b+=1)p.push(x[b].feature)}}return p},n.prototype.queryRenderedFeatures=function(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],u=this._layers[s];if(!u)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[u.source]=!0}}var c=[];for(var l in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!i[l]||c.push(j(this.sourceCaches[l],this._layers,this._serializedLayers,e,n,r));return this.placement&&c.push(function(t,e,n,r,i,o,a){for(var s={},u=o.queryRenderedSymbols(r),c=[],l=0,f=Object.keys(u).map(Number);l<f.length;l+=1)c.push(a[f[l]]);c.sort(N);for(var p=function(){var n=d[h],r=n.featureIndex.lookupSymbolFeatures(u[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,i.filter,i.layers,i.availableImages,t);for(var o in r){var a=s[o]=s[o]||[],c=r[o];c.sort((function(t,e){var r=n.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(var l=0,f=c;l<f.length;l+=1)a.push(f[l])}},h=0,d=c;h<d.length;h+=1)p();var m=function(e){s[e].forEach((function(r){var i=r.feature,o=n[t[e].source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o}))};for(var v in s)m(v);return s}(this._layers,this._serializedLayers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var r=this.sourceCaches[e];return r?function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),r=[],i={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(r,e))}return r}(r,n):[]},n.prototype.addSourceType=function(t,e,r){return n.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e,n){void 0===n&&(n={}),this._checkLoaded();var r=this.light.getLight(),i=!1;for(var o in e)if(!t.deepEqual(e[o],r[o])){i=!0;break}if(i){var a={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(a)}},n.prototype._validate=function(e,n,r,i,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&Fe(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.styleSpec},i)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var n in this.sourceCaches)this.sourceCaches[n].clearTiles(),this.sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,r,i,o){void 0===o&&(o=!1);for(var a=!1,s=!1,u={},c=0,l=this._order;c<l.length;c+=1){var f=this._layers[l[c]];if("symbol"===f.type){if(!u[f.source]){var p=this.sourceCaches[f.source];u[f.source]=p.getRenderableIds(!0).map((function(t){return p.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var h=this.crossTileSymbolIndex.addLayer(f,u[f.source],e.center.lng);a=a||h}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new Le(e,this._order,o,n,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(var d=0,m=this._order;d<m.length;d+=1){var v=this._layers[m[d]];"symbol"===v.type&&this.placement.updateLayerOpacities(v,u[v.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();var r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n.prototype.getResource=function(e,n,r){return t.makeRequest(n,r)},n}(t.Evented);Ge.getSourceType=function(t){return D[t]},Ge.setSourceType=function(t,e){D[t]=e},Ge.registerForPluginStateChange=t.registerForPluginStateChange;var qe=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ze=yn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),He=yn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),We=yn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Xe=yn("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ye=yn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ke=yn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Je=yn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qe=yn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),$e=yn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),tn=yn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),en=yn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),nn=yn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),rn=yn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),on=yn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),an=yn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),sn=yn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),un=yn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),cn=yn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ln=yn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),fn=yn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),pn=yn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),hn=yn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),dn=yn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),mn=yn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),vn=yn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),gn=yn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function yn(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),i=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(i):i,s={};return{fragmentSource:t=t.replace(n,(function(t,e,n,r,i){return s[i]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+i+"\nvarying "+n+" "+r+" "+i+";\n#else\nuniform "+n+" "+r+" u_"+i+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+i+"\n    "+n+" "+r+" "+i+" = u_"+i+";\n#endif\n"})),vertexSource:e=e.replace(n,(function(t,e,n,r,i){var o="float"===r?"vec2":"vec4",a=i.match(/color/)?"color":o;return s[i]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float u_"+i+"_t;\nattribute "+n+" "+o+" a_"+i+";\nvarying "+n+" "+r+" "+i+";\n#else\nuniform "+n+" "+r+" u_"+i+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = a_"+i+";\n#else\n    "+n+" "+r+" "+i+" = u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = unpack_mix_"+a+"(a_"+i+", u_"+i+"_t);\n#else\n    "+n+" "+r+" "+i+" = u_"+i+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float u_"+i+"_t;\nattribute "+n+" "+o+" a_"+i+";\n#else\nuniform "+n+" "+r+" u_"+i+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+n+" "+r+" "+i+" = a_"+i+";\n#else\n    "+n+" "+r+" "+i+" = u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+n+" "+r+" "+i+" = unpack_mix_"+a+"(a_"+i+", u_"+i+"_t);\n#else\n    "+n+" "+r+" "+i+" = u_"+i+";\n#endif\n"})),staticAttributes:r,staticUniforms:a}}var _n=Object.freeze({__proto__:null,prelude:Ze,background:He,backgroundPattern:We,circle:Xe,clippingMask:Ye,heatmap:Ke,heatmapTexture:Je,collisionBox:Qe,collisionCircle:$e,debug:tn,fill:en,fillOutline:nn,fillOutlinePattern:rn,fillPattern:on,fillExtrusion:an,fillExtrusionPattern:sn,hillshadePrepare:un,hillshade:cn,line:ln,lineGradient:fn,linePattern:pn,lineSDF:hn,raster:dn,symbolIcon:mn,symbolSDF:vn,symbolTextAndIcon:gn}),bn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function xn(t){for(var e=[],n=0;n<t.length;n++)if(null!==t[n]){var r=t[n].split(" ");e.push(r.pop())}return e}bn.prototype.bind=function(t,e,n,r,i,o,a,s){this.context=t;for(var u=this.boundPaintVertexBuffers.length!==r.length,c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!u&&this.boundIndexBuffer===i&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind()):this.freshBind(e,n,r,i,o,a,s)},bn.prototype.freshBind=function(t,e,n,r,i,o,a){var s,u=t.numAttributes,c=this.context,l=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var f=u;f<s;f++)l.disableVertexAttribArray(f)}e.enableAttributes(l,t);for(var p=0,h=n;p<h.length;p+=1)h[p].enableAttributes(l,t);o&&o.enableAttributes(l,t),a&&a.enableAttributes(l,t),e.bind(),e.setVertexAttribPointers(l,t,i);for(var d=0,m=n;d<m.length;d+=1){var v=m[d];v.bind(),v.setVertexAttribPointers(l,t,i)}o&&(o.bind(),o.setVertexAttribPointers(l,t,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(l,t,i)),c.currentNumAttributes=u},bn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var wn=function(t,e,n,r,i,o){var a=t.gl;this.program=a.createProgram();for(var s=xn(n.staticAttributes),u=r?r.getBinderAttributes():[],c=s.concat(u),l=n.staticUniforms?xn(n.staticUniforms):[],f=r?r.getBinderUniforms():[],p=[],h=0,d=l.concat(f);h<d.length;h+=1){var m=d[h];p.indexOf(m)<0&&p.push(m)}var v=r?r.defines():[];o&&v.push("#define OVERDRAW_INSPECTOR;");var g=v.concat(Ze.fragmentSource,n.fragmentSource).join("\n"),y=v.concat(Ze.vertexSource,n.vertexSource).join("\n"),_=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,g),a.compileShader(_),a.attachShader(this.program,_);var b=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(b,y),a.compileShader(b),a.attachShader(this.program,b),this.attributes={};var x={};this.numAttributes=c.length;for(var w=0;w<this.numAttributes;w++)c[w]&&(a.bindAttribLocation(this.program,w,c[w]),this.attributes[c[w]]=w);a.linkProgram(this.program),a.deleteShader(b),a.deleteShader(_);for(var S=0;S<p.length;S++){var E=p[S];if(E&&!x[E]){var T=a.getUniformLocation(this.program,E);T&&(x[E]=T)}}this.fixedUniforms=i(t,x),this.binderUniforms=r?r.getUniforms(t,x):[]}}};function Sn(t,e,n){var r=1/pe(n,1,e.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/i,a=o*(n.tileID.canonical.x+n.tileID.wrap*i),s=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}wn.prototype.draw=function(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m){var v,g=t.gl;if(!this.failedToCreate){for(var y in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[y].set(a[y]);h&&h.setUniforms(t,this.binderUniforms,f,{zoom:p});for(var _=(v={},v[g.LINES]=2,v[g.TRIANGLES]=3,v[g.LINE_STRIP]=1,v)[e],b=0,x=l.get();b<x.length;b+=1){var w=x[b],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new bn)).bind(t,this,u,h?h.getPaintVertexBuffers():[],c,w.vertexOffset,d,m),g.drawElements(e,w.primitiveLength*_,g.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var En=function(e,n,r,i){var o=n.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],u=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(u,-n.transform.angle),t.transformMat3(s,s,u);var c=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:i}},Tn=function(e,n,r,i,o,a,s){return t.extend(En(e,n,r,i),Sn(a,n,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8})},An=function(t){return{u_matrix:t}},Cn=function(e,n,r,i){return t.extend(An(e),Sn(r,n,i))},kn=function(t,e){return{u_matrix:t,u_world:e}},Pn=function(e,n,r,i,o){return t.extend(Cn(e,n,r,i),{u_world:o})},Mn=function(e,n,r,i){var o,a,s=e.transform;if("map"===i.paint.get("circle-pitch-alignment")){var u=pe(r,1,s.zoom);o=!0,a=[u,u]}else o=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(n.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:a}},In=function(t,e,n){var r=pe(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},On=function(t,e,n){return{u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},Ln=function(t,e,n){return void 0===n&&(n=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}},Rn=function(t){return{u_matrix:t}},Dn=function(t,e,n,r){return{u_matrix:t,u_extrude_scale:pe(e,1,n),u_intensity:r}},zn=function(e,n,r){var i=e.transform;return{u_matrix:Un(e,n,r),u_ratio:1/pe(n,1,i.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},jn=function(e,n,r){return t.extend(zn(e,n,r),{u_image:0})},Nn=function(e,n,r,i){var o=e.transform,a=Bn(n,o);return{u_matrix:Un(e,n,r),u_texsize:n.imageAtlasTexture.size,u_ratio:1/pe(n,1,o.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[a,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Fn=function(e,n,r,i,o){var a=e.lineAtlas,s=Bn(n,e.transform),u="round"===r.layout.get("line-cap"),c=a.getDash(i.from,u),l=a.getDash(i.to,u),f=c.width*o.fromScale,p=l.width*o.toScale;return t.extend(zn(e,n,r),{u_patternscale_a:[s/f,-c.height/2],u_patternscale_b:[s/p,-l.height/2],u_sdfgamma:a.width/(256*Math.min(f,p)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:l.y,u_mix:o.t})};function Bn(t,e){return 1/pe(t,1,e.tileZoom)}function Un(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Vn=function(t,e,n,r,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Gn(i.paint.get("raster-hue-rotate"))};var o,a};function Gn(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}var qn,Zn=function(t,e,n,r,i,o,a,s,u,c){var l=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:l.cameraToCenterDistance,u_pitch:l.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:l.width/l.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},Hn=function(e,n,r,i,o,a,s,u,c,l,f){var p=o.transform;return t.extend(Zn(e,n,r,i,o,a,s,u,c,l),{u_gamma_scale:i?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+f})},Wn=function(e,n,r,i,o,a,s,u,c,l){return t.extend(Hn(e,n,r,i,o,a,s,u,!0,c,!0),{u_texsize_icon:l,u_texture_icon:1})},Xn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Yn=function(e,n,r,i,o,a){return t.extend(function(t,e,n,r){var i=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),a=n.imageManager.getPixelSize(),s=a.width,u=a.height,c=Math.pow(2,r.tileID.overscaledZ),l=r.tileSize*Math.pow(2,n.transform.tileZoom)/c,f=l*(r.tileID.canonical.x+r.tileID.wrap*c),p=l*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,u],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/pe(r,1,n.transform.tileZoom),u_pixel_coord_upper:[f>>16,p>>16],u_pixel_coord_lower:[65535&f,65535&p]}}(i,a,r,o),{u_matrix:e,u_opacity:n})},Kn={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},collisionCircle:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}},debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_maxzoom:new t.Uniform1f(e,n.u_maxzoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},symbolTextAndIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Jn(e,n,r,i,o,a,s){for(var u=e.context,c=u.gl,l=e.useProgram("collisionBox"),f=[],p=0,h=0,d=0;d<i.length;d++){var m=i[d],v=n.getTile(m),g=v.getBucket(r);if(g){var y=m.posMatrix;0===o[0]&&0===o[1]||(y=e.translatePosMatrix(m.posMatrix,v,o,a));var _=s?g.textCollisionBox:g.iconCollisionBox,b=g.collisionCircleArray;if(b.length>0){var x=t.create(),w=y;t.mul(x,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(x,x,g.placementViewportMatrix),f.push({circleArray:b,circleOffset:h,transform:w,invTransform:x}),h=p+=b.length/4}_&&l.draw(u,c.LINES,Tt.disabled,At.disabled,e.colorModeForRenderPass(),kt.disabled,In(y,e.transform,v),r.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(s&&f.length){var S=e.useProgram("collisionCircle"),E=new t.StructArrayLayout2f1f2i16;E.resize(4*p),E._trim();for(var T=0,A=0,C=f;A<C.length;A+=1)for(var k=C[A],P=0;P<k.circleArray.length/4;P++){var M=4*P,I=k.circleArray[M+0],O=k.circleArray[M+1],L=k.circleArray[M+2],R=k.circleArray[M+3];E.emplace(T++,I,O,L,R,0),E.emplace(T++,I,O,L,R,1),E.emplace(T++,I,O,L,R,2),E.emplace(T++,I,O,L,R,3)}(!qn||qn.length<2*p)&&(qn=function(e){var n=2*e,r=new t.StructArrayLayout3ui6;r.resize(n),r._trim();for(var i=0;i<n;i++){var o=6*i;r.uint16[o+0]=4*i+0,r.uint16[o+1]=4*i+1,r.uint16[o+2]=4*i+2,r.uint16[o+3]=4*i+2,r.uint16[o+4]=4*i+3,r.uint16[o+5]=4*i+0}return r}(p));for(var D=u.createIndexBuffer(qn,!0),z=u.createVertexBuffer(E,t.collisionCircleLayout.members,!0),j=0,N=f;j<N.length;j+=1){var F=N[j],B=On(F.transform,F.invTransform,e.transform);S.draw(u,c.TRIANGLES,Tt.disabled,At.disabled,e.colorModeForRenderPass(),kt.disabled,B,r.id,z,D,t.SegmentVector.simpleSegment(0,2*F.circleOffset,F.circleArray.length,F.circleArray.length/2),null,e.transform.zoom,null,null,null)}z.destroy(),D.destroy()}}var Qn=t.identity(new Float32Array(16));function $n(e,n,r,i,o,a){var s=t.getAnchorAlignment(e),u=-(s.horizontalAlign-.5)*n,c=-(s.verticalAlign-.5)*r,l=t.evaluateVariableOffset(e,i);return new t.Point((u/o+l[0])*a,(c/o+l[1])*a)}function tr(e,n,r,i,o,a,s,u,c,l,f){var p=e.text.placedSymbolArray,h=e.text.dynamicLayoutVertexArray,d=e.icon.dynamicLayoutVertexArray,m={};h.clear();for(var v=0;v<p.length;v++){var g=p.get(v),y=g.hidden||!g.crossTileID||e.allowVerticalPlacement&&!g.placedOrientation?null:i[g.crossTileID];if(y){var _=new t.Point(g.anchorX,g.anchorY),b=$t(_,r?u:s),x=te(a.cameraToCenterDistance,b.signedDistanceFromCamera),w=o.evaluateSizeForFeature(e.textSizeData,l,g)*x/t.ONE_EM;r&&(w*=e.tilePixelRatio/c);for(var S=$n(y.anchor,y.width,y.height,y.textOffset,y.textBoxScale,w),E=r?$t(_.add(S),s).point:b.point.add(n?S.rotate(-a.angle):S),T=e.allowVerticalPlacement&&g.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,A=0;A<g.numGlyphs;A++)t.addDynamicAttributes(h,E,T);f&&g.associatedIconIndex>=0&&(m[g.associatedIconIndex]={shiftedAnchor:E,angle:T})}else ce(g.numGlyphs,h)}if(f){d.clear();for(var C=e.icon.placedSymbolArray,k=0;k<C.length;k++){var P=C.get(k);if(P.hidden)ce(P.numGlyphs,d);else{var M=m[k];if(M)for(var I=0;I<P.numGlyphs;I++)t.addDynamicAttributes(d,M.shiftedAnchor,M.angle);else ce(P.numGlyphs,d)}}e.icon.dynamicLayoutVertexBuffer.updateData(d)}e.text.dynamicLayoutVertexBuffer.updateData(h)}function er(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function nr(e,n,r,i,o,a,s,u,c,l,f,p){for(var h=e.context,d=h.gl,m=e.transform,v="map"===u,g="map"===c,y=v&&"point"!==r.layout.get("symbol-placement"),_=v&&!g&&!y,b=void 0!==r.layout.get("symbol-sort-key").constantOr(1),x=e.depthModeForSublayer(0,Tt.ReadOnly),w=r.layout.get("text-variable-anchor"),S=[],E=0,T=i;E<T.length;E+=1){var A=T[E],C=n.getTile(A),k=C.getBucket(r);if(k){var P=o?k.text:k.icon;if(P&&P.segments.get().length){var M=P.programConfigurations.get(r.id),I=o||k.sdfIcons,O=o?k.textSizeData:k.iconSizeData,L=g||0!==m.pitch,R=e.useProgram(er(I,o,k),M),D=t.evaluateSizeForZoom(O,m.zoom),z=void 0,j=[0,0],N=void 0,F=void 0,B=null,U=void 0;if(o)N=C.glyphAtlasTexture,F=d.LINEAR,z=C.glyphAtlasTexture.size,k.iconsInText&&(j=C.imageAtlasTexture.size,B=C.imageAtlasTexture,U=L||e.options.rotating||e.options.zooming||"composite"===O.kind||"camera"===O.kind?d.LINEAR:d.NEAREST);else{var V=1!==r.layout.get("icon-size").constantOr(0)||k.iconsNeedLinear;N=C.imageAtlasTexture,F=I||e.options.rotating||e.options.zooming||V||L?d.LINEAR:d.NEAREST,z=C.imageAtlasTexture.size}var G=pe(C,1,e.transform.zoom),q=Jt(A.posMatrix,g,v,e.transform,G),Z=Qt(A.posMatrix,g,v,e.transform,G),H=w&&k.hasTextData(),W="none"!==r.layout.get("icon-text-fit")&&H&&k.hasIconData();y&&ne(k,A.posMatrix,e,o,q,Z,g,l);var X=e.translatePosMatrix(A.posMatrix,C,a,s),Y=y||o&&w||W?Qn:q,K=e.translatePosMatrix(Z,C,a,s,!0),J=I&&0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),Q={program:R,buffers:P,uniformValues:I?k.iconsInText?Wn(O.kind,D,_,g,e,X,Y,K,z,j):Hn(O.kind,D,_,g,e,X,Y,K,o,z,!0):Zn(O.kind,D,_,g,e,X,Y,K,o,z),atlasTexture:N,atlasTextureIcon:B,atlasInterpolation:F,atlasInterpolationIcon:U,isSDF:I,hasHalo:J};if(b)for(var $=0,tt=P.segments.get();$<tt.length;$+=1){var et=tt[$];S.push({segments:new t.SegmentVector([et]),sortKey:et.sortKey,state:Q})}else S.push({segments:P.segments,sortKey:0,state:Q})}}}b&&S.sort((function(t,e){return t.sortKey-e.sortKey}));for(var nt=0,rt=S;nt<rt.length;nt+=1){var it=rt[nt],ot=it.state;if(h.activeTexture.set(d.TEXTURE0),ot.atlasTexture.bind(ot.atlasInterpolation,d.CLAMP_TO_EDGE),ot.atlasTextureIcon&&(h.activeTexture.set(d.TEXTURE1),ot.atlasTextureIcon&&ot.atlasTextureIcon.bind(ot.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),ot.isSDF){var at=ot.uniformValues;ot.hasHalo&&(at.u_is_halo=1,rr(ot.buffers,it.segments,r,e,ot.program,x,f,p,at)),at.u_is_halo=0}rr(ot.buffers,it.segments,r,e,ot.program,x,f,p,ot.uniformValues)}}function rr(t,e,n,r,i,o,a,s,u){var c=r.context;i.draw(c,c.gl.TRIANGLES,o,a,s,kt.disabled,u,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function ir(t,e,n,r,i,o,a){var s,u,c,l,f,p=t.context.gl,h=n.paint.get("fill-pattern"),d=h&&h.constantOr(1),m=n.getCrossfadeParameters();a?(u=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=p.LINES):(u=d?"fillPattern":"fill",s=p.TRIANGLES);for(var v=0,g=r;v<g.length;v+=1){var y=g[v],_=e.getTile(y);if(!d||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=t.useProgram(u,x);d&&(t.context.activeTexture.set(p.TEXTURE0),_.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),x.updatePaintBuffers(m));var S=h.constantOr(null);if(S&&_.imageAtlas){var E=_.imageAtlas,T=E.patternPositions[S.to.toString()],A=E.patternPositions[S.from.toString()];T&&A&&x.setConstantPatternPositions(T,A)}var C=t.translatePosMatrix(y.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){l=b.indexBuffer2,f=b.segments2;var k=[p.drawingBufferWidth,p.drawingBufferHeight];c="fillOutlinePattern"===u&&d?Pn(C,t,m,_,k):kn(C,k)}else l=b.indexBuffer,f=b.segments,c=d?Cn(C,t,m,_):An(C);w.draw(t.context,s,i,t.stencilModeForClipping(y),o,kt.disabled,c,n.id,b.layoutVertexBuffer,l,f,n.paint,t.transform.zoom,x)}}}}function or(t,e,n,r,i,o,a){for(var s=t.context,u=s.gl,c=n.paint.get("fill-extrusion-pattern"),l=c.constantOr(1),f=n.getCrossfadeParameters(),p=n.paint.get("fill-extrusion-opacity"),h=0,d=r;h<d.length;h+=1){var m=d[h],v=e.getTile(m),g=v.getBucket(n);if(g){var y=g.programConfigurations.get(n.id),_=t.useProgram(l?"fillExtrusionPattern":"fillExtrusion",y);l&&(t.context.activeTexture.set(u.TEXTURE0),v.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),y.updatePaintBuffers(f));var b=c.constantOr(null);if(b&&v.imageAtlas){var x=v.imageAtlas,w=x.patternPositions[b.to.toString()],S=x.patternPositions[b.from.toString()];w&&S&&y.setConstantPatternPositions(w,S)}var E=t.translatePosMatrix(m.posMatrix,v,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),T=n.paint.get("fill-extrusion-vertical-gradient"),A=l?Tn(E,t,T,p,m,f,v):En(E,t,T,p);_.draw(s,s.gl.TRIANGLES,i,o,a,kt.backCCW,A,n.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,n.paint,t.transform.zoom,y)}}}function ar(e,n,r,i,o,a){var s=e.context,u=s.gl,c=n.fbo;if(c){var l=e.useProgram("hillshade");s.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());var f=function(e,n,r){var i=r.paint.get("hillshade-shadow-color"),o=r.paint.get("hillshade-highlight-color"),a=r.paint.get("hillshade-accent-color"),s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var u,c,l,f=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),f),u_image:0,u_latrange:(u=n.tileID,c=Math.pow(2,u.canonical.z),l=u.canonical.y,[new t.MercatorCoordinate(0,l/c).toLngLat().lat,new t.MercatorCoordinate(0,(l+1)/c).toLngLat().lat]),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}}(e,n,r);l.draw(s,u.TRIANGLES,i,o,a,kt.disabled,f,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function sr(e,n,r,i,o,a,s){var u=e.context,c=u.gl,l=n.dem;if(l&&l.data){var f=l.dim,p=l.stride,h=l.getPixels();if(u.activeTexture.set(c.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(p),n.demTexture){var d=n.demTexture;d.update(h,{premultiply:!1}),d.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(u,h,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);u.activeTexture.set(c.TEXTURE0);var m=n.fbo;if(!m){var v=new t.Texture(u,{width:f,height:f,data:null},c.RGBA);v.bind(c.LINEAR,c.CLAMP_TO_EDGE),(m=n.fbo=u.createFramebuffer(f,f,!0)).colorAttachment.set(v.texture)}u.bindFramebuffer.set(m.framebuffer),u.viewport.set([0,0,f,f]),e.useProgram("hillshadePrepare").draw(u,c.TRIANGLES,o,a,s,kt.disabled,function(e,n,r){var i=n.stride,o=t.create();return t.ortho(o,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(o,o,[0,-t.EXTENT,0]),{u_matrix:o,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_maxzoom:r,u_unpack:n.getUnpackVector()}}(n.tileID,l,i),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function ur(e,n,r,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),u=(s-e.timeAdded)/a,c=n?(s-n.timeAdded)/a:-1,l=r.getSource(),f=o.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-f)>Math.abs(e.tileID.overscaledZ-f),h=p&&e.refreshedUponExpiration?1:t.clamp(p?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}var cr=new t.Color(1,0,0,1),lr=new t.Color(0,1,0,1),fr=new t.Color(0,0,1,1),pr=new t.Color(1,0,1,1),hr=new t.Color(0,1,1,1);function dr(t,e,n,r){vr(t,0,e+n/2,t.transform.width,n,r)}function mr(t,e,n,r){vr(t,e-n/2,0,n,t.transform.height,r)}function vr(e,n,r,i,o,a){var s=e.context,u=s.gl;u.enable(u.SCISSOR_TEST),u.scissor(n*t.browser.devicePixelRatio,r*t.browser.devicePixelRatio,i*t.browser.devicePixelRatio,o*t.browser.devicePixelRatio),s.clear({color:a}),u.disable(u.SCISSOR_TEST)}function gr(e,n,r){var i=e.context,o=i.gl,a=r.posMatrix,s=e.useProgram("debug"),u=Tt.disabled,c=At.disabled,l=e.colorModeForRenderPass();i.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.draw(i,o.LINE_STRIP,u,c,l,kt.disabled,Ln(a,t.Color.red),"$debug",e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var f=n.getTileByID(r.key).latestRawTileData,p=Math.floor((f&&f.byteLength||0)/1024),h=n.getTile(r).tileSize,d=512/Math.min(h,512)*(r.overscaledZ/e.transform.zoom)*.5,m=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(m+=" => "+r.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var n=t.debugOverlayCanvas,r=t.context.gl,i=t.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(e,5,5),i.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,m+" "+p+"kb"),s.draw(i,o.TRIANGLES,u,c,Ct.alphaBlended,kt.disabled,Ln(a,t.Color.transparent,d),"$debug",e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}var yr={symbol:function(e,n,r,i,o){if("translucent"===e.renderPass){var a=At.disabled,s=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,i,o,a,s){for(var u=n.transform,c="map"===o,l="map"===a,f=0,p=e;f<p.length;f+=1){var h=p[f],d=i.getTile(h),m=d.getBucket(r);if(m&&m.text&&m.text.segments.get().length){var v=t.evaluateSizeForZoom(m.textSizeData,u.zoom),g=pe(d,1,n.transform.zoom),y=Jt(h.posMatrix,l,c,n.transform,g),_="none"!==r.layout.get("icon-text-fit")&&m.hasIconData();if(v){var b=Math.pow(2,u.zoom-d.tileID.overscaledZ);tr(m,c,l,s,t.symbolSize,u,y,h.posMatrix,b,v,_)}}}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o),0!==r.paint.get("icon-opacity").constantOr(1)&&nr(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,s),0!==r.paint.get("text-opacity").constantOr(1)&&nr(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,s),n.map.showCollisionBoxes&&(Jn(e,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Jn(e,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),u=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var c=e.context,l=c.gl,f=e.depthModeForSublayer(0,Tt.ReadOnly),p=At.disabled,h=e.colorModeForRenderPass(),d=[],m=0;m<i.length;m++){var v=i[m],g=n.getTile(v),y=g.getBucket(r);if(y){var _=y.programConfigurations.get(r.id),b={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:y.layoutVertexBuffer,indexBuffer:y.indexBuffer,uniformValues:Mn(e,v,g,r)};if(u)for(var x=0,w=y.segments.get();x<w.length;x+=1){var S=w[x];d.push({segments:new t.SegmentVector([S]),sortKey:S.sortKey,state:b})}else d.push({segments:y.segments,sortKey:0,state:b})}}u&&d.sort((function(t,e){return t.sortKey-e.sortKey}));for(var E=0,T=d;E<T.length;E+=1){var A=T[E],C=A.state;C.program.draw(c,l.TRIANGLES,f,p,h,kt.disabled,C.uniformValues,r.id,C.layoutVertexBuffer,C.indexBuffer,A.segments,r.paint,e.transform.zoom,C.programConfiguration)}}}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=At.disabled,u=new Ct([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,r){var i=t.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e.width/4,e.height/4,0,i.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(t,e,o,i)}}(o,e,r),o.clear({color:t.Color.transparent});for(var c=0;c<i.length;c++){var l=i[c];if(!n.hasRenderableParent(l)){var f=n.getTile(l),p=f.getBucket(r);if(p){var h=p.programConfigurations.get(r.id);e.useProgram("heatmap",h).draw(o,a.TRIANGLES,Tt.disabled,s,u,kt.disabled,Dn(l.posMatrix,f,e.transform.zoom,r.paint.get("heatmap-intensity")),r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,h)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var r=e.context,i=r.gl,o=n.heatmapFbo;if(o){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.Texture(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Tt.disabled,At.disabled,e.colorModeForRenderPass(),kt.disabled,function(e,n,r,i){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}}(e,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,r))},line:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=e.depthModeForSublayer(0,Tt.ReadOnly),u=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),l=r.paint.get("line-pattern"),f=l.constantOr(1),p=r.paint.get("line-gradient"),h=r.getCrossfadeParameters(),d=f?"linePattern":c?"lineSDF":p?"lineGradient":"line",m=e.context,v=m.gl,g=!0;if(p){m.activeTexture.set(v.TEXTURE0);var y=r.gradientTexture;if(!r.gradient)return;y||(y=r.gradientTexture=new t.Texture(m,r.gradient,v.RGBA)),y.bind(v.LINEAR,v.CLAMP_TO_EDGE)}for(var _=0,b=i;_<b.length;_+=1){var x=b[_],w=n.getTile(x);if(!f||w.patternsLoaded()){var S=w.getBucket(r);if(S){var E=S.programConfigurations.get(r.id),T=e.context.program.get(),A=e.useProgram(d,E),C=g||A.program!==T,k=l.constantOr(null);if(k&&w.imageAtlas){var P=w.imageAtlas,M=P.patternPositions[k.to.toString()],I=P.patternPositions[k.from.toString()];M&&I&&E.setConstantPatternPositions(M,I)}var O=f?Nn(e,w,r,h):c?Fn(e,w,r,c,h):p?jn(e,w,r):zn(e,w,r);f?(m.activeTexture.set(v.TEXTURE0),w.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),E.updatePaintBuffers(h)):c&&(C||e.lineAtlas.dirty)&&(m.activeTexture.set(v.TEXTURE0),e.lineAtlas.bind(m)),A.draw(m,v.TRIANGLES,s,e.stencilModeForClipping(x),u,kt.disabled,O,r.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,r.paint,e.transform.zoom,E),g=!1}}}}}},fill:function(e,n,r,i){var o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),u=r.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){var l=e.depthModeForSublayer(1,"opaque"===e.renderPass?Tt.ReadWrite:Tt.ReadOnly);ir(e,n,r,i,l,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){var f=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Tt.ReadOnly);ir(e,n,r,i,f,s,!0)}}},"fill-extrusion":function(t,e,n,r){var i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===t.renderPass){var o=new Tt(t.context.gl.LEQUAL,Tt.ReadWrite,t.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))or(t,e,n,r,o,At.disabled,Ct.disabled),or(t,e,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();or(t,e,n,r,o,At.disabled,a)}}},hillshade:function(t,e,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var i=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,Tt.ReadOnly),s=t.colorModeForRenderPass(),u="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r],c=u[0],l=0,f=u[1];l<f.length;l+=1){var p=f[l],h=e.getTile(p);h.needsHillshadePrepare&&"offscreen"===t.renderPass?sr(t,h,n,o,a,At.disabled,s):"translucent"===t.renderPass&&ar(t,h,n,a,c[p.overscaledZ],s)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,r){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&r.length)for(var i=t.context,o=i.gl,a=e.getSource(),s=t.useProgram("raster"),u=t.colorModeForRenderPass(),c=a instanceof O?[{},r]:t.stencilConfigForOverlap(r),l=c[0],f=c[1],p=f[f.length-1].overscaledZ,h=!t.options.moving,d=0,m=f;d<m.length;d+=1){var v=m[d],g=t.depthModeForSublayer(v.overscaledZ-p,1===n.paint.get("raster-opacity")?Tt.ReadWrite:Tt.ReadOnly,o.LESS),y=e.getTile(v),_=t.transform.calculatePosMatrix(v.toUnwrapped(),h);y.registerFadeDuration(n.paint.get("raster-fade-duration"));var b=e.findLoadedParent(v,0),x=ur(y,b,e,n,t.transform),w=void 0,S=void 0,E="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),y.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),b?(b.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-y.tileID.overscaledZ),S=[y.tileID.canonical.x*w%1,y.tileID.canonical.y*w%1]):y.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var T=Vn(_,S||[0,0],w||1,x,n);a instanceof O?s.draw(i,o.TRIANGLES,g,At.disabled,u,kt.disabled,T,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):s.draw(i,o.TRIANGLES,g,l[v.overscaledZ],u,kt.disabled,T,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var r=n.paint.get("background-color"),i=n.paint.get("background-opacity");if(0!==i){var o=t.context,a=o.gl,s=t.transform,u=s.tileSize,c=n.paint.get("background-pattern");if(!t.isPatternMissing(c)){var l=!c&&1===r.a&&1===i&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===l){var f=At.disabled,p=t.depthModeForSublayer(0,"opaque"===l?Tt.ReadWrite:Tt.ReadOnly),h=t.colorModeForRenderPass(),d=t.useProgram(c?"backgroundPattern":"background"),m=s.coveringTiles({tileSize:u});c&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var v=n.getCrossfadeParameters(),g=0,y=m;g<y.length;g+=1){var _=y[g],b=t.transform.calculatePosMatrix(_.toUnwrapped()),x=c?Yn(b,i,t,c,{tileID:_,tileSize:u},v):Xn(b,i,r);d.draw(o,a.TRIANGLES,p,f,h,kt.disabled,x,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var r=0;r<n.length;r++)gr(t,e,n[r])},custom:function(t,e,n){var r=t.context,i=n.implementation;if("offscreen"===t.renderPass){var o=i.prerender;o&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),o.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(At.disabled);var a="3d"===i.renderingMode?new Tt(t.context.gl.LEQUAL,Tt.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Tt.ReadOnly);r.setDepthMode(a),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},_r=function(t,e){this.context=new Pt(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=Mt.maxUnderzooming+Mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ne,this.gpuTimers={}};_r.prototype.resize=function(e,n){if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var r=0,i=this.style._order;r<i.length;r+=1)this.style._layers[i[r]].resize()},_r.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,qe.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,qe.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,I.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,qe.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var u=this.context.gl;this.stencilClearMode=new At({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)},_r.prototype.clearStencil=function(){var e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Tt.disabled,this.stencilClearMode,Ct.disabled,kt.disabled,Rn(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},_r.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var n=this.context,r=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(Ct.disabled),n.setDepthMode(Tt.disabled);var i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var s=a[o],u=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;i.draw(n,r.TRIANGLES,Tt.disabled,new At({func:r.ALWAYS,mask:0},u,255,r.KEEP,r.KEEP,r.REPLACE),Ct.disabled,kt.disabled,Rn(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},_r.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new At({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},_r.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new At({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},_r.prototype.stencilConfigForOverlap=function(t){var e,n=this.context.gl,r=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),i=r[r.length-1].overscaledZ,o=r[0].overscaledZ-i+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+i]=new At({func:n.GEQUAL,mask:255},s+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[a,r]}return[(e={},e[i]=At.disabled,e),r]},_r.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new Ct([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ct.unblended:Ct.alphaBlended},_r.prototype.depthModeForSublayer=function(t,e,n){if(!this.opaquePassEnabledForLayer())return Tt.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Tt(n||this.context.gl.LEQUAL,e,[r,r])},_r.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},_r.prototype.render=function(e,n){var r=this;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var i=this.style._order,o=this.style.sourceCaches;for(var a in o){var s=o[a];s.used&&s.prepare(this.context)}var u,c,l={},f={},p={};for(var h in o){var d=o[h];l[h]=d.getVisibleCoordinates(),f[h]=l[h].slice().reverse(),p[h]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<i.length;m++)if(this.style._layers[i[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var v=0,g=i;v<g.length;v+=1){var y=this.style._layers[g[v]];if(y.hasOffscreenPass()&&!y.isHidden(this.transform.zoom)){var _=f[y.source];("custom"===y.type||_.length)&&this.renderLayer(this,o[y.source],y,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var b=this.style._layers[i[this.currentLayer]],x=o[b.source],w=l[b.source];this._renderTileClippingMasks(b,w),this.renderLayer(this,x,b,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var S=this.style._layers[i[this.currentLayer]],E=o[S.source],T=("symbol"===S.type?p:f)[S.source];this._renderTileClippingMasks(S,l[S.source]),this.renderLayer(this,E,S,T)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(r.transform.zoom)&&(t.source!==(c&&c.id)&&(c=r.style.sourceCaches[t.source]),(!u||u.getSource().maxzoom<c.getSource().maxzoom)&&(u=c))})),u&&yr.debug(this,u,u.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;dr(t,t.transform.height-(e.top||0),3,cr),dr(t,e.bottom||0,3,lr),mr(t,e.left||0,3,fr),mr(t,t.transform.width-(e.right||0),3,pr);var n=t.transform.centerPoint;!function(t,e,n,r){vr(t,e-1,n-10,2,20,r),vr(t,e-10,n-1,20,2,r)}(t,n.x,t.transform.height-n.y,hr)}(this),this.context.setDefault()},_r.prototype.renderLayer=function(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||r.length)&&(this.id=n.id,this.gpuTimingStart(n),yr[n.type](t,e,n,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},_r.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}},_r.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},_r.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},_r.prototype.queryGpuTimers=function(t){var e={};for(var n in t){var r=t[n],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),e[n]=o}return e},_r.prototype.translatePosMatrix=function(e,n,r,i,o){if(!r[0]&&!r[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),u=Math.cos(a);r=[r[0]*u-r[1]*s,r[0]*s+r[1]*u]}var c=[o?r[0]:pe(n,r[0],this.transform.zoom),o?r[1]:pe(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,c),l},_r.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},_r.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},_r.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n},_r.prototype.useProgram=function(t,e){this.cache=this.cache||{};var n=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new wn(this.context,t,_n[t],e,Kn[t],this._showOverdrawInspector)),this.cache[n]},_r.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},_r.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},_r.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},_r.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var br=function(t,e){this.points=t,this.planes=e};br.fromInvProjectionMatrix=function(e,n,r){var i=Math.pow(2,r),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(n){return t.transformMat4([],n,e)})).map((function(e){return t.scale$1([],e,1/e[3]/n*i)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var n=t.sub([],o[e[0]],o[e[1]]),r=t.sub([],o[e[2]],o[e[1]]),i=t.normalize([],t.cross([],n,r)),a=-t.dot(i,o[e[1]]);return i.concat(a)}));return new br(o,a)};var xr=function(e,n){this.min=e,this.max=n,this.center=t.scale$2([],t.add([],this.min,this.max),.5)};xr.prototype.quadrant=function(e){for(var n=[e%2==0,e<2],r=t.clone$2(this.min),i=t.clone$2(this.max),o=0;o<n.length;o++)r[o]=n[o]?this.min[o]:this.center[o],i[o]=n[o]?this.center[o]:this.max[o];return i[2]=this.max[2],new xr(r,i)},xr.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},xr.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},xr.prototype.intersects=function(e){for(var n=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],r=!0,i=0;i<e.planes.length;i++){for(var o=e.planes[i],a=0,s=0;s<n.length;s++)a+=t.dot$1(o,n[s])>=0;if(0===a)return 0;a!==n.length&&(r=!1)}if(r)return 2;for(var u=0;u<3;u++){for(var c=Number.MAX_VALUE,l=-Number.MAX_VALUE,f=0;f<e.points.length;f++){var p=e.points[f][u]-this.min[u];c=Math.min(c,p),l=Math.max(l,p)}if(l<0||c>this.max[u]-this.min[u])return 0}return 1};var wr=function(t,e,n,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=r};wr.prototype.interpolate=function(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,r)),this},wr.prototype.getCenter=function(e,n){var r=t.clamp((this.left+e-this.right)/2,0,e),i=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.Point(r,i)},wr.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},wr.prototype.clone=function(){return new wr(this.top,this.bottom,this.left,this.right)},wr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Sr=function(e,n,r,i,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wr,this._posMatrixCache={},this._alignedPosMatrixCache={}},Er={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Sr.prototype.clone=function(){var t=new Sr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},Er.minZoom.get=function(){return this._minZoom},Er.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Er.maxZoom.get=function(){return this._maxZoom},Er.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Er.minPitch.get=function(){return this._minPitch},Er.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},Er.maxPitch.get=function(){return this._maxPitch},Er.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},Er.renderWorldCopies.get=function(){return this._renderWorldCopies},Er.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Er.worldSize.get=function(){return this.tileSize*this.scale},Er.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Er.size.get=function(){return new t.Point(this.width,this.height)},Er.bearing.get=function(){return-this.angle/Math.PI*180},Er.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Er.pitch.get=function(){return this._pitch/Math.PI*180},Er.pitch.set=function(e){var n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},Er.fov.get=function(){return this._fov/Math.PI*180},Er.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Er.zoom.get=function(){return this._zoom},Er.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Er.center.get=function(){return this._center},Er.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Er.padding.get=function(){return this._edgeInsets.toJSON()},Er.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},Er.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Sr.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},Sr.prototype.interpolatePadding=function(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()},Sr.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},Sr.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.Point(0,0)),i=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),u=Math.floor(Math.max(r.x,i.x,o.x,a.x)),c=s-1;c<=u+1;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e));return n},Sr.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),r=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var i=t.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,n),a=[o*i.x,o*i.y,0],s=br.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),u=e.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(u=n);var c=function(t){return{aabb:new xr([t*o,0,0],[(t+1)*o,o,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}},l=[],f=[],p=n,h=e.reparseOverscaled?r:n;if(this._renderWorldCopies)for(var d=1;d<=3;d++)l.push(c(-d)),l.push(c(d));for(l.push(c(0));l.length>0;){var m=l.pop(),v=m.x,g=m.y,y=m.fullyVisible;if(!y){var _=m.aabb.intersects(s);if(0===_)continue;y=2===_}var b=m.aabb.distanceX(a),x=m.aabb.distanceY(a),w=Math.max(Math.abs(b),Math.abs(x));if(m.zoom===p||w>3+(1<<p-m.zoom)-2&&m.zoom>=u)f.push({tileID:new t.OverscaledTileID(m.zoom===p?h:m.zoom,m.wrap,m.zoom,v,g),distanceSq:t.sqrLen([a[0]-.5-v,a[1]-.5-g])});else for(var S=0;S<4;S++){var E=(v<<1)+S%2,T=(g<<1)+(S>>1);l.push({aabb:m.aabb.quadrant(S),zoom:m.zoom+1,x:E,y:T,wrap:m.wrap,fullyVisible:y})}}return f.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))},Sr.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Er.unmodified.get=function(){return this._unmodified},Sr.prototype.zoomScale=function(t){return Math.pow(2,t)},Sr.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Sr.prototype.project=function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)},Sr.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},Er.point.get=function(){return this.project(this.center)},Sr.prototype.setLocationAtPoint=function(e,n){var r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},Sr.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Sr.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Sr.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},Sr.prototype.coordinateLocation=function(t){return t.toLngLat()},Sr.prototype.pointCoordinate=function(e){var n=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse);var i=n[3],o=r[3],a=n[1]/i,s=r[1]/o,u=n[2]/i,c=r[2]/o,l=u===c?0:(0-u)/(c-u);return new t.MercatorCoordinate(t.number(n[0]/i,r[0]/o,l)/this.worldSize,t.number(a,s,l)/this.worldSize)},Sr.prototype.coordinatePoint=function(e){var n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},Sr.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Sr.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Sr.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Sr.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,u=t.identity(new Float64Array(16));return t.translate(u,u,[s*a,o.y*a,0]),t.scale(u,u,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(u,n?this.alignedProjMatrix:this.projMatrix,u),i[r]=new Float32Array(u),i[r]},Sr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Sr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,r,i,o=-90,a=90,s=-180,u=180,c=this.size,l=this._unmodified;if(this.latRange){var f=this.latRange;o=t.mercatorYfromLat(f[1])*this.worldSize,e=(a=t.mercatorYfromLat(f[0])*this.worldSize)-o<c.y?c.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=t.mercatorXfromLng(p[0])*this.worldSize,n=(u=t.mercatorXfromLng(p[1])*this.worldSize)-s<c.x?c.x/(u-s):0}var h=this.point,d=Math.max(n||0,e||0);if(d)return this.center=this.unproject(new t.Point(n?(u+s)/2:h.x,e?(a+o)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=l,void(this._constraining=!1);if(this.latRange){var m=h.y,v=c.y/2;m-v<o&&(i=o+v),m+v>a&&(i=a-v)}if(this.lngRange){var g=h.x,y=c.x/2;g-y<s&&(r=s+y),g+y>u&&(r=u-y)}void 0===r&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==r?r:h.x,void 0!==i?i:h.y))),this._unmodified=l,this._constraining=!1}},Sr.prototype._calcMatrices=function(){if(this.height){var e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var n=Math.PI/2+this._pitch,r=this._fov*(.5+e.y/this.height),i=Math.sin(r)*this.cameraToCenterDistance/Math.sin(t.clamp(Math.PI-n-r,.01,Math.PI-.01)),o=this.point,a=o.x,s=o.y,u=1.01*(Math.cos(Math.PI/2-this._pitch)*i+this.cameraToCenterDistance),c=this.height/50,l=new Float64Array(16);t.perspective(l,this._fov,this.width/this.height,c,u),l[8]=2*-e.x/this.width,l[9]=2*e.y/this.height,t.scale(l,l,[1,-1,1]),t.translate(l,l,[0,0,-this.cameraToCenterDistance]),t.rotateX(l,l,this._pitch),t.rotateZ(l,l,this.angle),t.translate(l,l,[-a,-s,0]),this.mercatorMatrix=t.scale([],l,[this.worldSize,this.worldSize,this.worldSize]),t.scale(l,l,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=l,this.invProjMatrix=t.invert([],this.projMatrix);var f=this.width%2/2,p=this.height%2/2,h=Math.cos(this.angle),d=Math.sin(this.angle),m=a-Math.round(a)+h*f+d*p,v=s-Math.round(s)+h*p+d*f,g=new Float64Array(l);if(t.translate(g,g,[m>.5?m-1:m,v>.5?v-1:v,0]),this.alignedProjMatrix=g,l=t.create(),t.scale(l,l,[this.width/2,-this.height/2,1]),t.translate(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=t.create(),t.scale(l,l,[1,-1,1]),t.translate(l,l,[-1,-1,0]),t.scale(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(l=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Sr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Sr.prototype.getCameraPoint=function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))},Sr.prototype.getCameraQueryGeometry=function(e){var n=this.getCameraPoint();if(1===e.length)return[e[0],n];for(var r=n.x,i=n.y,o=n.x,a=n.y,s=0,u=e;s<u.length;s+=1){var c=u[s];r=Math.min(r,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}return[new t.Point(r,i),new t.Point(o,i),new t.Point(o,a),new t.Point(r,a),new t.Point(r,i)]},Object.defineProperties(Sr.prototype,Er);var Tr=function(e){var n,r,i,o;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),r=!1,i=null,o=function(){i=null,r&&(n(),i=setTimeout(o,300),r=!1)},function(){return r=!0,i||o(),i})};Tr.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Tr.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Tr.prototype.getHashString=function(e){var n=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),a=Math.round(n.lng*o)/o,s=Math.round(n.lat*o)/o,u=this._map.getBearing(),c=this._map.getPitch(),l="";if(l+=e?"/"+a+"/"+s+"/"+r:r+"/"+s+"/"+a,(u||c)&&(l+="/"+Math.round(10*u)/10),c&&(l+="/"+Math.round(c)),this._hashName){var f=this._hashName,p=!1,h=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===f?(p=!0,e+"="+l):t})).filter((function(t){return t}));return p||h.push(f+"="+l),"#"+h.join("&")}return"#"+l},Tr.prototype._getCurrentHash=function(){var e,n=this,r=t.window.location.hash.replace("#","");return this._hashName?(r.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===n._hashName&&(e=t)})),(e&&e[1]||"").split("/")):r.split("/")},Tr.prototype._onHashChange=function(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},Tr.prototype._updateHashUnthrottled=function(){var e=this.getHashString();try{t.window.history.replaceState(t.window.history.state,"",e)}catch(t){}};var Ar={linearity:.3,easing:t.bezier(0,0,.3,1)},Cr=t.extend({deceleration:2500,maxSpeed:1400},Ar),kr=t.extend({deceleration:20,maxSpeed:1400},Ar),Pr=t.extend({deceleration:1e3,maxSpeed:360},Ar),Mr=t.extend({deceleration:1e3,maxSpeed:90},Ar),Ir=function(t){this._map=t,this.clear()};function Or(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Lr(e,n,r){var i=r.maxSpeed,o=r.linearity,a=r.deceleration,s=t.clamp(e*o/(n/1e3),-i,i),u=Math.abs(s)/(a*o);return{easing:r.easing,duration:1e3*u,amount:s*(u/2)}}Ir.prototype.clear=function(){this._inertiaBuffer=[]},Ir.prototype.record=function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.browser.now(),settings:e})},Ir.prototype._drainInertiaBuffer=function(){for(var e=this._inertiaBuffer,n=t.browser.now();e.length>0&&n-e[0].time>160;)e.shift()},Ir.prototype._onMoveEnd=function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0},r=0,i=this._inertiaBuffer;r<i.length;r+=1){var o=i[r].settings;n.zoom+=o.zoomDelta||0,n.bearing+=o.bearingDelta||0,n.pitch+=o.pitchDelta||0,o.panDelta&&n.pan._add(o.panDelta),o.around&&(n.around=o.around),o.pinchAround&&(n.pinchAround=o.pinchAround)}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(n.pan.mag()){var u=Lr(n.pan.mag(),a,t.extend({},Cr,e||{}));s.offset=n.pan.mult(u.amount/n.pan.mag()),s.center=this._map.transform.center,Or(s,u)}if(n.zoom){var c=Lr(n.zoom,a,kr);s.zoom=this._map.transform.zoom+c.amount,Or(s,c)}if(n.bearing){var l=Lr(n.bearing,a,Pr);s.bearing=this._map.transform.bearing+t.clamp(l.amount,-179,179),Or(s,l)}if(n.pitch){var f=Lr(n.pitch,a,Mr);s.pitch=this._map.transform.pitch+f.amount,Or(s,f)}if(s.zoom||s.bearing){var p=void 0===n.pinchAround?n.around:n.pinchAround;s.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),t.extend(s,{noMoveStart:!0})}};var Rr=function(e){function r(r,i,o,a){void 0===a&&(a={});var s=n.mousePos(i.getCanvasContainer(),o),u=i.unproject(s);e.call(this,r,t.extend({point:s,lngLat:u,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),Dr=function(e){function r(r,i,o){var a="touchend"===r?o.changedTouches:o.touches,s=n.touchPos(i.getCanvasContainer(),a),u=s.map((function(t){return i.unproject(t)})),c=s.reduce((function(t,e,n,r){return t.add(e.div(r.length))}),new t.Point(0,0)),l=i.unproject(c);e.call(this,r,{points:s,point:c,lngLats:u,lngLat:l,originalEvent:o}),this._defaultPrevented=!1}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),zr=function(t){function e(e,n,r){t.call(this,e,{originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),jr=function(t,e){this._map=t,this._clickTolerance=e.clickTolerance};jr.prototype.reset=function(){delete this._mousedownPos},jr.prototype.wheel=function(t){return this._firePreventable(new zr(t.type,this._map,t))},jr.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new Rr(t.type,this._map,t))},jr.prototype.mouseup=function(t){this._map.fire(new Rr(t.type,this._map,t))},jr.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Rr(t.type,this._map,t))},jr.prototype.dblclick=function(t){return this._firePreventable(new Rr(t.type,this._map,t))},jr.prototype.mouseover=function(t){this._map.fire(new Rr(t.type,this._map,t))},jr.prototype.mouseout=function(t){this._map.fire(new Rr(t.type,this._map,t))},jr.prototype.touchstart=function(t){return this._firePreventable(new Dr(t.type,this._map,t))},jr.prototype.touchmove=function(t){this._map.fire(new Dr(t.type,this._map,t))},jr.prototype.touchend=function(t){this._map.fire(new Dr(t.type,this._map,t))},jr.prototype.touchcancel=function(t){this._map.fire(new Dr(t.type,this._map,t))},jr.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},jr.prototype.isEnabled=function(){return!0},jr.prototype.isActive=function(){return!1},jr.prototype.enable=function(){},jr.prototype.disable=function(){};var Nr=function(t){this._map=t};Nr.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Nr.prototype.mousemove=function(t){this._map.fire(new Rr(t.type,this._map,t))},Nr.prototype.mousedown=function(){this._delayContextMenu=!0},Nr.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Rr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Nr.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Rr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},Nr.prototype.isEnabled=function(){return!0},Nr.prototype.isActive=function(){return!1},Nr.prototype.enable=function(){},Nr.prototype.disable=function(){};var Fr=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1};function Br(t,e){for(var n={},r=0;r<t.length;r++)n[t[r].identifier]=e[r];return n}Fr.prototype.isEnabled=function(){return!!this._enabled},Fr.prototype.isActive=function(){return!!this._active},Fr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Fr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Fr.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(n.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},Fr.prototype.mousemoveWindow=function(t,e){if(this._active){var r=e;if(!(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)){var i=this._startPos;this._lastPos=r,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var o=Math.min(i.x,r.x),a=Math.max(i.x,r.x),s=Math.min(i.y,r.y),u=Math.max(i.y,r.y);n.setTransform(this._box,"translate("+o+"px,"+s+"px)"),this._box.style.width=a-o+"px",this._box.style.height=u-s+"px"}}},Fr.prototype.mouseupWindow=function(e,r){var i=this;if(this._active&&0===e.button){var o=this._startPos,a=r;if(this.reset(),n.suppressClick(),o.x!==a.x||o.y!==a.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(o,a,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}},Fr.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},Fr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},Fr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var Ur=function(t){this.reset(),this.numTouches=t.numTouches};Ur.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ur.prototype.touchstart=function(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){for(var n=new t.Point(0,0),r=0,i=e;r<i.length;r+=1)n._add(i[r]);return n.div(e.length)}(n),this.touches=Br(r,n)))},Ur.prototype.touchmove=function(t,e,n){if(!this.aborted&&this.centroid){var r=Br(n,e);for(var i in this.touches){var o=r[i];(!o||o.dist(this.touches[i])>30)&&(this.aborted=!0)}}},Ur.prototype.touchend=function(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){var r=!this.aborted&&this.centroid;if(this.reset(),r)return r}};var Vr=function(t){this.singleTap=new Ur(t),this.numTaps=t.numTaps,this.reset()};Vr.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Vr.prototype.touchstart=function(t,e,n){this.singleTap.touchstart(t,e,n)},Vr.prototype.touchmove=function(t,e,n){this.singleTap.touchmove(t,e,n)},Vr.prototype.touchend=function(t,e,n){var r=this.singleTap.touchend(t,e,n);if(r){var i=t.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(r)<30;if(i&&o||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}};var Gr=function(){this._zoomIn=new Vr({numTouches:1,numTaps:2}),this._zoomOut=new Vr({numTouches:2,numTaps:1}),this.reset()};Gr.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Gr.prototype.touchstart=function(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)},Gr.prototype.touchmove=function(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)},Gr.prototype.touchend=function(t,e,n){var r=this,i=this._zoomIn.touchend(t,e,n),o=this._zoomOut.touchend(t,e,n);return i?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}}):o?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}}):void 0},Gr.prototype.touchcancel=function(){this.reset()},Gr.prototype.enable=function(){this._enabled=!0},Gr.prototype.disable=function(){this._enabled=!1,this.reset()},Gr.prototype.isEnabled=function(){return this._enabled},Gr.prototype.isActive=function(){return this._active};var qr={0:1,2:2},Zr=function(t){this.reset(),this._clickTolerance=t.clickTolerance||1};Zr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Zr.prototype._correctButton=function(t,e){return!1},Zr.prototype._move=function(t,e){return{}},Zr.prototype.mousedown=function(t,e){if(!this._lastPoint){var r=n.mouseButton(t);this._correctButton(t,r)&&(this._lastPoint=e,this._eventButton=r)}},Zr.prototype.mousemoveWindow=function(t,e){var n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){var n=qr[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)},Zr.prototype.mouseupWindow=function(t){this._lastPoint&&n.mouseButton(t)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},Zr.prototype.enable=function(){this._enabled=!0},Zr.prototype.disable=function(){this._enabled=!1,this.reset()},Zr.prototype.isEnabled=function(){return this._enabled},Zr.prototype.isActive=function(){return this._active};var Hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.mousedown=function(e,n){t.prototype.mousedown.call(this,e,n),this._lastPoint&&(this._active=!0)},e.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},e.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},e}(Zr),Wr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Zr),Xr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Zr),Yr=function(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()};Yr.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)},Yr.prototype.touchstart=function(t,e,n){return this._calculateTransform(t,e,n)},Yr.prototype.touchmove=function(t,e,n){if(this._active)return t.preventDefault(),this._calculateTransform(t,e,n)},Yr.prototype.touchend=function(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()},Yr.prototype.touchcancel=function(){this.reset()},Yr.prototype._calculateTransform=function(e,n,r){r.length>0&&(this._active=!0);var i=Br(r,n),o=new t.Point(0,0),a=new t.Point(0,0),s=0;for(var u in i){var c=i[u],l=this._touches[u];l&&(o._add(c),a._add(c.sub(l)),s++,i[u]=c)}if(this._touches=i,!(s<this._minTouches)&&a.mag()){var f=a.div(s);if(this._sum._add(f),!(this._sum.mag()<this._clickTolerance))return{around:o.div(s),panDelta:f}}},Yr.prototype.enable=function(){this._enabled=!0},Yr.prototype.disable=function(){this._enabled=!1,this.reset()},Yr.prototype.isEnabled=function(){return this._enabled},Yr.prototype.isActive=function(){return this._active};var Kr=function(){this.reset()};function Jr(t,e,n){for(var r=0;r<t.length;r++)if(t[r].identifier===n)return e[r]}function Qr(t,e){return Math.log(t/e)/Math.LN2}Kr.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Kr.prototype._start=function(t){},Kr.prototype._move=function(t,e,n){return{}},Kr.prototype.touchstart=function(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))},Kr.prototype.touchmove=function(t,e,n){if(this._firstTwoTouches){t.preventDefault();var r=this._firstTwoTouches,i=r[1],o=Jr(n,e,r[0]),a=Jr(n,e,i);if(o&&a){var s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,t)}}},Kr.prototype.touchend=function(t,e,r){if(this._firstTwoTouches){var i=this._firstTwoTouches,o=i[1],a=Jr(r,e,i[0]),s=Jr(r,e,o);a&&s||(this._active&&n.suppressClick(),this.reset())}},Kr.prototype.touchcancel=function(){this.reset()},Kr.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},Kr.prototype.disable=function(){this._enabled=!1,this.reset()},Kr.prototype.isEnabled=function(){return this._enabled},Kr.prototype.isActive=function(){return this._active};var $r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._distance,delete this._startDistance},e.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Qr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qr(this._distance,n),pinchAround:e}},e}(Kr);function ti(t,e){return 180*t.angleWith(e)/Math.PI}var ei=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},e.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ti(this._vector,n),pinchAround:e}},e.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,n=ti(t,this._startVector);return Math.abs(n)<e},e}(Kr);function ni(t){return Math.abs(t.y)>Math.abs(t.x)}var ri=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},e.prototype._start=function(t){this._lastPoints=t,ni(t[0].sub(t[1]))&&(this._valid=!1)},e.prototype._move=function(t,e,n){var r=t[0].sub(this._lastPoints[0]),i=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+i.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(t,e,n){if(void 0!==this._valid)return this._valid;var r=t.mag()>=2,i=e.mag()>=2;if(r||i){if(!r||!i)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;var o=t.y>0==e.y>0;return ni(t)&&ni(e)&&o}},e}(Kr),ii={panStep:100,bearingStep:15,pitchStep:10},oi=function(){var t=ii;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep};function ai(t){return t*(2-t)}oi.prototype.reset=function(){this._active=!1},oi.prototype.keydown=function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var n=0,r=0,i=0,o=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),a=1);break;default:return}return{cameraAnimation:function(s){var u=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:ai,zoom:n?Math.round(u)+n*(t.shiftKey?2:1):u,bearing:s.getBearing()+r*e._bearingStep,pitch:s.getPitch()+i*e._pitchStep,offset:[-o*e._panStep,-a*e._panStep],center:s.getCenter()},{originalEvent:t})}}}},oi.prototype.enable=function(){this._enabled=!0},oi.prototype.disable=function(){this._enabled=!1,this.reset()},oi.prototype.isEnabled=function(){return this._enabled},oi.prototype.isActive=function(){return this._active};var si=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};si.prototype.setZoomRate=function(t){this._defaultZoomRate=t},si.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},si.prototype.isEnabled=function(){return!!this._enabled},si.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},si.prototype.isZooming=function(){return!!this._zooming},si.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},si.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},si.prototype.wheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}},si.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},si.prototype._start=function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var r=n.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},si.prototype.renderFrame=function(){return this._onScrollFrame()},si.prototype._onScrollFrame=function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,s="number"==typeof this._targetZoom?this._targetZoom:n.zoom,u=this._startZoom,c=this._easing,l=!1;if("wheel"===this._type&&u&&c){var f=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),p=c(f);a=t.number(u,s,p),f<1?this._frameId||(this._frameId=!0):l=!0}else a=s,l=!0;return this._active=!0,l&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!l,zoomDelta:a-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},si.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var r=this._prevEase,i=(t.browser.now()-r.start)/r.duration,o=r.easing(i+.01)-r.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n},si.prototype.reset=function(){this._active=!1};var ui=function(t,e){this._clickZoom=t,this._tapZoom=e};ui.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ui.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ui.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ui.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ci=function(){this.reset()};ci.prototype.reset=function(){this._active=!1},ci.prototype.dblclick=function(t,e){return t.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}},ci.prototype.enable=function(){this._enabled=!0},ci.prototype.disable=function(){this._enabled=!1,this.reset()},ci.prototype.isEnabled=function(){return this._enabled},ci.prototype.isActive=function(){return this._active};var li=function(){this._tap=new Vr({numTouches:1,numTaps:1}),this.reset()};li.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},li.prototype.touchstart=function(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))},li.prototype.touchmove=function(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var r=e[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(t,e,n)},li.prototype.touchend=function(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)},li.prototype.touchcancel=function(){this.reset()},li.prototype.enable=function(){this._enabled=!0},li.prototype.disable=function(){this._enabled=!1,this.reset()},li.prototype.isEnabled=function(){return this._enabled},li.prototype.isActive=function(){return this._active};var fi=function(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n};fi.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},fi.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},fi.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},fi.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var pi=function(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n};pi.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},pi.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},pi.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},pi.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var hi=function(t,e,n,r){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0};hi.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},hi.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},hi.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},hi.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},hi.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},hi.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var di=function(t){return t.zoom||t.drag||t.pitch||t.rotate},mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(t.Event);function vi(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}var gi=function(e,r){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ir(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r),t.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[t.window,"blur",void 0]];for(var o=0,a=this._listeners;o<a.length;o+=1){var s=a[o],u=s[0];n.addEventListener(u,s[1],u===t.window.document?this.handleWindowEvent:this.handleEvent,s[2])}};gi.prototype.destroy=function(){for(var e=0,r=this._listeners;e<r.length;e+=1){var i=r[e],o=i[0];n.removeEventListener(o,i[1],o===t.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},gi.prototype._addDefaultHandlers=function(t){var e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new jr(e,t));var r=e.boxZoom=new Fr(e,t);this._add("boxZoom",r);var i=new Gr,o=new ci;e.doubleClickZoom=new ui(o,i),this._add("tapZoom",i),this._add("clickZoom",o);var a=new li;this._add("tapDragZoom",a);var s=e.touchPitch=new ri;this._add("touchPitch",s);var u=new Wr(t),c=new Xr(t);e.dragRotate=new pi(t,u,c),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);var l=new Hr(t),f=new Yr(t);e.dragPan=new fi(n,l,f),this._add("mousePan",l),this._add("touchPan",f,["touchZoom","touchRotate"]);var p=new ei,h=new $r;e.touchZoomRotate=new hi(n,h,p,a),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",h,["touchPan","touchRotate"]);var d=e.scrollZoom=new si(e,this);this._add("scrollZoom",d,["mousePan"]);var m=e.keyboard=new oi;this._add("keyboard",m),this._add("blockableMapEvent",new Nr(e));for(var v=0,g=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];v<g.length;v+=1){var y=g[v];t.interactive&&t[y]&&e[y].enable(t[y])}},gi.prototype._add=function(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e},gi.prototype.stop=function(){if(!this._updatingCamera){for(var t=0,e=this._handlers;t<e.length;t+=1)e[t].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},gi.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},gi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},gi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},gi.prototype.isMoving=function(){return Boolean(di(this._eventsInProgress))||this.isZooming()},gi.prototype._blockedByActive=function(t,e,n){for(var r in t)if(r!==n&&(!e||e.indexOf(r)<0))return!0;return!1},gi.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},gi.prototype._getMapTouches=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=r[n];this._el.contains(i.target)&&e.push(i)}return e},gi.prototype.handleEvent=function(t,e){if("blur"!==t.type){this._updatingCamera=!0;for(var r="renderFrame"===t.type?void 0:t,i={needsRenderFrame:!1},o={},a={},s=t.touches?this._getMapTouches(t.touches):void 0,u=s?n.touchPos(this._el,s):n.mousePos(this._el,t),c=0,l=this._handlers;c<l.length;c+=1){var f=l[c],p=f.handlerName,h=f.handler,d=f.allowed;if(h.isEnabled()){var m=void 0;this._blockedByActive(a,d,p)?h.reset():h[e||t.type]&&(m=h[e||t.type](t,u,s),this.mergeHandlerResult(i,o,m,p,r),m&&m.needsRenderFrame&&this._triggerRenderFrame()),(m||h.isActive())&&(a[p]=h)}}var v={};for(var g in this._previousActiveHandlers)a[g]||(v[g]=r);this._previousActiveHandlers=a,(Object.keys(v).length||vi(i))&&(this._changes.push([i,o,v]),this._triggerRenderFrame()),(Object.keys(a).length||vi(i))&&this._map._stop(!0),this._updatingCamera=!1;var y=i.cameraAnimation;y&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],y(this._map))}else this.stop()},gi.prototype.mergeHandlerResult=function(e,n,r,i,o){if(r){t.extend(e,r);var a={handlerName:i,originalEvent:r.originalEvent||o};void 0!==r.zoomDelta&&(n.zoom=a),void 0!==r.panDelta&&(n.drag=a),void 0!==r.pitchDelta&&(n.pitch=a),void 0!==r.bearingDelta&&(n.rotate=a)}},gi.prototype._applyChanges=function(){for(var e={},n={},r={},i=0,o=this._changes;i<o.length;i+=1){var a=o[i],s=a[0],u=a[1],c=a[2];s.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(e.around=s.around),void 0!==s.pinchAround&&(e.pinchAround=s.pinchAround),s.noInertia&&(e.noInertia=s.noInertia),t.extend(n,u),t.extend(r,c)}this._updateMapTransform(e,n,r),this._changes=[]},gi.prototype._updateMapTransform=function(t,e,n){var r=this._map,i=r.transform;if(!vi(t))return this._fireEvents(e,n);var o=t.panDelta,a=t.zoomDelta,s=t.bearingDelta,u=t.pitchDelta,c=t.around,l=t.pinchAround;void 0!==l&&(c=l),r._stop(!0),c=c||r.transform.centerPoint;var f=i.pointLocation(o?c.sub(o):c);s&&(i.bearing+=s),u&&(i.pitch+=u),a&&(i.zoom+=a),i.setLocationAtPoint(f,c),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,n)},gi.prototype._fireEvents=function(e,n){var r=this,i=di(this._eventsInProgress),o=di(e),a={};for(var s in e)this._eventsInProgress[s]||(a[s+"start"]=e[s].originalEvent),this._eventsInProgress[s]=e[s];for(var u in!i&&o&&this._fireEvent("movestart",o.originalEvent),a)this._fireEvent(u,a[u]);for(var c in e.rotate&&(this._bearingChanged=!0),o&&this._fireEvent("move",o.originalEvent),e)this._fireEvent(c,e[c].originalEvent);var l,f={};for(var p in this._eventsInProgress){var h=this._eventsInProgress[p],d=h.handlerName,m=h.originalEvent;this._handlersById[d].isActive()||(delete this._eventsInProgress[p],f[p+"end"]=l=n[d]||m)}for(var v in f)this._fireEvent(v,f[v]);var g=di(this._eventsInProgress);if((i||o)&&!g){this._updatingCamera=!0;var y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=function(t){return 0!==t&&-r._bearingSnap<t&&t<r._bearingSnap};y?(_(y.bearing||this._map.getBearing())&&(y.bearing=0),this._map.easeTo(y,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),_(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},gi.prototype._fireEvent=function(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},gi.prototype._requestFrame=function(){var t=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(e){delete t._frameId,t.handleEvent(new mi("renderFrame",{timeStamp:e})),t._applyChanges()}))},gi.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var yi=function(e){function n(n,r){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)},n.prototype.panTo=function(e,n,r){return this.easeTo(t.extend({center:e},n),r)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.getPadding=function(){return this.transform.padding},n.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},n.prototype.rotateTo=function(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.resetNorthPitch=function(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){return e=t.LngLatBounds.convert(e),this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),0,n)},n.prototype._cameraForBoxAndBearing=function(e,n,r,i){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var a=i.padding;i.padding={top:a,bottom:a,right:a,left:a}}i.padding=t.extend(o,i.padding);var s=this.transform,u=s.padding,c=s.project(t.LngLat.convert(e)),l=s.project(t.LngLat.convert(n)),f=c.rotate(-r*Math.PI/180),p=l.rotate(-r*Math.PI/180),h=new t.Point(Math.max(f.x,p.x),Math.max(f.y,p.y)),d=new t.Point(Math.min(f.x,p.x),Math.min(f.y,p.y)),m=h.sub(d),v=(s.width-(u.left+u.right+i.padding.left+i.padding.right))/m.x,g=(s.height-(u.top+u.bottom+i.padding.top+i.padding.bottom))/m.y;if(!(g<0||v<0)){var y=Math.min(s.scaleZoom(s.scale*Math.min(v,g)),i.maxZoom),_=t.Point.convert(i.offset),b=new t.Point(_.x+(i.padding.left-i.padding.right)/2,_.y+(i.padding.top-i.padding.bottom)/2).mult(s.scale/s.zoomScale(y));return{center:s.unproject(c.add(l).div(2).sub(b)),zoom:y,bearing:r}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),r,i),i,o)},n.prototype._fitInternal=function(e,n,r){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this},n.prototype.jumpTo=function(e,n){this.stop();var r=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(a=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var r=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u=this.getPadding(),c="zoom"in e?+e.zoom:o,l="bearing"in e?this._normalizeBearing(e.bearing,a):a,f="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:i.padding,h=t.Point.convert(e.offset),d=i.centerPoint.add(h),m=i.pointLocation(d),v=t.LngLat.convert(e.center||m);this._normalizeCenter(v);var g,y,_=i.project(m),b=i.project(v).sub(_),x=i.zoomScale(c-o);e.around&&(g=t.LngLat.convert(e.around),y=i.locationPoint(g));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||c!==o,this._rotating=this._rotating||a!==l,this._pitching=this._pitching||f!==s,this._padding=!i.isPaddingEqual(p),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,w),clearTimeout(this._easeEndTimeoutID),this._ease((function(e){if(r._zooming&&(i.zoom=t.number(o,c,e)),r._rotating&&(i.bearing=t.number(a,l,e)),r._pitching&&(i.pitch=t.number(s,f,e)),r._padding&&(i.interpolatePadding(u,p,e),d=i.centerPoint.add(h)),g)i.setLocationAtPoint(g,y);else{var m=i.zoomScale(i.zoom-o),v=c>o?Math.min(2,x):Math.max(.5,x),w=Math.pow(v,1-e),S=i.unproject(_.add(b.mult(e*w)).mult(m));i.setLocationAtPoint(i.renderWorldCopies?S.wrap():S,d)}r._fireMoveEvents(n)}),(function(t){r._afterEase(n,t)}),e),this},n.prototype._prepareEase=function(e,n,r){void 0===r&&(r={}),this._moving=!0,n||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e,n){if(!this._easeId||!n||this._easeId!==n){delete this._easeId;var r=this._zooming,i=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}},n.prototype.flyTo=function(e,n){var r=this;if(!e.essential&&t.browser.prefersReducedMotion){var i=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var o=this.transform,a=this.getZoom(),s=this.getBearing(),u=this.getPitch(),c=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):a,f="bearing"in e?this._normalizeBearing(e.bearing,s):s,p="pitch"in e?+e.pitch:u,h="padding"in e?e.padding:o.padding,d=o.zoomScale(l-a),m=t.Point.convert(e.offset),v=o.centerPoint.add(m),g=o.pointLocation(v),y=t.LngLat.convert(e.center||g);this._normalizeCenter(y);var _=o.project(g),b=o.project(y).sub(_),x=e.curve,w=Math.max(o.width,o.height),S=w/d,E=b.mag();if("minZoom"in e){var T=t.clamp(Math.min(e.minZoom,a,l),o.minZoom,o.maxZoom),A=w/o.zoomScale(T-a);x=Math.sqrt(A/E*2)}var C=x*x;function k(t){var e=(S*S-w*w+(t?-1:1)*C*C*E*E)/(2*(t?S:w)*C*E);return Math.log(Math.sqrt(e*e+1)-e)}function P(t){return(Math.exp(t)-Math.exp(-t))/2}function M(t){return(Math.exp(t)+Math.exp(-t))/2}var I=k(0),O=function(t){return M(I)/M(I+x*t)},L=function(t){return w*((M(I)*(P(e=I+x*t)/M(e))-P(I))/C)/E;var e},R=(k(1)-I)/x;if(Math.abs(E)<1e-6||!isFinite(R)){if(Math.abs(w-S)<1e-6)return this.easeTo(e,n);var D=S<w?-1:1;R=Math.abs(Math.log(S/w))/x,L=function(){return 0},O=function(t){return Math.exp(D*x*t)}}return e.duration="duration"in e?+e.duration:1e3*R/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==f,this._pitching=p!==u,this._padding=!o.isPaddingEqual(h),this._prepareEase(n,!1),this._ease((function(e){var i=e*R,d=1/O(i);o.zoom=1===e?l:a+o.scaleZoom(d),r._rotating&&(o.bearing=t.number(s,f,e)),r._pitching&&(o.pitch=t.number(u,p,e)),r._padding&&(o.interpolatePadding(c,h,e),v=o.centerPoint.add(m));var g=1===e?y:o.unproject(_.add(b.mult(L(i))).mult(d));o.setLocationAtPoint(o.renderWorldCopies?g.wrap():g,v),r._fireMoveEvents(n)}),(function(){return r._afterEase(n)}),e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){return this._stop()},n.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var n=this._onEaseEnd;delete this._onEaseEnd,n.call(this,e)}if(!t){var r=this.handlers;r&&r.stop()}return this},n.prototype._ease=function(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),_i=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};_i.prototype.getDefaultPosition=function(){return"bottom-right"},_i.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_i.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_i.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var r=n.reduce((function(t,e,r){return e.value&&(t+=e.key+"="+e.value+(r<n.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow"}},_i.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},_i.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r];if(i.used){var o=i.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t.sort((function(t,e){return t.length-e.length}));var a=(t=t.filter((function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,t.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},_i.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var bi=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};bi.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},bi.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},bi.prototype.getDefaultPosition=function(){return"bottom-left"},bi.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},bi.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},bi.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var xi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xi.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},xi.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,r=e?this._queue.concat(e):this._queue;n<r.length;n+=1){var i=r[n];if(i.id===t)return void(i.cancelled=!0)}},xi.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,r=e;n<r.length;n+=1){var i=r[n];if(!i.cancelled&&(i.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var wi={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Si=t.window.HTMLImageElement,Ei=t.window.HTMLElement,Ti=t.window.ImageBitmap,Ai={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ci=function(r){function i(e){var n=this;if(null!=(e=t.extend({},Ai,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var i=new Sr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(r.call(this,i,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new xi,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},wi,e.locale),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof Ei))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return n._update(!1)})),this.on("moveend",(function(){return n._update(!1)})),this.on("zoom",(function(){return n._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new gi(this,e),this._hash=e.hash&&new Tr("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new _i({customAttribution:e.customAttribution})),this.addControl(new bi,e.logoPosition),this.on("style.load",(function(){n.transform.unmodified&&n.jumpTo(n.style.stylesheet)})),this.on("data",(function(e){n._update("style"===e.dataType),n.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){n.fire(new t.Event(e.dataType+"dataloading",e))}))}r&&(i.__proto__=r),(i.prototype=Object.create(r&&r.prototype)).constructor=i;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(e,n){if(void 0===n&&e.getDefaultPosition&&(n=e.getDefaultPosition()),void 0===n&&(n="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},i.prototype.resize=function(e){var n=this._containerDimensions(),r=n[0],i=n[1];this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i);var o=!this._moving;return o&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},i.prototype.setMinZoom=function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(t){if((t=null==t?60:t)>60)throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},i.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},i.prototype._createDelegatedListener=function(t,e,n){var r,i=this;if("mouseenter"===t||"mouseover"===t){var o=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){var a=i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[];a.length?o||(o=!0,n.call(i,new Rr(t,i,r.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){(i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,n.call(i,new Rr(t,i,r.originalEvent)))},mouseout:function(e){a&&(a=!1,n.call(i,new Rr(t,i,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(r={},r[t]=function(t){var r=i.getLayer(e)?i.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(i,t),delete t.features)},r)}},i.prototype.on=function(t,e,n){if(void 0===n)return r.prototype.on.call(this,t,e);var i=this._createDelegatedListener(t,e,n);for(var o in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i),i.delegates)this.on(o,i.delegates[o]);return this},i.prototype.once=function(t,e,n){if(void 0===n)return r.prototype.once.call(this,t,e);var i=this._createDelegatedListener(t,e,n);for(var o in i.delegates)this.once(o,i.delegates[o]);return this},i.prototype.off=function(t,e,n){var i=this;return void 0===n?r.prototype.off.call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(r){for(var o=r[t],a=0;a<o.length;a++){var s=o[a];if(s.layer===e&&s.listener===n){for(var u in s.delegates)i.off(u,s.delegates[u]);return o.splice(a,1),i}}}(this._delegatedListeners),this)},i.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var r;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])r=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),o=t.Point.convert(e[1]);r=[i,new t.Point(o.x,i.y),o,new t.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))},i.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},i.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new Ge(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},i.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ge(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},i.prototype._diffStyle=function(e,n){var r=this;if("string"==typeof e){var i=this._requestManager.normalizeStyleURL(e),o=this._requestManager.transformRequest(i,t.ResourceType.Style);t.getJSON(o,(function(e,i){e?r.fire(new t.ErrorEvent(e)):i&&r._updateDiff(i,n)}))}else"object"==typeof e&&this._updateDiff(e,n)},i.prototype._updateDiff=function(e,n){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce("Unable to perform style diff: "+(r.message||r.error||r)+".  Rebuilding the style from scratch."),this._updateStyle(e,n)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,n,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var o=r.sdf;void 0===o&&(o=!1);var a=r.stretchX,s=r.stretchY,u=r.content;if(this._lazyInitEmptyStyle(),n instanceof Si||Ti&&n instanceof Ti){var c=t.browser.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:c.width,height:c.height},c.data),pixelRatio:i,stretchX:a,stretchY:s,content:u,sdf:o,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var l=n;this.style.addImage(e,{data:new t.RGBAImage({width:n.width,height:n.height},new Uint8Array(n.data)),pixelRatio:i,stretchX:a,stretchY:s,content:u,sdf:o,version:0,userImage:l}),l.onAdd&&l.onAdd(this,e)}},i.prototype.updateImage=function(e,n){var r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=n instanceof Si||Ti&&n instanceof Ti?t.browser.getImageData(n):n,o=i.width,a=i.height,s=i.data;return void 0===o||void 0===a?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==r.data.width||a!==r.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(r.data.replace(s,!(n instanceof Si||Ti&&n instanceof Ti)),void this.style.updateImage(e,r))},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},i.prototype.setFilter=function(t,e,n){return void 0===n&&(n={}),this.style.setFilter(t,e,n),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,n,r){return void 0===r&&(r={}),this.style.setPaintProperty(t,e,n,r),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,n,r){return void 0===r&&(r={}),this.style.setLayoutProperty(t,e,n,r),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=n.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){o[t]=n.create("div","mapboxgl-ctrl-"+t,i)}))},i.prototype._resizeCanvas=function(e,n){var r=t.browser.devicePixelRatio||1;this._canvas.width=r*e,this._canvas.height=r*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(this.painter=new _r(r,this.transform),t.webpSupported.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(e){var n,r=this,i=0,o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,n),i=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,u=t.browser.now();this.style.zoomHistory.update(s,u);var c=new t.EvaluationParameters(s,{now:u,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),l=c.crossFadingFactor();1===l&&l===this._crossFadingFactor||(a=!0,this._crossFadingFactor=l),this.style.update(c)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var f=t.browser.now()-i;o.endQueryEXT(o.TIME_ELAPSED_EXT,n),setTimeout((function(){var e=o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(n),r.fire(new t.Event("gpu-timing-frame",{cpuTime:f,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout((function(){var e=r.painter.queryGpuTimers(p);r.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}var h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0),this}},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),ki(this._canvasContainer),ki(this._controlContainer),ki(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new t.Event("remove"))},i.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(t){e._frame=null,e._render(t)})))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},i.prototype._setCacheLimits=function(e,n){t.setCacheLimits(e,n)},o.version.get=function(){return t.version},Object.defineProperties(i.prototype,o),i}(yi);function ki(t){t.parentNode&&t.parentNode.removeChild(t)}var Pi={showCompass:!0,showZoom:!0,visualizePitch:!1},Mi=function(e){var r=this;this.options=t.extend({},Pi,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return r._map.zoomIn({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return r._map.zoomOut({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){r.options.visualizePitch?r._map.resetNorthPitch({},{originalEvent:t}):r._map.resetNorth({},{originalEvent:t})})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Mi.prototype._updateZoomButtons=function(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom(),this._zoomOutButton.disabled=t===this._map.getMinZoom()},Mi.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},Mi.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ii(this._map,this._compass,this.options.visualizePitch)),this._container},Mi.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Mi.prototype._createButton=function(t,e){var r=n.create("button",t,this._container);return r.type="button",r.addEventListener("click",e),r},Mi.prototype._setButtonTitle=function(t,e){var n=this._map._getUIString("NavigationControl."+e);t.title=n,t.setAttribute("aria-label",n)};var Ii=function(e,r,i){void 0===i&&(i=!1),this._clickTolerance=10,this.element=r,this.mouseRotate=new Wr({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new Xr({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(r,"mousedown",this.mousedown),n.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(r,"touchmove",this.touchmove),n.addEventListener(r,"touchend",this.touchend),n.addEventListener(r,"touchcancel",this.reset)};function Oi(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){var i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<a?e=i:r.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-r.center.lng)>180;){var s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}Ii.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),n.disableDrag()},Ii.prototype.move=function(t,e){var n=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&n.setBearing(n.getBearing()+r.bearingDelta),this.mousePitch){var i=this.mousePitch.mousemoveWindow(t,e);i&&i.pitchDelta&&n.setPitch(n.getPitch()+i.pitchDelta)}},Ii.prototype.off=function(){var t=this.element;n.removeEventListener(t,"mousedown",this.mousedown),n.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(t,"touchmove",this.touchmove),n.removeEventListener(t,"touchend",this.touchend),n.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},Ii.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(t.window,"mousemove",this.mousemove),n.removeEventListener(t.window,"mouseup",this.mouseup)},Ii.prototype.mousedown=function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),n.mousePos(this.element,e)),n.addEventListener(t.window,"mousemove",this.mousemove),n.addEventListener(t.window,"mouseup",this.mouseup)},Ii.prototype.mousemove=function(t){this.move(t,n.mousePos(this.element,t))},Ii.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},Ii.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},Ii.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},Ii.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ii.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Li={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ri(t,e,n){var r=t.classList;for(var i in Li)r.remove("mapboxgl-"+n+"-anchor-"+i);r.add("mapboxgl-"+n+"-anchor-"+e)}var Di,zi=function(e){function r(r,i){var o=this;if(e.call(this),(r instanceof t.window.HTMLElement||i)&&(r=t.extend({element:r},i)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&"auto"!==r.pitchAlignment?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=t.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var a=n.createNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height","41px"),a.setAttributeNS(null,"width","27px"),a.setAttributeNS(null,"viewBox","0 0 27 41");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");var u=n.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill-rule","nonzero");var c=n.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"transform","translate(3.0, 29.0)"),c.setAttributeNS(null,"fill","#000000");for(var l=0,f=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<f.length;l+=1){var p=f[l],h=n.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",p.rx),h.setAttributeNS(null,"ry",p.ry),c.appendChild(h)}var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var m=n.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(m);var v=n.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"opacity","0.25"),v.setAttributeNS(null,"fill","#000000");var g=n.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),v.appendChild(g);var y=n.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),y.setAttributeNS(null,"fill","#FFFFFF");var _=n.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(8.0, 8.0)");var b=n.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#000000"),b.setAttributeNS(null,"opacity","0.25"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962");var x=n.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962"),_.appendChild(b),_.appendChild(x),u.appendChild(c),u.appendChild(d),u.appendChild(v),u.appendChild(y),u.appendChild(_),a.appendChild(u),a.setAttributeNS(null,"height",41*this._scale+"px"),a.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(a),this._offset=t.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),this._element.addEventListener("focus",(function(){var t=o._map.getContainer();t.scrollTop=0,t.scrollLeft=0})),Ri(this._element,this._anchor,"marker"),this._popup=null}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},r.prototype._onKeyPress=function(t){var e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},r.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},r.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Oi(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,Li[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+r+" "+e)}},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},r.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},r.prototype.getRotation=function(){return this._rotation},r.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},r.prototype.getRotationAlignment=function(){return this._rotationAlignment},r.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},r.prototype.getPitchAlignment=function(){return this._pitchAlignment},r}(t.Evented),ji={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ni=0,Fi=!1,Bi=function(e){function r(n){e.call(this),this.options=t.extend({},ji,n),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Di?r(Di):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){r(Di="denied"!==t.state)})):r(Di=!!t.window.navigator.geolocation),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ni=0,Fi=!1},r.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())},r.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},r.prototype._onSuccess=function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}},r.prototype._updateCamera=function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),o=t.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})},r.prototype._updateMarker=function(e){if(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},r.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([1,t]),r=e.distanceTo(n),i=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=i+"px",this._circleElement.style.height=i+"px"},r.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},r.prototype._onError=function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Fi)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new zi(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ni--,Fi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ni>1?(e={maximumAge:6e5,timeout:0},Fi=!0):(e=this.options.positionOptions,Fi=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),Ui={maxWidth:100,unit:"metric"},Vi=function(e){this.options=t.extend({},Ui,e),t.bindAll(["_onMove","setUnit"],this)};function Gi(t,e,n){var r=n&&n.maxWidth||100,i=t._container.clientHeight/2,o=t.unproject([0,i]),a=t.unproject([r,i]),s=o.distanceTo(a);if(n&&"imperial"===n.unit){var u=3.2808*s;u>5280?qi(e,r,u/5280,t._getUIString("ScaleControl.Miles")):qi(e,r,u,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?qi(e,r,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?qi(e,r,s/1e3,t._getUIString("ScaleControl.Kilometers")):qi(e,r,s,t._getUIString("ScaleControl.Meters"))}function qi(t,e,n,r){var i,o,a,s=(i=n,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(a)));t.style.width=e*(s/n)+"px",t.innerHTML=s+"&nbsp;"+r}Vi.prototype.getDefaultPosition=function(){return"bottom-left"},Vi.prototype._onMove=function(){Gi(this._map,this._container,this.options)},Vi.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vi.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vi.prototype.setUnit=function(t){this.options.unit=t,Gi(this._map,this._container,this.options)};var Zi=function(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")};Zi.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Zi.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Zi.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},Zi.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Zi.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},Zi.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Zi.prototype._isFullscreen=function(){return this._fullscreen},Zi.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Zi.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Hi={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Wi=function(e){function r(n){e.call(this),this.options=t.extend(Object.create(Hi),n),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.addTo=function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},r.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},r.prototype.getElement=function(){return this._container},r.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},r.prototype.setHTML=function(e){var n,r=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;n=i.firstChild;)r.appendChild(n);return this.setDOMContent(r)},r.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},r.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},r.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},r.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},r.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},r.prototype._onMouseUp=function(t){this._update(t.point)},r.prototype._onMouseMove=function(t){this._update(t.point)},r.prototype._onDrag=function(t){this._update(t.point)},r.prototype._update=function(e){var r=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return r._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Oi(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var i=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),o=this.options.anchor,a=function e(n){if(n){if("number"==typeof n){var r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-n),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var i=t.Point.convert(n);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!o){var s,u=this._container.offsetWidth,c=this._container.offsetHeight;s=i.y+a.bottom.y<c?["top"]:i.y>this._map.transform.height-c?["bottom"]:[],i.x<u/2?s.push("left"):i.x>this._map.transform.width-u/2&&s.push("right"),o=0===s.length?"bottom":s.join("-")}var l=i.add(a[o]).round();n.setTransform(this._container,Li[o]+" translate("+l.x+"px,"+l.y+"px)"),Ri(this._container,o,"popup")}},r.prototype._onClose=function(){this.remove()},r}(t.Evented),Xi={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:Ci,NavigationControl:Mi,GeolocateControl:Bi,AttributionControl:_i,ScaleControl:Vi,FullscreenControl:Zi,Popup:Wi,Marker:zi,Style:Ge,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,prewarm:function(){Nt().acquire(Rt)},clearPrewarmedResources:function(){var t=zt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Rt),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Dt.workerCount},set workerCount(t){Dt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};return Xi})),n}))},"4cb6":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm");e.METADATA_KEY=r;var i=n("9Fde");e.Container=i.Container;var o=n("FV85");e.BindingScopeEnum=o.BindingScopeEnum,e.BindingTypeEnum=o.BindingTypeEnum,e.TargetTypeEnum=o.TargetTypeEnum;var a=n("dxzI");e.AsyncContainerModule=a.AsyncContainerModule,e.ContainerModule=a.ContainerModule;var s=n("cZ5Q");e.injectable=s.injectable;var u=n("0gSV");e.tagged=u.tagged;var c=n("ZzCi");e.named=c.named;var l=n("Yk9n");e.inject=l.inject,e.LazyServiceIdentifer=l.LazyServiceIdentifer;var f=n("jYx5");e.optional=f.optional;var p=n("n2J3");e.unmanaged=p.unmanaged;var h=n("jIg/");e.multiInject=h.multiInject;var d=n("oaX6");e.targetName=d.targetName;var m=n("Sk89");e.postConstruct=m.postConstruct;var v=n("wnjb");e.MetadataReader=v.MetadataReader;var g=n("d9O0");e.id=g.id;var y=n("Ztfv");e.decorate=y.decorate;var _=n("RR/i");e.traverseAncerstors=_.traverseAncerstors,e.taggedConstraint=_.taggedConstraint,e.namedConstraint=_.namedConstraint,e.typeConstraint=_.typeConstraint;var b=n("ujMp");e.getServiceIdentifierAsString=b.getServiceIdentifierAsString;var x=n("78VC");e.multiBindToService=x.multiBindToService},"4qC0":function(t,e,n){var r=n("NykK"),i=n("Z0cm"),o=n("ExA7"),a="[object String]";function s(t){return"string"==typeof t||!i(t)&&o(t)&&r(t)==a}t.exports=s},"5gLl":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("lSNA"),i=n.n(r),o=n("LvWW"),a=n.n(o),s=n("AKIq"),u=n("cWyK");function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e){var n=[],r={};if(t.features=t.features.filter((function(t){var e=t.geometry;return null!=t&&e&&e.type&&e.coordinates&&e.coordinates.length>0})),a()(t,!0),0===t.features.length)return{dataArray:[],featureKeys:r};return u["flattenEach"](t,(function(t,e){var r=Object(s["getCoords"])(t),i=e;if("MultiPolygon"===t.geometry.type)r.forEach((function(e){var r=l(l({},t.properties),{},{coordinates:[e],_id:i});n.push(r)}));else{var o=l(l({},t.properties),{},{coordinates:r,_id:i});n.push(o)}})),{dataArray:n,featureKeys:r}}},"5ku3":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var r=n("U8pU"),i=n("I0ug");function o(){var e="object"===("undefined"===typeof t?"undefined":Object(r["a"])(t))&&"[object process]"===String(t)&&!t.browser;return!e||Object(i["a"])()}}).call(this,n("Q2Ig"))},"5zYK":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("lSNA"),i=n.n(r),o=n("RIqP"),a=n.n(o),s=n("LvWW"),u=n.n(s);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e){var n=e.x,r=e.y,i=e.x1,o=e.y1,s=e.coordinates,c=[];return t.forEach((function(t,e){var f=[];if(n&&r&&(f=[parseFloat(t[n]),parseFloat(t[r])]),n&&r&&i&&o){var p=[parseFloat(t[n]),parseFloat(t[r])],h=[parseFloat(t[i]),parseFloat(t[o])];f=[p,h]}if(s){var d="Polygon";Array.isArray(s[0])||(d="Point"),Array.isArray(s[0])&&!Array.isArray(s[0][0])&&(d="LineString");var m={type:d,coordinates:a()(t[s])};u()(m,!0),f=m.coordinates}var v=l(l({},t),{},{_id:e,coordinates:f});c.push(v)})),{dataArray:c}}},"6AGu":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("FV85"),i=n("LKzl"),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=o},"6D9b":function(t,e,n){t.exports={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(t,e){},"6acW":function(t,e,n){var r=n("dt0z"),i=n("gQMU");function o(t){return i(r(t).toLowerCase())}t.exports=o},"6nK8":function(t,e,n){var r=n("dVn5"),i=n("fo6e"),o=n("dt0z"),a=n("9NmV");function s(t,e,n){return t=o(t),e=n?void 0:e,void 0===e?i(t)?a(t):r(t):t.match(e)||[]}t.exports=s},"711d":function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}t.exports=n},"78VC":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=function(t){return function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return t.bind(n).toService(e)}))}}}},"7tbW":function(t,e,n){var r=n("LGYb");function i(t){return t&&t.length?r(t):[]}t.exports=i},"8/Fi":function(t,e,n){"use strict";n("J4zp"),n("9nhX")},"8ml+":function(t,e,n){"use strict";var r=n("h1nZ");n.o(r,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return r["CityBuildingLayer"]})),n.o(r,"Control")&&n.d(e,"Control",(function(){return r["Control"]})),n.o(r,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return r["HeatmapLayer"]})),n.o(r,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return r["ImageLayer"]})),n.o(r,"LineLayer")&&n.d(e,"LineLayer",(function(){return r["LineLayer"]})),n.o(r,"Logo")&&n.d(e,"Logo",(function(){return r["Logo"]})),n.o(r,"Marker")&&n.d(e,"Marker",(function(){return r["Marker"]})),n.o(r,"PointLayer")&&n.d(e,"PointLayer",(function(){return r["PointLayer"]})),n.o(r,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return r["PolygonLayer"]})),n.o(r,"Popup")&&n.d(e,"Popup",(function(){return r["Popup"]})),n.o(r,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return r["RasterLayer"]})),n.o(r,"Scale")&&n.d(e,"Scale",(function(){return r["Scale"]})),n.o(r,"Scene")&&n.d(e,"Scene",(function(){return r["Scene"]})),n.o(r,"Zoom")&&n.d(e,"Zoom",(function(){return r["Zoom"]}));var i=n("kQ+U");n.d(e,"Scene",(function(){return i["a"]}));var o=n("sxDa");n.d(e,"CityBuildingLayer",(function(){return o["a"]})),n.d(e,"HeatmapLayer",(function(){return o["b"]})),n.d(e,"ImageLayer",(function(){return o["c"]})),n.d(e,"LineLayer",(function(){return o["d"]})),n.d(e,"PointLayer",(function(){return o["e"]})),n.d(e,"PolygonLayer",(function(){return o["f"]})),n.d(e,"RasterLayer",(function(){return o["g"]}));var a=n("k5/I");n.d(e,"Control",(function(){return a["a"]})),n.d(e,"Logo",(function(){return a["b"]})),n.d(e,"Marker",(function(){return a["c"]})),n.d(e,"Popup",(function(){return a["d"]})),n.d(e,"Scale",(function(){return a["e"]})),n.d(e,"Zoom",(function(){return a["f"]}));n("Hel2"),n("RL2/")},"8uyu":function(t,e){},"9Fde":function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n("LgvC"),a=n("MON2"),s=n("FV85"),u=n("xfSm"),c=n("wnjb"),l=n("h7MG"),f=n("aPG5"),p=n("gzZq"),h=n("d9O0"),d=n("ujMp"),m=n("HpQ9"),v=n("AwBQ"),g=function(){function t(t){var e=t||{};if("object"!==typeof e)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=s.BindingScopeEnum.Transient;else if(e.defaultScope!==s.BindingScopeEnum.Singleton&&e.defaultScope!==s.BindingScopeEnum.Transient&&e.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!==typeof e.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!==typeof e.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=h.id(),this._bindingDictionary=new v.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new c.MetadataReader}return t.merge=function(e,n){var r=new t,i=l.getBindingDictionary(r),o=l.getBindingDictionary(e),a=l.getBindingDictionary(n);function s(t,e){t.traverse((function(t,n){n.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return s(o,i),s(a,i),r},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,r=t,i.label=1;case 1:return n<r.length?(o=r[n],a=e(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){return function(e){return e.moduleId===t}};e.forEach((function(e){var n=r(e.id);t._bindingDictionary.removeByCondition(n)}))},t.prototype.bind=function(t){var e=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new o.Binding(t,e);return this._bindingDictionary.add(t,n),new p.BindingToSyntax(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(a.CANNOT_UNBIND+" "+d.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new v.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,u.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=l.createMockRequest(this,t,e,n);r=i.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r},t.prototype.snapshot=function(){this._snapshots.push(m.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,s.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,u.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,s.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,u.NAMED_TAG,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.bind.bind(t),o=i(r);return e(o,n),o}},r=function(e){return function(e){var n=t.unbind.bind(t);n(e)}},i=function(e){return function(e){var n=t.isBound.bind(t);return n(e)}},o=function(n){return function(r){var i=t.rebind.bind(t),o=i(r);return e(o,n),o}};return function(t){return{bindFunction:n(t),isboundFunction:i(t),rebindFunction:o(t),unbindFunction:r(t)}}},t.prototype._get=function(t,e,n,r,i,o){var s=null,u={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(s=this._middleware(u),void 0===s||null===s)throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(u);return s},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=l.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);n=e.contextInterceptor(n);var r=f.resolve(n);return r}},t}();e.Container=g},"9NmV":function(t,e){var n="\\ud800-\\udfff",r="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",a=r+i+o,s="\\u2700-\\u27bf",u="a-z\\xdf-\\xf6\\xf8-\\xff",c="\\xac\\xb1\\xd7\\xf7",l="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",f="\\u2000-\\u206f",p=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",h="A-Z\\xc0-\\xd6\\xd8-\\xde",d="\\ufe0e\\ufe0f",m=c+l+f+p,v="['\u2019]",g="["+m+"]",y="["+a+"]",_="\\d+",b="["+s+"]",x="["+u+"]",w="[^"+n+m+_+s+u+h+"]",S="\\ud83c[\\udffb-\\udfff]",E="(?:"+y+"|"+S+")",T="[^"+n+"]",A="(?:\\ud83c[\\udde6-\\uddff]){2}",C="[\\ud800-\\udbff][\\udc00-\\udfff]",k="["+h+"]",P="\\u200d",M="(?:"+x+"|"+w+")",I="(?:"+k+"|"+w+")",O="(?:"+v+"(?:d|ll|m|re|s|t|ve))?",L="(?:"+v+"(?:D|LL|M|RE|S|T|VE))?",R=E+"?",D="["+d+"]?",z="(?:"+P+"(?:"+[T,A,C].join("|")+")"+D+R+")*",j="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",N="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",F=D+R+z,B="(?:"+[b,A,C].join("|")+")"+F,U=RegExp([k+"?"+x+"+"+O+"(?="+[g,k,"$"].join("|")+")",I+"+"+L+"(?="+[g,k+M,"$"].join("|")+")",k+"?"+M+"+"+O,k+"+"+L,N,j,_,B].join("|"),"g");function V(t){return t.match(U)||[]}t.exports=V},"9lTW":function(t,e,n){"use strict";(function(e){var r=n("MgzW");function i(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"===typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n("MCLT"),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c=function(){return"foo"===function(){}.name}();function l(t){return Object.prototype.toString.call(t)}function f(t){return!o(t)&&("function"===typeof e.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var p=t.exports=_,h=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(a.isFunction(t)){if(c)return t.name;var e=t.toString(),n=e.match(h);return n&&n[1]}}function m(t,e){return"string"===typeof t?t.length<e?t:t.slice(0,e):t}function v(t){if(c||!a.isFunction(t))return a.inspect(t);var e=d(t),n=e?": "+e:"";return"[Function"+n+"]"}function g(t){return m(v(t.actual),128)+" "+t.operator+" "+m(v(t.expected),128)}function y(t,e,n,r,i){throw new p.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function _(t,e){t||y(t,!0,e,"==",p.ok)}function b(t,e,n,r){if(t===e)return!0;if(o(t)&&o(e))return 0===i(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"===typeof t||null!==e&&"object"===typeof e){if(f(t)&&f(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;r=r||{actual:[],expected:[]};var s=r.actual.indexOf(t);return-1!==s&&s===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),w(t,e,n,r))}return n?t===e:t==e}function x(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function w(t,e,n,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=x(t),o=x(e);if(i&&!o||!i&&o)return!1;if(i)return t=u.call(t),e=u.call(e),b(t,e,n);var s,c,l=k(t),f=k(e);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),c=l.length-1;c>=0;c--)if(l[c]!==f[c])return!1;for(c=l.length-1;c>=0;c--)if(s=l[c],!b(t[s],e[s],n,r))return!1;return!0}function S(t,e,n){b(t,e,!0)&&y(t,e,n,"notDeepStrictEqual",S)}function E(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(n){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function T(t){var e;try{t()}catch(n){e=n}return e}function A(t,e,n,r){var i;if("function"!==typeof e)throw new TypeError('"block" argument must be a function');"string"===typeof n&&(r=n,n=null),i=T(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&y(i,n,"Missing expected exception"+r);var o="string"===typeof r,s=!t&&a.isError(i),u=!t&&i&&!n;if((s&&o&&E(i,n)||u)&&y(i,n,"Got unwanted exception"+r),t&&i&&n&&!E(i,n)||!t&&i)throw i}function C(t,e){t||y(t,!0,e,"==",C)}p.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=g(this),this.generatedMessage=!0);var e=t.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=d(e),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(p.AssertionError,Error),p.fail=y,p.ok=_,p.equal=function(t,e,n){t!=e&&y(t,e,n,"==",p.equal)},p.notEqual=function(t,e,n){t==e&&y(t,e,n,"!=",p.notEqual)},p.deepEqual=function(t,e,n){b(t,e,!1)||y(t,e,n,"deepEqual",p.deepEqual)},p.deepStrictEqual=function(t,e,n){b(t,e,!0)||y(t,e,n,"deepStrictEqual",p.deepStrictEqual)},p.notDeepEqual=function(t,e,n){b(t,e,!1)&&y(t,e,n,"notDeepEqual",p.notDeepEqual)},p.notDeepStrictEqual=S,p.strictEqual=function(t,e,n){t!==e&&y(t,e,n,"===",p.strictEqual)},p.notStrictEqual=function(t,e,n){t===e&&y(t,e,n,"!==",p.notStrictEqual)},p.throws=function(t,e,n){A(!0,t,e,n)},p.doesNotThrow=function(t,e,n){A(!1,t,e,n)},p.ifError=function(t){if(t)throw t},p.strict=r(C,p,{equal:p.strictEqual,deepEqual:p.deepStrictEqual,notEqual:p.notStrictEqual,notDeepEqual:p.notDeepStrictEqual}),p.strict.strict=p.strict;var k=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n("yLpj"))},"9nhX":function(t,e,n){var r=n("g4R6"),i=n("tLB3");function o(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=i(n),n=n===n?n:0),void 0!==e&&(e=i(e),e=e===e?e:0),r(i(t),e,n)}t.exports=o},AFH1:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t["TOPRIGHT"]="topright",t["TOPLEFT"]="topleft",t["BOTTOMRIGHT"]="bottomright",t["BOTTOMLEFT"]="bottomleft"}(r||(r={}))},AKIq:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("/rf6");function i(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function o(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function a(t){if(t.length>1&&r.isNumber(t[0])&&r.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return a(t[0]);throw new Error("coordinates must only contain numbers")}function s(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function u(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function c(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}}function l(t){return"Feature"===t.type?t.geometry:t}function f(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}e.getCoord=i,e.getCoords=o,e.containsNumber=a,e.geojsonType=s,e.featureOf=u,e.collectionOf=c,e.getGeom=l,e.getType=f},APxj:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Ucsi");function i(t,e){void 0===e&&(e=!0);var n=r.makePropertyInjectDecorator(t,e),i=r.makePropertyInjectNamedDecorator(t,e),o=r.makePropertyInjectTaggedDecorator(t,e),a=r.makePropertyMultiInjectDecorator(t,e);return{lazyInject:n,lazyInjectNamed:i,lazyInjectTagged:o,lazyMultiInject:a}}e.default=i},AwBQ:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(r.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(r.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach((function(n,r){var i=n.filter((function(e){return!t(e)}));i.length>0?e._map.set(r,i):e._map.delete(r)}))},t.prototype.hasKey=function(t){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,n){t.forEach((function(t){return e.add(n,t.clone())}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,n){t(n,e)}))},t}();e.Lookup=i},"B6l+":function(t,e,n){var r=n("Sq3C"),i=n("Z1HP"),o=n("Sxd8"),a=n("dt0z");function s(t,e,n){t=a(t),e=o(e);var s=e?i(t):0;return e&&s<e?t+r(e-s,n):t}t.exports=s},BGjm:function(t,e){function n(t,e){e||(e=document);var n=e.head||e.getElementsByTagName("head")[0];if(!n){n=e.createElement("head");var r=e.body||e.getElementsByTagName("body")[0];r?r.parentNode.insertBefore(n,r):e.documentElement.appendChild(n)}var i=e.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(e.createTextNode(t)),n.appendChild(i),i}t.exports=n},BkRI:function(t,e,n){var r=n("OBhP"),i=1,o=4;function a(t){return r(t,i|o)}t.exports=a},BpBL:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("Hel2");function i(t,e){var n=e.extent,r=new Promise((function(e){o(t,(function(t){e(t)}))})),i={images:r,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return i}function o(t,e){var n=t,o=[];if("string"===typeof n)Object(r["n"])({url:n},(function(t,n){o.push(n),e(o)}));else{var a=n.length,s=0;n.forEach((function(t){Object(r["n"])({url:t},(function(t,n){s++,o.push(n),s===a&&e(o)}))}))}return i}},CIdX:function(t,e,n){t.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(t,e){function n(t,e,n){var r=n-1,i=t.length;while(++r<i)if(t[r]===e)return r;return-1}t.exports=n},"D+ow":function(t,e){},D9lx:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("6AGu"),i=n("406g"),o=n("z4Hk"),a=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=a},"Dw+G":function(t,e,n){var r=n("juv8"),i=n("mTTR");function o(t,e){return t&&r(e,i(e),t)}t.exports=o},EEGq:function(t,e,n){var r=n("juv8"),i=n("oCl/");function o(t,e){return r(t,i(t),e)}t.exports=o},EfZ0:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},FI6e:function(t,e){},FV85:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={Request:"Request",Singleton:"Singleton",Transient:"Transient"};e.BindingScopeEnum=r;var i={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};e.BindingTypeEnum=i;var o={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};e.TargetTypeEnum=o},FmoU:function(t,e,n){"use strict";n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return A}));var r=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function i(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function o(){}var a=.7,s=1/a,u="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",f=/^#([0-9a-f]{3,8})$/,p=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),h=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),d=new RegExp("^rgba\\("+[u,u,u,c]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,c]+"\\)$"),v=new RegExp("^hsl\\("+[c,l,l]+"\\)$"),g=new RegExp("^hsla\\("+[c,l,l,c]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _(){return this.rgb().formatHex()}function b(){return O(this).formatHsl()}function x(){return this.rgb().formatRgb()}function w(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=f.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?S(e):3===n?new C(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?E(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?E(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=p.exec(t))?new C(e[1],e[2],e[3],1):(e=h.exec(t))?new C(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=d.exec(t))?E(e[1],e[2],e[3],e[4]):(e=m.exec(t))?E(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=v.exec(t))?I(e[1],e[2]/100,e[3]/100,1):(e=g.exec(t))?I(e[1],e[2]/100,e[3]/100,e[4]):y.hasOwnProperty(t)?S(y[t]):"transparent"===t?new C(NaN,NaN,NaN,0):null}function S(t){return new C(t>>16&255,t>>8&255,255&t,1)}function E(t,e,n,r){return r<=0&&(t=e=n=NaN),new C(t,e,n,r)}function T(t){return t instanceof o||(t=w(t)),t?(t=t.rgb(),new C(t.r,t.g,t.b,t.opacity)):new C}function A(t,e,n,r){return 1===arguments.length?T(t):new C(t,e,n,null==r?1:r)}function C(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function k(){return"#"+M(this.r)+M(this.g)+M(this.b)}function P(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function M(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function I(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new R(t,e,n,r)}function O(t){if(t instanceof R)return new R(t.h,t.s,t.l,t.opacity);if(t instanceof o||(t=w(t)),!t)return new R;if(t instanceof R)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,u=a-i,c=(a+i)/2;return u?(s=e===a?(n-r)/u+6*(n<r):n===a?(r-e)/u+2:(e-n)/u+4,u/=c<.5?a+i:2-a-i,s*=60):u=c>0&&c<1?0:s,new R(s,u,c,t.opacity)}function L(t,e,n,r){return 1===arguments.length?O(t):new R(t,e,n,null==r?1:r)}function R(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function D(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}r(o,w,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:_,formatHex:_,formatHsl:b,formatRgb:x,toString:x}),r(C,A,i(o,{brighter:function(t){return t=null==t?s:Math.pow(s,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?a:Math.pow(a,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k,formatHex:k,formatRgb:P,toString:P})),r(R,L,i(o,{brighter:function(t){return t=null==t?s:Math.pow(s,t),new R(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?a:Math.pow(a,t),new R(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new C(D(t>=240?t-240:t+120,i,r),D(t,i,r),D(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}))},G6z8:function(t,e,n){var r=n("fR/l"),i=n("oCl/"),o=n("mTTR");function a(t){return r(t,o,i)}t.exports=a},GXnB:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=i},Gi0A:function(t,e,n){var r=n("QqLw"),i=n("ExA7"),o="[object Map]";function a(t){return i(t)&&r(t)==o}t.exports=a},"H+7v":function(t,e,n){t.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},Hel2:function(t,e,n){"use strict";n.d(e,"n",(function(){return B})),n.d(e,"l",(function(){return Z})),n.d(e,"o",(function(){return W})),n.d(e,"d",(function(){return J})),n.d(e,"p",(function(){return Q})),n.d(e,"q",(function(){return $})),n.d(e,"i",(function(){return tt})),n.d(e,"b",(function(){return et})),n.d(e,"h",(function(){return nt})),n.d(e,"r",(function(){return ot})),n.d(e,"j",(function(){return at})),n.d(e,"k",(function(){return st})),n.d(e,"m",(function(){return ut})),n.d(e,"f",(function(){return rt})),n.d(e,"e",(function(){return ct})),n.d(e,"g",(function(){return lt})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i}));var r={};n.r(r),n.d(r,"getContainer",(function(){return a})),n.d(r,"trim",(function(){return s})),n.d(r,"splitWords",(function(){return u})),n.d(r,"create",(function(){return l})),n.d(r,"remove",(function(){return f})),n.d(r,"addClass",(function(){return p})),n.d(r,"removeClass",(function(){return h})),n.d(r,"hasClass",(function(){return d})),n.d(r,"setClass",(function(){return m})),n.d(r,"getClass",(function(){return v})),n.d(r,"empty",(function(){return g})),n.d(r,"setTransform",(function(){return _})),n.d(r,"triggerResize",(function(){return b})),n.d(r,"printCanvas",(function(){return x}));var i={};n.r(i),n.d(i,"sum",(function(){return ht})),n.d(i,"max",(function(){return ft})),n.d(i,"min",(function(){return pt})),n.d(i,"mean",(function(){return dt})),n.d(i,"mode",(function(){return mt})),n.d(i,"statMap",(function(){return vt})),n.d(i,"getColumn",(function(){return gt})),n.d(i,"getSatByColumn",(function(){return yt}));var o=window.document.documentElement.style;function a(t){var e=t;return"string"===typeof t&&(e=document.getElementById(t)),e}function s(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function u(t){return s(t).split(/\s+/)}function c(t){if(!o)return t[0];for(var e in t)if(t[e]&&t[e]in o)return t[e];return t[0]}function l(t,e,n){var r=document.createElement(t);return r.className=e||"",n&&n.appendChild(r),r}function f(t){var e=t.parentNode;e&&e.removeChild(t)}function p(t,e){if(void 0!==t.classList)for(var n=u(e),r=0,i=n.length;r<i;r++)t.classList.add(n[r]);else if(!d(t,e)){var o=v(t);m(t,(o?o+" ":"")+e)}}function h(t,e){void 0!==t.classList?t.classList.remove(e):m(t,s((" "+v(t)+" ").replace(" "+e+" "," ")))}function d(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=v(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function m(t,e){t instanceof HTMLElement?t.className=e:t.className.baseVal=e}function v(t){return t instanceof SVGElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function g(t){while(t&&t.firstChild)t.removeChild(t.firstChild)}var y=c(["transform","WebkitTransform"]);function _(t,e){t.style[y]=e}function b(){if("function"===typeof Event)window.dispatchEvent(new Event("resize"));else{var t=window.document.createEvent("UIEvents");t.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(t)}}function x(t){var e=["padding: "+(t.height/2-8)+"px "+t.width/2+"px;","line-height: "+t.height+"px;","background-image: url("+t.toDataURL()+");"];console.log("%c\n",e.join(""))}var w=n("lwsE"),S=n.n(w),E=n("W8MJ"),T=n.n(E),A=n("7W2i"),C=n.n(A),k=n("a1gu"),P=n.n(k),M=n("Nsbk"),I=n.n(M),O=n("oShl"),L=n.n(O);function R(t){var e=D();return function(){var n,r=I()(t);if(e){var i=I()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P()(this,n)}}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var z=function(t){C()(n,t);var e=R(n);function n(t,r,i){var o;return S()(this,n),o=e.call(this,t),o.status=void 0,o.url=void 0,o.status=r,o.url=i,o.name=o.constructor.name,o.message=t,o}return T()(n,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),n}(L()(Error));function j(t){var e=new XMLHttpRequest;for(var n in e.open("GET",t.url,!0),t.headers)t.headers.hasOwnProperty(n)&&e.setRequestHeader(n,t.headers[n]);return e.withCredentials="include"===t.credentials,e}var N=function(t,e){var n=j(t);return n.responseType="arraybuffer",n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){var r=n.response;if(0===r.byteLength&&200===n.status)return e(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?e(null,{data:r,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):e(new z(n.statusText,n.status,t.url))},n.send(),n};var F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",B=function(t,e){return N(t,(function(t,n){if(t)e(t);else if(n){var r=new window.Image;r.crossOrigin="anonymous";var i=window.URL||window.webkitURL;r.onload=function(){e(null,r),i.revokeObjectURL(r.src)};var o=new window.Blob([new Uint8Array(n.data)],{type:"image/png"});r.src=n.data.byteLength?i.createObjectURL(o):F}}))},U=n("J4zp"),V=n.n(U),G=n("/rf6"),q=2*Math.PI*6378137/2;function Z(t){var e=[1/0,1/0,-1/0,-1/0];return t.forEach((function(t){var n=t.coordinates;H(e,n)})),e}function H(t,e){return Array.isArray(e[0])?e.forEach((function(e){H(t,e)})):(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])),t}function W(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1};t=K(t,e);var r=t[0],i=t[1],o=r*q/180,a=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return a=a*q/180,n.enable&&(o=Number(o.toFixed(n.decimal)),a=Number(a.toFixed(n.decimal))),3===t.length?[o,a,t[2]]:[o,a]}function X(t){if(void 0===t||null===t)throw new Error("lng is required");return(t>180||t<-180)&&(t%=360,t>180&&(t=-360+t),t<-180&&(t=360+t),0===t&&(t=0)),t}function Y(t){if(void 0===t||null===t)throw new Error("lat is required");return(t>90||t<-90)&&(t%=180,t>90&&(t=-180+t),t<-90&&(t=180+t),0===t&&(t=0)),t}function K(t,e){if(!1===e)return t;var n=X(t[0]),r=Y(t[1]);return r>85&&(r=85),r<-85&&(r=-85),3===t.length?[n,r,t[2]]:[n,r]}function J(t){var e=85.0511287798,n=Math.max(Math.min(e,t[1]),-e),r=256<<20,i=Math.PI/180,o=t[0]*i,a=n*i;a=Math.log(Math.tan(Math.PI/4+a/2));var s=.5/Math.PI,u=.5,c=-.5/Math.PI;return i=.5,o=r*(s*o+u),a=r*(c*a+i),[Math.floor(o),Math.floor(a)]}function Q(t,e,n){var r=Object(G["degreesToRadians"])(e[1]-t[1]),i=Object(G["degreesToRadians"])(e[0]-t[0]),o=Object(G["degreesToRadians"])(t[1]),a=Object(G["degreesToRadians"])(e[1]),s=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(o)*Math.cos(a);return Object(G["radiansToLength"])(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),"meters")}function $(t,e){var n=Math.abs(t[1][1]-t[0][1])*e,r=Math.abs(t[1][0]-t[0][0])*e;return[[t[0][0]-r,t[0][1]-n],[t[1][0]+r,t[1][1]+n]]}function tt(t,e){return t[0][0]<=e[0][0]&&t[0][1]<=e[0][1]&&t[1][0]>=e[1][0]&&t[1][1]>=e[1][1]}var et=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0;S()(this,t),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=e,this.destroy=n||this.defaultDestroy,this.order=[],this.clear()}return T()(t,[{key:"clear",value:function(){var t=this;this.order.forEach((function(e){t.delete(e)})),this.cache={},this.order=[]}},{key:"get",value:function(t){var e=this.cache[t];return e&&(this.deleteOrder(t),this.appendOrder(t)),e}},{key:"set",value:function(t,e){this.cache[t]?(this.delete(t),this.cache[t]=e,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=e,this.appendOrder(t))}},{key:"delete",value:function(t){var e=this.cache[t];e&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(e,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var e=this.order.findIndex((function(e){return e===t}));e>=0&&this.order.splice(e,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,e){return null}}]),t}();function nt(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}var rt,it=n("FmoU");function ot(t){var e=it["a"](t),n=[0,0,0,0];return null!=e&&(n[0]=e.r/255,n[1]=e.g/255,n[2]=e.b/255,n[3]=e.opacity),n}function at(t){var e=V()(t,3),n=e[0],r=e[1],i=e[2],o=n+256*r+65536*i-1;return o}function st(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}function ut(t){var e=document.createElement("canvas"),n=e.getContext("2d");e.width=256,e.height=1;for(var r=n.createLinearGradient(0,0,256,1),i=null,o=t.positions[0],a=t.positions[t.positions.length-1],s=0;s<t.colors.length;++s){var u=(t.positions[s]-o)/(a-o);r.addColorStop(u,t.colors[s])}return n.fillStyle=r,n.fillRect(0,0,256,1),i=new Uint8ClampedArray(n.getImageData(0,0,256,1).data),new ImageData(i,256,1)}(function(t){t["CENTER"]="center",t["TOP"]="top",t["TOP-LEFT"]="top-left",t["TOP-RIGHT"]="top-right",t["BOTTOM"]="bottom",t["BOTTOM-LEFT"]="bottom-left",t["LEFT"]="left",t["RIGHT"]="right"})(rt||(rt={}));var ct={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lt(t,e,n){var r=t.classList;for(var i in ct)ct.hasOwnProperty(i)&&r.remove("l7-".concat(n,"-anchor-").concat(i));r.add("l7-".concat(n,"-anchor-").concat(e))}function ft(t){if(0===t.length)throw new Error("max requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]>e&&(e=t[n]);return 1*e}function pt(t){if(0===t.length)throw new Error("min requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]<e&&(e=t[n]);return 1*e}function ht(t){if(0===t.length)return 0;for(var e=1*t[0],n=1;n<t.length;n++)e+=1*t[n];return e}function dt(t){if(0===t.length)throw new Error("mean requires at least one data point");return ht(t)/t.length}function mt(t){if(0===t.length)throw new Error("mean requires at least one data point");if(t.length<3)return t[0];t.sort();for(var e=t[0],n=NaN,r=0,i=1,o=1;o<t.length+1;o++)t[o]!==e?(i>r&&(r=i,n=e),i=1,e=t[o]):i++;return 1*n}var vt={min:pt,max:ft,mean:dt,sum:ht,mode:mt};function gt(t,e){return t.map((function(t){return t[e]}))}function yt(t,e){return vt[t](e)}},HpQ9:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.of=function(e,n){var r=new t;return r.bindings=e,r.middleware=n,r},t}();e.ContainerSnapshot=r},HthE:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),function(t){t[t["LNGLAT"]=1]="LNGLAT",t[t["LNGLAT_OFFSET"]=2]="LNGLAT_OFFSET",t[t["VECTOR_TILE"]=3]="VECTOR_TILE",t[t["IDENTITY"]=4]="IDENTITY",t[t["P20"]=5]="P20",t[t["P20_OFFSET"]=6]="P20_OFFSET",t[t["METER_OFFSET"]=7]="METER_OFFSET"}(r||(r={}));var i={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n("U8pU");function i(e){if("undefined"!==typeof window&&"object"===Object(r["a"])(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof t&&"object"===Object(r["a"])(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"===typeof navigator?"undefined":Object(r["a"])(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,i=e||n;return!!(i&&i.indexOf("Electron")>=0)}}).call(this,n("Q2Ig"))},IOcx:function(t,e,n){"use strict";var r=n("ZaHm");n.d(e,"a",(function(){return r}));var i=n("ZxFD");n.d(e,"b",(function(){return i}));var o=n("n+fv");n.d(e,"c",(function(){return o}));var a=n("bl9R");n.d(e,"d",(function(){return a}))},ISu3:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u}));var r={},i={},o=function(t){return i[t]},a=function(t,e){i[t]=e},s=function(t){return r[t]},u=function(t,e){r[t]=e}},J2iB:function(t,e){function n(t){return null==t}t.exports=n},J7lC:function(t,e){},K9nA:function(t,e,n){"use strict";(function(t,r){n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var i=n("U8pU"),o={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof t&&t,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":Object(i["a"])(r))&&r},a=(o.self||o.window||o.global,o.window||o.self||o.global),s=(o.global||o.self||o.window,o.document,o.process||{});console}).call(this,n("yLpj"),n("Q2Ig"))},KKCa:function(t,e){"function"===typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},KwMD:function(t,e){function n(t,e,n,r){var i=t.length,o=n+(r?1:-1);while(r?o--:++o<i)if(e(t[o],o,t))return o;return-1}t.exports=n},L56e:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["mapload"]},LGYb:function(t,e,n){var r=n("1hJj"),i=n("jbM+"),o=n("Xt/L"),a=n("xYSL"),s=n("dQpi"),u=n("rEGp"),c=200;function l(t,e,n){var l=-1,f=i,p=t.length,h=!0,d=[],m=d;if(n)h=!1,f=o;else if(p>=c){var v=e?null:s(t);if(v)return u(v);h=!1,f=a,m=new r}else m=e?[]:d;t:while(++l<p){var g=t[l],y=e?e(g):g;if(g=n||0!==g?g:0,h&&y===y){var _=m.length;while(_--)if(m[_]===y)continue t;e&&m.push(y),d.push(g)}else f(m,y,n)||(m!==d&&m.push(y),d.push(g))}return d}t.exports=l},LKzl:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("406g"),i=n("z4Hk"),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=o},LgvC:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("FV85"),i=n("d9O0"),o=function(){function t(t,e){this.id=i.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=o},LvWW:function(t,e,n){var r=n("mhV4");function i(t,e){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(o(i,e)),t;case"GeometryCollection":return t.geometries=t.geometries.map(o(i,e)),t;case"Feature":return t.geometry=i(t.geometry,e),t;case"Polygon":case"MultiPolygon":return a(t,e);default:return t}}function o(t,e){return function(n){return t(n,e)}}function a(t,e){return"Polygon"===t.type?t.coordinates=s(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(o(s,e))),t}function s(t,e){e=!!e,t[0]=u(t[0],e);for(var n=1;n<t.length;n++)t[n]=u(t[n],!e);return t}function u(t,e){return c(t)===e?t:t.reverse()}function c(t){return r.ring(t)>=0}t.exports=i},MCLT:function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!w(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}})),u=r[n];n<o;u=r[++n])_(u)||!A(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,r){if("undefined"!==typeof t&&!0===t.noDeprecation)return n;if("undefined"===typeof t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;function o(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}return o};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&e._extend(r,n),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),f(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"\x1b["+s.colors[n][0]+"m"+t+"\x1b["+s.colors[n][1]+"m":t}function c(t,e){return t}function l(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}function f(t,n,r){if(t.customInspect&&n&&P(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return w(i)||(i=f(t,i,r)),i}var o=p(t,n);if(o)return o;var a=Object.keys(n),s=l(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),k(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(P(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(T(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(C(n))return t.stylize(Date.prototype.toString.call(n),"date");if(k(n))return h(n)}var c,y="",_=!1,b=["{","}"];if(g(n)&&(_=!0,b=["[","]"]),P(n)){var x=n.name?": "+n.name:"";y=" [Function"+x+"]"}return T(n)&&(y=" "+RegExp.prototype.toString.call(n)),C(n)&&(y=" "+Date.prototype.toUTCString.call(n)),k(n)&&(y=" "+h(n)),0!==a.length||_&&0!=n.length?r<0?T(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=_?d(t,n,r,s,a):a.map((function(e){return m(t,n,r,s,e,_)})),t.seen.pop(),v(c,y,b)):b[0]+y+b[1]}function p(t,e){if(E(e))return t.stylize("undefined","undefined");if(w(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return x(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):_(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)D(e,String(a))?o.push(m(t,e,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(m(t,e,n,r,i,!0))})),o}function m(t,e,n,r,i,o){var a,s,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),D(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=_(n)?f(t,u.value,null):f(t,u.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n"))):s=t.stylize("[Circular]","special")),E(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function v(t,e,n){var r=t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0);return r>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function g(t){return Array.isArray(t)}function y(t){return"boolean"===typeof t}function _(t){return null===t}function b(t){return null==t}function x(t){return"number"===typeof t}function w(t){return"string"===typeof t}function S(t){return"symbol"===typeof t}function E(t){return void 0===t}function T(t){return A(t)&&"[object RegExp]"===I(t)}function A(t){return"object"===typeof t&&null!==t}function C(t){return A(t)&&"[object Date]"===I(t)}function k(t){return A(t)&&("[object Error]"===I(t)||t instanceof Error)}function P(t){return"function"===typeof t}function M(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t}function I(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(E(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=g,e.isBoolean=y,e.isNull=_,e.isNullOrUndefined=b,e.isNumber=x,e.isString=w,e.isSymbol=S,e.isUndefined=E,e.isRegExp=T,e.isObject=A,e.isDate=C,e.isError=k,e.isFunction=P,e.isPrimitive=M,e.isBuffer=n("1gqn");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),L[t.getMonth()],e].join(" ")}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",R(),e.format.apply(e,arguments))},e.inherits=n("KKCa"),e._extend=function(t,e){if(!e||!A(e))return t;var n=Object.keys(e),r=n.length;while(r--)t[n[r]]=e[n[r]];return t};var z="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function j(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}function N(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!==typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(j,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}e.promisify=function(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');if(z&&t[z]){var e=t[z];if("function"!==typeof e)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,z,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(a){n(a)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),z&&Object.defineProperty(e,z,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=z,e.callbackify=N}).call(this,n("Q2Ig"))},MON2:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"},O1je:function(t,e){},OBhP:function(t,e,n){var r=n("fmRc"),i=n("gFfm"),o=n("MrPd"),a=n("WwFo"),s=n("Dw+G"),u=n("5Tg0"),c=n("Q1l4"),l=n("VOtZ"),f=n("EEGq"),p=n("qZTm"),h=n("G6z8"),d=n("QqLw"),m=n("yHx3"),v=n("wrZu"),g=n("+iFO"),y=n("Z0cm"),_=n("DSRE"),b=n("zEVN"),x=n("GoyQ"),w=n("1+5i"),S=n("7GkX"),E=1,T=2,A=4,C="[object Arguments]",k="[object Array]",P="[object Boolean]",M="[object Date]",I="[object Error]",O="[object Function]",L="[object GeneratorFunction]",R="[object Map]",D="[object Number]",z="[object Object]",j="[object RegExp]",N="[object Set]",F="[object String]",B="[object Symbol]",U="[object WeakMap]",V="[object ArrayBuffer]",G="[object DataView]",q="[object Float32Array]",Z="[object Float64Array]",H="[object Int8Array]",W="[object Int16Array]",X="[object Int32Array]",Y="[object Uint8Array]",K="[object Uint8ClampedArray]",J="[object Uint16Array]",Q="[object Uint32Array]",$={};function tt(t,e,n,k,P,M){var I,R=e&E,D=e&T,j=e&A;if(n&&(I=P?n(t,k,P,M):n(t)),void 0!==I)return I;if(!x(t))return t;var N=y(t);if(N){if(I=m(t),!R)return c(t,I)}else{var F=d(t),B=F==O||F==L;if(_(t))return u(t,R);if(F==z||F==C||B&&!P){if(I=D||B?{}:g(t),!R)return D?f(t,s(I,t)):l(t,a(I,t))}else{if(!$[F])return P?t:{};I=v(t,F,R)}}M||(M=new r);var U=M.get(t);if(U)return U;M.set(t,I),w(t)?t.forEach((function(r){I.add(tt(r,e,n,r,t,M))})):b(t)&&t.forEach((function(r,i){I.set(i,tt(r,e,n,i,t,M))}));var V=j?D?h:p:D?keysIn:S,G=N?void 0:V(t);return i(G||t,(function(r,i){G&&(i=r,r=t[i]),o(I,i,tt(r,e,n,i,t,M))})),I}$[C]=$[k]=$[V]=$[G]=$[P]=$[M]=$[q]=$[Z]=$[H]=$[W]=$[X]=$[R]=$[D]=$[z]=$[j]=$[N]=$[F]=$[B]=$[Y]=$[K]=$[J]=$[Q]=!0,$[I]=$[O]=$[U]=!1,t.exports=tt},PSsN:function(t,e){},PUg6:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t["normal"]="normal",t["additive"]="additive",t["subtractive"]="subtractive",t["min"]="min",t["max"]="max"}(r||(r={}))},QGbF:function(t,e){},"QQZ/":function(t,e,n){var r=n("Sq3C"),i=n("Z1HP"),o=n("Sxd8"),a=n("dt0z");function s(t,e,n){t=a(t),e=o(e);var s=e?i(t):0;return e&&s<e?r(e-s,n)+t:t}t.exports=s},"R/W3":function(t,e,n){var r=n("KwMD"),i=n("2ajD"),o=n("CZoQ");function a(t,e,n){return e===e?o(t,e,n):r(t,i,n)}t.exports=a},"RL2/":function(t,e,n){"use strict"},RMtq:function(t,e){},"RR/i":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=function t(e,n){var r=e.parentRequest;return null!==r&&(!!n(r)||t(r,n))};e.traverseAncerstors=o;var a=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new i.Metadata(t,e),n}};e.taggedConstraint=a;var s=a(r.NAMED_TAG);e.namedConstraint=s;var u=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"===typeof t){var r=n.serviceIdentifier;return r===t}var i=e.bindings[0].implementationType;return t===i}return!1}};e.typeConstraint=u},Sk89:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm"),o=n("GXnB");function a(){return function(t,e,n){var a=new o.Metadata(i.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,t.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,t.constructor)}}e.postConstruct=a},Sq3C:function(t,e,n){var r=n("sKgW"),i=n("zoYe"),o=n("wy8a"),a=n("quyA"),s=n("Z1HP"),u=n("Em2t"),c=Math.ceil;function l(t,e){e=void 0===e?" ":i(e);var n=e.length;if(n<2)return n?r(e,t):e;var l=r(e,c(t/s(e)));return a(e)?o(u(l),0,t).join(""):l.slice(0,t)}t.exports=l},Sxd8:function(t,e,n){var r=n("ZCgT");function i(t){var e=r(t),n=e%1;return e===e?n?e-n:e:0}t.exports=i},TKrE:function(t,e,n){var r=n("qRkn"),i=n("dt0z"),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,a="\\u0300-\\u036f",s="\\ufe20-\\ufe2f",u="\\u20d0-\\u20ff",c=a+s+u,l="["+c+"]",f=RegExp(l,"g");function p(t){return t=i(t),t&&t.replace(o,r).replace(f,"")}t.exports=p},"U+yc":function(t,e){function n(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}t.exports=n},U1ZX:function(t,e){},UB5X:function(t,e,n){var r=n("NykK"),i=n("ExA7"),o="[object Number]";function a(t){return"number"==typeof t||i(t)&&r(t)==o}t.exports=a},Ucsi:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Symbol.for("INJECTION");function i(t,e,n,i){function o(){return i&&!Reflect.hasMetadata(r,this,e)&&Reflect.defineMetadata(r,n(),this,e),Reflect.hasMetadata(r,this,e)?Reflect.getMetadata(r,this,e):n()}function a(t){Reflect.defineMetadata(r,t,this,e)}Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:o,set:a})}function o(t,e){return function(n){return function(r,o){var a=function(){return t.get(n)};i(r,o,a,e)}}}function a(t,e){return function(n,r){return function(o,a){var s=function(){return t.getNamed(n,r)};i(o,a,s,e)}}}function s(t,e){return function(n,r,o){return function(a,s){var u=function(){return t.getTagged(n,r,o)};i(a,s,u,e)}}}function u(t,e){return function(n){return function(r,o){var a=function(){return t.getAll(n)};i(r,o,a,e)}}}e.makePropertyInjectDecorator=o,e.makePropertyInjectNamedDecorator=a,e.makePropertyInjectTaggedDecorator=s,e.makePropertyMultiInjectDecorator=u},V1cb:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t["Hover"]="hover",t["Click"]="click",t["Select"]="select",t["Active"]="active",t["Drag"]="drag"}(r||(r={}))},VIsB:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("Hel2");function i(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=o(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function o(t,e){if(t){if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=6378e3;function u(t,e){var n=t.dataArray,r=e.size,i=void 0===r?10:r,o=c(n,i),a=o.gridHash,s=o.gridOffset,u=h(a,s,e);return{yOffset:s.yOffset/2,xOffset:s.xOffset/2,radius:s.xOffset,type:"grid",dataArray:u}}function c(t,e){var n,r,o=1/0,a=-1/0,s=i(t);try{for(s.s();!(r=s.n()).done;){var u=r.value;n=u.coordinates[1],Number.isFinite(n)&&(o=n<o?n:o,a=n>a?n:a)}}catch(x){s.e(x)}finally{s.f()}var c=(o+a)/2,f=l(e,c);if(f.xOffset<=0||f.yOffset<=0)return{gridHash:{},gridOffset:f};var p,h={},d=i(t);try{for(d.s();!(p=d.n()).done;){var m=p.value,v=m.coordinates[1],g=m.coordinates[0];if(Number.isFinite(v)&&Number.isFinite(g)){var y=Math.floor((v+90)/f.yOffset),_=Math.floor((g+180)/f.xOffset),b="".concat(y,"-").concat(_);h[b]=h[b]||{count:0,points:[]},h[b].count+=1,h[b].points.push(m)}}}catch(x){d.e(x)}finally{d.f()}return{gridHash:h,gridOffset:f}}function l(t,e){var n=f(t),r=p(e,t);return{yOffset:n,xOffset:r}}function f(t){return t/s*(180/Math.PI)}function p(t,e){return e/s*(180/Math.PI)/Math.cos(t*Math.PI/180)}function h(t,e,n){return Object.keys(t).reduce((function(i,o,a){var s=o.split("-"),u=parseInt(s[0],10),c=parseInt(s[1],10),l={};if(n.field&&n.method){var f=r["c"].getColumn(t[o].points,n.field);l[n.method]=r["c"].statMap[n.method](f)}return Object.assign(l,{_id:a,coordinates:[e.xOffset*(c+.5)-180,e.yOffset*(u+.5)-90],rawData:t[o].points,count:t[o].count}),i.push(l),i}),[])}},VOtZ:function(t,e,n){var r=n("juv8"),i=n("MvSz");function o(t,e){return r(t,i(t),e)}t.exports=o},VmRL:function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,o,s,u,c,l,p,h=e&&e.length,d=h?e[0]*n:t.length,m=i(t,0,d,n,!0),v=[];if(!m||m.next===m.prev)return v;if(h&&(m=f(t,e,m,n)),t.length>80*n){r=s=t[0],o=u=t[1];for(var g=n;g<d;g+=n)c=t[g],l=t[g+1],c<r&&(r=c),l<o&&(o=l),c>s&&(s=c),l>u&&(u=l);p=Math.max(s-r,u-o),p=0!==p?1/p:0}return a(m,v,n,r,o,p),v}function i(t,e,n,r,i){var o,a;if(i===R(t,e,n,r)>0)for(o=e;o<n;o+=r)a=I(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=I(o,t[o],t[o+1],a);return a&&S(a,a.next)&&(O(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!S(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(O(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,p){if(t){!p&&f&&v(t,r,i,f);var h,d,m=t;while(t.prev!==t.next)if(h=t.prev,d=t.next,f?u(t,r,i,f):s(t))e.push(h.i/n),e.push(t.i/n),e.push(d.i/n),O(t),t=d.next,m=d.next;else if(t=d,t===m){p?1===p?(t=c(o(t),e,n),a(t,e,n,r,i,f,2)):2===p&&l(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(w(e,n,r)>=0)return!1;var i=t.next.next;while(i!==t.prev){if(b(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&w(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(w(i,o,a)>=0)return!1;var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=y(s,u,e,n,r),p=y(c,l,e,n,r),h=t.prevZ,d=t.nextZ;while(h&&h.z>=f&&d&&d.z<=p){if(h!==t.prev&&h!==t.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}while(h&&h.z>=f){if(h!==t.prev&&h!==t.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;h=h.prevZ}while(d&&d.z<=p){if(d!==t.prev&&d!==t.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!S(i,a)&&E(i,r,r.next,a)&&k(i,a)&&k(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),O(r),O(r.next),r=t=a),r=r.next}while(r!==t);return o(r)}function l(t,e,n,r,i,s){var u=t;do{var c=u.next.next;while(c!==u.prev){if(u.i!==c.i&&x(u,c)){var l=M(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,e,n,r,i,s),void a(l,e,n,r,i,s)}c=c.next}u=u.next}while(u!==t)}function f(t,e,n,r){var a,s,u,c,l,f=[];for(a=0,s=e.length;a<s;a++)u=e[a]*r,c=a<s-1?e[a+1]*r:t.length,l=i(t,u,c,r,!1),l===l.next&&(l.steiner=!0),f.push(_(l));for(f.sort(p),a=0;a<f.length;a++)h(f[a],n),n=o(n,n.next);return n}function p(t,e){return t.x-e.x}function h(t,e){if(e=d(t,e),e){var n=M(e,t);o(e,e.next),o(n,n.next)}}function d(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,f=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&b(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),k(r,t)&&(u<p||u===p&&(r.x>n.x||r.x===n.x&&m(n,r)))&&(n=r,p=u)),r=r.next}while(r!==c);return n}function m(t,e){return w(t.prev,t,e.prev)<0&&w(e.next,t,t.next)<0}function v(t,e,n,r){var i=t;do{null===i.z&&(i.z=y(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,g(i)}function g(t){var e,n,r,i,o,a,s,u,c=1;do{n=t,t=null,o=null,a=0;while(n){for(a++,r=n,s=0,e=0;e<c;e++)if(s++,r=r.nextZ,!r)break;u=c;while(s>0||u>0&&r)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1);return t}function y(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function _(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function b(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!C(t,e)&&(k(t,e)&&k(e,t)&&P(t,e)&&(w(t.prev,t,e.prev)||w(t,e.prev,e))||S(t,e)&&w(t.prev,t,t.next)>0&&w(e.prev,e,e.next)>0)}function w(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function S(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,r){var i=A(w(t,e,n)),o=A(w(t,e,r)),a=A(w(n,r,t)),s=A(w(n,r,e));return i!==o&&a!==s||(!(0!==i||!T(t,n,e))||(!(0!==o||!T(t,r,e))||(!(0!==a||!T(n,t,r))||!(0!==s||!T(n,e,r)))))}function T(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function C(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function k(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function P(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function M(t,e){var n=new L(t.i,t.x,t.y),r=new L(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function I(t,e,n,r){var i=new L(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function O(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function L(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(R(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(R(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var p=r[s]*n,h=r[s+1]*n,d=r[s+2]*n;f+=Math.abs((t[p]-t[d])*(t[h+1]-t[p+1])-(t[p]-t[h])*(t[d+1]-t[p+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},WFAs:function(t,e){var n=Array.isArray;t.exports=n},Wnft:function(t,e,n){t.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(t,e,n){var r=n("juv8"),i=n("7GkX");function o(t,e){return t&&r(e,i(e),t)}t.exports=o},XYm9:function(t,e,n){var r=n("+K+b");function i(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}t.exports=i},"Xt/L":function(t,e){function n(t,e,n){var r=-1,i=null==t?0:t.length;while(++r<i)if(n(e,t[r]))return!0;return!1}t.exports=n},Y8BV:function(t,e,n){"use strict";function r(t,e){var n=e.callback;return n&&(t.dataArray=t.dataArray.filter(n)),t}n.d(e,"a",(function(){return r}))},Yk9n:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm"),o=n("GXnB"),a=n("Ztfv"),s=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();function u(t){return function(e,n,s){if(void 0===t)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(e.name));var u=new o.Metadata(i.INJECT_TAG,t);"number"===typeof s?a.tagParameter(e,n,s,u):a.tagProperty(e,n,u)}}e.LazyServiceIdentifer=s,e.inject=u},Z1HP:function(t,e,n){var r=n("ycre"),i=n("quyA"),o=n("q4HE");function a(t){return i(t)?o(t):r(t)}t.exports=a},ZCgT:function(t,e,n){var r=n("tLB3"),i=1/0,o=17976931348623157e292;function a(t){if(!t)return 0===t?t:0;if(t=r(t),t===i||t===-i){var e=t<0?-1:1;return e*o}return t===t?t:0}t.exports=a},ZK94:function(t,e){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},ZaHm:function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"copy",(function(){return a})),n.d(e,"fromValues",(function(){return s})),n.d(e,"set",(function(){return u})),n.d(e,"identity",(function(){return c})),n.d(e,"transpose",(function(){return l})),n.d(e,"invert",(function(){return f})),n.d(e,"adjoint",(function(){return p})),n.d(e,"determinant",(function(){return h})),n.d(e,"multiply",(function(){return d})),n.d(e,"translate",(function(){return m})),n.d(e,"scale",(function(){return v})),n.d(e,"rotate",(function(){return g})),n.d(e,"rotateX",(function(){return y})),n.d(e,"rotateY",(function(){return _})),n.d(e,"rotateZ",(function(){return b})),n.d(e,"fromTranslation",(function(){return x})),n.d(e,"fromScaling",(function(){return w})),n.d(e,"fromRotation",(function(){return S})),n.d(e,"fromXRotation",(function(){return E})),n.d(e,"fromYRotation",(function(){return T})),n.d(e,"fromZRotation",(function(){return A})),n.d(e,"fromRotationTranslation",(function(){return C})),n.d(e,"fromQuat2",(function(){return k})),n.d(e,"getTranslation",(function(){return P})),n.d(e,"getScaling",(function(){return M})),n.d(e,"getRotation",(function(){return I})),n.d(e,"fromRotationTranslationScale",(function(){return O})),n.d(e,"fromRotationTranslationScaleOrigin",(function(){return L})),n.d(e,"fromQuat",(function(){return R})),n.d(e,"frustum",(function(){return D})),n.d(e,"perspective",(function(){return z})),n.d(e,"perspectiveFromFieldOfView",(function(){return j})),n.d(e,"ortho",(function(){return N})),n.d(e,"lookAt",(function(){return F})),n.d(e,"targetTo",(function(){return B})),n.d(e,"str",(function(){return U})),n.d(e,"frob",(function(){return V})),n.d(e,"add",(function(){return G})),n.d(e,"subtract",(function(){return q})),n.d(e,"multiplyScalar",(function(){return Z})),n.d(e,"multiplyScalarAndAdd",(function(){return H})),n.d(e,"exactEquals",(function(){return W})),n.d(e,"equals",(function(){return X})),n.d(e,"mul",(function(){return Y})),n.d(e,"sub",(function(){return K}));var r=n("yU0y");function i(){var t=new r["a"](16);return r["a"]!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function o(t){var e=new r["a"](16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function s(t,e,n,i,o,a,s,u,c,l,f,p,h,d,m,v){var g=new r["a"](16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=o,g[5]=a,g[6]=s,g[7]=u,g[8]=c,g[9]=l,g[10]=f,g[11]=p,g[12]=h,g[13]=d,g[14]=m,g[15]=v,g}function u(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=f,t[11]=p,t[12]=h,t[13]=d,t[14]=m,t[15]=v,t}function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function f(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],h=e[11],d=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,S=i*c-o*u,E=l*m-f*d,T=l*v-p*d,A=l*g-h*d,C=f*v-p*m,k=f*g-h*m,P=p*g-h*v,M=y*P-_*k+b*C+x*A-w*T+S*E;return M?(M=1/M,t[0]=(s*P-u*k+c*C)*M,t[1]=(i*k-r*P-o*C)*M,t[2]=(m*S-v*w+g*x)*M,t[3]=(p*w-f*S-h*x)*M,t[4]=(u*A-a*P-c*T)*M,t[5]=(n*P-i*A+o*T)*M,t[6]=(v*b-d*S-g*_)*M,t[7]=(l*S-p*b+h*_)*M,t[8]=(a*k-s*A+c*E)*M,t[9]=(r*A-n*k-o*E)*M,t[10]=(d*w-m*b+g*y)*M,t[11]=(f*b-l*w-h*y)*M,t[12]=(s*T-a*C-u*E)*M,t[13]=(n*C-r*T+i*E)*M,t[14]=(m*_-d*x-v*y)*M,t[15]=(l*x-f*_+p*y)*M,t):null}function p(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],h=e[11],d=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(p*g-h*v)-f*(u*g-c*v)+m*(u*h-c*p),t[1]=-(r*(p*g-h*v)-f*(i*g-o*v)+m*(i*h-o*p)),t[2]=r*(u*g-c*v)-s*(i*g-o*v)+m*(i*c-o*u),t[3]=-(r*(u*h-c*p)-s*(i*h-o*p)+f*(i*c-o*u)),t[4]=-(a*(p*g-h*v)-l*(u*g-c*v)+d*(u*h-c*p)),t[5]=n*(p*g-h*v)-l*(i*g-o*v)+d*(i*h-o*p),t[6]=-(n*(u*g-c*v)-a*(i*g-o*v)+d*(i*c-o*u)),t[7]=n*(u*h-c*p)-a*(i*h-o*p)+l*(i*c-o*u),t[8]=a*(f*g-h*m)-l*(s*g-c*m)+d*(s*h-c*f),t[9]=-(n*(f*g-h*m)-l*(r*g-o*m)+d*(r*h-o*f)),t[10]=n*(s*g-c*m)-a*(r*g-o*m)+d*(r*c-o*s),t[11]=-(n*(s*h-c*f)-a*(r*h-o*f)+l*(r*c-o*s)),t[12]=-(a*(f*v-p*m)-l*(s*v-u*m)+d*(s*p-u*f)),t[13]=n*(f*v-p*m)-l*(r*v-i*m)+d*(r*p-i*f),t[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+d*(r*u-i*s)),t[15]=n*(s*p-u*f)-a*(r*p-i*f)+l*(r*u-i*s),t}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],p=t[11],h=t[12],d=t[13],m=t[14],v=t[15],g=e*a-n*o,y=e*s-r*o,_=e*u-i*o,b=n*s-r*a,x=n*u-i*a,w=r*u-i*s,S=c*d-l*h,E=c*m-f*h,T=c*v-p*h,A=l*m-f*d,C=l*v-p*d,k=f*v-p*m;return g*k-y*C+_*A+b*T-x*E+w*S}function d(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],m=e[12],v=e[13],g=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*s+x*f+w*m,t[1]=_*i+b*u+x*p+w*v,t[2]=_*o+b*c+x*h+w*g,t[3]=_*a+b*l+x*d+w*y,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*r+b*s+x*f+w*m,t[5]=_*i+b*u+x*p+w*v,t[6]=_*o+b*c+x*h+w*g,t[7]=_*a+b*l+x*d+w*y,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*r+b*s+x*f+w*m,t[9]=_*i+b*u+x*p+w*v,t[10]=_*o+b*c+x*h+w*g,t[11]=_*a+b*l+x*d+w*y,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*r+b*s+x*f+w*m,t[13]=_*i+b*u+x*p+w*v,t[14]=_*o+b*c+x*h+w*g,t[15]=_*a+b*l+x*d+w*y,t}function m(t,e,n){var r,i,o,a,s,u,c,l,f,p,h,d,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=p,t[10]=h,t[11]=d,t[12]=r*m+s*v+f*g+e[12],t[13]=i*m+u*v+p*g+e[13],t[14]=o*m+c*v+h*g+e[14],t[15]=a*m+l*v+d*g+e[15]),t}function v(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function g(t,e,n,i){var o,a,s,u,c,l,f,p,h,d,m,v,g,y,_,b,x,w,S,E,T,A,C,k,P=i[0],M=i[1],I=i[2],O=Math.hypot(P,M,I);return O<r["b"]?null:(O=1/O,P*=O,M*=O,I*=O,o=Math.sin(n),a=Math.cos(n),s=1-a,u=e[0],c=e[1],l=e[2],f=e[3],p=e[4],h=e[5],d=e[6],m=e[7],v=e[8],g=e[9],y=e[10],_=e[11],b=P*P*s+a,x=M*P*s+I*o,w=I*P*s-M*o,S=P*M*s-I*o,E=M*M*s+a,T=I*M*s+P*o,A=P*I*s+M*o,C=M*I*s-P*o,k=I*I*s+a,t[0]=u*b+p*x+v*w,t[1]=c*b+h*x+g*w,t[2]=l*b+d*x+y*w,t[3]=f*b+m*x+_*w,t[4]=u*S+p*E+v*T,t[5]=c*S+h*E+g*T,t[6]=l*S+d*E+y*T,t[7]=f*S+m*E+_*T,t[8]=u*A+p*C+v*k,t[9]=c*A+h*C+g*k,t[10]=l*A+d*C+y*k,t[11]=f*A+m*C+_*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function y(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+p*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=p*i-u*r,t}function _(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-p*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+p*i,t}function b(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+p*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=p*i-u*r,t}function x(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function w(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e,n){var i,o,a,s=n[0],u=n[1],c=n[2],l=Math.hypot(s,u,c);return l<r["b"]?null:(l=1/l,s*=l,u*=l,c*=l,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+c*i,t[2]=c*s*a-u*i,t[3]=0,t[4]=s*u*a-c*i,t[5]=u*u*a+o,t[6]=c*u*a+s*i,t[7]=0,t[8]=s*c*a+u*i,t[9]=u*c*a-s*i,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function E(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function T(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function C(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,p=r*c,h=i*u,d=i*c,m=o*c,v=a*s,g=a*u,y=a*c;return t[0]=1-(h+m),t[1]=f+y,t[2]=p-g,t[3]=0,t[4]=f-y,t[5]=1-(l+m),t[6]=d+v,t[7]=0,t[8]=p+g,t[9]=d-v,t[10]=1-(l+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function k(t,e){var n=new r["a"](3),i=-e[0],o=-e[1],a=-e[2],s=e[3],u=e[4],c=e[5],l=e[6],f=e[7],p=i*i+o*o+a*a+s*s;return p>0?(n[0]=2*(u*s+f*i+c*a-l*o)/p,n[1]=2*(c*s+f*o+l*i-u*a)/p,n[2]=2*(l*s+f*a+u*o-c*i)/p):(n[0]=2*(u*s+f*i+c*a-l*o),n[1]=2*(c*s+f*o+l*i-u*a),n[2]=2*(l*s+f*a+u*o-c*i)),C(t,e,n),t}function P(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function M(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function I(t,e){var n=new r["a"](3);M(n,e);var i=1/n[0],o=1/n[1],a=1/n[2],s=e[0]*i,u=e[1]*o,c=e[2]*a,l=e[4]*i,f=e[5]*o,p=e[6]*a,h=e[8]*i,d=e[9]*o,m=e[10]*a,v=s+f+m,g=0;return v>0?(g=2*Math.sqrt(v+1),t[3]=.25*g,t[0]=(p-d)/g,t[1]=(h-c)/g,t[2]=(u-l)/g):s>f&&s>m?(g=2*Math.sqrt(1+s-f-m),t[3]=(p-d)/g,t[0]=.25*g,t[1]=(u+l)/g,t[2]=(h+c)/g):f>m?(g=2*Math.sqrt(1+f-s-m),t[3]=(h-c)/g,t[0]=(u+l)/g,t[1]=.25*g,t[2]=(p+d)/g):(g=2*Math.sqrt(1+m-s-f),t[3]=(u-l)/g,t[0]=(h+c)/g,t[1]=(p+d)/g,t[2]=.25*g),t}function O(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,l=a+a,f=i*u,p=i*c,h=i*l,d=o*c,m=o*l,v=a*l,g=s*u,y=s*c,_=s*l,b=r[0],x=r[1],w=r[2];return t[0]=(1-(d+v))*b,t[1]=(p+_)*b,t[2]=(h-y)*b,t[3]=0,t[4]=(p-_)*x,t[5]=(1-(f+v))*x,t[6]=(m+g)*x,t[7]=0,t[8]=(h+y)*w,t[9]=(m-g)*w,t[10]=(1-(f+d))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function L(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,l=a+a,f=s+s,p=o*c,h=o*l,d=o*f,m=a*l,v=a*f,g=s*f,y=u*c,_=u*l,b=u*f,x=r[0],w=r[1],S=r[2],E=i[0],T=i[1],A=i[2],C=(1-(m+g))*x,k=(h+b)*x,P=(d-_)*x,M=(h-b)*w,I=(1-(p+g))*w,O=(v+y)*w,L=(d+_)*S,R=(v-y)*S,D=(1-(p+m))*S;return t[0]=C,t[1]=k,t[2]=P,t[3]=0,t[4]=M,t[5]=I,t[6]=O,t[7]=0,t[8]=L,t[9]=R,t[10]=D,t[11]=0,t[12]=n[0]+E-(C*E+M*T+L*A),t[13]=n[1]+T-(k*E+I*T+R*A),t[14]=n[2]+A-(P*E+O*T+D*A),t[15]=1,t}function R(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,p=i*a,h=i*s,d=i*u,m=o*a,v=o*s,g=o*u;return t[0]=1-f-d,t[1]=l+g,t[2]=p-v,t[3]=0,t[4]=l-g,t[5]=1-c-d,t[6]=h+m,t[7]=0,t[8]=p+v,t[9]=h-m,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function D(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function z(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function j(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function N(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}function F(t,e,n,i){var o,a,s,u,l,f,p,h,d,m,v=e[0],g=e[1],y=e[2],_=i[0],b=i[1],x=i[2],w=n[0],S=n[1],E=n[2];return Math.abs(v-w)<r["b"]&&Math.abs(g-S)<r["b"]&&Math.abs(y-E)<r["b"]?c(t):(p=v-w,h=g-S,d=y-E,m=1/Math.hypot(p,h,d),p*=m,h*=m,d*=m,o=b*d-x*h,a=x*p-_*d,s=_*h-b*p,m=Math.hypot(o,a,s),m?(m=1/m,o*=m,a*=m,s*=m):(o=0,a=0,s=0),u=h*s-d*a,l=d*o-p*s,f=p*a-h*o,m=Math.hypot(u,l,f),m?(m=1/m,u*=m,l*=m,f*=m):(u=0,l=0,f=0),t[0]=o,t[1]=u,t[2]=p,t[3]=0,t[4]=a,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=f,t[10]=d,t[11]=0,t[12]=-(o*v+a*g+s*y),t[13]=-(u*v+l*g+f*y),t[14]=-(p*v+h*g+d*y),t[15]=1,t)}function B(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],l=i-n[0],f=o-n[1],p=a-n[2],h=l*l+f*f+p*p;h>0&&(h=1/Math.sqrt(h),l*=h,f*=h,p*=h);var d=u*p-c*f,m=c*l-s*p,v=s*f-u*l;return h=d*d+m*m+v*v,h>0&&(h=1/Math.sqrt(h),d*=h,m*=h,v*=h),t[0]=d,t[1]=m,t[2]=v,t[3]=0,t[4]=f*v-p*m,t[5]=p*d-l*v,t[6]=l*m-f*d,t[7]=0,t[8]=l,t[9]=f,t[10]=p,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function U(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function V(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function G(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function q(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Z(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function H(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function W(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function X(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],p=t[9],h=t[10],d=t[11],m=t[12],v=t[13],g=t[14],y=t[15],_=e[0],b=e[1],x=e[2],w=e[3],S=e[4],E=e[5],T=e[6],A=e[7],C=e[8],k=e[9],P=e[10],M=e[11],I=e[12],O=e[13],L=e[14],R=e[15];return Math.abs(n-_)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-b)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-x)<=r["b"]*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-w)<=r["b"]*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=r["b"]*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-E)<=r["b"]*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-T)<=r["b"]*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(l-A)<=r["b"]*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-C)<=r["b"]*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-k)<=r["b"]*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(h-P)<=r["b"]*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-M)<=r["b"]*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(m-I)<=r["b"]*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-O)<=r["b"]*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(g-L)<=r["b"]*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(y-R)<=r["b"]*Math.max(1,Math.abs(y),Math.abs(R))}var Y=d,K=q},Ztfv:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm");function o(t,e,n,r){var o=i.TAGGED;s(o,t,e,r,n)}function a(t,e,n){var r=i.TAGGED_PROP;s(r,t.constructor,e,n)}function s(t,e,n,i,o){var a={},s="number"===typeof o,u=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(a=Reflect.getMetadata(t,e));var c=a[u];if(Array.isArray(c))for(var l=0,f=c;l<f.length;l++){var p=f[l];if(p.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+p.key.toString())}else c=[];c.push(i),a[u]=c,Reflect.defineMetadata(t,a,e)}function u(t,e){Reflect.decorate(t,e)}function c(t,e){return function(n,r){e(n,r,t)}}function l(t,e,n){"number"===typeof n?u([c(n,t)],e):"string"===typeof n?Reflect.decorate([t],e,n):u([t],e)}e.tagParameter=o,e.tagProperty=a,e.decorate=l},ZxFD:function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"fromValues",(function(){return a})),n.d(e,"copy",(function(){return s})),n.d(e,"set",(function(){return u})),n.d(e,"add",(function(){return c})),n.d(e,"subtract",(function(){return l})),n.d(e,"multiply",(function(){return f})),n.d(e,"divide",(function(){return p})),n.d(e,"ceil",(function(){return h})),n.d(e,"floor",(function(){return d})),n.d(e,"min",(function(){return m})),n.d(e,"max",(function(){return v})),n.d(e,"round",(function(){return g})),n.d(e,"scale",(function(){return y})),n.d(e,"scaleAndAdd",(function(){return _})),n.d(e,"distance",(function(){return b})),n.d(e,"squaredDistance",(function(){return x})),n.d(e,"length",(function(){return w})),n.d(e,"squaredLength",(function(){return S})),n.d(e,"negate",(function(){return E})),n.d(e,"inverse",(function(){return T})),n.d(e,"normalize",(function(){return A})),n.d(e,"dot",(function(){return C})),n.d(e,"cross",(function(){return k})),n.d(e,"lerp",(function(){return P})),n.d(e,"random",(function(){return M})),n.d(e,"transformMat2",(function(){return I})),n.d(e,"transformMat2d",(function(){return O})),n.d(e,"transformMat3",(function(){return L})),n.d(e,"transformMat4",(function(){return R})),n.d(e,"rotate",(function(){return D})),n.d(e,"angle",(function(){return z})),n.d(e,"zero",(function(){return j})),n.d(e,"str",(function(){return N})),n.d(e,"exactEquals",(function(){return F})),n.d(e,"equals",(function(){return B})),n.d(e,"len",(function(){return U})),n.d(e,"sub",(function(){return V})),n.d(e,"mul",(function(){return G})),n.d(e,"div",(function(){return q})),n.d(e,"dist",(function(){return Z})),n.d(e,"sqrDist",(function(){return H})),n.d(e,"sqrLen",(function(){return W})),n.d(e,"forEach",(function(){return X}));var r=n("yU0y");function i(){var t=new r["a"](2);return r["a"]!=Float32Array&&(t[0]=0,t[1]=0),t}function o(t){var e=new r["a"](2);return e[0]=t[0],e[1]=t[1],e}function a(t,e){var n=new r["a"](2);return n[0]=t,n[1]=e,n}function s(t,e){return t[0]=e[0],t[1]=e[1],t}function u(t,e,n){return t[0]=e,t[1]=n,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function f(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function p(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function h(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function d(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function m(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function v(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function y(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function _(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function b(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function x(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function w(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function S(t){var e=t[0],n=t[1];return e*e+n*n}function E(t,e){return t[0]=-e[0],t[1]=-e[1],t}function T(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function A(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function C(t,e){return t[0]*e[0]+t[1]*e[1]}function k(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function P(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function M(t,e){e=e||1;var n=2*r["c"]()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function I(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function O(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function L(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function R(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function D(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+n[0],t[1]=i*a+o*s+n[1],t}function z(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),s=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function j(t){return t[0]=0,t[1]=0,t}function N(t){return"vec2("+t[0]+", "+t[1]+")"}function F(t,e){return t[0]===e[0]&&t[1]===e[1]}function B(t,e){var n=t[0],i=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(a))}var U=w,V=l,G=f,q=p,Z=b,H=x,W=S,X=function(){var t=i();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}()},ZzCi:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(t){return function(e,n,a){var s=new i.Metadata(r.NAMED_TAG,t);"number"===typeof a?o.tagParameter(e,n,a,s):o.tagProperty(e,n,s)}}e.named=a},a5Wf:function(t,e,n){"use strict";n.r(e);n("IzEo");var r=n("bx4M"),i=(n("14J3"),n("BMrR")),o=(n("jCWc"),n("kPKH")),a=n("fWQN"),s=n("mtLc"),u=n("yKVA"),c=n("879j"),l=(n("aHsQ"),n("sGsY")),f=n("9kvl"),p=n("q1tI"),h=n.n(p),d=n("Hx5s"),m=n("ZhIB"),v=n.n(m),g=n("yP6+"),y=n("0Owb");function _(t){var e=t.style;e.height="100%";var n=parseInt("".concat(getComputedStyle(t).height),10),r=parseInt("".concat(getComputedStyle(t).paddingTop),10)+parseInt("".concat(getComputedStyle(t).paddingBottom),10);return n-r}function b(t){if(!t)return 0;var e=t,n=_(e),r=e.parentNode;return r&&(n=_(r)),n}function x(){return function(t){var e=function(e){Object(u["a"])(r,e);var n=Object(c["a"])(r);function r(){var t;Object(a["a"])(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t=n.call.apply(n,[this].concat(i)),t.state={computedHeight:0},t.root=null,t.handleRoot=function(e){t.root=e},t}return Object(s["a"])(r,[{key:"componentDidMount",value:function(){var t=this.props.height;if(!t&&this.root){var e=b(this.root);this.setState({computedHeight:e}),e<1&&(e=b(this.root),this.setState({computedHeight:e}))}}},{key:"render",value:function(){var e=this.props.height,n=this.state.computedHeight,r=e||n;return h.a.createElement("div",{ref:this.handleRoot},r>0&&h.a.createElement(t,Object(y["a"])({},this.props,{height:r})))}}]),r}(h.a.Component);return e}}var w=x,S=g["Guide"].Arc,E=g["Guide"].Html,T=g["Guide"].Line,A=function(t){switch(t){case"2":return"\u5dee";case"4":return"\u4e2d";case"6":return"\u826f";case"8":return"\u4f18";default:return""}};g["Shape"].registerShape&&g["Shape"].registerShape("point","pointer",{drawShape:function(t,e){var n=t.points[0];n=this.parsePoint(n);var r=this.parsePoint({x:0,y:0});return e.addShape("line",{attrs:{x1:r.x,y1:r.y,x2:n.x,y2:n.y,stroke:t.color,lineWidth:2,lineCap:"round"}}),e.addShape("circle",{attrs:{x:r.x,y:r.y,r:6,stroke:t.color,lineWidth:3,fill:"#fff"}})}});var C=function(t){var e=t.title,n=t.height,r=void 0===n?1:n,i=t.percent,o=t.forceFit,a=void 0===o||o,s=t.formatter,u=void 0===s?A:s,c=t.color,l=void 0===c?"#2F9CFF":c,f=t.bgColor,p=void 0===f?"#F0F2F5":f,d={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},m=[{value:i/10}],v=function(){return'\n  <div style="width: 300px;text-align: center;font-size: 12px!important;">\n    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">'.concat(e,'</div>\n    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">\n      ').concat((10*m[0].value).toFixed(2),"%\n    </div>\n  </div>")},y={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return h.a.createElement(g["Chart"],{height:r,data:m,scale:d,padding:[-16,0,16,0],forceFit:a},h.a.createElement(g["Coord"],{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),h.a.createElement(g["Axis"],{name:"1",line:void 0}),h.a.createElement(g["Axis"],{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:u,textStyle:y}}),h.a.createElement(g["Guide"],null,h.a.createElement(T,{start:[3,.905],end:[3,.85],lineStyle:{stroke:l,lineDash:void 0,lineWidth:2}}),h.a.createElement(T,{start:[5,.905],end:[5,.85],lineStyle:{stroke:l,lineDash:void 0,lineWidth:3}}),h.a.createElement(T,{start:[7,.905],end:[7,.85],lineStyle:{stroke:l,lineDash:void 0,lineWidth:3}}),h.a.createElement(S,{start:[0,.965],end:[10,.965],style:{stroke:p,lineWidth:10}}),h.a.createElement(S,{start:[0,.965],end:[m[0].value,.965],style:{stroke:l,lineWidth:10}}),h.a.createElement(E,{position:["50%","95%"],html:v()})),h.a.createElement(g["Geom"],{line:!1,type:"point",position:"value*1",shape:"pointer",color:l,active:!1}))},k=w()(C),P=n("k1fw"),M=n("iz+Y"),I=n.n(M),O=function(t){var e=t.height,n=void 0===e?1:e,r=t.data,i=void 0===r?[]:r,o=t.forceFit,a=void 0===o||o,s=t.color,u=void 0===s?"rgba(24, 144, 255, 0.2)":s,c=t.borderColor,l=void 0===c?"#1089ff":c,f=t.scale,p=void 0===f?{x:{},y:{}}:f,d=t.borderWidth,m=void 0===d?2:d,v=t.line,_=t.xAxis,b=t.yAxis,x=t.animate,w=void 0===x||x,S=[36,5,30,5],E={x:Object(P["a"])({type:"cat",range:[0,1]},p.x),y:Object(P["a"])({min:0},p.y)},T=["x*y",function(t,e){return{name:t,value:e}}],A=n+54;return h.a.createElement("div",{className:I.a.miniChart,style:{height:n}},h.a.createElement("div",{className:I.a.chartContent},n>0&&h.a.createElement(g["Chart"],{animate:w,scale:E,height:A,forceFit:a,data:i,padding:S},h.a.createElement(g["Axis"],Object(y["a"])({key:"axis-x",name:"x",label:null,line:null,tickLine:null,grid:null},_)),h.a.createElement(g["Axis"],Object(y["a"])({key:"axis-y",name:"y",label:null,line:null,tickLine:null,grid:null},b)),h.a.createElement(g["Tooltip"],{showTitle:!1,crosshairs:!1}),h.a.createElement(g["Geom"],{type:"area",position:"x*y",color:u,tooltip:T,shape:"smooth",style:{fillOpacity:1}}),v?h.a.createElement(g["Geom"],{type:"line",position:"x*y",shape:"smooth",color:l,size:m,tooltip:!1}):h.a.createElement("span",{style:{display:"none"}}))))},L=w()(O),R=(n("/zsF"),n("PArb")),D=n("jrin"),z=n("cQSq"),j=n.n(z),N=n("9/5/"),F=n.n(N),B=n("Jssm"),U=n.n(B),V=n("TSYQ"),G=n.n(V),q=n("d9mD"),Z=n.n(q),H=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;Object(a["a"])(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.state={legendData:[],legendBlock:!1},t.chart=void 0,t.root=void 0,t.requestRef=0,t.resize=F()((function(){var e=t.props.hasLegend,n=t.state.legendBlock;e&&t.root?t.root&&t.root.parentNode&&t.root.parentNode.clientWidth<=380?n||t.setState({legendBlock:!0}):n&&t.setState({legendBlock:!1}):window.removeEventListener("resize",t.resize)}),300),t.getG2Instance=function(e){t.chart=e,requestAnimationFrame((function(){t.getLegendData(),t.resize()}))},t.getLegendData=function(){if(t.chart){var e=t.chart.getAllGeoms()[0];if(e){var n=e.get("dataArray")||[],r=n.map((function(t){var e=t[0]._origin;return e.color=t[0].color,e.checked=!0,e}));t.setState({legendData:r})}}},t.handleRoot=function(e){t.root=e},t.handleLegendClick=function(e,n){var r=e;r.checked=!r.checked;var i=t.state.legendData;i[n]=r;var o=i.filter((function(t){return t.checked})).map((function(t){return t.x}));t.chart&&t.chart.filter("x",(function(t){return o.indexOf("".concat(t))>-1})),t.setState({legendData:i})},t}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",(function(){t.requestRef=requestAnimationFrame((function(){return t.resize()}))}),{passive:!0})}},{key:"componentDidUpdate",value:function(t){var e=this.props.data;e!==t.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var t,e,n=this,r=this.props,i=r.valueFormat,o=r.subTitle,a=r.total,s=r.hasLegend,u=void 0!==s&&s,c=r.className,l=r.style,f=r.height,p=void 0===f?0:f,d=r.forceFit,m=void 0===d||d,v=r.percent,y=r.color,_=r.inner,b=void 0===_?.75:_,x=r.animate,w=void 0===x||x,S=r.colors,E=r.lineWidth,T=void 0===E?1:E,A=this.state,C=A.legendData,k=A.legendBlock,P=G()(Z.a.pie,c,(t={},Object(D["a"])(t,Z.a.hasLegend,!!u),Object(D["a"])(t,Z.a.legendBlock,k),t)),M=this.props,I=M.data,O=M.selected,L=void 0===O||O,j=M.tooltip,N=void 0===j||j,F=I||[],B=L,V=N,q=S;F=F||[],B=B||!0,V=V||!0;var H={x:{type:"cat",range:[0,1]},y:{min:0}};(v||0===v)&&(B=!1,V=!1,e=function(t){return"\u5360\u6bd4"===t?y||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},F=[{x:"\u5360\u6bd4",y:parseFloat("".concat(v))},{x:"\u53cd\u6bd4",y:100-parseFloat("".concat(v))}]);var W=["x*percent",function(t,e){return{name:t,value:"".concat((100*e).toFixed(2),"%")}}],X=[12,0,12,0],Y=new z["DataView"];return Y.source(F).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),h.a.createElement("div",{ref:this.handleRoot,className:P,style:l},h.a.createElement(U.a,{maxFontSize:25},h.a.createElement("div",{className:Z.a.chart},h.a.createElement(g["Chart"],{scale:H,height:p,forceFit:m,data:Y,padding:X,animate:w,onGetG2Instance:this.getG2Instance},!!V&&h.a.createElement(g["Tooltip"],{showTitle:!1}),h.a.createElement(g["Coord"],{type:"theta",innerRadius:b}),h.a.createElement(g["Geom"],{style:{lineWidth:T,stroke:"#fff"},tooltip:V?W:void 0,type:"intervalStack",position:"percent",color:["x",v||0===v?e:q],selected:B})),(o||a)&&h.a.createElement("div",{className:Z.a.total},o&&h.a.createElement("h4",{className:"pie-sub-title"},o),a&&h.a.createElement("div",{className:"pie-stat"},"function"===typeof a?a():a)))),u&&h.a.createElement("ul",{className:Z.a.legend},C.map((function(t,e){return h.a.createElement("li",{key:t.x,onClick:function(){return n.handleLegendClick(t,e)}},h.a.createElement("span",{className:Z.a.dot,style:{backgroundColor:t.checked?t.color:"#aaa"}}),h.a.createElement("span",{className:Z.a.legendTitle},t.x),h.a.createElement(R["a"],{type:"vertical"}),h.a.createElement("span",{className:Z.a.percent},"".concat((Number.isNaN(t.percent)?0:100*t.percent).toFixed(2),"%")),h.a.createElement("span",{className:Z.a.value},i?i(t.y):t.y))}))))}}]),n}(p["Component"]),W=w()(H),X=n("tJVT"),Y=n("1XEM"),K=n.n(Y),J="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",Q=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;Object(a["a"])(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.state={dv:null,height:0,width:0},t.requestRef=0,t.isUnmount=!1,t.root=void 0,t.imageMask=void 0,t.resize=function(){t.requestRef=requestAnimationFrame((function(){t.renderChart(t.props)}))},t.saveRootRef=function(e){t.root=e},t.initTagCloud=function(){function t(t){return Object(P["a"])(Object(P["a"])({},t.style),{},{fillOpacity:t.opacity,fontSize:t.origin._origin.size,rotate:t.origin._origin.rotate,text:t.origin._origin.text,textAlign:"center",fontFamily:t.origin._origin.font,fill:t.color,textBaseline:"Alphabetic"})}g["Shape"].registerShape("point","cloud",{drawShape:function(e,n){var r=t(e);return n.addShape("text",{attrs:Object(P["a"])(Object(P["a"])({},r),{},{x:e.x,y:e.y})})}})},t.renderChart=F()((function(e){var n=e||t.props,r=n.data,i=n.height;if(!(r.length<1)&&t.root){var o=i,a=t.root.offsetWidth,s=function(){var e=(new j.a.View).source(r),n=e.range("value"),i=Object(X["a"])(n,2),s=i[0],u=i[1];e.transform({type:"tag-cloud",fields:["name","value"],imageMask:t.imageMask,font:"Verdana",size:[a,o],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(t){var e=Math.pow((t.value-s)/(u-s),2);return 12.5*e+5}}),t.isUnmount||t.setState({dv:e,width:a,height:o})};t.imageMask?s():(t.imageMask=new Image,t.imageMask.crossOrigin="",t.imageMask.src=J,t.imageMask.onload=s)}}),200),t}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){var t=this;requestAnimationFrame((function(){t.initTagCloud(),t.renderChart(t.props)})),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(t){var e=this.props.data;t&&JSON.stringify(t.data)!==JSON.stringify(e)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.height,r=this.state,i=r.dv,o=r.width,a=r.height;return h.a.createElement("div",{className:G()(K.a.tagCloud,e),style:{width:"100%",height:n},ref:this.saveRootRef},i&&h.a.createElement(g["Chart"],{width:o,height:a,data:i,padding:0,scale:{x:{nice:!1},y:{nice:!1}}},h.a.createElement(g["Tooltip"],{showTitle:!1}),h.a.createElement(g["Coord"],{reflect:"y"}),h.a.createElement(g["Geom"],{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(t,e){return{name:t,value:e}}]})))}}]),n}(p["Component"]),$=w()(Q),tt=n("CIdX"),et=n.n(tt),nt=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;Object(a["a"])(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.state={radio:1},t.timer=0,t.root=null,t.node=null,t.resize=function(){if(t.root){var e=t.props.height,n=void 0===e?1:e,r=t.root.parentNode,i=r.offsetWidth;t.setState({radio:i<n?i/n:1})}},t}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){var t=this;this.renderChart(),this.resize(),window.addEventListener("resize",(function(){requestAnimationFrame((function(){return t.resize()}))}),{passive:!0})}},{key:"componentDidUpdate",value:function(t){var e=this.props.percent;t.percent!==e&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(t){var e=this.props,n=e.percent,r=e.color,i=void 0===r?"#1890FF":r,o=n/100,a=this;if(cancelAnimationFrame(this.timer),this.node&&(0===o||o)){var s=this.node,u=s.getContext("2d");if(u){var c=s.width,l=s.height,f=c/2,p=2,h=f-p;u.beginPath(),u.lineWidth=2*p;for(var d=c-p,m=d/8,v=.2,g=v,y=p,_=0,b=0,x=.005,w=[],S=f-p,E=-Math.PI/2,T=!0,A=E;A<E+2*Math.PI;A+=1/(8*Math.PI))w.push([f+S*Math.cos(A),f+S*Math.sin(A)]);var C=w.shift();u.strokeStyle=i,u.moveTo(C[0],C[1]),P()}}function k(){if(u){u.beginPath(),u.save();for(var t=[],e=y;e<=y+d;e+=20/d){var n=_+(y+e)/m,r=Math.sin(n)*g,o=e,a=2*h*(1-b)+(f-h)-m*r;u.lineTo(o,a),t.push([o,a])}var s=t.shift();u.lineTo(y+d,l),u.lineTo(y,l),u.lineTo(s[0],s[1]);var c=u.createLinearGradient(0,0,0,l);c.addColorStop(0,"#ffffff"),c.addColorStop(1,i),u.fillStyle=c,u.fill(),u.restore()}}function P(){if(u){if(u.clearRect(0,0,c,l),T&&"update"!==t)if(w.length){var e=w.shift();u.lineTo(e[0],e[1]),u.stroke()}else T=!1,u.lineTo(C[0],C[1]),u.stroke(),w=[],u.globalCompositeOperation="destination-over",u.beginPath(),u.lineWidth=p,u.arc(f,f,S,0,2*Math.PI,!0),u.beginPath(),u.save(),u.arc(f,f,f-3*p,0,2*Math.PI,!0),u.restore(),u.clip(),u.fillStyle=i;else{if(o>=.85){if(g>v/4){var n=.01*v;g-=n}}else if(o<=.1){if(g<1.5*v){var r=.01*v;g+=r}}else{if(g<=v){var s=.01*v;g+=s}if(g>=v){var h=.01*v;g-=h}}o-b>0&&(b+=x),o-b<0&&(b-=x),_+=.07,k()}a.timer=requestAnimationFrame(P)}}}},{key:"render",value:function(){var t=this,e=this.state.radio,n=this.props,r=n.percent,i=n.title,o=n.height,a=void 0===o?1:o;return h.a.createElement("div",{className:et.a.waterWave,ref:function(e){return t.root=e},style:{transform:"scale(".concat(e,")")}},h.a.createElement("div",{style:{width:a,height:a,overflow:"hidden"}},h.a.createElement("canvas",{className:et.a.waterWaveCanvasWrapper,ref:function(e){return t.node=e},width:2*a,height:2*a})),h.a.createElement("div",{className:et.a.text,style:{width:a}},i&&h.a.createElement("span",null,i),h.a.createElement("h4",null,r,"%")))}}]),n}(p["Component"]),rt=w()(nt),it=n("WmNS"),ot=n.n(it),at=n("9og8"),st=Object(p["createContext"])({});function ut(){return Object(p["useContext"])(st)}var ct,lt,ft,pt,ht,dt,mt=n("lSNA"),vt=n.n(mt),gt=n("J4zp"),yt=n.n(gt),_t=n("8ml+"),bt=n("lwsE"),xt=n.n(bt),wt=n("W8MJ"),St=n.n(wt),Et=n("7W2i"),Tt=n.n(Et),At=n("a1gu"),Ct=n.n(At),kt=n("Nsbk"),Pt=n.n(kt),Mt=n("yG8O"),It=n.n(Mt),Ot=n("U+yc"),Lt=n.n(Ot),Rt=(n("1ABj"),n("h1nZ"));function Dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function zt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(n),!0).forEach((function(e){vt()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var jt,Nt,Ft,Bt,Ut,Vt,Gt,qt,Zt,Ht,Wt,Xt,Yt,Kt,Jt=(ct=Object(Rt["lazyInject"])(Rt["TYPES"].ILogService),lt=Object(Rt["lazyInject"])(Rt["TYPES"].IGlobalConfigService),dt=function(){function t(e){xt()(this,t),It()(this,"logger",pt,this),It()(this,"configService",ht,this),this.config=void 0,this.config=e}return St()(t,[{key:"setContainer",value:function(t,e){t.bind(Rt["TYPES"].MapConfig).toConstantValue(zt(zt({},this.config),{},{id:e})),t.bind(Rt["TYPES"].IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),t}(),ft=dt,pt=Lt()(ft.prototype,"logger",[ct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=Lt()(ft.prototype,"configService",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft),Qt=n("o0o1"),$t=n.n(Qt),te=n("QILm"),ee=n.n(te),ne=n("yXPU"),re=n.n(ne),ie=n("Hel2"),oe=n("IOcx"),ae=n("4cb6"),se={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},ue=Math.PI/180,ce=function(){function t(){xt()(this,t),this.projectionMatrix=oe["a"].create(),this.viewMatrix=oe["a"].create(),this.viewProjectionMatrix=oe["a"].create(),this.ViewProjectionMatrixUncentered=oe["a"].create(),this.viewUncenteredMatrix=oe["a"].create(),this.zoom=void 0,this.center=void 0}return St()(t,[{key:"syncWithMapCamera",value:function(t){var e=t.zoom,n=void 0===e?1:e,r=t.pitch,i=void 0===r?0:r,o=t.bearing,a=void 0===o?0:o,s=t.center,u=void 0===s?[0,0]:s,c=t.offsetOrigin,l=void 0===c?[0,0]:c,f=t.cameraHeight,p=void 0===f?1:f,h=t.aspect,d=void 0===h?1:h,m=t.near,v=void 0===m?.1:m,g=t.far,y=void 0===g?1e3:g,_=t.fov,b=void 0===_?0:_;this.zoom=n,this.center=u;var x=i*ue,w=(360-a)*ue;oe["a"].perspective(this.projectionMatrix,b,d,v,y);var S=oe["c"].fromValues(p*Math.sin(x)*Math.sin(w),-p*Math.sin(x)*Math.cos(w),p*Math.cos(x)),E=oe["c"].fromValues(-Math.cos(x)*Math.sin(w),Math.cos(x)*Math.cos(w),Math.sin(x));oe["a"].lookAt(this.viewMatrix,S,oe["c"].fromValues(0,0,0),E),this.viewUncenteredMatrix=oe["a"].clone(this.viewMatrix),oe["a"].translate(this.viewMatrix,this.viewMatrix,oe["c"].fromValues(-l[0],l[1],0)),oe["a"].multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),oe["a"].multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var t=yt()(this.center,2),e=t[0],n=t[1];return[e,n]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,e){var n=85.0511287798,r=Math.max(Math.min(n,t[1]),-n),i=256<<20,o=Math.PI/180,a=t[0]*o,s=r*o;s=Math.log(Math.tan(Math.PI/4+s/2));var u=.5/Math.PI,c=.5,l=-.5/Math.PI;return o=.5,a=i*(u*a+c)-215440491,s=-(i*(l*s+o)-106744817),[a,s]}}]),t}();function le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?le(Object(n),!0).forEach((function(e){vt()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n("BGjm")("/* @antv/l7-maps */\n.amap-logo{\n display: none !important;\n}\n");var pe=0;window.forceWebGL=!0;var he="15cd8a57710d40c9b7c0e3cc120f1200",de="1.4.15",me="amap-script",ve=!1,ge=[],ye=12,_e=(jt=Object(ae["injectable"])(),Nt=Object(ae["inject"])(Rt["TYPES"].IGlobalConfigService),Ft=Object(ae["inject"])(Rt["TYPES"].ILogService),Bt=Object(ae["inject"])(Rt["TYPES"].MapConfig),Ut=Object(ae["inject"])(Rt["TYPES"].ICoordinateSystemService),Vt=Object(ae["inject"])(Rt["TYPES"].IEventEmitter),jt((Kt=function(){function t(){var e=this;xt()(this,t),this.map=void 0,It()(this,"configService",Zt,this),It()(this,"logger",Ht,this),It()(this,"config",Wt,this),It()(this,"coordinateSystemService",Xt,this),It()(this,"eventEmitter",Yt,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(t){var n=t.camera,r=n.fov,i=n.near,o=n.far,a=n.height,s=n.pitch,u=n.rotation,c=n.aspect,l=n.position,f=e.getCenter(),p=f.lng,h=f.lat;e.cameraChangedCallback&&(e.viewport.syncWithMapCamera({aspect:c,bearing:360-u,far:o,fov:r,cameraHeight:a,near:i,pitch:s,zoom:e.map.getZoom()-1,center:[p,h],offsetOrigin:[l.x,l.y]}),e.viewport.getZoom()>ye?e.coordinateSystemService.setCoordinateSystem(Rt["CoordinateSystem"].P20_OFFSET):e.coordinateSystemService.setCoordinateSystem(Rt["CoordinateSystem"].P20),e.cameraChangedCallback(e.viewport))}}return St()(t,[{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(null!==t){var e=t.getElementsByClassName("amap-maps")[0];this.markerContainer=ie["a"].create("div","l7-marker-container",e)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,e){-1!==Rt["MapServiceEvent"].indexOf(t)?this.eventEmitter.on(t,e):this.map.on(t,e)}},{key:"off",value:function(t,e){-1!==Rt["MapServiceEvent"].indexOf(t)?this.eventEmitter.off(t,e):this.map.off(t,e)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return null===(t=this.map.getContainer())||void 0===t?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){var t=this.map.getCenter();return{lng:t.getLng(),lat:t.getLat()}}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),e=t.getNorthEast(),n=t.getSouthWest(),r=this.getCenter(),i=r.lng>e.getLng()||r.lng<n.getLng()?180-e.getLng():e.getLng(),o=r.lng<n.getLng()?n.getLng()-180:n.getLng();return[[o,n.getLat()],[i,e.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.get("zooms");return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.get("zooms");return t[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(t){this.map.panTo(t)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,e){this.map.setZoomAndCenter(t,e)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyle(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"pixelToLngLat",value:function(t){var e=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:e.getLng(),lat:e.getLat()}}},{key:"lngLatToPixel",value:function(t){var e=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:e.getX(),y:e.getY()}}},{key:"containerToLngLat",value:function(t){var e=new AMap.Pixel(t[0],t[1]),n=this.map.containerToLngLat(e);return{lng:null===n||void 0===n?void 0:n.getLng(),lat:null===n||void 0===n?void 0:n.getLat()}}},{key:"lngLatToContainer",value:function(t){var e=new AMap.LngLat(t[0],t[1]),n=this.map.lngLatToContainer(e);return{x:n.getX(),y:n.getY()}}},{key:"lngLatToMercator",value:function(t,e){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=this.viewport.projectFlat(t),o=oe["a"].create();return oe["a"].translate(o,o,oe["c"].fromValues(i[0],i[1],e)),oe["a"].scale(o,o,oe["c"].fromValues(r[0],r[1],r[2])),oe["a"].rotateX(o,o,n[0]),oe["a"].rotateY(o,o,n[1]),oe["a"].rotateZ(o,o,n[2]),o}},{key:"init",value:function(){var t=re()($t.a.mark((function t(){var e,n,r,i,o,a,s,u,c,l,f,p,h,d,m=this;return $t.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.config,n=e.id,r=e.style,i=void 0===r?"light":r,o=e.minZoom,a=void 0===o?0:o,s=e.maxZoom,u=void 0===s?18:s,c=e.token,l=void 0===c?he:c,f=e.mapInstance,p=e.plugin,h=void 0===p?[]:p,d=ee()(e,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),t.next=3,new Promise((function(t){var e=function(){if(f)m.map=f,m.$mapContainer=m.map.getContainer(),setTimeout((function(){m.map.on("camerachange",m.handleCameraChanged),t()}),30);else{m.$mapContainer=m.creatAmapContainer(n);var e=new AMap.Map(m.$mapContainer,fe({mapStyle:m.getMapStyle(i),zooms:[a,u],viewMode:"3D"},d));e.on("camerachange",m.handleCameraChanged),m.map=e,setTimeout((function(){t()}),10)}};ve||f?ve&&window.AMap||f?e():ge.push(e):(l===he&&m.logger.warn(m.configService.getSceneWarninfo("MapToken")),ve=!0,h.push("Map3D"),m.loadAMapScript("https://webapi.amap.com/maps?v=".concat(de,"&key=").concat(l,"&plugin=").concat(h.join(","))).then((function(){e(),ge.length&&(ge.forEach((function(t){return t()})),ge=[])})))}));case 3:this.viewport=new ce;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"exportMap",value:function(t){var e,n=null===(e=this.getContainer())||void 0===e?void 0:e.getElementsByClassName("amap-layer")[0],r="jpg"===t?null===n||void 0===n?void 0:n.toDataURL("image/jpeg"):null===n||void 0===n?void 0:n.toDataURL("image/png");return r}},{key:"emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.eventEmitter).emit.apply(e,[t].concat(r))}},{key:"once",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.eventEmitter).once.apply(e,[t].concat(r))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var t=document.getElementById(me);t&&document.head.removeChild(t)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"getMapStyle",value:function(t){return se[t]?se[t]:t}},{key:"creatAmapContainer",value:function(t){var e=t;"string"===typeof t&&(e=document.getElementById(t));var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    ",n.id="l7_amap_div"+pe++,e.appendChild(n),n}},{key:"loadAMapScript",value:function(t){return new Promise((function(e,n){var r=document.createElement("script");r.src=t,r.onload=function(){e()},r.onerror=n,document.head.appendChild(r)}))}}]),t}(),qt=Kt,Zt=Lt()(qt.prototype,"configService",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=Lt()(qt.prototype,"logger",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=Lt()(qt.prototype,"config",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=Lt()(qt.prototype,"coordinateSystemService",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Lt()(qt.prototype,"eventEmitter",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=qt))||Gt);function be(t){var e=xe();return function(){var n,r=Pt()(t);if(e){var i=Pt()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ct()(this,n)}}function xe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var we=function(t){Tt()(n,t);var e=be(n);function n(){return xt()(this,n),e.apply(this,arguments)}return St()(n,[{key:"getServiceConstructor",value:function(){return _e}}]),n}(Jt);function Se(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Se(Object(n),!0).forEach((function(e){vt()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}h.a.memo((function(t){var e=t.style,n=t.className,r=t.map,i=t.option,o=t.onSceneLoaded,a=Object(p["createRef"])(),s=Object(p["useState"])(),u=yt()(s,2),c=u[0],l=u[1];return Object(p["useEffect"])((function(){var t=new _t["Scene"](Ee(Ee({id:a.current},i),{},{map:new we(r)}));return t.on("loaded",(function(){l(t),o&&o(t)})),function(){t.destroy()}}),[]),Object(p["useEffect"])((function(){c&&c.setMapStyle(r.style)}),[r.style]),h.a.createElement(st.Provider,{value:c},Object(p["createElement"])("div",{ref:a,style:e,className:n},c&&t.children))}));var Te=n("4ZJM"),Ae=n.n(Te),Ce=n("1OyB"),ke=n("vuIU"),Pe=n("md7G"),Me=n("foSv"),Ie=n("Ji7U"),Oe=n("JX7q"),Le=n("ODXe"),Re=n("bl9R");function De(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ze(t,e){var n=Re["transformMat4"]([],e,t);return Re["scale"](n,n,1/n[3]),n}var je=n("ZaHm"),Ne=n("ZxFD"),Fe=n("n+fv");function Be(t,e){if(!t)throw new Error(e||"viewport-mercator-project: assertion failed.")}var Ue=Math.PI,Ve=Ue/4,Ge=Ue/180,qe=180/Ue,Ze=512,He=4003e4,We=1.5;function Xe(t){return Math.pow(2,t)}function Ye(t,e){var n=Object(Le["a"])(t,2),r=n[0],i=n[1];Be(Number.isFinite(r)&&Number.isFinite(e)),Be(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),e*=Ze;var o=r*Ge,a=i*Ge,s=e*(o+Ue)/(2*Ue),u=e*(Ue-Math.log(Math.tan(Ve+.5*a)))/(2*Ue);return[s,u]}function Ke(t,e){var n=Object(Le["a"])(t,2),r=n[0],i=n[1];e*=Ze;var o=r/e*(2*Ue)-Ue,a=2*(Math.atan(Math.exp(Ue-i/e*(2*Ue)))-Ve);return[o*qe,a*qe]}function Je(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:Xe(r),Be(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=Ze*i,c=Math.cos(e*Ge),l=u/360,f=l/c,p=u/He/c;if(s.pixelsPerMeter=[p,-p,p],s.metersPerPixel=[1/p,-1/p,1/p],s.pixelsPerDegree=[l,-f,p],s.degreesPerPixel=[1/l,-1/f,1/p],a){var h=Ge*Math.tan(e*Ge)/c,d=l*h/2,m=u/He*h,v=m/f*p;s.pixelsPerDegree2=[0,-d,m],s.pixelsPerMeter2=[v,0,v]}return s}function Qe(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.center,a=void 0===o?null:o,s=t.flipY,u=void 0!==s&&s,c=De();return je["translate"](c,c,[0,0,-i]),je["scale"](c,c,[1,1,1/e]),je["rotateX"](c,c,-n*Ge),je["rotateZ"](c,c,r*Ge),u&&je["scale"](c,c,[1,-1,1]),a&&je["translate"](c,c,Fe["negate"]([],a)),c}function $e(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?We:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,u=void 0===s?1:s,c=t.farZMultiplier,l=void 0===c?1:c,f=a*Ge,p=Math.atan(.5/i),h=Math.sin(p)*i/Math.sin(Math.PI/2-f-p),d=Math.cos(Math.PI/2-f)*h+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:u,far:d*l}}function tn(t){var e=t.width,n=t.height,r=t.pitch,i=t.altitude,o=t.nearZMultiplier,a=t.farZMultiplier,s=$e({width:e,height:n,altitude:i,pitch:r,nearZMultiplier:o,farZMultiplier:a}),u=s.fov,c=s.aspect,l=s.near,f=s.far,p=je["perspective"]([],u,c,l,f);return p}function en(t,e){var n=Object(Le["a"])(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return Be(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),ze(e,[r,i,a,1])}function nn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(Le["a"])(t,3),i=r[0],o=r[1],a=r[2];if(Be(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){var s=ze(e,[i,o,a,1]);return s}var u=ze(e,[i,o,0,1]),c=ze(e,[i,o,1,1]),l=u[2],f=c[2],p=l===f?0:((n||0)-l)/(f-l);return Ne["lerp"]([],u,c,p)}var rn=De(),on=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=e.height,i=e.viewMatrix,o=void 0===i?rn:i,a=e.projectionMatrix,s=void 0===a?rn:a;Object(Ce["a"])(this,t),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=s;var u=De();je["multiply"](u,u,this.projectionMatrix),je["multiply"](u,u,this.viewMatrix),this.viewProjectionMatrix=u;var c=De();je["scale"](c,c,[this.width/2,-this.height/2,1]),je["translate"](c,c,[1,-1,0]),je["multiply"](c,c,this.viewProjectionMatrix);var l=je["invert"](De(),c);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=c,this.pixelUnprojectionMatrix=l,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(ke["a"])(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&je["equals"](e.projectionMatrix,this.projectionMatrix)&&je["equals"](e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=this.projectPosition(t),o=en(i,this.pixelProjectionMatrix),a=Object(Le["a"])(o,2),s=a[0],u=a[1],c=r?u:this.height-u;return 2===t.length?[s,c]:[s,c,o[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Object(Le["a"])(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.pixelsPerMeter,f=nn([a,c,u],this.pixelUnprojectionMatrix,l),p=this.unprojectPosition(f),h=Object(Le["a"])(p,3),d=h[0],m=h[1],v=h[2];return Number.isFinite(u)?[d,m,v]:Number.isFinite(i)?[d,m,i]:[d,m]}},{key:"projectPosition",value:function(t){var e=this.projectFlat(t),n=Object(Le["a"])(e,2),r=n[0],i=n[1],o=(t[2]||0)*this.pixelsPerMeter;return[r,i,o]}},{key:"unprojectPosition",value:function(t){var e=this.unprojectFlat(t),n=Object(Le["a"])(e,2),r=n[0],i=n[1],o=(t[2]||0)/this.pixelsPerMeter;return[r,i,o]}},{key:"projectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]||this.scale;return t}},{key:"unprojectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]||this.scale;return t}}]),t}();function an(t){var e=t.width,n=t.height,r=t.bounds,i=t.minExtent,o=void 0===i?0:i,a=t.maxZoom,s=void 0===a?24:a,u=t.padding,c=void 0===u?0:u,l=t.offset,f=void 0===l?[0,0]:l,p=Object(Le["a"])(r,2),h=Object(Le["a"])(p[0],2),d=h[0],m=h[1],v=Object(Le["a"])(p[1],2),g=v[0],y=v[1];if(Number.isFinite(c)){var _=c;c={top:_,bottom:_,left:_,right:_}}else Be(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var b=new xn({width:e,height:n,longitude:0,latitude:0,zoom:0}),x=b.project([d,y]),w=b.project([g,m]),S=[Math.max(Math.abs(w[0]-x[0]),o),Math.max(Math.abs(w[1]-x[1]),o)],E=[e-c.left-c.right-2*Math.abs(f[0]),n-c.top-c.bottom-2*Math.abs(f[1])];Be(E[0]>0&&E[1]>0);var T=E[0]/S[0],A=E[1]/S[1],C=(c.right-c.left)/2/T,k=(c.bottom-c.top)/2/A,P=[(w[0]+x[0])/2+C,(w[1]+x[1])/2+k],M=b.unproject(P),I=b.zoom+Math.log2(Math.abs(Math.min(T,A)));return{longitude:M[0],latitude:M[1],zoom:Math.min(I,s)}}var sn,un,cn,ln,fn,pn,hn,dn,mn,vn,gn,yn,_n,bn,xn=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=void 0===o?0:o,s=n.longitude,u=void 0===s?0:s,c=n.zoom,l=void 0===c?0:c,f=n.pitch,p=void 0===f?0:f,h=n.bearing,d=void 0===h?0:h,m=n.altitude,v=void 0===m?1.5:m,g=n.nearZMultiplier,y=n.farZMultiplier;Object(Ce["a"])(this,e),r=r||1,i=i||1;var _=Xe(l);v=Math.max(.75,v);var b=Ye([u,a],_);b[2]=0;var x=tn({width:r,height:i,pitch:p,bearing:d,altitude:v,nearZMultiplier:g||1/i,farZMultiplier:y||1.01}),w=Qe({height:i,center:b,pitch:p,bearing:d,altitude:v,flipY:!0});return t=Object(Pe["a"])(this,Object(Me["a"])(e).call(this,{width:r,height:i,viewMatrix:w,projectionMatrix:x})),t.latitude=a,t.longitude=u,t.zoom=l,t.pitch=p,t.bearing=d,t.altitude=v,t.scale=_,t.center=b,t.pixelsPerMeter=Je(Object(Oe["a"])(Object(Oe["a"])(t))).pixelsPerMeter[2],Object.freeze(Object(Oe["a"])(Object(Oe["a"])(t))),t}return Object(Ie["a"])(e,t),Object(ke["a"])(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Ye(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Ke(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=t.pos,r=nn(n,this.pixelUnprojectionMatrix),i=Ye(e,this.scale),o=Ne["add"]([],i,Ne["negate"]([],r)),a=Ne["add"]([],this.center,o);return Ke(a,this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=an(Object.assign({width:r,height:i,bounds:t},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new e({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),e}(on),wn=function(){function t(){xt()(this,t),this.viewport=void 0}return St()(t,[{key:"syncWithMapCamera",value:function(t){var e=t.center,n=t.zoom,r=t.pitch,i=t.bearing,o=t.viewportHeight,a=t.viewportWidth;this.viewport=new xn({width:a,height:o,longitude:e&&e[0],latitude:e&&e[1],zoom:n,pitch:r,bearing:i})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,e){return this.viewport.projectFlat(t,e)}}]),t}(),Sn={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}};function En(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Tn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?En(Object(n),!0).forEach((function(e){vt()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n("BGjm")("/* @antv/l7-maps */\n.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:\"\";cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),window.mapboxgl=Ae.a;var An={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Cn=12,kn="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Pn=(sn=Object(ae["injectable"])(),un=Object(ae["inject"])(Rt["TYPES"].MapConfig),cn=Object(ae["inject"])(Rt["TYPES"].IGlobalConfigService),ln=Object(ae["inject"])(Rt["TYPES"].ILogService),fn=Object(ae["inject"])(Rt["TYPES"].ICoordinateSystemService),pn=Object(ae["inject"])(Rt["TYPES"].IEventEmitter),sn((bn=function(){function t(){var e=this;xt()(this,t),this.map=void 0,It()(this,"config",mn,this),It()(this,"configService",vn,this),It()(this,"logger",gn,this),It()(this,"coordinateSystemService",yn,this),It()(this,"eventEmitter",_n,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var t=e.map.getCenter().wrap(),n=t.lat,r=t.lng;e.viewport.syncWithMapCamera({bearing:e.map.getBearing(),center:[r,n],viewportHeight:e.map.transform.height,pitch:e.map.getPitch(),viewportWidth:e.map.transform.width,zoom:e.map.getZoom(),cameraHeight:0}),e.viewport.getZoom()>Cn?e.coordinateSystemService.setCoordinateSystem(Rt["CoordinateSystem"].LNGLAT_OFFSET):e.coordinateSystemService.setCoordinateSystem(Rt["CoordinateSystem"].LNGLAT),e.cameraChangedCallback(e.viewport)}}return St()(t,[{key:"addMarkerContainer",value:function(){var t=this.map.getCanvasContainer();this.markerContainer=ie["a"].create("div","l7-marker-container",t)}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,e){-1!==Rt["MapServiceEvent"].indexOf(t)?this.eventEmitter.on(t,e):this.map.on(An[t]||t,e)}},{key:"off",value:function(t,e){this.map.off(An[t]||t,e)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(t){return this.map.setZoom(t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(t){this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(t){this.map.setBearing(t)}},{key:"zoomIn",value:function(t,e){this.map.zoomIn(t,e)}},{key:"zoomOut",value:function(t,e){this.map.zoomOut(t,e)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(t){this.panTo(t)}},{key:"fitBounds",value:function(t,e){this.map.fitBounds(t,e)}},{key:"setMaxZoom",value:function(t){this.map.setMaxZoom(t)}},{key:"setMinZoom",value:function(t){this.map.setMinZoom(t)}},{key:"setMapStatus",value:function(t){!0===t.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===t.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===t.dragEnable&&this.map.dragPan.disable(),!0===t.dragEnable&&this.map.dragPan.enable(),!1===t.rotateEnable&&this.map.dragRotate.disable(),!0===t.dragEnable&&this.map.dragRotate.enable(),!1===t.keyboardEnable&&this.map.keyboard.disable(),!0===t.keyboardEnable&&this.map.keyboard.enable(),!1===t.zoomEnable&&this.map.scrollZoom.disable(),!0===t.zoomEnable&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(t,e){this.map.flyTo({zoom:t,center:e})}},{key:"setMapStyle",value:function(t){this.map.setStyle(this.getMapStyle(t))}},{key:"pixelToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToPixel",value:function(t){return this.map.project(t)}},{key:"containerToLngLat",value:function(t){return this.map.unproject(t)}},{key:"lngLatToContainer",value:function(t){return this.map.project(t)}},{key:"lngLatToMercator",value:function(t,e){var n=window.mapboxgl.MercatorCoordinate.fromLngLat(t,e),r=n.x,i=void 0===r?0:r,o=n.y,a=void 0===o?0:o,s=n.z,u=void 0===s?0:s;return{x:i,y:a,z:u}}},{key:"getModelMatrix",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0,z:0},o=window.mapboxgl.MercatorCoordinate.fromLngLat(t,e),a=o.meterInMercatorCoordinateUnits(),s=oe["a"].create();return oe["a"].translate(s,s,oe["c"].fromValues(o.x-i.x,o.y-i.y,o.z||0-i.z)),oe["a"].scale(s,s,oe["c"].fromValues(a*r[0],-a*r[1],a*r[2])),oe["a"].rotateX(s,s,n[0]),oe["a"].rotateY(s,s,n[1]),oe["a"].rotateZ(s,s,n[2]),s}},{key:"init",value:function(){var t=re()($t.a.mark((function t(){var e,n,r,i,o,a,s,u,c,l,f,p,h;return $t.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.config,n=e.id,r=void 0===n?"map":n,i=e.attributionControl,o=void 0!==i&&i,a=e.style,s=void 0===a?"light":a,u=e.token,c=void 0===u?kn:u,l=e.rotation,f=void 0===l?0:l,p=e.mapInstance,h=ee()(e,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new wn,p||window.mapboxgl||this.logger.error(this.configService.getSceneWarninfo("SDK")),c!==kn||"blank"===s||window.mapboxgl.accessToken||p||this.logger.warn(this.configService.getSceneWarninfo("MapToken")),p||window.mapboxgl.accessToken||(window.mapboxgl.accessToken=c),p?(this.map=p,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(r),this.map=new window.mapboxgl.Map(Tn({container:this.$mapContainer,style:this.getMapStyle(s),attributionControl:o,bearing:f},h))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.eventEmitter).emit.apply(e,[t].concat(r))}},{key:"once",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.eventEmitter).once.apply(e,[t].concat(r))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(t){var e=this.map.getCanvas(),n="jpg"===t?null===e||void 0===e?void 0:e.toDataURL("image/jpeg"):null===e||void 0===e?void 0:e.toDataURL("image/png");return n}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"creatAmapContainer",value:function(t){var e=t;return"string"===typeof t&&(e=document.getElementById(t)),e}},{key:"getMapStyle",value:function(t){return"string"!==typeof t?t:Sn[t]?Sn[t]:t}}]),t}(),dn=bn,mn=Lt()(dn.prototype,"config",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn=Lt()(dn.prototype,"configService",[cn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=Lt()(dn.prototype,"logger",[ln],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Lt()(dn.prototype,"coordinateSystemService",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Lt()(dn.prototype,"eventEmitter",[pn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=dn))||hn);function Mn(t){var e=In();return function(){var n,r=Pt()(t);if(e){var i=Pt()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ct()(this,n)}}function In(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}n("BGjm")("/* @antv/l7-maps */\n.mapboxgl-ctrl-logo {\n display: none !important;\n}\n");var On=function(t){Tt()(n,t);var e=Mn(n);function n(){return xt()(this,n),e.apply(this,arguments)}return St()(n,[{key:"getServiceConstructor",value:function(){return Pn}}]),n}(Jt);function Ln(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Rn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ln(Object(n),!0).forEach((function(e){vt()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Dn=h.a.memo((function(t){var e=t.style,n=t.className,r=t.map,i=t.option,o=t.onSceneLoaded,a=Object(p["createRef"])(),s=Object(p["useState"])(),u=yt()(s,2),c=u[0],l=u[1];return Object(p["useEffect"])((function(){var t=new _t["Scene"](Rn(Rn({id:a.current},i),{},{map:new On(r)}));return t.on("loaded",(function(){l(t),o&&o(t)})),function(){t.destroy()}}),[]),Object(p["useEffect"])((function(){c&&r.style&&c.setMapStyle(r.style)}),[JSON.stringify(r.style)]),Object(p["useEffect"])((function(){c&&r.zoom&&c.setZoom(r.zoom)}),[r.zoom]),Object(p["useEffect"])((function(){c&&r.center&&c.setCenter(r.center)}),[JSON.stringify(r.center)]),Object(p["useEffect"])((function(){c&&r.pitch&&c.setPitch(r.pitch)}),[r.pitch]),Object(p["useEffect"])((function(){c&&r.rotation&&c.setRotation(r.rotation)}),[r.rotation]),h.a.createElement(st.Provider,{value:c},Object(p["createElement"])("div",{ref:a,style:e,className:n},c&&t.children))})),zn=Dn,jn=(h.a.memo((function(t){var e=t.style,n=t.className,r=t.map,i=Object(p["createRef"])(),o=Object(p["useState"])(),a=yt()(o,2),s=a[0],u=a[1];return Object(p["useEffect"])((function(){var t=new _t["Scene"]({id:i.current,map:r});return t.on("loaded",(function(){u(t)})),function(){t.destroy()}}),[]),h.a.createElement(st.Provider,{value:s},Object(p["createElement"])("div",{ref:i,style:e,className:n},s&&t.children))})),Object(p["createContext"])({}));function Nn(){return Object(p["useContext"])(jn)}var Fn=p["useEffect"],Bn=p["memo"]((function(t){var e=t.layer,n=t.active;return Fn((function(){e.active(n.option)}),[JSON.stringify(n)]),null})),Un=p["useEffect"],Vn=p["memo"]((function(t){var e=t.layer,n=t.animate;return Un((function(){e.animate(n)}),[JSON.stringify(n)]),null})),Gn=p["useEffect"],qn=p["memo"]((function(t){var e=t.layer,n=t.color;return Gn((function(){n.field?e.color(n.field,n.values):e.color(n.values)}),[n.field,n.scale,JSON.stringify(n.values),JSON.stringify(n.options)]),null})),Zn=p["useEffect"],Hn=p["memo"]((function(t){var e=t.layer,n=t.filter;return Zn((function(){n.field&&e.filter(n.field,n.values)}),[n.field,n.values,JSON.stringify(n.values),JSON.stringify(n.options)]),null})),Wn=p["useEffect"],Xn=p["memo"]((function(t){var e=t.layer,n=t.scale;return Wn((function(){e.scale(n.values)}),[n.values]),null})),Yn=p["useEffect"],Kn=p["memo"]((function(t){var e=t.layer,n=t.select;return Yn((function(){e.select(n.option)}),[JSON.stringify(n)]),null})),Jn=p["useEffect"],Qn=p["memo"]((function(t){var e=t.layer,n=t.shape;return Jn((function(){n.field?e.shape(n.field,n.values):e.shape(n.values)}),[n.field,JSON.stringify(n.values),JSON.stringify(n.options)]),null})),$n=p["useEffect"],tr=p["memo"]((function(t){var e=t.layer,n=t.size;return $n((function(){n.field?e.size(n.field,n.values):e.size(n.values)}),[n.field,n.scale,JSON.stringify(n.values),JSON.stringify(n.options)]),null})),er=p["useEffect"],nr=p["memo"]((function(t){var e=t.layer,n=t.source,r=n.data,i=ee()(n,["data"]);return er((function(){e.inited?e.setData(r,i):e.source(r,i),i.autoFit&&e.fitBounds(i&&i.fitBoundsOptions)}),[r,JSON.stringify(i)]),null})),rr=p["useEffect"],ir=p["memo"]((function(t){var e=t.layer,n=t.style;return rr((function(){e.style(n)}),Object.keys(n).map((function(t){return n[t]}))),null})),or=p["useEffect"],ar=p["useState"];function sr(t,e){var n=e.source,r=e.color,i=e.shape,o=e.style,a=e.size,s=e.scale,u=e.active,c=e.select,l=e.filter,f=e.animate,h=e.options,d=e.onLayerLoaded,m=ut(),v=ar(),g=yt()(v,2),y=g[0],_=g[1];if(!y){var b;switch(t){case"polygonLayer":b=new _t["PolygonLayer"](h);break;case"lineLayer":b=new _t["LineLayer"](h);break;case"pointLayer":b=new _t["PointLayer"](h);break;case"heatmapLayer":b=new _t["HeatmapLayer"](h);break;case"rasterLayer":b=new _t["RasterLayer"](h);break;case"imageLayer":b=new _t["ImageLayer"](h);break;case"citybuildingLayer":b=new _t["CityBuildingLayer"](h);break;default:b=new _t["PolygonLayer"](h)}b.on("inited",(function(){d&&d(b,m)})),_(b)}return or((function(){if(void 0!==y)return m.addLayer(y),function(){m.removeLayer(y)}}),[]),or((function(){y&&m.render()})),or((function(){y&&y.inited&&h&&y.updateLayerConfig(h)}),[null===h||void 0===h?void 0:h.minZoom,null===h||void 0===h?void 0:h.maxZoom,null===h||void 0===h?void 0:h.visible]),or((function(){y&&y.inited&&h&&h.zIndex&&y.setIndex(h.zIndex)}),[null===h||void 0===h?void 0:h.zIndex]),or((function(){y&&y.inited&&h&&h.blend&&y.setBlend(h.blend)}),[null===h||void 0===h?void 0:h.blend]),null!==y&&void 0!==y?p["createElement"](jn.Provider,{value:y},p["createElement"](nr,{layer:y,source:n}),s&&p["createElement"](Xn,{layer:y,scale:s}),r&&p["createElement"](qn,{layer:y,color:r}),a&&p["createElement"](tr,{layer:y,size:a}),i&&p["createElement"](Qn,{layer:y,shape:i}),o&&p["createElement"](ir,{layer:y,style:o}),u&&p["createElement"](Bn,{layer:y,active:u}),c&&p["createElement"](Kn,{layer:y,select:c}),l&&p["createElement"](Hn,{layer:y,filter:l}),f&&p["createElement"](Vn,{layer:y,animate:f}),e.children):null}p["memo"]((function(t){return sr("polygonLayer",t)})),p["memo"]((function(t){return sr("lineLayer",t)}));var ur=p["memo"]((function(t){return sr("pointLayer",t)})),cr=p["memo"]((function(t){return sr("heatmapLayer",t)})),lr=(p["memo"]((function(t){return sr("rasterLayer",t)})),p["memo"]((function(t){return sr("imagelayer",t)})),p["memo"]((function(t){return sr("citybuildinglayer",t)})),h.a.memo((function(t){var e=ut(),n=Object(p["useState"])(),r=yt()(n,2),i=r[1],o=t.type,a=t.position;return Object(p["useEffect"])((function(){var t;switch(o){case"scale":t=new _t["Scale"]({position:a||"bottomright"});break;case"zoom":t=new _t["Zoom"]({position:a||"topright"});break;case"logo":t=new _t["Logo"]({position:a||"bottomleft"})}return i(t),e.addControl(t),function(){e.removeControl(t)}}),[o,a]),null})),n("i8i4"));p["useEffect"],p["useState"];var fr=p["useEffect"];p["memo"]((function(t){var e=t.type,n=t.handler,r=Nn();return fr((function(){return r.off(e,n),r.on(e,n),function(){r.off(e,n)}}),[e,n]),null}));n("BGjm")("/* @antv/l7-react */\n.color {\n color:'red';\n}\n");p["memo"]((function(t){t.className,t.style,t.title;var e=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return p["createElement"]("div",null,p["createElement"]("div",null,e.map((function(t,n){return p["createElement"]("div",{key:n.toString(),style:{background:t.color,height:"100%",display:"inline-block",cursor:"pointer",width:(100-e.length)/e.length+"%",marginRight:"1%",padding:5}})}))),p["createElement"]("div",null,e.map((function(t,n){return p["createElement"]("div",{key:n.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:(100-e.length)/e.length+"%",marginRight:"1%"}},t.title)}))))}));function pr(t){var e=hr();return function(){var n,r=Pt()(t);if(e){var i=Pt()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ct()(this,n)}}function hr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(function(t){Tt()(n,t);var e=pr(n);function n(t){var r;return xt()(this,n),r=e.call(this,t),r.el=void 0,r.scene=void 0,r.popup=void 0,r.el=document.createElement("div"),r}St()(n,[{key:"componentDidMount",value:function(){var t=this.props,e=t.lnglat,n=t.children,r=t.option,i=new _t["Popup"](r);e&&i.setLnglat(e),n&&i.setDOMContent(this.el),this.popup=i,this.scene.addPopup(i)}},{key:"componentDidUpdate",value:function(t){var e,n,r,i=(null===t||void 0===t||null===(e=t.lnglat)||void 0===e?void 0:e.toString())!==(null===(n=this.props)||void 0===n||null===(r=n.lnglat)||void 0===r?void 0:r.toString());i&&(this.popup.remove(),this.popup=new _t["Popup"](this.props.option),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var t=this;return p["createElement"](st.Consumer,{},(function(e){return e&&(t.scene=e),Object(lr["createPortal"])(t.props.children,t.el)}))}}])})(p["PureComponent"]);function dr(t){var e=mr();return function(){var n,r=Pt()(t);if(e){var i=Pt()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ct()(this,n)}}function mr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(function(t){Tt()(n,t);var e=dr(n);function n(t){var r;return xt()(this,n),r=e.call(this,t),r.el=void 0,r.scene=void 0,r.marker=void 0,r.el=document.createElement("div"),r}St()(n,[{key:"componentDidMount",value:function(){var t=this.props,e=t.lnglat,n=t.children,r=t.option,i=t.onMarkerLoaded,o=new _t["Marker"](r);e&&o.setLnglat(e),n&&o.setElement(this.el),this.marker=o,i&&i(o),this.scene.addMarker(o)}},{key:"componentDidUpdate",value:function(t){var e,n=(null===t||void 0===t?void 0:t.lnglat.toString())!==(null===(e=this.props)||void 0===e?void 0:e.lnglat.toString());n&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var t=this;return p["createElement"](st.Consumer,{},(function(e){return e&&(t.scene=e),Object(lr["createPortal"])(t.props.children,t.el)}))}}])})(p["PureComponent"]);var vr=p["useEffect"],gr=(p["memo"]((function(t){var e=t.type,n=t.handler,r=ut();return vr((function(){return r.on(e,n),function(){r.off(e,n)}}),[e]),null})),p["useEffect"]),yr=(p["memo"]((function(t){var e=t.name,n=t.url,r=ut();return gr((function(){r.addImage(e,n)}),[e,n]),null})),["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"]),_r=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;Object(a["a"])(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.state={data:null,grid:null,loading:!1},t}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){var t=Object(at["a"])(ot.a.mark((function t(){var e,n,r,i;return ot.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then((function(t){return t.json()})),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then((function(t){return t.json()}))]);case 2:e=t.sent,n=Object(X["a"])(e,2),r=n[0],i=n[1],this.setState({data:r,grid:i,loading:!0});case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=this.state,e=t.data,n=t.grid,r=t.loading;return!1===r?p["createElement"](d["d"],null):p["createElement"](zn,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"}},n&&p["createElement"](cr,{key:"1",source:{data:n,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}}),e&&[p["createElement"](ur,{key:"2",options:{autoFit:!0},source:{data:e},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:yr},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}}),p["createElement"](ur,{key:"5",source:{data:e},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(t){return t>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}})])}}]),n}(p["Component"]),br=n("oBTY"),xr=n("H+7v"),wr=n.n(xr);function Sr(t){return 1*t<10?"0".concat(t):t}function Er(){for(var t=[],e=0;e<24;e+=1)t.push({x:"".concat(Sr(e),":00"),y:Math.floor(200*Math.random())+50*e});return t}var Tr=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;Object(a["a"])(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.state={activeData:Er()},t.timer=void 0,t.requestRef=void 0,t.loopData=function(){t.requestRef=requestAnimationFrame((function(){t.timer=window.setTimeout((function(){t.setState({activeData:Er()},(function(){t.loopData()}))}),1e3)}))},t}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var t=this.state.activeData,e=void 0===t?[]:t;return h.a.createElement("div",{className:wr.a.activeChart},h.a.createElement(l["a"],{title:"\u76ee\u6807\u8bc4\u4f30",value:"\u6709\u671b\u8fbe\u5230\u9884\u671f"}),h.a.createElement("div",{style:{marginTop:32}},h.a.createElement(L,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:e})),e&&h.a.createElement("div",null,h.a.createElement("div",{className:wr.a.activeChartGrid},h.a.createElement("p",null,Object(br["a"])(e).sort()[e.length-1].y+200," \u4ebf\u5143"),h.a.createElement("p",null,Object(br["a"])(e).sort()[Math.floor(e.length/2)].y," \u4ebf\u5143")),h.a.createElement("div",{className:wr.a.dashedLine},h.a.createElement("div",{className:wr.a.line})),h.a.createElement("div",{className:wr.a.dashedLine},h.a.createElement("div",{className:wr.a.line}))),e&&h.a.createElement("div",{className:wr.a.activeChartLegend},h.a.createElement("span",null,"00:00"),h.a.createElement("span",null,e[Math.floor(e.length/2)].x),h.a.createElement("span",null,e[e.length-1].x)))}}]),n}(p["Component"]),Ar=n("Wnft"),Cr=n.n(Ar),kr=l["a"].Countdown,Pr=Date.now()+1728e5+3e4,Mr=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){var t=this.props.dispatch;t({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var t=this.props,e=t.dashboardAndmonitor,n=t.loading,a=e.tags;return h.a.createElement(d["b"],null,h.a.createElement(h.a.Fragment,null,h.a.createElement(i["a"],{gutter:24},h.a.createElement(o["a"],{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24}},h.a.createElement(r["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1},h.a.createElement(i["a"],null,h.a.createElement(o["a"],{md:6,sm:12,xs:24},h.a.createElement(l["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:v()(124543233).format("0,0")})),h.a.createElement(o["a"],{md:6,sm:12,xs:24},h.a.createElement(l["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})),h.a.createElement(o["a"],{md:6,sm:12,xs:24},h.a.createElement(kr,{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:Pr,format:"HH:mm:ss:SSS"})),h.a.createElement(o["a"],{md:6,sm:12,xs:24},h.a.createElement(l["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:v()(234).format("0,0")}))),h.a.createElement("div",{className:Cr.a.mapChart},h.a.createElement(_r,null)))),h.a.createElement(o["a"],{xl:6,lg:24,md:24,sm:24,xs:24},h.a.createElement(r["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1},h.a.createElement(Tr,null)),h.a.createElement(r["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1},h.a.createElement(k,{title:Object(f["d"])({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})))),h.a.createElement(i["a"],{gutter:24},h.a.createElement(o["a"],{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24}},h.a.createElement(r["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:Cr.a.pieCard},h.a.createElement(i["a"],{style:{padding:"16px 0"}},h.a.createElement(o["a"],{span:8},h.a.createElement(W,{animate:!1,percent:28,title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})),h.a.createElement(o["a"],{span:8},h.a.createElement(W,{animate:!1,color:"#5DDECF",percent:22,title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})),h.a.createElement(o["a"],{span:8},h.a.createElement(W,{animate:!1,color:"#2FC25B",percent:32,title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2}))))),h.a.createElement(o["a"],{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},h.a.createElement(r["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:n,bordered:!1,bodyStyle:{overflow:"hidden"}},h.a.createElement($,{data:a||[],height:161}))),h.a.createElement(o["a"],{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},h.a.createElement(r["a"],{title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1},h.a.createElement(rt,{height:161,title:h.a.createElement(f["a"],{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34}))))))}}]),n}(p["Component"]);e["default"]=Object(f["c"])((function(t){var e=t.dashboardAndmonitor,n=t.loading;return{dashboardAndmonitor:e,loading:n.models.dashboardAndmonitor}}))(Mr)},aF1E:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("lSNA"),i=n.n(r);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){var n=e.sourceField,r=e.targetField,i=e.data,o={};return i.forEach((function(t){o[t[n]]=t})),t.dataArray=t.dataArray.map((function(t){var e=t[r];return a(a({},t),o[e])})),t}},aHsQ:function(t,e,n){"use strict";n("cIOH"),n("6D9b")},aPG5:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("FV85"),o=n("qK8v"),a=n("ujMp"),s=n("cSJO"),u=function(t,e,n){try{return n()}catch(i){throw o.isStackOverflowExeption(i)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):i}},c=function t(e){return function(n){n.parentContext.setCurrentRequest(n);var o=n.bindings,c=n.childRequests,l=n.target&&n.target.isArray(),f=!n.parentRequest||!n.parentRequest.target||!n.target||!n.parentRequest.target.matchesArray(n.target.serviceIdentifier);if(l&&f)return c.map((function(n){var r=t(e);return r(n)}));var p=null;if(!n.target.isOptional()||0!==o.length){var h=o[0],d=h.scope===i.BindingScopeEnum.Singleton,m=h.scope===i.BindingScopeEnum.Request;if(d&&h.activated)return h.cache;if(m&&null!==e&&e.has(h.id))return e.get(h.id);if(h.type===i.BindingTypeEnum.ConstantValue)p=h.cache;else if(h.type===i.BindingTypeEnum.Function)p=h.cache;else if(h.type===i.BindingTypeEnum.Constructor)p=h.implementationType;else if(h.type===i.BindingTypeEnum.DynamicValue&&null!==h.dynamicValue)p=u("toDynamicValue",h.serviceIdentifier,(function(){return h.dynamicValue(n.parentContext)}));else if(h.type===i.BindingTypeEnum.Factory&&null!==h.factory)p=u("toFactory",h.serviceIdentifier,(function(){return h.factory(n.parentContext)}));else if(h.type===i.BindingTypeEnum.Provider&&null!==h.provider)p=u("toProvider",h.serviceIdentifier,(function(){return h.provider(n.parentContext)}));else{if(h.type!==i.BindingTypeEnum.Instance||null===h.implementationType){var v=a.getServiceIdentifierAsString(n.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+v)}p=s.resolveInstance(h.implementationType,c,t(e))}return"function"===typeof h.onActivation&&(p=h.onActivation(n.parentContext,p)),d&&(h.cache=p,h.activated=!0),m&&null!==e&&!e.has(h.id)&&e.set(h.id,p),p}}};function l(t){var e=c(t.plan.rootRequest.requestScope);return e(t.plan.rootRequest)}e.resolve=l},asDA:function(t,e){function n(t,e,n,r){var i=-1,o=null==t?0:t.length;r&&o&&(n=t[++i]);while(++i<o)n=e(n,t[i],i,t);return n}t.exports=n},b2z7:function(t,e){var n=/\w*$/;function r(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}t.exports=r},bB6j:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t["Normal"]="normal",t["PostProcessing"]="post-processing"}(r||(r={}))},bTtR:function(t,e){},bYl4:function(t,e){},bl9R:function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"fromValues",(function(){return a})),n.d(e,"copy",(function(){return s})),n.d(e,"set",(function(){return u})),n.d(e,"add",(function(){return c})),n.d(e,"subtract",(function(){return l})),n.d(e,"multiply",(function(){return f})),n.d(e,"divide",(function(){return p})),n.d(e,"ceil",(function(){return h})),n.d(e,"floor",(function(){return d})),n.d(e,"min",(function(){return m})),n.d(e,"max",(function(){return v})),n.d(e,"round",(function(){return g})),n.d(e,"scale",(function(){return y})),n.d(e,"scaleAndAdd",(function(){return _})),n.d(e,"distance",(function(){return b})),n.d(e,"squaredDistance",(function(){return x})),n.d(e,"length",(function(){return w})),n.d(e,"squaredLength",(function(){return S})),n.d(e,"negate",(function(){return E})),n.d(e,"inverse",(function(){return T})),n.d(e,"normalize",(function(){return A})),n.d(e,"dot",(function(){return C})),n.d(e,"cross",(function(){return k})),n.d(e,"lerp",(function(){return P})),n.d(e,"random",(function(){return M})),n.d(e,"transformMat4",(function(){return I})),n.d(e,"transformQuat",(function(){return O})),n.d(e,"zero",(function(){return L})),n.d(e,"str",(function(){return R})),n.d(e,"exactEquals",(function(){return D})),n.d(e,"equals",(function(){return z})),n.d(e,"sub",(function(){return j})),n.d(e,"mul",(function(){return N})),n.d(e,"div",(function(){return F})),n.d(e,"dist",(function(){return B})),n.d(e,"sqrDist",(function(){return U})),n.d(e,"len",(function(){return V})),n.d(e,"sqrLen",(function(){return G})),n.d(e,"forEach",(function(){return q}));var r=n("yU0y");function i(){var t=new r["a"](4);return r["a"]!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function o(t){var e=new r["a"](4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(t,e,n,i){var o=new r["a"](4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function u(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function f(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function p(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function h(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function d(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function m(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function v(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function y(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function _(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function b(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,r,i,o)}function x(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function w(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function S(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function E(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function T(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function A(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function C(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function k(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],l=e[0],f=e[1],p=e[2],h=e[3];return t[0]=f*c-p*u+h*s,t[1]=-l*c+p*a-h*o,t[2]=l*u-f*a+h*i,t[3]=-l*s+f*o-p*i,t}function P(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function M(t,e){var n,i,o,a,s,u;e=e||1;do{n=2*r["c"]()-1,i=2*r["c"]()-1,s=n*n+i*i}while(s>=1);do{o=2*r["c"]()-1,a=2*r["c"]()-1,u=o*o+a*a}while(u>=1);var c=Math.sqrt((1-s)/u);return t[0]=e*n,t[1]=e*i,t[2]=e*o*c,t[3]=e*a*c,t}function I(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function O(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,p=c*o+a*i-s*r,h=-a*r-s*i-u*o;return t[0]=l*c+h*-a+f*-u-p*-s,t[1]=f*c+h*-s+p*-a-l*-u,t[2]=p*c+h*-u+l*-s-f*-a,t[3]=e[3],t}function L(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function R(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function D(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function z(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-s)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r["b"]*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=r["b"]*Math.max(1,Math.abs(a),Math.abs(l))}var j=l,N=f,F=p,B=b,U=x,V=w,G=S,q=function(){var t=i();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}()},bzyH:function(t,e){},cSJO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("FV85"),o=n("xfSm");function a(t,e,n){var r=e.filter((function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ClassProperty})),o=r.map(n);return r.forEach((function(e,n){var r="";r=e.target.name.value();var i=o[n];t[r]=i})),t}function s(t,e){return new(t.bind.apply(t,[void 0].concat(e)))}function u(t,e){if(Reflect.hasMetadata(o.POST_CONSTRUCT,t)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,t);try{e[n.value]()}catch(i){throw new Error(r.POST_CONSTRUCT_ERROR(t.name,i.message))}}}function c(t,e,n){var r=null;if(e.length>0){var o=e.filter((function(t){return null!==t.target&&t.target.type===i.TargetTypeEnum.ConstructorArgument})),c=o.map(n);r=s(t,c),r=a(r,e,n)}else r=new t;return u(t,r),r}e.resolveInstance=c},cWyK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("/rf6");function i(t,e,n){if(null!==t)for(var r,o,a,s,u,c,l,f,p=0,h=0,d=t.type,m="FeatureCollection"===d,v="Feature"===d,g=m?t.features.length:1,y=0;y<g;y++){l=m?t.features[y].geometry:v?t.geometry:t,f=!!l&&"GeometryCollection"===l.type,u=f?l.geometries.length:1;for(var _=0;_<u;_++){var b=0,x=0;if(s=f?l.geometries[_]:l,null!==s){c=s.coordinates;var w=s.type;switch(p=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(c,h,y,b,x))return!1;h++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(!1===e(c[r],h,y,b,x))return!1;h++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(o=0;o<c[r].length-p;o++){if(!1===e(c[r][o],h,y,b,x))return!1;h++}"MultiLineString"===w&&b++,"Polygon"===w&&x++}"Polygon"===w&&b++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(x=0,o=0;o<c[r].length;o++){for(a=0;a<c[r][o].length-p;a++){if(!1===e(c[r][o][a],h,y,b,x))return!1;h++}x++}b++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===i(s.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e,n,r){var o=n;return i(t,(function(t,r,i,a,s){o=0===r&&void 0===n?t:e(o,t,r,i,a,s)}),r),o}function a(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)if(!1===e(t.features[n].properties,n))break;break;case"Feature":e(t.properties,0);break}}function s(t,e,n){var r=n;return a(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function u(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)if(!1===e(t.features[n],n))break}function c(t,e,n){var r=n;return u(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function l(t){var e=[];return i(t,(function(t){e.push(t)})),e}function f(t,e){var n,r,i,o,a,s,u,c,l,f,p=0,h="FeatureCollection"===t.type,d="Feature"===t.type,m=h?t.features.length:1;for(n=0;n<m;n++){for(s=h?t.features[n].geometry:d?t.geometry:t,c=h?t.features[n].properties:d?t.properties:{},l=h?t.features[n].bbox:d?t.bbox:void 0,f=h?t.features[n].id:d?t.id:void 0,u=!!s&&"GeometryCollection"===s.type,a=u?s.geometries.length:1,i=0;i<a;i++)if(o=u?s.geometries[i]:s,null!==o)switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,c,l,f))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],p,c,l,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,c,l,f))return!1;p++}}function p(t,e,n){var r=n;return f(t,(function(t,i,o,a,s){r=0===i&&void 0===n?t:e(r,t,i,o,a,s)})),r}function h(t,e){f(t,(function(t,n,i,o,a){var s,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:a}),n,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var c=0;c<t.coordinates.length;c++){var l=t.coordinates[c],f={type:s,coordinates:l};if(!1===e(r.feature(f,i),n,c))return!1}}))}function d(t,e,n){var r=n;return h(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r}function m(t,e){h(t,(function(t,n,o){var a=0;if(t.geometry){var s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var u,c=0,l=0,f=0;return!1!==i(t,(function(i,s,p,h,d){if(void 0===u||n>c||h>l||d>f)return u=i,c=n,l=h,f=d,void(a=0);var m=r.lineString([u,i],t.properties);if(!1===e(m,n,o,d,a))return!1;a++,u=i}))&&void 0}}}))}function v(t,e,n){var r=n,i=!1;return m(t,(function(t,o,a,s,u){r=!1===i&&void 0===n?t:e(r,t,o,a,s,u),i=!0})),r}function g(t,e){if(!t)throw new Error("geojson is required");h(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===e(r.lineString(a[s],t.properties),n,i,s))return!1;break}}}))}function y(t,e,n){var r=n;return g(t,(function(t,i,o,a){r=0===i&&void 0===n?t:e(r,t,i,o,a)})),r}function _(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.segmentIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),u=u||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":u=u||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=c.length+s-1),r.lineString([c[s],c[s+1]],u,e);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s-1),r.lineString([c[a][s],c[a][s+1]],u,e);case"MultiLineString":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s-1),r.lineString([c[o][s],c[o][s+1]],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),s<0&&(s=c[o][a].length-s-1),r.lineString([c[o][a][s],c[o][a][s+1]],u,e)}throw new Error("geojson is invalid")}function b(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.coordIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),u=u||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":u=u||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return r.point(c,u,e);case"MultiPoint":return o<0&&(o=c.length+o),r.point(c[o],u,e);case"LineString":return s<0&&(s=c.length+s),r.point(c[s],u,e);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s),r.point(c[a][s],u,e);case"MultiLineString":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),r.point(c[o][s],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),s<0&&(s=c[o][a].length-s),r.point(c[o][a][s],u,e)}throw new Error("geojson is invalid")}e.coordEach=i,e.coordReduce=o,e.propEach=a,e.propReduce=s,e.featureEach=u,e.featureReduce=c,e.coordAll=l,e.geomEach=f,e.geomReduce=p,e.flattenEach=h,e.flattenReduce=d,e.segmentEach=m,e.segmentReduce=v,e.lineEach=g,e.lineReduce=y,e.findSegment=_,e.findPoint=b},cZ5Q:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm");function o(){return function(t){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,t))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(i.PARAM_TYPES,e,t),t}}e.injectable=o},cZlC:function(t,e,n){"use strict";var r,i,o;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),function(t){t["LINEAR"]="linear",t["POWER"]="power",t["LOG"]="log",t["IDENTITY"]="identity",t["TIME"]="time",t["QUANTILE"]="quantile",t["QUANTIZE"]="quantize",t["THRESHOLD"]="threshold",t["CAT"]="cat"}(r||(r={})),function(t){t["CONSTANT"]="constant",t["VARIABLE"]="variable"}(i||(i={})),function(t){t[t["Attribute"]=0]="Attribute",t[t["InstancedAttribute"]=1]="InstancedAttribute",t[t["Uniform"]=2]="Uniform"}(o||(o={}))},d9O0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0;function i(){return r++}e.id=i},d9mD:function(t,e,n){t.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(t,e,n){var r=n("yGk4"),i=n("vN+2"),o=n("rEGp"),a=1/0,s=r&&1/o(new r([,-0]))[1]==a?function(t){return new r(t)}:i;t.exports=s},dVn5:function(t,e){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function r(t){return t.match(n)||[]}t.exports=r},dX1H:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("d9O0"),o=n("GXnB"),a=n("zxMA"),s=function(){function t(t,e,n,s){this.id=i.id(),this.type=t,this.serviceIdentifier=n,this.name=new a.QueryableString(e||""),this.metadata=new Array;var u=null;"string"===typeof s?u=new o.Metadata(r.NAMED_TAG,s):s instanceof o.Metadata&&(u=s),null!==u&&this.metadata.push(u)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++){var r=n[e];if(r.key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(r.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG}))},t.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===r.NAMED_TAG}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return t.key!==r.INJECT_TAG&&t.key!==r.MULTI_INJECT_TAG&&t.key!==r.NAME_TAG&&t.key!==r.UNMANAGED_TAG&&t.key!==r.NAMED_TAG})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(r.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var r=0,i=e.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===n)return!0}return!1}},t}();e.Target=s},doU7:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};e.BindingCount=r},dxzI:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("d9O0"),i=function(){function t(t){this.id=r.id(),this.registry=t}return t}();e.ContainerModule=i;var o=function(){function t(t){this.id=r.id(),this.registry=t}return t}();e.AsyncContainerModule=o},"eg+a":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(t,e,n){"use strict";n.d(e,"d",(function(){return Xa})),n.d(e,"b",(function(){return Ka})),n.d(e,"a",(function(){return Ja}));n("mNvP");var r=n("uhBA"),i=n.n(r),o=n("4cb6"),a=n("APxj"),s=n.n(a),u=n("bB6j"),c=n("lSNA"),l=n.n(c),f=n("lwsE"),p=n.n(f),h=n("W8MJ"),d=n.n(h),m=n("Hel2"),v=n("rxlC"),g=n.n(v);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=x(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function x(t,e){if(t){if("string"===typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S,E,T,A=30;function C(t){var e=t.characterSet,n=t.getFontWidth,r=t.fontHeight,i=t.buffer,o=t.maxCanvasWidth,a=t.mapping,s=void 0===a?{}:a,u=t.xOffset,c=void 0===u?0:u,l=t.yOffset,f=void 0===l?0:l,p=0,h=c;Array.from(e).forEach((function(t,e){if(!s[t]){var r=n(t,e);h+A>o&&(h=0,p++),s[t]={x:h,y:f+p*A,width:A,height:A,advance:r},h+=A}}));var d=r+2*i;return{mapping:s,xOffset:h,yOffset:f+p*d,canvasHeight:M(f+(p+1)*d)}}function k(t,e,n){var r,i=0,o=0,a=0,s=[],u={},c=b(t);try{for(c.s();!(r=c.n()).done;){var l=r.value;if(!u[l.id]){var f=l.height,p=l.width;i+p+e>n&&(P(u,s,o),i=0,o=a+o+e,a=0,s=[]),s.push({icon:l,xOffset:i}),i=i+p+e,a=Math.max(a,f)}}}catch(d){c.e(d)}finally{c.f()}s.length>0&&P(u,s,o);var h=M(a+o+e);return{mapping:u,canvasHeight:h}}function P(t,e,n){var r,i=b(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.icon,s=o.xOffset;t[a.id]=_(_({},a),{},{x:s,y:n,image:a.image})}}catch(u){i.e(u)}finally{i.f()}}function M(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function I(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=O(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function O(t,e){if(t){if("string"===typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(t,e):void 0}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z=W(),j="sans-serif",N="normal",F=24,B=3,U=.25,V=8,G=1024,q=1,Z=1,H=3;function W(){for(var t=[],e=32;e<128;e++)t.push(String.fromCharCode(e));return t}function X(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="black",t.textBaseline="middle"}function Y(t,e){for(var n=0;n<t.length;n++)e.data[4*n+3]=t[n]}var K,J,Q,$=(S=Object(o["injectable"])(),S((T=function(){function t(){p()(this,t),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new m["b"](H)}return d()(t,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:j,fontWeight:N,characterSet:z,fontSize:F,buffer:B,sdf:!0,cutoff:U,radius:V},this.key=""}},{key:"addIconGlyphs",value:function(t){var e=this;t.forEach((function(t){e.iconFontGlyphs[t.name]=t.unicode}))}},{key:"getGlyph",value:function(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}},{key:"setFontOptions",value:function(t){this.fontOptions=D(D({},this.fontOptions),t),this.key=this.getKey();var e=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(!n||0!==e.length){var r=this.generateFontAtlas(this.key,e,n);this.fontAtlas=r,this.cache.set(this.key,r)}}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(t,e,n){var r=this.fontOptions,i=r.fontFamily,o=r.fontWeight,a=r.fontSize,s=r.buffer,u=r.sdf,c=r.radius,l=r.cutoff,f=n&&n.data;f||(f=document.createElement("canvas"),f.width=G);var p=f.getContext("2d");X(p,i,a,o);var h=C(D({getFontWidth:function(t){return p.measureText(t).width},fontHeight:a*Z,buffer:s,characterSet:e,maxCanvasWidth:G},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),d=h.mapping,m=h.canvasHeight,v=h.xOffset,y=h.yOffset;if(f.height!==m){var _=p.getImageData(0,0,f.width,f.height);f.height=m,p.putImageData(_,0,0)}if(X(p,i,a,o),u){var b,x=new g.a(a,s,c,l,i,o),w=p.getImageData(0,0,x.size,x.size),S=I(e);try{for(S.s();!(b=S.n()).done;){var E=b.value;Y(x.draw(E),w),p.putImageData(w,d[E].x,d[E].y)}}catch(P){S.e(P)}finally{S.f()}}else{var T,A=I(e);try{for(A.s();!(T=A.n()).done;){var k=T.value;p.fillText(k,d[k].x,d[k].y+a*q)}}catch(P){A.e(P)}finally{A.f()}}return{xOffset:v,yOffset:y,mapping:d,data:f,width:f.width,height:f.height}}},{key:"getKey",value:function(){var t=this.fontOptions,e=t.fontFamily,n=t.fontWeight,r=t.fontSize,i=t.buffer,o=t.sdf,a=t.radius,s=t.cutoff;return o?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(a," ").concat(s):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}},{key:"getNewChars",value:function(t,e){var n=this.cache.get(t);if(!n)return e;var r=[],i=n.mapping,o=new Set(Object.keys(i)),a=new Set(e);return a.forEach((function(t){o.has(t)||r.push(t)})),r}},{key:"scale",get:function(){return Z}},{key:"canvas",get:function(){var t=this.cache.get(this.key);return t&&t.data}},{key:"mapping",get:function(){var t=this.cache.get(this.key);return t&&t.mapping}}]),t}(),E=T))||E),tt=n("7W2i"),et=n.n(tt),nt=n("a1gu"),rt=n.n(nt),it=n("Nsbk"),ot=n.n(it);function at(t){var e=st();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function st(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var ut,ct,lt,ft,pt,ht,dt=3,mt=1024,vt=64,gt=(K=Object(o["injectable"])(),K((Q=function(t){et()(n,t);var e=at(n);function n(){var t;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.canvasHeight=void 0,t.texture=void 0,t.canvas=void 0,t.iconData=void 0,t.iconMap=void 0,t.ctx=void 0,t}return d()(n,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(t,e){var n=this,r=new Image;if(this.hasImage(t))throw new Error("Image Id already exists");this.iconData.push({id:t,width:vt,height:vt}),this.updateIconMap(),this.loadImage(e).then((function(e){r=e;var i=n.iconData.find((function(e){return e.id===t}));i&&(i.image=r),n.update()}))}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(t){return this.iconMap.hasOwnProperty(t)}},{key:"removeImage",value:function(t){this.hasImage(t)&&(this.iconData=this.iconData.filter((function(e){return e.id!==t})),delete this.iconMap[t],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var t=this;this.canvas.width=mt,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach((function(e){var n=t.iconMap[e],r=n.x,i=n.y,o=n.image;o&&t.ctx.drawImage(o,r,i,vt,vt)}))}},{key:"updateIconMap",value:function(){var t=k(this.iconData,dt,mt),e=t.mapping,n=t.canvasHeight;this.iconMap=e,this.canvasHeight=n}},{key:"loadImage",value:function(t){return new Promise((function(e,n){if(t instanceof HTMLImageElement)e(t);else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){e(r)},r.onerror=function(){n(new Error("Could not load image at "+t))},r.src=t instanceof File?URL.createObjectURL(t):t}}))}}]),n}(r["EventEmitter"]),J=Q))||J),yt=n("J4zp"),_t=n.n(yt),bt=n("IOcx"),xt=(ut=Object(o["injectable"])(),ut((lt=function(){function t(){p()(this,t),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return d()(t,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=bt["a"].invert(bt["a"].create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=this.viewport.getCenter(),e=_t()(t,2),n=e[0],r=e[1];return[n,r]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,e){return this.viewport.projectFlat(t,e)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,e){var n=bt["a"].fromTranslation(bt["a"].create(),[t,e,0]);this.jitteredProjectionMatrix=bt["a"].multiply(bt["a"].create(),n,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=bt["a"].multiply(bt["a"].create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),t}(),ct=lt))||ct);function wt(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=St(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function St(t,e){if(t){if("string"===typeof t)return Et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Et(t,e):void 0}}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Tt,At,Ct,kt,Pt,Mt,It,Ot,Lt,Rt=(ft=Object(o["injectable"])(),ft((ht=function(){function t(){p()(this,t),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return d()(t,[{key:"init",value:function(t,e){this.container=t.container,this.scene=e,this.mapsService=e.get(u["a"].IMapService),this.initControlPos()}},{key:"addControl",value:function(t,e){var n=e.get(u["a"].IMapService);n.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find((function(e){return e.controlOption.name===t}))}},{key:"removeControl",value:function(t){var e=this.controls.indexOf(t);return e>-1&&this.controls.splice(e,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach((function(e){e.addTo(t.scene),t.controls.push(e)})),this.unAddControls=[]}},{key:"destroy",value:function(){var t,e=wt(this.controls);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.remove()}}catch(r){e.e(r)}finally{e.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},e="l7-",n=this.controlContainer=m["a"].create("div",e+"control-container",this.container);function r(r,i){var o=e+r+" "+e+i;t[r+i]=m["a"].create("div",o,n)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&m["a"].remove(this.controlCorners[t]);this.controlContainer&&m["a"].remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),t}(),pt=ht))||pt),Dt=(Tt=Object(o["injectable"])(),Tt((Ct=function(){function t(){p()(this,t),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return d()(t,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var e=this.markerLayers.indexOf(t);e>-1&&this.markerLayers.splice(e,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach((function(e){e.addTo(t.scene),t.markers.push(e)})),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach((function(e){t.markerLayers.push(e),e.addTo(t.scene)})),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var e=this.markers.indexOf(t);e>-1&&this.markers.splice(e,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(u["a"].IMapService)}},{key:"destroy",value:function(){this.markers.forEach((function(t){t.remove()})),this.markers=[],this.markerLayers.forEach((function(t){t.destroy()})),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),t}(),At=Ct))||At),zt=(kt=Object(o["injectable"])(),kt((Mt=function(){function t(){p()(this,t),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return d()(t,[{key:"removePopup",value:function(t){t.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(t){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(t.addTo(this.scene),this.popup=t):this.unAddPopup=t}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(u["a"].IMapService)}}]),t}(),Pt=Mt))||Pt),jt=n("QkVN"),Nt=n.n(jt),Ft={MapToken:"\u60a8\u6b63\u5728\u4f7f\u7528 Demo\u6d4b\u8bd5\u5730\u56fetoken\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u53bb\u5bf9\u5e94\u5730\u56fe\u8bf7\u6ce8\u518cToken",SDK:"\u8bf7\u786e\u8ba4\u5f15\u5165\u4e86mapbox-gl api\u4e14\u5728L7\u4e4b\u524d\u5f15\u5165"},Bt=Ft;function Ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Gt={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},qt={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},Zt=(It=Object(o["injectable"])(),It((Lt=function(){function t(){p()(this,t),this.sceneConfigCache={},this.layerConfigCache={}}return d()(t,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return Bt[t]}},{key:"setSceneConfig",value:function(t,e){this.sceneConfigCache[t]=Vt(Vt({},Gt),e)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,e,n){this.layerConfigCache[e]=Vt({},Nt()({},this.sceneConfigCache[t],qt,n))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),t}(),Ot=Lt))||Ot),Ht=n("yG8O"),Wt=n.n(Ht),Xt=n("U+yc"),Yt=n.n(Xt),Kt=(n("1ABj"),Math.PI/180),Jt=512,Qt=4003e4;function $t(t){var e=t.latitude,n=void 0===e?0:e,r=t.zoom,i=void 0===r?0:r,o=t.scale,a=t.highPrecision,s=void 0!==a&&a,u=t.flipY,c=void 0!==u&&u;o=void 0!==o?o:Math.pow(2,i);var l={},f=Jt*o,p=Math.cos(n*Kt),h=f/360,d=h/p,m=f/Qt/p;if(l.pixelsPerMeter=[m,-m,m],l.metersPerPixel=[1/m,-1/m,1/m],l.pixelsPerDegree=[h,-d,m],l.degreesPerPixel=[1/h,-1/d,1/m],s){var v=Kt*Math.tan(n*Kt)/p,g=h*v/2,y=f/Qt*v,_=y/d*m;l.pixelsPerDegree2=[0,-g,y],l.pixelsPerMeter2=[_,0,_],c&&(l.pixelsPerDegree2[1]=-l.pixelsPerDegree2[1],l.pixelsPerMeter2[1]=-l.pixelsPerMeter2[1])}return c&&(l.pixelsPerMeter[1]=-l.pixelsPerMeter[1],l.metersPerPixel[1]=-l.metersPerPixel[1],l.pixelsPerDegree[1]=-l.pixelsPerDegree[1],l.degreesPerPixel[1]=-l.degreesPerPixel[1]),l}var te,ee,ne,re,ie,oe,ae,se,ue,ce,le,fe,pe,he,de=n("HthE"),me=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],ve=(te=Object(o["injectable"])(),ee=Object(o["inject"])(u["a"].ICameraService),te((oe=function(){function t(){p()(this,t),this.needRefresh=!0,Wt()(this,"cameraService",ie,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return d()(t,[{key:"refresh",value:function(){var t=this.cameraService.getZoom(),e=this.cameraService.getZoomScale(),n=this.cameraService.getCenter(),r=$t({latitude:n[1],zoom:t}),i=r.pixelsPerMeter,o=r.pixelsPerDegree;this.viewportCenter=n,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=i,this.pixelsPerDegree=o,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===de["a"].LNGLAT||this.coordinateSystem===de["a"].P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===de["a"].LNGLAT_OFFSET?this.calculateLnglatOffset(n,t):this.coordinateSystem===de["a"].P20_OFFSET&&this.calculateLnglatOffset(n,t,e,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,e,n,r){var i=$t({latitude:t[1],zoom:e,scale:n,flipY:r,highPrecision:!0}),o=i.pixelsPerMeter,a=i.pixelsPerDegree,s=i.pixelsPerDegree2,u=this.cameraService.getViewMatrix(),c=this.cameraService.getProjectionMatrix(),l=bt["a"].multiply([],c,u),f=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,e));this.viewportCenterProjection=bt["d"].transformMat4([],[f[0],f[1],0,1],l),u=this.cameraService.getViewMatrixUncentered()||u,l=bt["a"].multiply([],c,u),l=bt["a"].multiply([],l,me),this.cameraService.setViewProjectionMatrix(l),this.pixelsPerMeter=o,this.pixelsPerDegree=a,this.pixelsPerDegree2=s}}]),t}(),re=oe,ie=Yt()(re.prototype,"cameraService",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=re))||ne),ge=n("PJYZ"),ye=n.n(ge),_e=n("yLV6"),be=n.n(_e),xe=n("V1cb");function we(t){var e=Se();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Se(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ee,Te,Ae,Ce,ke,Pe,Me,Ie,Oe,Le,Re,De,ze={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},je=(ae=Object(o["injectable"])(),se=Object(o["inject"])(u["a"].IMapService),ue=Object(o["inject"])(u["a"].ILogService),ae((he=function(t){et()(n,t);var e=we(n);function n(){var t;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Wt()(t,"mapService",fe,ye()(t)),Wt()(t,"logger",pe,ye()(t)),t.hammertime=void 0,t.lastClickTime=0,t.lastClickXY=[-1,-1],t.clickTimer=void 0,t.$containter=void 0,t.onDrag=function(e){var n=t.interactionEvent(e);n.type=ze[n.type],t.emit(xe["a"].Drag,n)},t.onHammer=function(e){e.srcEvent.stopPropagation();var n=t.interactionEvent(e);t.emit(xe["a"].Hover,n)},t.onTouch=function(e){var n=e.touches[0];t.onHover({x:n.pageX,y:n.pageY,type:"touch"})},t.onHover=function(e){var n=e.x,r=e.y,i=e.type,o=t.mapService.getMapContainer();if(o){var a=o.getBoundingClientRect(),s=a.top,u=a.left;n-=u,r-=s}var c=t.mapService.containerToLngLat([n,r]);if("click"!==i)"touch"!==i?"click"!==i&&"dblclick"!==i&&t.emit(xe["a"].Hover,{x:n,y:r,lngLat:c,type:i}):t.isDoubleTap(n,r,c);else{if("ontouchstart"in document.documentElement===!0)return;t.isDoubleTap(n,r,c)}},t}return d()(n,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(xe["a"].Hover)}},{key:"triggerHover",value:function(t){var e=t.x,n=t.y;this.emit(xe["a"].Hover,{x:e,y:n})}},{key:"triggerSelect",value:function(t){this.emit(xe["a"].Select,{featureId:t})}},{key:"triggerActive",value:function(t){this.emit(xe["a"].Active,{featureId:t})}},{key:"addEventListenerOnMap",value:function(){var t=this.mapService.getMapContainer();if(t){var e=new be.a.Manager(t);e.add(new be.a.Tap({event:"dblclick",taps:2})),e.add(new be.a.Tap({event:"click"})),e.add(new be.a.Pan({threshold:0,pointers:0})),e.add(new be.a.Press({})),e.on("dblclick click",this.onHammer),e.on("panstart panmove panend pancancel",this.onDrag),t.addEventListener("mousemove",this.onHover),t.addEventListener("mousedown",this.onHover),t.addEventListener("mouseup",this.onHover),t.addEventListener("contextmenu",this.onHover),this.hammertime=e,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var t=this.mapService.getMapContainer();t&&(t.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),t.removeEventListener("mousedown",this.onHover),t.removeEventListener("mouseup",this.onHover),t.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(t){var e,n,r=t.type,i=t.pointerType;"touch"===i?(n=Math.floor(t.pointers[0].clientY),e=Math.floor(t.pointers[0].clientX)):(n=Math.floor(t.srcEvent.y),e=Math.floor(t.srcEvent.x));var o=this.mapService.getMapContainer();if(o){var a=o.getBoundingClientRect(),s=a.top,u=a.left;e-=u,n-=s}var c=this.mapService.containerToLngLat([e,n]);return{x:e,y:n,lngLat:c,type:r}}},{key:"isDoubleTap",value:function(t,e,n){var r=this,i=(new Date).getTime(),o="click";i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-t)<10&&Math.abs(this.lastClickXY[1]-e)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),o="dblclick",this.emit(xe["a"].Hover,{x:t,y:e,lngLat:n,type:o})):(this.lastClickTime=i,this.lastClickXY=[t,e],this.clickTimer=setTimeout((function(){o="click",r.emit(xe["a"].Hover,{x:t,y:e,lngLat:n,type:o})}),400))}}]),n}(i.a),le=he,fe=Yt()(le.prototype,"mapService",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=Yt()(le.prototype,"logger",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=le))||ce),Ne=n("o0o1"),Fe=n.n(Ne),Be=n("yXPU"),Ue=n.n(Be),Ve=n("o+pz");function Ge(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ze,He,We,Xe,Ye,Ke,Je,Qe,$e,tn,en,nn,rn,on,an,sn=(Ee=Object(o["injectable"])(),Te=Object(o["inject"])(u["a"].IRendererService),Ae=Object(o["inject"])(u["a"].IGlobalConfigService),Ce=Object(o["inject"])(u["a"].IInteractionService),ke=Object(o["inject"])(u["a"].ILayerService),Ee((De=function(){function t(){var e=this;p()(this,t),Wt()(this,"rendererService",Ie,this),Wt()(this,"configService",Oe,this),Wt()(this,"interactionService",Le,this),Wt()(this,"layerService",Re,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(t,n){var r,i=n.x,o=n.y,a=n.lngLat,s=n.type,u=!1,c=e.rendererService,l=(c.getViewportSize,c.readPixels),f=c.getContainer,p=f().getBoundingClientRect(),h=p.width,d=p.height;h*=window.devicePixelRatio,d*=window.devicePixelRatio;var v,g=t.getLayerConfig(),y=g.enableHighlight,_=g.enableSelect,b=i*window.devicePixelRatio,x=o*window.devicePixelRatio;if(b>h-1*window.devicePixelRatio||b<0||x>d-1*window.devicePixelRatio||x<0)return!1;if(v=l({x:Math.floor(b/e.pickBufferScale),y:Math.floor((d-(o+1)*window.devicePixelRatio)/e.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:e.pickingFBO}),0!==v[0]||0!==v[1]||0!==v[2]){var w=Object(m["j"])(v),S=t.getSource().getFeatureById(w);w!==t.getCurrentPickId()&&"mousemove"===s&&(s="mouseenter");var E={x:i,y:o,type:s,lngLat:a,featureId:w,feature:S};S&&(u=!0,t.setCurrentPickId(w),e.triggerHoverOnLayer(t,E))}else{var T={x:i,y:o,lngLat:a,type:null!==t.getCurrentPickId()&&"mousemove"===s?"mouseout":"un"+s,featureId:null,feature:null};e.triggerHoverOnLayer(t,qe(qe({},T),{},{type:"unpick"})),e.triggerHoverOnLayer(t,T),t.setCurrentPickId(null)}if(y&&e.highlightPickedFeature(t,v),_&&"click"===s&&(null===(r=v)||void 0===r?void 0:r.toString())!==[0,0,0,0].toString()){var A=Object(m["j"])(v);null===t.getCurrentSelectedId()||A!==t.getCurrentSelectedId()?(e.selectFeature(t,v),t.setCurrentSelectedId(A)):(e.selectFeature(t,new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return u}}return d()(t,[{key:"init",value:function(t){var e=this.rendererService,n=e.createTexture2D,r=e.createFramebuffer,i=(e.getViewportSize,e.getContainer),o=i().getBoundingClientRect(),a=o.width,s=o.height;a*=window.devicePixelRatio,s*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=r({color:n({width:Math.round(a/this.pickBufferScale),height:Math.round(s/this.pickBufferScale),wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})}),this.interactionService.on(xe["a"].Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var t=Ue()(Fe.a.mark((function t(e){return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.alreadyInPicking&&!this.layerService.alreadyInRendering){t.next=2;break}return t.abrupt("return");case 2:return this.alreadyInPicking=!0,t.next=5,this.pickingLayers(e);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"pickingLayers",value:function(){var t=Ue()(Fe.a.mark((function t(e){var n,r,i,o,a,s,u,c=this;return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=this.rendererService,n.getViewportSize,r=n.useFramebuffer,i=n.clear,o=n.getContainer,a=o().getBoundingClientRect(),s=a.width,u=a.height,s*=window.devicePixelRatio,u*=window.devicePixelRatio,this.width===s&&this.height===u||(this.pickingFBO.resize({width:Math.round(s/this.pickBufferScale),height:Math.round(u/this.pickBufferScale)}),this.width=s,this.height=u),r(this.pickingFBO,(function(){var t=c.layerService.getLayers();t.filter((function(t){return t.needPick(e.type)})).reverse().some((function(t){i({framebuffer:c.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.hooks.beforePickingEncode.call(),t.renderModels(),t.hooks.afterPickingEncode.call();var n=c.pickFromPickingFBO(t,e);return n&&!t.getLayerConfig().enablePropagation}))}));case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"triggerHoverOnLayer",value:function(t,e){t.emit(e.type,e)}},{key:"highlightPickedFeature",value:function(t,e){var n=_t()(e,3),r=n[0],i=n[1],o=n[2];t.hooks.beforeHighlight.call([r,i,o])}},{key:"selectFeature",value:function(t,e){var n=_t()(e,3),r=n[0],i=n[1],o=n[2];t.hooks.beforeSelect.call([r,i,o])}}]),t}(),Me=De,Ie=Yt()(Me.prototype,"rendererService",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=Yt()(Me.prototype,"configService",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Yt()(Me.prototype,"interactionService",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Yt()(Me.prototype,"layerService",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pe=Me))||Pe),un=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];p()(this,t),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=e}return d()(t,[{key:"start",value:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"===typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}]),t}(),cn=(Ze=Object(o["injectable"])(),He=Object(o["inject"])(u["a"].IRendererService),We=Object(o["inject"])(u["a"].IGlobalConfigService),Ze((Qe=function(){function t(){p()(this,t),this.clock=new un,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,Wt()(this,"renderService",Ke,this),Wt()(this,"configService",Je,this)}return d()(t,[{key:"add",value:function(t){this.sceneInited&&t.init(),this.layers.push(t)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach((function(t){t.inited||t.init()}))}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(t){return this.layers.find((function(e){return e.id===t}))}},{key:"getLayerByName",value:function(t){return this.layers.find((function(e){return e.name===t}))}},{key:"remove",value:function(t){var e=this.layers.indexOf(t);e>-1&&this.layers.splice(e,1),t.emit("remove",null),t.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter((function(t){return t.inited})).filter((function(t){return t.isVisible()})).forEach((function(t){t.hooks.beforeRenderData.call(),t.hooks.beforeRender.call(),t.render(),t.hooks.afterRender.call()})),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort((function(t,e){return t.zIndex-e.zIndex}))}},{key:"destroy",value:function(){this.layers.forEach((function(t){return t.destroy()})),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){0===this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0===--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),t}(),Ye=Qe,Ke=Yt()(Ye.prototype,"renderService",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Yt()(Ye.prototype,"configService",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Ye))||Xe),ln=n("QILm"),fn=n.n(ln),pn=n("RIqP"),hn=n.n(pn),dn=n("J2iB"),mn=n.n(dn),vn=function(){function t(e){var n=this;p()(this,t),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:1/0},this.vertexAttribute=void 0,this.defaultCallback=function(t){var e;return 0===t.length?(null===(e=n.scale)||void 0===e?void 0:e.defaultValues)||[]:t.map((function(t,e){var r,i=(null===(r=n.scale)||void 0===r?void 0:r.scalers)[e].func,o=i(t);return o}))},this.setProps(e)}return d()(t,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var e;if(null===(e=this.scale)||void 0===e?void 0:e.callback){var n,r=null===(n=this.scale)||void 0===n?void 0:n.callback.apply(n,hn()(t));if(!mn()(r))return[r]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),t}();function gn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gn(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _n=($e={},l()($e,Ve["a"].FLOAT,4),l()($e,Ve["a"].UNSIGNED_BYTE,1),l()($e,Ve["a"].UNSIGNED_SHORT,2),$e),bn=(tn=Object(o["injectable"])(),en=Object(o["inject"])(u["a"].IRendererService),tn((an=function(){function t(){p()(this,t),this.attributesAndIndices=void 0,Wt()(this,"rendererService",on,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return d()(t,[{key:"registerStyleAttribute",value:function(t){var e=this.getLayerStyleAttribute(t.name||"");return e?e.setProps(t):(e=new vn(t),this.attributes.push(e)),e}},{key:"updateStyleAttribute",value:function(t,e,n){var r=this.getLayerStyleAttribute(t);r||(r=this.registerStyleAttribute(yn(yn({},e),{},{name:t})));var i=e.scale;i&&r&&(r.scale=i,r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0,n&&n.featureRange&&(r.featureRange=n.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find((function(e){return e.name===t}))}},{key:"getLayerAttributeScale",value:function(t){var e,n=this.getLayerStyleAttribute(t),r=null===n||void 0===n||null===(e=n.scale)||void 0===e?void 0:e.scalers;return r&&r[0]?r[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=this.attributes.find((function(e){return e.name===t}));if(i&&i.descriptor){var o=i.descriptor,a=o.update,s=o.buffer,u=o.size,c=void 0===u?0:u,l=_n[s.type||Ve["a"].FLOAT];if(a){var f=this.featureLayout,p=f.elements,h=f.sizePerElement,d=p.slice(n,r);if(!d.length)return;var m=d[0].offset,v=m*c*l,g=d.map((function(t,n){for(var r=t.featureIdx,i=t.vertices,o=t.normals,s=i.length/h,u=[],c=0;c<s;c++){var l=o?o.slice(3*c,3*c+3):[];u.push.apply(u,hn()(a(e[r],r,i.slice(c*h,c*h+h),n,l)))}return u})).reduce((function(t,e){return t.push.apply(t,hn()(e)),t}),[]);i.vertexAttribute.updateBuffer({data:g,offset:v})}}}},{key:"createAttributesAndIndices",value:function(t,e){var n=this;this.featureLayout={sizePerElement:0,elements:[]},e&&(this.triangulation=e);var r=this.attributes.map((function(t){return t.resetDescriptor(),t.descriptor})),i=0,o=[],a=3;t.forEach((function(t,e){var s=n.triangulation(t),u=s.indices,c=s.vertices,l=s.normals,f=s.size;u.forEach((function(t){o.push(t+i)})),a=f;var p=c.length/f;n.featureLayout.sizePerElement=a,n.featureLayout.elements.push({featureIdx:e,vertices:c,normals:l,offset:i}),i+=p;for(var h=function(n){var i=(null===l||void 0===l?void 0:l.slice(3*n,3*n+3))||[],o=c.slice(n*f,n*f+f);r.forEach((function(r,a){var s;r&&r.update&&(s=r.buffer.data).push.apply(s,hn()(r.update(t,e,o,n,i)))}))},d=0;d<p;d++)h(d)}));var s=this.rendererService,u=s.createAttribute,c=s.createBuffer,l=s.createElements,f={};r.forEach((function(t,e){if(t){var r=t.buffer,i=(t.update,t.name,fn()(t,["buffer","update","name"])),o=u(yn({buffer:c(r)},i));f[t.name||""]=o,n.attributes[e].vertexAttribute=o}}));var p=l({data:o,type:Ve["a"].UNSIGNED_INT,count:o.length});return this.attributesAndIndices={attributes:f,elements:p},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){this.attributes.forEach((function(t){t.vertexAttribute&&t.vertexAttribute.destroy()})),this.attributesAndIndices.elements.destroy(),this.attributes=[]}}]),t}(),rn=an,on=Yt()(rn.prototype,"rendererService",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn=rn))||nn),xn=n("U8pU"),wn=n("KQm4"),Sn=n("rePB"),En=n("1OyB"),Tn=n("vuIU"),An=n("5ku3"),Cn="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source",kn=Object(An["a"])();function Pn(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(r){return null}}var Mn=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(En["a"])(this,t),this.storage=Pn(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(Tn["a"])(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}();function In(t){var e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}function On(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Ln(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}var Rn={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Dn(t){return"string"===typeof t?Rn[t.toUpperCase()]||Rn.WHITE:t}function zn(t,e,n){return kn||"string"!==typeof t||(e&&(e=Dn(e),t="\x1b[".concat(e,"m").concat(t,"\x1b[39m")),n&&(e=Dn(n),t="\x1b[".concat(n+10,"m").concat(t,"\x1b[49m"))),t}function jn(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=Nn(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r["return"]||r["return"]()}finally{if(a)throw i}}}}function Nn(t,e){if(t){if("string"===typeof t)return Fn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fn(t,e):void 0}}function Fn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Bn(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(r),o=jn(i);try{var a=function(){var r=e.value;"function"===typeof t[r]&&(n.find((function(t){return r===t}))||(t[r]=t[r].bind(t)))};for(o.s();!(e=o.n()).done;)a()}catch(s){o.e(s)}finally{o.f()}}function Un(t,e){if(!t)throw new Error(e||"Assertion failed")}var Vn=n("K9nA");function Gn(){var t;if(kn&&Vn["b"].performance)t=Vn["b"].performance.now();else if(Vn["a"].hrtime){var e=Vn["a"].hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}var qn={debug:kn&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Zn={enabled:!0,level:0};function Hn(){}var Wn={},Xn={once:!0};function Yn(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}var Kn,Jn,Qn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id;Object(En["a"])(this,t),this.id=n,this.VERSION=Cn,this._startTs=Gn(),this._deltaTs=Gn(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Mn("__probe-".concat(this.id,"__"),Zn),this.userData={},this.timeStamp("".concat(this.id," started")),Bn(this),Object.seal(this)}return Object(Tn["a"])(t,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Gn()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Gn()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({level:t}),this}},{key:"assert",value:function(t,e){Un(t,e)}},{key:"warn",value:function(t){return this._getLogFunction(0,t,qn.warn,arguments,Xn)}},{key:"error",value:function(t){return this._getLogFunction(0,t,qn.error,arguments)}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){return this._getLogFunction(t,e,qn.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(t,e){return this._getLogFunction(t,e,qn.debug,arguments)}},{key:"info",value:function(t,e){return this._getLogFunction(t,e,console.info,arguments)}},{key:"once",value:function(t,e){return this._getLogFunction(t,e,qn.debug||qn.info,arguments,Xn)}},{key:"table",value:function(t,e,n){return e?this._getLogFunction(t,e,console.table||Hn,n&&[n],{tag:Yn(e)}):Hn}},{key:"image",value:function(t){var e=t.logLevel,n=t.priority,r=t.image,i=t.message,o=void 0===i?"":i,a=t.scale,s=void 0===a?1:a;return this._shouldLog(e||n)?kn?rr({image:r,message:o,scale:s}):nr({image:r,message:o,scale:s}):Hn}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,e){this._storage.updateConfiguration(Object(Sn["a"])({},t,e))}},{key:"time",value:function(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}},{key:"timeEnd",value:function(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(t,e){return this._getLogFunction(t,e,console.timeStamp||Hn)}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};n=tr({logLevel:t,message:e,opts:n});var r=n,i=r.collapsed;return n.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction(t,"",console.groupEnd||Hn)}},{key:"withGroup",value:function(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return this.isEnabled()&&this.getLevel()>=$n(t)}},{key:"_getLogFunction",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(t)){var o;i=tr({logLevel:t,message:e,args:r,opts:i}),n=n||i.method,Un(n),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Gn();var a=i.tag||i.message;if(i.once){if(Wn[a])return Hn;Wn[a]=Gn()}return e=er(this.id,i.message,i),(o=n).bind.apply(o,[console,e].concat(Object(wn["a"])(i.args)))}return Hn}},{key:"level",set:function(t){this.setLevel(t)},get:function(){return this.getLevel()}},{key:"priority",set:function(t){this.level=t},get:function(){return this.level}}]),t}();function $n(t){if(!t)return 0;var e;switch(Object(xn["a"])(t)){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Un(Number.isFinite(e)&&e>=0),e}function tr(t){var e=t.logLevel,n=t.message;t.logLevel=$n(e);var r=t.args?Array.from(t.args):[];while(r.length&&r.shift()!==n);switch(t.args=r,Object(xn["a"])(e)){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break;default:}"function"===typeof t.message&&(t.message=t.message());var i=Object(xn["a"])(t.message);return Un("string"===i||"object"===i),Object.assign(t,t.opts)}function er(t,e,n){if("string"===typeof e){var r=n.time?On(In(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=zn(e,n.color,n.background)}return e}function nr(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(2)}catch(a){}return o?function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((function(t){return console.log(t)}))}:Hn}function rr(t){var e=t.image,n=t.message,r=void 0===n?"":n,i=t.scale,o=void 0===i?1:i;if("string"===typeof e){var a=new Image;return a.onload=function(){var t,e=Ln(a,r,o);(t=console).log.apply(t,Object(wn["a"])(e))},a.src=e,Hn}var s,u=e.nodeName||"";if("img"===u.toLowerCase())return(s=console).log.apply(s,Object(wn["a"])(Ln(e,r,o))),Hn;if("canvas"===u.toLowerCase()){var c=new Image;return c.onload=function(){var t;return(t=console).log.apply(t,Object(wn["a"])(Ln(c,r,o)))},c.src=e.toDataURL(),Hn}return Hn}Qn.VERSION=Cn;var ir=new Qn({id:"L7"}).enable(!1);ir.priority=5;var or,ar,sr,ur,cr,lr,fr,pr,hr,dr,mr,vr,gr,yr,_r,br,xr,wr,Sr,Er,Tr,Ar,Cr,kr,Pr,Mr,Ir,Or,Lr,Rr,Dr,zr,jr,Nr,Fr,Br,Ur=(Kn=Object(o["injectable"])(),Kn(Jn=function(){function t(){p()(this,t)}return d()(t,[{key:"error",value:function(t){ir.error(t)()}},{key:"warn",value:function(t){ir.probe(1,t)()}},{key:"info",value:function(t){ir.info(3,t)()}},{key:"debug",value:function(t){ir.probe(4,t)()}}]),t}())||Jn),Vr=n("xp6e"),Gr=n("iegG"),qr=n.n(Gr),Zr=(window.document.documentElement.style,0);function Hr(t){var e=t;if("string"===typeof t&&(e=document.getElementById(t)),e){var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",n.id="l7-scene-".concat(Zr++),n.classList.add("l7-scene"),e.appendChild(n),n}return null}function Wr(t){var e=Xr();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Xr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Yr=(or=Object(o["injectable"])(),ar=Object(o["inject"])(u["a"].SceneID),sr=Object(o["inject"])(u["a"].IIconService),ur=Object(o["inject"])(u["a"].IFontService),cr=Object(o["inject"])(u["a"].IControlService),lr=Object(o["inject"])(u["a"].ILogService),fr=Object(o["inject"])(u["a"].IGlobalConfigService),pr=Object(o["inject"])(u["a"].IMapService),hr=Object(o["inject"])(u["a"].ICoordinateSystemService),dr=Object(o["inject"])(u["a"].IRendererService),mr=Object(o["inject"])(u["a"].ILayerService),vr=Object(o["inject"])(u["a"].ICameraService),gr=Object(o["inject"])(u["a"].IInteractionService),yr=Object(o["inject"])(u["a"].IPickingService),_r=Object(o["inject"])(u["a"].IShaderModuleService),br=Object(o["inject"])(u["a"].IMarkerService),xr=Object(o["inject"])(u["a"].IPopupService),or((Br=function(t){et()(n,t);var e=Wr(n);function n(){var t;return p()(this,n),t=e.call(this),t.destroyed=!1,t.loaded=!1,Wt()(t,"id",Er,ye()(t)),Wt()(t,"iconService",Tr,ye()(t)),Wt()(t,"fontService",Ar,ye()(t)),Wt()(t,"controlService",Cr,ye()(t)),Wt()(t,"logger",kr,ye()(t)),Wt()(t,"configService",Pr,ye()(t)),Wt()(t,"map",Mr,ye()(t)),Wt()(t,"coordinateSystemService",Ir,ye()(t)),Wt()(t,"rendererService",Or,ye()(t)),Wt()(t,"layerService",Lr,ye()(t)),Wt()(t,"cameraService",Rr,ye()(t)),Wt()(t,"interactionService",Dr,ye()(t)),Wt()(t,"pickingService",zr,ye()(t)),Wt()(t,"shaderModuleService",jr,ye()(t)),Wt()(t,"markerService",Nr,ye()(t)),Wt()(t,"popupService",Fr,ye()(t)),t.inited=!1,t.initPromise=void 0,t.rendering=!1,t.$container=void 0,t.canvas=void 0,t.hooks=void 0,t.handleWindowResized=function(){t.emit("resize"),t.$container&&(t.initContainer(),m["a"].triggerResize(),t.coordinateSystemService.needRefresh=!0,t.render())},t.handleMapCameraChanged=function(e){t.cameraService.update(e),t.render()},t.hooks={init:new Vr["a"]},t}return d()(n,[{key:"init",value:function(t){var e=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ue()(Fe.a.mark((function t(){return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){e.map.onCameraChanged((function(n){e.cameraService.init(),e.cameraService.update(n),t()})),e.map.init()}));case 2:e.map.onCameraChanged(e.handleMapCameraChanged),e.map.addMarkerContainer(),e.markerService.addMarkers(),e.markerService.addMarkerLayers(),e.popupService.initPopup(),e.interactionService.init(),e.interactionService.on(xe["a"].Drag,e.addSceneEvent.bind(e)),e.logger.debug("map ".concat(e.id," loaded"));case 10:case"end":return t.stop()}}),t)})))),this.hooks.init.tapPromise("initRenderer",Ue()(Fe.a.mark((function t(){var n;return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Hr(e.configService.getSceneConfig(e.id).id||""),e.$container=n,!n){t.next=11;break}return e.canvas=m["a"].create("canvas","",n),e.setCanvas(),t.next=7,e.rendererService.init(e.canvas,e.configService.getSceneConfig(e.id));case 7:qr()(e.$container,e.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(e.handleWindowResized),t.next=12;break;case 11:e.logger.error("\u5bb9\u5668 id \u4e0d\u5b58\u5728");case 12:e.pickingService.init(e.id),e.logger.debug("scene ".concat(e.id," renderer loaded"));case 14:case"end":return t.stop()}}),t)})))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(t){this.logger.debug("add layer ".concat(t.name," to scene ").concat(this.id)),this.layerService.add(t),this.render()}},{key:"render",value:function(){var t=Ue()(Fe.a.mark((function t(){return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.rendering&&!this.destroyed){t.next=2;break}return t.abrupt("return");case 2:if(this.rendering=!0,this.inited){t.next=13;break}return t.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(t){var e,n=null===(e=this.$container)||void 0===e?void 0:e.getElementsByTagName("canvas")[0];this.render();var r="jpg"===t?null===n||void 0===n?void 0:n.toDataURL("image/jpeg"):null===n||void 0===n?void 0:n.toDataURL("image/png");return r}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"destroy",value:function(){this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Gr["unbind"])(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)):this.destroyed=!0}},{key:"initContainer",value:function(){var t,e,n=window.devicePixelRatio,r=(null===(t=this.$container)||void 0===t?void 0:t.clientWidth)||400,i=(null===(e=this.$container)||void 0===e?void 0:e.clientHeight)||300,o=this.canvas;o&&(o.width=r*n,o.height=i*n,o.style.width="".concat(r,"px"),o.style.height="".concat(i,"px")),this.rendererService.viewport({x:0,y:0,width:n*r,height:n*i})}},{key:"setCanvas",value:function(){var t,e,n=window.devicePixelRatio,r=(null===(t=this.$container)||void 0===t?void 0:t.clientWidth)||400,i=(null===(e=this.$container)||void 0===e?void 0:e.clientHeight)||300,o=this.canvas;o.width=r*n,o.height=i*n,o.style.width="".concat(r,"px"),o.style.height="".concat(i,"px")}},{key:"addSceneEvent",value:function(t){this.emit(t.type,t)}}]),n}(r["EventEmitter"]),Sr=Br,Er=Yt()(Sr.prototype,"id",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tr=Yt()(Sr.prototype,"iconService",[sr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar=Yt()(Sr.prototype,"fontService",[ur],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cr=Yt()(Sr.prototype,"controlService",[cr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kr=Yt()(Sr.prototype,"logger",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pr=Yt()(Sr.prototype,"configService",[fr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr=Yt()(Sr.prototype,"map",[pr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ir=Yt()(Sr.prototype,"coordinateSystemService",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Or=Yt()(Sr.prototype,"rendererService",[dr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lr=Yt()(Sr.prototype,"layerService",[mr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=Yt()(Sr.prototype,"cameraService",[vr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr=Yt()(Sr.prototype,"interactionService",[gr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=Yt()(Sr.prototype,"pickingService",[yr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jr=Yt()(Sr.prototype,"shaderModuleService",[_r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nr=Yt()(Sr.prototype,"markerService",[br],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fr=Yt()(Sr.prototype,"popupService",[xr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wr=Sr))||wr),Kr=n("7tbW"),Jr=n.n(Kr);function Qr(t){var e=0;switch(t){case"vec2":case"ivec2":e=2;break;case"vec3":case"ivec3":e=3;break;case"vec4":case"ivec4":case"mat2":e=4;break;case"mat3":e=9;break;case"mat4":e=16;break;default:}return e}var $r,ti,ei,ni=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function ri(t){var e={};return t=t.replace(ni,(function(t,n,r){var i=r.split(":"),o=i[0].trim(),a="";switch(i.length>1&&(a=i[1].trim()),n){case"bool":a="true"===a;break;case"float":case"int":a=Number(a);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":a=a?a.replace("[","").replace("]","").split(",").reduce((function(t,e){return t.push(Number(e.trim())),t}),[]):new Array(Qr(n)).fill(0);break;default:}return e[o]=a,"uniform ".concat(n," ").concat(o,";\n")})),{content:t,uniforms:e}}function ii(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function oi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ii(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ii(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ai,si,ui,ci,li,fi,pi,hi,di="#define PI 3.14159265359",mi="#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",vi="#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",gi="// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",yi="varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n",_i="attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n",bi="\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n",xi="#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n  return position;\n\n  // TODO: \u74e6\u7247\u5750\u6807\u7cfb & \u5e38\u89c4\u4e16\u754c\u5750\u6807\u7cfb\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}\n\n",wi="/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n",Si=/precision\s+(high|low|medium)p\s+float/,Ei="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n",Ti=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Ai=($r=Object(o["injectable"])(),$r((ei=function(){function t(){p()(this,t),this.moduleCache={},this.rawContentCache={}}return d()(t,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:di,fs:di}),this.registerModule("decode",{vs:mi,fs:""}),this.registerModule("projection",{vs:xi,fs:""}),this.registerModule("project",{vs:bi,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:wi}),this.registerModule("lighting",{vs:gi,fs:""}),this.registerModule("light",{vs:vi,fs:""}),this.registerModule("picking",{vs:_i,fs:yi})}},{key:"registerModule",value:function(t,e){if(!this.rawContentCache[t]){var n=e.vs,r=e.fs,i=e.uniforms,o=ri(n),a=o.content,s=o.uniforms,u=ri(r),c=u.content,l=u.uniforms;this.rawContentCache[t]={fs:c,uniforms:oi(oi(oi({},s),l),i),vs:a}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var e=this;if(this.moduleCache[t])return this.moduleCache[t];var n=this.rawContentCache[t].vs,r=this.rawContentCache[t].fs,i=this.processModule(n,[],"vs"),o=i.content,a=i.includeList,s=this.processModule(r,[],"fs"),u=s.content,c=s.includeList,l=u,f=Jr()(a.concat(c).concat(t)).reduce((function(t,n){return oi(oi({},t),e.rawContentCache[n].uniforms)}),{});return Si.test(u)||(l=Ei+u),this.moduleCache[t]={fs:l.trim(),uniforms:f,vs:o.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,e,n){var r=this,i=t.replace(Ti,(function(t,i){var o=i.split(" "),a=o[0].replace(/"/g,"");if(e.indexOf(a)>-1)return"";var s=r.rawContentCache[a][n];e.push(a);var u=r.processModule(s,e,n),c=u.content;return c}));return{content:i,includeList:e}}}]),t}(),ti=ei))||ti),Ci=n("iWIM"),ki=n.n(Ci),Pi=n("bPkA"),Mi=(ai=Object(o["injectable"])(),si=Object(o["inject"])(u["a"].IShaderModuleService),ai((fi=function(){function t(){p()(this,t),Wt()(this,"shaderModuleService",li,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return d()(t,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Pi["a"].Normal}},{key:"init",value:function(t,e){this.config=e,this.rendererService=t.getContainer().get(u["a"].IRendererService),this.cameraService=t.getContainer().get(u["a"].ICameraService),this.mapService=t.getContainer().get(u["a"].IMapService),this.interactionService=t.getContainer().get(u["a"].IInteractionService),this.layerService=t.getContainer().get(u["a"].ILayerService)}},{key:"render",value:function(t){}}]),t}(),ci=fi,li=Yt()(ci.prototype,"shaderModuleService",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ui=ci))||ui);function Ii(t){var e=Oi();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Oi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Li,Ri,Di,zi,ji,Ni,Fi=(pi=Object(o["injectable"])(),pi(hi=function(t){et()(n,t);var e=Ii(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(t,e){ki()(ot()(n.prototype),"init",this).call(this,t,e)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),n}(Mi))||hi);function Bi(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=Ui(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Ui(t,e){if(t){if("string"===typeof t)return Vi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vi(t,e):void 0}}function Vi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Gi,qi,Zi,Hi,Wi,Xi,Yi=(Li=Object(o["injectable"])(),Ri=Object(o["inject"])(u["a"].IPostProcessor),Li((Ni=function(){function t(){p()(this,t),this.passes=[],Wt()(this,"postProcessor",ji,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return d()(t,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var t=Ue()(Fe.a.mark((function t(){var e,n,r;return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=Bi(this.passes),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.render(this.layer);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:this.layer.renderModels();case 18:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"resize",value:function(t,e){this.width===t&&this.height===e||(this.postProcessor.resize(t,e),this.width=t,this.height=e)}},{key:"add",value:function(t,e){t.getType()===Pi["a"].PostProcessing?this.postProcessor.add(t,this.layer,e):(t.init(this.layer,e),this.passes.push(t))}},{key:"insert",value:function(t,e,n){t.init(this.layer,e),this.passes.splice(n,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),t}(),zi=Ni,ji=Yt()(zi.prototype,"postProcessor",[Ri],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Di=zi))||Di);function Ki(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ji(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ki(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ki(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qi(t){var e=$i();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function $i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var to,eo,no=(Gi=Object(o["injectable"])(),qi=Object(o["inject"])(u["a"].ILogService),Gi((Xi=function(t){et()(n,t);var e=Qi(n);function n(){var t;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Wt()(t,"logger",Wi,ye()(t)),t.pickingFBO=void 0,t.layer=void 0,t.width=0,t.height=0,t.alreadyInRendering=!1,t.pickFromPickingFBO=function(e){var n=e.x,r=e.y,i=e.lngLat,o=e.type;if(t.layer.isVisible()&&t.layer.needPick(o)){var a,s=t.rendererService,u=s.getViewportSize,c=s.readPixels,l=s.useFramebuffer,f=u(),p=f.width,h=f.height,d=t.layer.getLayerConfig(),v=d.enableHighlight,g=d.enableSelect,y=n*window.devicePixelRatio,_=r*window.devicePixelRatio;if(!(y>p||y<0||_>h||_<0))l(t.pickingFBO,(function(){var e;if(a=c({x:Math.round(y),y:Math.round(h-(r+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}),0!==a[0]||0!==a[1]||0!==a[2]){t.logger.debug("picked");var s=Object(m["j"])(a),u=t.layer.getSource().getFeatureById(s),l={x:n,y:r,type:o,lngLat:i,featureId:s,feature:u};u&&(t.layer.setCurrentPickId(s),t.triggerHoverOnLayer(l))}else{var f={x:n,y:r,lngLat:i,type:null===t.layer.getCurrentPickId()?"un"+o:"mouseout",featureId:null,feature:null};t.triggerHoverOnLayer(Ji(Ji({},f),{},{type:"unpick"})),t.triggerHoverOnLayer(f),t.layer.setCurrentPickId(null)}v&&t.highlightPickedFeature(a),g&&"click"===o&&(null===(e=a)||void 0===e?void 0:e.toString())!==[0,0,0,0].toString()&&t.selectFeature(a)}))}},t}return d()(n,[{key:"getType",value:function(){return Pi["a"].Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(t,e){ki()(ot()(n.prototype),"init",this).call(this,t,e),this.layer=t;var r=this.rendererService,i=r.createTexture2D,o=r.createFramebuffer,a=r.getViewportSize,s=a(),u=s.width,c=s.height;this.pickingFBO=o({color:i({width:u,height:c,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})}),this.interactionService.on(xe["a"].Hover,this.pickFromPickingFBO),this.interactionService.on(xe["a"].Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(xe["a"].Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(t){var e=this;if(!this.alreadyInRendering){var n=this.rendererService,r=n.getViewportSize,i=n.useFramebuffer,o=n.clear,a=r(),s=a.width,u=a.height;this.alreadyInRendering=!0,this.width===s&&this.height===u||(this.pickingFBO.resize({width:s,height:u}),this.width=s,this.height=u),i(this.pickingFBO,(function(){o({framebuffer:e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n=e.layer.multiPassRenderer.getRenderFlag();e.layer.multiPassRenderer.setRenderFlag(!1),t.hooks.beforePickingEncode.call(),t.render(),t.hooks.afterPickingEncode.call(),e.layer.multiPassRenderer.setRenderFlag(n),e.alreadyInRendering=!1}))}}},{key:"triggerHoverOnLayer",value:function(t){this.layer.emit(t.type,t)}},{key:"highlightPickedFeature",value:function(t){var e=_t()(t,3),n=e[0],r=e[1],i=e[2];this.layer.hooks.beforeHighlight.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(t){var e=_t()(t,3),n=e[0],r=e[1],i=e[2];this.layer.hooks.beforeSelect.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(t){var e=t.featureId,n=Object(m["k"])(e);this.selectFeature(new Uint8Array(n))}},{key:"highlightFeatureHandle",value:function(t){var e=t.featureId,n=Object(m["k"])(e);this.highlightPickedFeature(new Uint8Array(n))}}]),n}(Mi),Hi=Xi,Wi=Yt()(Hi.prototype,"logger",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zi=Hi))||Zi),ro=n("+em5");function io(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function oo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?io(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ao(t){var e=so();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function so(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var uo,co,lo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}",fo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",po=(to=Object(o["injectable"])(),to(eo=function(t){et()(n,t);var e=ao(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:fo,fs:lo});var t=this.shaderModuleService.getModule("blur-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:oo(oo({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(t){var e={};return mn()(t.blurRadius)||(e.u_BlurDir=[t.blurRadius,0]),e}}]),n}(ro["a"]))||eo);function ho(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function mo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ho(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ho(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vo(t){var e=go();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function go(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var yo,_o,bo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}",xo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",wo=(uo=Object(o["injectable"])(),uo(co=function(t){et()(n,t);var e=vo(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:xo,fs:bo});var t=this.shaderModuleService.getModule("blur-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:mo(mo({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(t){var e={};return mn()(t.blurRadius)||(e.u_BlurDir=[0,t.blurRadius]),e}}]),n}(ro["a"]))||co);function So(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Eo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?So(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):So(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function To(t){var e=Ao();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Ao(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Co,ko,Po='varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}',Mo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",Io=(yo=Object(o["injectable"])(),yo(_o=function(t){et()(n,t);var e=To(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Mo,fs:Po});var t=this.shaderModuleService.getModule("colorhalftone-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Eo(Eo({},r),{},{u_ViewportSize:[o,a]})}}}]),n}(ro["a"]))||_o);function Oo(t){var e=Lo();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Lo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ro,Do,zo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",jo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",No=(Co=Object(o["injectable"])(),Co(ko=function(t){et()(n,t);var e=Oo(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:jo,fs:zo}),this.shaderModuleService.getModule("copy-pass")}}]),n}(ro["a"]))||ko);function Fo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fo(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Uo(t){var e=Vo();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Vo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Go,qo,Zo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}",Ho="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",Wo=(Ro=Object(o["injectable"])(),Ro(Do=function(t){et()(n,t);var e=Uo(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Ho,fs:Zo});var t=this.shaderModuleService.getModule("hexagonalpixelate-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Bo(Bo({},r),{},{u_ViewportSize:[o,a]})}}}]),n}(ro["a"]))||Do);function Xo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Yo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xo(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ko(t){var e=Jo();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Jo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Qo,$o,ta="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}",ea="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",na=(Go=Object(o["injectable"])(),Go(qo=function(t){et()(n,t);var e=Ko(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:ea,fs:ta});var t=this.shaderModuleService.getModule("ink-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Yo(Yo({},r),{},{u_ViewportSize:[o,a]})}}}]),n}(ro["a"]))||qo);function ra(t){var e=ia();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function ia(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var oa,aa,sa="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}",ua="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",ca=(Qo=Object(o["injectable"])(),Qo($o=function(t){et()(n,t);var e=ra(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:ua,fs:sa}),this.shaderModuleService.getModule("noise-pass")}}]),n}(ro["a"]))||$o);function la(t){var e=fa();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function fa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var pa,ha,da,ma,va,ga,ya,_a,ba,xa="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",wa="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}",Sa=(oa=Object(o["injectable"])(),oa(aa=function(t){et()(n,t);var e=la(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:xa,fs:wa}),this.shaderModuleService.getModule("sepia-pass")}}]),n}(ro["a"]))||aa),Ea=(pa=Object(o["injectable"])(),ha=Object(o["inject"])(u["a"].IRendererService),da=Object(o["postConstruct"])(),pa((ya=function(){function t(){p()(this,t),Wt()(this,"rendererService",ga,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return d()(t,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var t=Ue()(Fe.a.mark((function t(e){var n,r;return Fe.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.passes.length)){t.next=10;break}return r=this.passes[n],r.setRenderToScreen(this.isLastEnabledPass(n)),t.next=6,r.render(e);case 6:n!==this.passes.length-1&&this.swap();case 7:n++,t.next=1;break;case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"resize",value:function(t,e){this.readFBO.resize({width:t,height:e}),this.writeFBO.resize({width:t,height:e})}},{key:"add",value:function(t,e,n){t.init(e,n),this.passes.push(t)}},{key:"insert",value:function(t,e,n,r){t.init(n,r),this.passes.splice(e,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find((function(e){return e.getName()===t}))}},{key:"init",value:function(){var t=this.rendererService,e=t.createFramebuffer,n=t.createTexture2D;this.readFBO=e({color:n({width:1,height:1,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})}),this.writeFBO=e({color:n({width:1,height:1,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),t}(),va=ya,ga=Yt()(va.prototype,"rendererService",[ha],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt()(va.prototype,"init",[da],Object.getOwnPropertyDescriptor(va.prototype,"init"),va.prototype),ma=va))||ma);function Ta(t){var e=Aa();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Aa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ca,ka,Pa,Ma,Ia,Oa,La,Ra,Da=(_a=Object(o["injectable"])(),_a(ba=function(t){et()(n,t);var e=Ta(n);function n(){return p()(this,n),e.apply(this,arguments)}return d()(n,[{key:"getType",value:function(){return Pi["a"].Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(t,e){ki()(ot()(n.prototype),"init",this).call(this,t,e)}},{key:"render",value:function(t){var e=this.rendererService,n=e.useFramebuffer,r=e.clear,i=t.multiPassRenderer.getPostProcessor().getReadFBO();n(i,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i}),t.multiPassRenderer.setRenderFlag(!1),t.render(),t.multiPassRenderer.setRenderFlag(!0)}))}}]),n}(Mi))||ba);function za(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ja(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?za(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):za(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Na(t){var e=Fa();return function(){var n,r=ot()(t);if(e){var i=ot()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rt()(this,n)}}function Fa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ba="uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n",Ua="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",Va="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}";function Ga(t,e){var n=0,r=1/e,i=t;while(i>0)n+=r*(i%e),i=Math.floor(i/e),r/=e;return n}var qa=1,Za=(Ca=Object(o["injectable"])(),ka=Object(o["inject"])(u["a"].IShaderModuleService),Pa=Object(o["inject"])(u["a"].ILogService),Ca((Ra=function(t){et()(n,t);var e=Na(n);function n(){var t;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Wt()(t,"shaderModuleService",Oa,ye()(t)),Wt()(t,"logger",La,ye()(t)),t.haltonSequence=[],t.accumulatingId=0,t.frame=0,t.timer=void 0,t.sampleRenderTarget=void 0,t.prevRenderTarget=void 0,t.outputRenderTarget=void 0,t.copyRenderTarget=void 0,t.blendModel=void 0,t.outputModel=void 0,t.copyModel=void 0,t}return d()(n,[{key:"getType",value:function(){return Pi["a"].Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(t,e){ki()(ot()(n.prototype),"init",this).call(this,t,e);var r=this.rendererService,i=r.createFramebuffer,o=r.createTexture2D;this.sampleRenderTarget=i({color:o({width:1,height:1,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})}),this.prevRenderTarget=i({color:o({width:1,height:1,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})}),this.outputRenderTarget=i({color:o({width:1,height:1,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})}),this.copyRenderTarget=i({color:o({width:1,height:1,wrapS:Ve["a"].CLAMP_TO_EDGE,wrapT:Ve["a"].CLAMP_TO_EDGE})});for(var a=0;a<30;a++)this.haltonSequence.push([Ga(a,2),Ga(a,3)]);this.blendModel=this.createTriangleModel("blend-pass",Ba),this.outputModel=this.createTriangleModel("copy-pass",Ua,{blend:{enable:!0,func:{srcRGB:Ve["a"].ONE,dstRGB:Ve["a"].ONE_MINUS_SRC_ALPHA,srcAlpha:Ve["a"].ONE,dstAlpha:Ve["a"].ONE_MINUS_SRC_ALPHA},equation:{rgb:Ve["a"].FUNC_ADD,alpha:Ve["a"].FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Ua)}},{key:"render",value:function(t){var e=this,n=this.rendererService,r=n.clear,i=n.getViewportSize,o=n.useFramebuffer,a=i(),s=a.width,u=a.height;this.sampleRenderTarget.resize({width:s,height:u}),this.prevRenderTarget.resize({width:s,height:u}),this.outputRenderTarget.resize({width:s,height:u}),this.copyRenderTarget.resize({width:s,height:u}),this.resetFrame(),this.stopAccumulating();var c=t.multiPassRenderer.getPostProcessor().getReadFBO();o(c,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:c}),t.multiPassRenderer.setRenderFlag(!1),t.render(),t.multiPassRenderer.setRenderFlag(!0)}));var l=function n(r){e.accumulatingId&&r===e.accumulatingId&&(e.isFinished()||(e.doRender(t),requestAnimationFrame((function(){n(r)}))))};this.accumulatingId=qa++,this.timer=window.setTimeout((function(){l(e.accumulatingId)}),50)}},{key:"doRender",value:function(t){var e=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var n=this.rendererService,r=n.clear,i=n.getViewportSize,o=n.useFramebuffer,a=i(),s=a.width,u=a.height,c=t.getLayerConfig(),l=c.jitterScale,f=void 0===l?1:l,p=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*p[0]-1)/s*f,(2*p[1]-1)/u*f),t.multiPassRenderer.setRenderFlag(!1),t.hooks.beforeRender.call(),o(this.sampleRenderTarget,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:e.sampleRenderTarget}),t.render()})),t.hooks.afterRender.call(),t.multiPassRenderer.setRenderFlag(!0);var h=t.getLayerConfig();o(this.outputRenderTarget,(function(){e.blendModel.draw({uniforms:{u_opacity:h.opacity||1,u_MixRatio:0===e.frame?1:.9,u_Diffuse1:e.sampleRenderTarget,u_Diffuse2:0===e.frame?t.multiPassRenderer.getPostProcessor().getReadFBO():e.prevRenderTarget}})})),0===this.frame&&r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(o(this.copyRenderTarget,(function(){e.outputModel.draw({uniforms:{u_Texture:e.outputRenderTarget}})})),o(t.multiPassRenderer.getPostProcessor().getReadFBO(),(function(){e.copyModel.draw({uniforms:{u_Texture:e.copyRenderTarget}})})),t.multiPassRenderer.getPostProcessor().render(t));var d=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=d,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(t,e,n){this.shaderModuleService.registerModule(t,{vs:Va,fs:e});var r=this.shaderModuleService.getModule(t),i=r.vs,o=r.fs,a=r.uniforms,s=this.rendererService,u=s.createAttribute,c=s.createBuffer,l=s.createModel;return l(ja({vs:i,fs:o,attributes:{a_Position:u({buffer:c({data:[-4,-4,4,-4,0,4],type:Ve["a"].FLOAT}),size:2})},uniforms:ja({},a),depth:{enable:!1},count:3},n))}}]),n}(Mi),Ia=Ra,Oa=Yt()(Ia.prototype,"shaderModuleService",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),La=Yt()(Ia.prototype,"logger",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma=Ia))||Ma),Ha=new o["Container"];Ha.bind(u["a"].IGlobalConfigService).to(Zt).inSingletonScope(),Ha.bind(u["a"].IShaderModuleService).to(Ai).inSingletonScope(),Ha.bind(u["a"].ILogService).to(Ur).inSingletonScope(),Object(o["decorate"])(Object(o["injectable"])(),r["EventEmitter"]),Ha.bind(u["a"].IEventEmitter).to(r["EventEmitter"]);var Wa=s()(Ha,!1),Xa=function(t){var e=Wa.lazyInject(t);return function(t,n,r){e.call(this,t,n),r&&(r.initializer=function(){return t[n]})}},Ya=(e["c"]=Ha,0);function Ka(){var t=new o["Container"];return t.parent=Ha,t.bind(u["a"].SceneID).toConstantValue("".concat(Ya++)),t.bind(u["a"].ILayerService).to(cn).inSingletonScope(),t.bind(u["a"].ISceneService).to(Yr).inSingletonScope(),t.bind(u["a"].ICameraService).to(xt).inSingletonScope(),t.bind(u["a"].ICoordinateSystemService).to(ve).inSingletonScope(),t.bind(u["a"].IInteractionService).to(je).inSingletonScope(),t.bind(u["a"].IPickingService).to(sn).inSingletonScope(),t.bind(u["a"].IControlService).to(Rt).inSingletonScope(),t.bind(u["a"].IMarkerService).to(Dt).inSingletonScope(),t.bind(u["a"].IIconService).to(gt).inSingletonScope(),t.bind(u["a"].IFontService).to($).inSingletonScope(),t.bind(u["a"].IPopupService).to(zt).inSingletonScope(),t.bind(u["a"].INormalPass).to(Fi).whenTargetNamed("clear"),t.bind(u["a"].INormalPass).to(no).whenTargetNamed("pixelPicking"),t.bind(u["a"].INormalPass).to(Da).whenTargetNamed("render"),t.bind(u["a"].INormalPass).to(Za).whenTargetNamed("taa"),t.bind(u["a"].IFactoryNormalPass).toFactory((function(t){return function(e){return t.container.getNamed(u["a"].INormalPass,e)}})),t.bind(u["a"].IPostProcessingPass).to(No).whenTargetNamed("copy"),t.bind(u["a"].IPostProcessingPass).to(po).whenTargetNamed("blurH"),t.bind(u["a"].IPostProcessingPass).to(wo).whenTargetNamed("blurV"),t.bind(u["a"].IPostProcessingPass).to(ca).whenTargetNamed("noise"),t.bind(u["a"].IPostProcessingPass).to(Sa).whenTargetNamed("sepia"),t.bind(u["a"].IPostProcessingPass).to(Io).whenTargetNamed("colorHalftone"),t.bind(u["a"].IPostProcessingPass).to(Wo).whenTargetNamed("hexagonalPixelate"),t.bind(u["a"].IPostProcessingPass).to(na).whenTargetNamed("ink"),t.bind(u["a"].IFactoryPostProcessingPass).toFactory((function(t){return function(e){var n=t.container.getNamed(u["a"].IPostProcessingPass,e);return n.setName(e),n}})),t}function Ja(t){var e=new o["Container"];return e.parent=t,e.bind(u["a"].IStyleAttributeService).to(bn).inSingletonScope(),e.bind(u["a"].IMultiPassRenderer).to(Yi).inSingletonScope(),e.bind(u["a"].IPostProcessor).to(Ea).inSingletonScope(),e}},fbrv:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Yk9n"),i=n("MON2"),o=n("FV85"),a=n("xfSm"),s=n("ujMp");e.getFunctionName=s.getFunctionName;var u=n("dX1H");function c(t,e){var n=s.getFunctionName(e),r=l(t,n,e,!1);return r}function l(t,e,n,r){var o=t.getConstructorMetadata(n),a=o.compilerGeneratedMetadata;if(void 0===a){var s=i.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var u=o.userGeneratedMetadata,c=Object.keys(u),l=0===n.length&&c.length>0,f=l?c.length:n.length,d=p(r,e,a,u,f),m=h(t,n),v=d.concat(m);return v}function f(t,e,n,a,s){var c=s[t.toString()]||[],l=m(c),f=!0!==l.unmanaged,p=a[t],h=l.inject||l.multiInject;if(p=h||p,p instanceof r.LazyServiceIdentifer&&(p=p.unwrap()),f){var d=p===Object,v=p===Function,g=void 0===p,y=d||v||g;if(!e&&y){var _=i.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".";throw new Error(_)}var b=new u.Target(o.TargetTypeEnum.ConstructorArgument,l.targetName,p);return b.metadata=c,b}return null}function p(t,e,n,r,i){for(var o=[],a=0;a<i;a++){var s=a,u=f(s,t,e,n,r);null!==u&&o.push(u)}return o}function h(t,e){for(var n=t.getPropertiesMetadata(e),r=[],i=Object.keys(n),a=0,s=i;a<s.length;a++){var c=s[a],l=n[c],f=m(n[c]),p=f.targetName||c,d=f.inject||f.multiInject,v=new u.Target(o.TargetTypeEnum.ClassProperty,p,d);v.metadata=l,r.push(v)}var g=Object.getPrototypeOf(e.prototype).constructor;if(g!==Object){var y=h(t,g);r=r.concat(y)}return r}function d(t,e){var n=Object.getPrototypeOf(e.prototype).constructor;if(n!==Object){var r=s.getFunctionName(n),i=l(t,r,n,!0),o=i.map((function(t){return t.metadata.filter((function(t){return t.key===a.UNMANAGED_TAG}))})),u=[].concat.apply([],o).length,c=i.length-u;return c>0?c:d(t,n)}return 0}function m(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[a.INJECT_TAG],multiInject:e[a.MULTI_INJECT_TAG],targetName:e[a.NAME_TAG],unmanaged:e[a.UNMANAGED_TAG]}}e.getDependencies=c,e.getBaseClassDependencyCount=d},fbvF:function(t,e,n){(function(e,n){t.exports=n()})(0,(function(){"use strict";var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t},n="\n";function r(t){return"undefined"!==typeof atob?atob(t):"base64:"+t}function i(t){var e=new Error("(regl) "+t);throw console.error(e),e}function o(t,e){t||i(e)}function a(t){return t?": "+t:""}function s(t,e,n){t in e||i("unknown parameter ("+t+")"+a(n)+". possible values: "+Object.keys(e).join())}function u(e,n){t(e)||i("invalid parameter type"+a(n)+". must be a typed array")}function c(t,e){switch(e){case"number":return"number"===typeof t;case"object":return"object"===typeof t;case"string":return"string"===typeof t;case"boolean":return"boolean"===typeof t;case"function":return"function"===typeof t;case"undefined":return"undefined"===typeof t;case"symbol":return"symbol"===typeof t}}function l(t,e,n){c(t,e)||i("invalid parameter type"+a(n)+". expected "+e+", got "+typeof t)}function f(t,e){t>=0&&(0|t)===t||i("invalid parameter type, ("+t+")"+a(e)+". must be a nonnegative integer")}function p(t,e,n){e.indexOf(t)<0&&i("invalid value"+a(n)+". must be one of: "+e)}var h=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function d(t){Object.keys(t).forEach((function(t){h.indexOf(t)<0&&i('invalid regl constructor argument "'+t+'". must be one of '+h)}))}function m(t,e){t+="";while(t.length<e)t=" "+t;return t}function v(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function g(t,e){this.number=t,this.line=e,this.errors=[]}function y(t,e,n){this.file=t,this.line=e,this.message=n}function _(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return r?r[1]:"unknown"}function b(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return r?r[1]:"unknown"}function x(t,e){var n=t.split("\n"),i=1,o=0,a={unknown:new v,0:new v};a.unknown.name=a[0].name=e||_(),a.unknown.lines.push(new g(0,""));for(var s=0;s<n.length;++s){var u=n[s],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(c)switch(c[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(c[2]);l&&(i=0|l[1],l[2]&&(o=0|l[2],o in a||(a[o]=new v)));break;case"define":var f=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);f&&(a[o].name=f[1]?r(f[2]):f[2]);break}a[o].lines.push(new g(i++,u))}return Object.keys(a).forEach((function(t){var e=a[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),a}function w(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new y(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new y("unknown",0,t))}})),e}function S(t,e){e.forEach((function(e){var n=t[e.file];if(n){var r=n.index[e.line];if(r)return r.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))}function E(t,e,r,i,a){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(e),u=i===t.FRAGMENT_SHADER?"fragment":"vertex";I(r,"string",u+" shader source must be a string",a);var c=x(r,a),l=w(s);S(c,l),Object.keys(c).forEach((function(t){var e=c[t];if(e.hasErrors){var r=[""],i=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(m(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+n,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(r){var i=r.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(a){var s=a[1];switch(i=a[2],s){case"assign":s="=";break}e=Math.max(t.line.indexOf(s,e),0)}else e=0;o(m("| ",6)),o(m("^^^",e+3)+n,"font-weight:bold"),o(m("| ",6)),o(i+n,"font-weight:bold")})),o(m("| ",6)+n)}else o(m(t.number,4)+"|  "),o(t.line+n,"color:red")})),"undefined"===typeof document||window.chrome?console.log(r.join("")):(i[0]=r.join("%c"),console.log.apply(console,i))}function o(t,e){r.push(t),i.push(e||"")}})),o.raise("Error compiling "+u+" shader, "+c[0].name)}}function T(t,e,r,i,a){if(!t.getProgramParameter(e,t.LINK_STATUS)){var s=t.getProgramInfoLog(e),u=x(r,a),c=x(i,a),l='Error linking program with vertex shader, "'+c[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!==typeof document?console.log("%c"+l+n+"%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(l+n+s),o.raise(l)}}function A(t){t._commandRef=_()}function C(t,e,n,r){function i(t){return t?r.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[r.id(e)]=!0}))}A(t),t._fragId=i(t.static.frag),t._vertId=i(t.static.vert);var a=t._uniformSet={};o(a,e.static),o(a,e.dynamic);var s=t._attributeSet={};o(s,n.static),o(s,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function k(t,e){var n=b();i(t+" in command "+(e||_())+("unknown"===n?"":" called from "+n))}function P(t,e,n){t||k(e,n||_())}function M(t,e,n,r){t in e||k("unknown parameter ("+t+")"+a(n)+". possible values: "+Object.keys(e).join(),r||_())}function I(t,e,n,r){c(t,e)||k("invalid parameter type"+a(n)+". expected "+e+", got "+typeof t,r||_())}function O(t){t()}function L(t,e,n){t.texture?p(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):p(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var R=33071,D=9728,z=9984,j=9985,N=9986,F=9987,B=5120,U=5121,V=5122,G=5123,q=5124,Z=5125,H=5126,W=32819,X=32820,Y=33635,K=34042,J=36193,Q={};function $(t,e){return t===X||t===W||t===Y?2:t===K?4:Q[t]*e}function tt(t){return!(t&t-1)&&!!t}function et(t,e,n){var r,i=e.width,a=e.height,s=e.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),t.wrapS===R&&t.wrapT===R||o(tt(i)&&tt(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==a&&o(t.minFilter!==z&&t.minFilter!==N&&t.minFilter!==j&&t.minFilter!==F,"min filter requires mipmap"):(o(tt(i)&&tt(a),"texture must be a square power of 2 to support mipmapping"),o(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),e.type===H&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(t.minFilter===D&&t.magFilter===D,"filter not supported, must enable oes_texture_float_linear"),o(!t.genMipmaps,"mipmap generation not supported with float textures"));var u=e.images;for(r=0;r<16;++r)if(u[r]){var c=i>>r,l=a>>r;o(e.mipmask&1<<r,"missing mipmap data");var f=u[r];if(o(f.width===c&&f.height===l,"invalid shape for mip images"),o(f.format===e.format&&f.internalformat===e.internalformat&&f.type===e.type,"incompatible type for mip image"),f.compressed);else if(f.data){var p=Math.ceil($(f.type,s)*c/f.unpackAlignment)*f.unpackAlignment;o(f.data.byteLength===p*l,"invalid data for image, buffer size is inconsistent with image format")}else f.element||f.copy}else t.genMipmaps||o(0===(e.mipmask&1<<r),"extra mipmap data");e.compressed&&o(!t.genMipmaps,"mipmap generation for compressed images not supported")}function nt(t,e,n,r){var i=t.width,a=t.height,s=t.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(e.wrapS===R&&e.wrapT===R,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var c=n[u];o(c.width===i&&c.height===a,"inconsistent cube map face shape"),e.genMipmaps&&(o(!c.compressed,"can not generate mipmap for compressed textures"),o(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=c.images,f=0;f<16;++f){var p=l[f];if(p){var h=i>>f,d=a>>f;o(c.mipmask&1<<f,"missing mipmap data"),o(p.width===h&&p.height===d,"invalid shape for mip images"),o(p.format===t.format&&p.internalformat===t.internalformat&&p.type===t.type,"incompatible type for mip image"),p.compressed||(p.data?o(p.data.byteLength===h*d*Math.max($(p.type,s),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):p.element||p.copy)}}}}Q[B]=Q[U]=1,Q[V]=Q[G]=Q[J]=Q[Y]=Q[W]=Q[X]=2,Q[q]=Q[Z]=Q[H]=Q[K]=4;var rt=e(o,{optional:O,raise:i,commandRaise:k,command:P,parameter:s,commandParameter:M,constructor:d,type:l,commandType:I,isTypedArray:u,nni:f,oneOf:p,shaderError:E,linkError:T,callSite:b,saveCommandRef:A,saveDrawInfo:C,framebufferFormat:L,guessCommand:_,texture2D:et,textureCube:nt}),it=0,ot=0;function at(t,e){this.id=it++,this.type=t,this.data=e}function st(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ut(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+st(t.substr(1,t.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(r)return ut(t.substr(0,r.index)).concat(ut(r[1])).concat(ut(t.substr(r.index+r[0].length)));var i=t.split(".");if(1===i.length)return['"'+st(t)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(ut(i[a]));return o}function ct(t){return"["+ut(t).join("][")+"]"}function lt(t,e){return new at(t,ct(e+""))}function ft(t){return"function"===typeof t&&!t._reglType||t instanceof at}function pt(t,e){return"function"===typeof t?new at(ot,t):t}var ht={DynamicVariable:at,define:lt,isDynamic:ft,unbox:pt,accessor:ct},dt={next:"function"===typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"===typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},mt="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function vt(){var t={"":0},e=[""];return{id:function(n){var r=t[n];return r||(r=t[n]=e.length,e.push(n),r)},str:function(t){return e[t]}}}function gt(t,n,r){var i,o=document.createElement("canvas");function a(){var n=window.innerWidth,i=window.innerHeight;if(t!==document.body){var a=t.getBoundingClientRect();n=a.right-a.left,i=a.bottom-a.top}o.width=r*n,o.height=r*i,e(o.style,{width:n+"px",height:i+"px"})}function s(){i?i.disconnect():window.removeEventListener("resize",a),t.removeChild(o)}return e(o.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(o),t===document.body&&(o.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"===typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(a)})),i.observe(t)):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:s}}function yt(t,e){function n(n){try{return t.getContext(n,e)}catch(r){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function _t(t){return"string"===typeof t.nodeName&&"function"===typeof t.appendChild&&"function"===typeof t.getBoundingClientRect}function bt(t){return"function"===typeof t.drawArrays||"function"===typeof t.drawElements}function xt(t){return"string"===typeof t?t.split():(rt(Array.isArray(t),"invalid extension array"),t)}function wt(t){return"string"===typeof t?(rt("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function St(t){var e,n,r,i,o=t||{},a={},s=[],u=[],c="undefined"===typeof window?1:window.devicePixelRatio,l=!1,f=function(t){t&&rt.raise(t)},p=function(){};if("string"===typeof o?(rt("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(o),rt(e,"invalid query string for element")):"object"===typeof o?_t(o)?e=o:bt(o)?(i=o,r=i.canvas):(rt.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=wt(o.canvas):"container"in o&&(n=wt(o.container)),"attributes"in o&&(a=o.attributes,rt.type(a,"object","invalid context attributes")),"extensions"in o&&(s=xt(o.extensions)),"optionalExtensions"in o&&(u=xt(o.optionalExtensions)),"onDone"in o&&(rt.type(o.onDone,"function","invalid or missing onDone callback"),f=o.onDone),"profile"in o&&(l=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,rt(c>0,"invalid pixel ratio"))):rt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?r=e:n=e),!i){if(!r){rt("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");var h=gt(n||document.body,f,c);if(!h)return null;r=h.canvas,p=h.onDestroy}void 0===a.premultipliedAlpha&&(a.premultipliedAlpha=!0),i=yt(r,a)}return i?{gl:i,canvas:r,container:n,extensions:s,optionalExtensions:u,pixelRatio:c,profile:l,onDone:f,onDestroy:p}:(p(),f("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Et(t,e){var n={};function r(e){rt.type(e,"string","extension name must be string");var r,i=e.toLowerCase();try{r=n[i]=t.getExtension(i)}catch(o){}return!!r}for(var i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!r(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!r(t))throw new Error("(regl): error restoring extension "+t)}))}}}function Tt(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}var At=5120,Ct=5121,kt=5122,Pt=5123,Mt=5124,It=5125,Ot=5126;function Lt(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function Rt(t){var e,n;return e=(t>65535)<<4,t>>>=e,n=(t>255)<<3,t>>>=n,e|=n,n=(t>15)<<2,t>>>=n,e|=n,n=(t>3)<<1,t>>>=n,e|=n,e|t>>1}function Dt(){var t=Tt(8,(function(){return[]}));function e(e){var n=Lt(e),r=t[Rt(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(e){t[Rt(e.byteLength)>>2].push(e)}function r(t,n){var r=null;switch(t){case At:r=new Int8Array(e(n),0,n);break;case Ct:r=new Uint8Array(e(n),0,n);break;case kt:r=new Int16Array(e(2*n),0,n);break;case Pt:r=new Uint16Array(e(2*n),0,n);break;case Mt:r=new Int32Array(e(4*n),0,n);break;case It:r=new Uint32Array(e(4*n),0,n);break;case Ot:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r}function i(t){n(t.buffer)}return{alloc:e,free:n,allocType:r,freeType:i}}var zt=Dt();zt.zero=Dt();var jt=3408,Nt=3410,Ft=3411,Bt=3412,Ut=3413,Vt=3414,Gt=3415,qt=33901,Zt=33902,Ht=3379,Wt=3386,Xt=34921,Yt=36347,Kt=36348,Jt=35661,Qt=35660,$t=34930,te=36349,ee=34076,ne=34024,re=7936,ie=7937,oe=7938,ae=35724,se=34047,ue=36063,ce=34852,le=3553,fe=34067,pe=34069,he=33984,de=6408,me=5126,ve=5121,ge=36160,ye=36053,_e=36064,be=16384,xe=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(se));var r=1,i=1;e.webgl_draw_buffers&&(r=t.getParameter(ce),i=t.getParameter(ue));var o=!!e.oes_texture_float;if(o){var a=t.createTexture();t.bindTexture(le,a),t.texImage2D(le,0,de,1,1,0,de,me,null);var s=t.createFramebuffer();if(t.bindFramebuffer(ge,s),t.framebufferTexture2D(ge,_e,le,a,0),t.bindTexture(le,null),t.checkFramebufferStatus(ge)!==ye)o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(be);var u=zt.allocType(me,4);t.readPixels(0,0,1,1,de,me,u),t.getError()?o=!1:(t.deleteFramebuffer(s),t.deleteTexture(a),o=1===u[0]),zt.freeType(u)}}var c="undefined"!==typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),l=!0;if(!c){var f=t.createTexture(),p=zt.allocType(ve,36);t.activeTexture(he),t.bindTexture(fe,f),t.texImage2D(pe,0,de,3,3,0,de,ve,p),zt.freeType(p),t.bindTexture(fe,null),t.deleteTexture(f),l=!t.getError()}return{colorBits:[t.getParameter(Nt),t.getParameter(Ft),t.getParameter(Bt),t.getParameter(Ut)],depthBits:t.getParameter(Vt),stencilBits:t.getParameter(Gt),subpixelBits:t.getParameter(jt),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(qt),lineWidthDims:t.getParameter(Zt),maxViewportDims:t.getParameter(Wt),maxCombinedTextureUnits:t.getParameter(Jt),maxCubeMapSize:t.getParameter(ee),maxRenderbufferSize:t.getParameter(ne),maxTextureUnits:t.getParameter($t),maxTextureSize:t.getParameter(Ht),maxAttributes:t.getParameter(Xt),maxVertexUniforms:t.getParameter(Yt),maxVertexTextureUnits:t.getParameter(Qt),maxVaryingVectors:t.getParameter(Kt),maxFragmentUniforms:t.getParameter(te),glsl:t.getParameter(ae),renderer:t.getParameter(ie),vendor:t.getParameter(re),version:t.getParameter(oe),readFloat:o,npotTextureCube:l}};function we(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var Se=function(t){return Object.keys(t).map((function(e){return t[e]}))},Ee={shape:Me,flatten:Pe};function Te(t,e,n){for(var r=0;r<e;++r)n[r]=t[r]}function Ae(t,e,n,r){for(var i=0,o=0;o<e;++o)for(var a=t[o],s=0;s<n;++s)r[i++]=a[s]}function Ce(t,e,n,r,i,o){for(var a=o,s=0;s<e;++s)for(var u=t[s],c=0;c<n;++c)for(var l=u[c],f=0;f<r;++f)i[a++]=l[f]}function ke(t,e,n,r,i){for(var o=1,a=n+1;a<e.length;++a)o*=e[a];var s=e[n];if(e.length-n===4){var u=e[n+1],c=e[n+2],l=e[n+3];for(a=0;a<s;++a)Ce(t[a],u,c,l,r,i),i+=o}else for(a=0;a<s;++a)ke(t[a],e,n+1,r,i),i+=o}function Pe(t,e,n,r){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;var a=r||zt.allocType(n,i);switch(e.length){case 0:break;case 1:Te(t,e[0],a);break;case 2:Ae(t,e[0],e[1],a);break;case 3:Ce(t,e[0],e[1],e[2],a,0);break;default:ke(t,e,0,a,0)}return a}function Me(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e}var Ie={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Oe=5120,Le=5122,Re=5124,De=5121,ze=5123,je=5125,Ne=5126,Fe=5126,Be={int8:Oe,int16:Le,int32:Re,uint8:De,uint16:ze,uint32:je,float:Ne,float32:Fe},Ue=35048,Ve=35040,Ge={dynamic:Ue,stream:Ve,static:35044},qe=Ee.flatten,Ze=Ee.shape,He=35044,We=35040,Xe=5121,Ye=5126,Ke=[];function Je(t){return 0|Ie[Object.prototype.toString.call(t)]}function Qe(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function $e(t,e,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)t[s++]=e[i*u+o*c+a]}function tn(e,n,r,i){var o=0,a={};function s(t){this.id=o++,this.buffer=e.createBuffer(),this.type=t,this.usage=He,this.byteLength=0,this.dimension=1,this.dtype=Xe,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){h(this)};var u=[];function c(t,e){var n=u.pop();return n||(n=new s(t)),n.bind(),p(n,e,We,0,1,!1),n}function l(t){u.push(t)}function f(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function p(e,n,r,i,o,a){var s,u;if(e.usage=r,Array.isArray(n)){if(e.dtype=i||Ye,n.length>0)if(Array.isArray(n[0])){s=Ze(n);for(var c=1,l=1;l<s.length;++l)c*=s[l];e.dimension=c,u=qe(n,s,e.dtype),f(e,u,r),a?e.persistentData=u:zt.freeType(u)}else if("number"===typeof n[0]){e.dimension=o;var p=zt.allocType(e.dtype,n.length);Qe(p,n),f(e,p,r),a?e.persistentData=p:zt.freeType(p)}else t(n[0])?(e.dimension=n[0].length,e.dtype=i||Je(n[0])||Ye,u=qe(n,[n.length,n[0].length],e.dtype),f(e,u,r),a?e.persistentData=u:zt.freeType(u)):rt.raise("invalid buffer data")}else if(t(n))e.dtype=i||Je(n),e.dimension=o,f(e,n,r),a&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(we(n)){s=n.shape;var h=n.stride,d=n.offset,m=0,v=0,g=0,y=0;1===s.length?(m=s[0],v=1,g=h[0],y=0):2===s.length?(m=s[0],v=s[1],g=h[0],y=h[1]):rt.raise("invalid shape"),e.dtype=i||Je(n.data)||Ye,e.dimension=v;var _=zt.allocType(e.dtype,m*v);$e(_,n.data,m,v,g,y,d),f(e,_,r),a?e.persistentData=_:zt.freeType(_)}else n instanceof ArrayBuffer?(e.dtype=Xe,e.dimension=o,f(e,n,r),a&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):rt.raise("invalid buffer data")}function h(t){n.bufferCount--,i(t);var r=t.buffer;rt(r,"buffer must not be deleted already"),e.deleteBuffer(r),t.buffer=null,delete a[t.id]}function d(i,o,u,c){n.bufferCount++;var l=new s(o);function f(n){var i=He,o=null,a=0,s=0,u=1;return Array.isArray(n)||t(n)||we(n)||n instanceof ArrayBuffer?o=n:"number"===typeof n?a=0|n:n&&(rt.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(rt(null===o||Array.isArray(o)||t(o)||we(o),"invalid data for buffer"),o=n.data),"usage"in n&&(rt.parameter(n.usage,Ge,"invalid buffer usage"),i=Ge[n.usage]),"type"in n&&(rt.parameter(n.type,Be,"invalid buffer type"),s=Be[n.type]),"dimension"in n&&(rt.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(rt.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),l.bind(),o?p(l,o,i,s,u,c):(a&&e.bufferData(l.type,a,i),l.dtype=s||Xe,l.usage=i,l.dimension=u,l.byteLength=a),r.profile&&(l.stats.size=l.byteLength*Ke[l.dtype]),f}function d(t,n){rt(n+t.byteLength<=l.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+l.byteLength),e.bufferSubData(l.type,n,t)}function m(e,n){var r,i=0|(n||0);if(l.bind(),t(e)||e instanceof ArrayBuffer)d(e,i);else if(Array.isArray(e)){if(e.length>0)if("number"===typeof e[0]){var o=zt.allocType(l.dtype,e.length);Qe(o,e),d(o,i),zt.freeType(o)}else if(Array.isArray(e[0])||t(e[0])){r=Ze(e);var a=qe(e,r,l.dtype);d(a,i),zt.freeType(a)}else rt.raise("invalid buffer data")}else if(we(e)){r=e.shape;var s=e.stride,u=0,c=0,p=0,h=0;1===r.length?(u=r[0],c=1,p=s[0],h=0):2===r.length?(u=r[0],c=r[1],p=s[0],h=s[1]):rt.raise("invalid shape");var m=Array.isArray(e.data)?l.dtype:Je(e.data),v=zt.allocType(m,u*c);$e(v,e.data,u,c,p,h,e.offset),d(v,i),zt.freeType(v)}else rt.raise("invalid data for buffer subdata");return f}return a[l.id]=l,u||f(i),f._reglType="buffer",f._buffer=l,f.subdata=m,r.profile&&(f.stats=l.stats),f.destroy=function(){h(l)},f}function m(){Se(a).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return r.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(a).forEach((function(e){t+=a[e].stats.size})),t}),{create:d,createStream:c,destroyStream:l,clear:function(){Se(a).forEach(h),u.forEach(h)},getBuffer:function(t){return t&&t._buffer instanceof s?t._buffer:null},restore:m,_initBuffer:p}}Ke[5120]=1,Ke[5122]=2,Ke[5124]=4,Ke[5121]=1,Ke[5123]=2,Ke[5125]=4,Ke[5126]=4;var en=0,nn=0,rn=1,on=1,an=4,sn=4,un={points:en,point:nn,lines:rn,line:on,triangles:an,triangle:sn,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},cn=0,ln=1,fn=4,pn=5120,hn=5121,dn=5122,mn=5123,vn=5124,gn=5125,yn=34963,_n=35040,bn=35044;function xn(e,n,r,i){var o={},a=0,s={uint8:hn,uint16:mn};function u(t){this.id=a++,o[this.id]=this,this.buffer=t,this.primType=fn,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=gn),u.prototype.bind=function(){this.buffer.bind()};var c=[];function l(t){var e=c.pop();return e||(e=new u(r.create(null,yn,!0,!1)._buffer)),p(e,t,_n,-1,-1,0,0),e}function f(t){c.push(t)}function p(i,o,a,s,u,c,l){var f;if(i.buffer.bind(),o){var p=l;l||t(o)&&(!we(o)||t(o.data))||(p=n.oes_element_index_uint?gn:mn),r._initBuffer(i.buffer,o,a,p,3)}else e.bufferData(yn,c,a),i.buffer.dtype=f||hn,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=c;if(f=l,!l){switch(i.buffer.dtype){case hn:case pn:f=hn;break;case mn:case dn:f=mn;break;case gn:case vn:f=gn;break;default:rt.raise("unsupported type for element array")}i.buffer.dtype=f}i.type=f,rt(f!==gn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var h=u;h<0&&(h=i.buffer.byteLength,f===mn?h>>=1:f===gn&&(h>>=2)),i.vertCount=h;var d=s;if(s<0){d=fn;var m=i.buffer.dimension;1===m&&(d=cn),2===m&&(d=ln),3===m&&(d=fn)}i.primType=d}function h(t){i.elementsCount--,rt(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}function d(e,n){var o=r.create(null,yn,!0),a=new u(o._buffer);function c(e){if(e)if("number"===typeof e)o(e),a.primType=fn,a.vertCount=0|e,a.type=hn;else{var n=null,r=bn,i=-1,u=-1,l=0,f=0;Array.isArray(e)||t(e)||we(e)?n=e:(rt.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,rt(Array.isArray(n)||t(n)||we(n),"invalid data for element buffer")),"usage"in e&&(rt.parameter(e.usage,Ge,"invalid element buffer usage"),r=Ge[e.usage]),"primitive"in e&&(rt.parameter(e.primitive,un,"invalid element buffer primitive"),i=un[e.primitive]),"count"in e&&(rt("number"===typeof e.count&&e.count>=0,"invalid vertex count for elements"),u=0|e.count),"type"in e&&(rt.parameter(e.type,s,"invalid buffer type"),f=s[e.type]),"length"in e?l=0|e.length:(l=u,f===mn||f===dn?l*=2:f!==gn&&f!==vn||(l*=4))),p(a,n,r,i,u,l,f)}else o(),a.primType=fn,a.vertCount=0,a.type=hn;return c}return i.elementsCount++,c(e),c._reglType="elements",c._elements=a,c.subdata=function(t,e){return o.subdata(t,e),c},c.destroy=function(){h(a)},c}return{create:d,createStream:l,destroyStream:f,getElements:function(t){return"function"===typeof t&&t._elements instanceof u?t._elements:null},clear:function(){Se(o).forEach(h)}}}var wn=new Float32Array(1),Sn=new Uint32Array(wn.buffer),En=5123;function Tn(t){for(var e=zt.allocType(En,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{wn[0]=t[n];var r=Sn[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)e[n]=i;else if(o<-14){var s=-14-o;e[n]=i+(a+1024>>s)}else e[n]=o>15?i+31744:i+(o+15<<10)+a}return e}function An(e){return Array.isArray(e)||t(e)}var Cn=function(t){return!(t&t-1)&&!!t},kn=34467,Pn=3553,Mn=34067,In=34069,On=6408,Ln=6406,Rn=6407,Dn=6409,zn=6410,jn=32854,Nn=32855,Fn=36194,Bn=32819,Un=32820,Vn=33635,Gn=34042,qn=6402,Zn=34041,Hn=35904,Wn=35906,Xn=36193,Yn=33776,Kn=33777,Jn=33778,Qn=33779,$n=35986,tr=35987,er=34798,nr=35840,rr=35841,ir=35842,or=35843,ar=36196,sr=5121,ur=5123,cr=5125,lr=5126,fr=10242,pr=10243,hr=10497,dr=33071,mr=33648,vr=10240,gr=10241,yr=9728,_r=9729,br=9984,xr=9985,wr=9986,Sr=9987,Er=33170,Tr=4352,Ar=4353,Cr=4354,kr=34046,Pr=3317,Mr=37440,Ir=37441,Or=37443,Lr=37444,Rr=33984,Dr=[br,wr,xr,Sr],zr=[0,Dn,zn,Rn,On],jr={};function Nr(t){return"[object "+t+"]"}jr[Dn]=jr[Ln]=jr[qn]=1,jr[Zn]=jr[zn]=2,jr[Rn]=jr[Hn]=3,jr[On]=jr[Wn]=4;var Fr=Nr("HTMLCanvasElement"),Br=Nr("OffscreenCanvas"),Ur=Nr("CanvasRenderingContext2D"),Vr=Nr("ImageBitmap"),Gr=Nr("HTMLImageElement"),qr=Nr("HTMLVideoElement"),Zr=Object.keys(Ie).concat([Fr,Br,Ur,Vr,Gr,qr]),Hr=[];Hr[sr]=1,Hr[lr]=4,Hr[Xn]=2,Hr[ur]=2,Hr[cr]=4;var Wr=[];function Xr(t){return Array.isArray(t)&&(0===t.length||"number"===typeof t[0])}function Yr(t){if(!Array.isArray(t))return!1;var e=t.length;return!(0===e||!An(t[0]))}function Kr(t){return Object.prototype.toString.call(t)}function Jr(t){return Kr(t)===Fr}function Qr(t){return Kr(t)===Br}function $r(t){return Kr(t)===Ur}function ti(t){return Kr(t)===Vr}function ei(t){return Kr(t)===Gr}function ni(t){return Kr(t)===qr}function ri(t){if(!t)return!1;var e=Kr(t);return Zr.indexOf(e)>=0||(Xr(t)||Yr(t)||we(t))}function ii(t){return 0|Ie[Object.prototype.toString.call(t)]}function oi(t,e){var n=e.length;switch(t.type){case sr:case ur:case cr:case lr:var r=zt.allocType(t.type,n);r.set(e),t.data=r;break;case Xn:t.data=Tn(e);break;default:rt.raise("unsupported texture type, must specify a typed array")}}function ai(t,e){return zt.allocType(t.type===Xn?lr:t.type,e)}function si(t,e){t.type===Xn?(t.data=Tn(e),zt.freeType(e)):t.data=e}function ui(t,e,n,r,i,o){for(var a=t.width,s=t.height,u=t.channels,c=a*s*u,l=ai(t,c),f=0,p=0;p<s;++p)for(var h=0;h<a;++h)for(var d=0;d<u;++d)l[f++]=e[n*h+r*p+i*d+o];si(t,l)}function ci(t,e,n,r,i,o){var a;if(a="undefined"!==typeof Wr[t]?Wr[t]:jr[t]*Hr[e],o&&(a*=6),i){var s=0,u=n;while(u>=1)s+=a*u*u,u/=2;return s}return a*n*r}function li(n,r,i,o,a,s,u){var c={"don't care":Tr,"dont care":Tr,nice:Cr,fast:Ar},l={repeat:hr,clamp:dr,mirror:mr},f={nearest:yr,linear:_r},p=e({mipmap:Sr,"nearest mipmap nearest":br,"linear mipmap nearest":xr,"nearest mipmap linear":wr,"linear mipmap linear":Sr},f),h={none:0,browser:Lr},d={uint8:sr,rgba4:Bn,rgb565:Vn,"rgb5 a1":Un},m={alpha:Ln,luminance:Dn,"luminance alpha":zn,rgb:Rn,rgba:On,rgba4:jn,"rgb5 a1":Nn,rgb565:Fn},v={};r.ext_srgb&&(m.srgb=Hn,m.srgba=Wn),r.oes_texture_float&&(d.float32=d.float=lr),r.oes_texture_half_float&&(d["float16"]=d["half float"]=Xn),r.webgl_depth_texture&&(e(m,{depth:qn,"depth stencil":Zn}),e(d,{uint16:ur,uint32:cr,"depth stencil":Gn})),r.webgl_compressed_texture_s3tc&&e(v,{"rgb s3tc dxt1":Yn,"rgba s3tc dxt1":Kn,"rgba s3tc dxt3":Jn,"rgba s3tc dxt5":Qn}),r.webgl_compressed_texture_atc&&e(v,{"rgb atc":$n,"rgba atc explicit alpha":tr,"rgba atc interpolated alpha":er}),r.webgl_compressed_texture_pvrtc&&e(v,{"rgb pvrtc 4bppv1":nr,"rgb pvrtc 2bppv1":rr,"rgba pvrtc 4bppv1":ir,"rgba pvrtc 2bppv1":or}),r.webgl_compressed_texture_etc1&&(v["rgb etc1"]=ar);var g=Array.prototype.slice.call(n.getParameter(kn));Object.keys(v).forEach((function(t){var e=v[t];g.indexOf(e)>=0&&(m[t]=e)}));var y=Object.keys(m);i.textureFormats=y;var _=[];Object.keys(m).forEach((function(t){var e=m[t];_[e]=t}));var b=[];Object.keys(d).forEach((function(t){var e=d[t];b[e]=t}));var x=[];Object.keys(f).forEach((function(t){var e=f[t];x[e]=t}));var w=[];Object.keys(p).forEach((function(t){var e=p[t];w[e]=t}));var S=[];Object.keys(l).forEach((function(t){var e=l[t];S[e]=t}));var E=y.reduce((function(t,e){var n=m[e];return n===Dn||n===Ln||n===Dn||n===zn||n===qn||n===Zn||r.ext_srgb&&(n===Hn||n===Wn)?t[n]=n:n===Nn||e.indexOf("rgba")>=0?t[n]=On:t[n]=Rn,t}),{});function T(){this.internalformat=On,this.format=On,this.type=sr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Lr,this.width=0,this.height=0,this.channels=0}function A(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function C(t,e){if("object"===typeof e&&e){if("premultiplyAlpha"in e&&(rt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(rt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(rt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(rt.parameter(e.colorSpace,h,"invalid colorSpace"),t.colorSpace=h[e.colorSpace]),"type"in e){var n=e.type;rt(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),rt(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),rt(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),rt.parameter(n,d,"invalid texture type"),t.type=d[n]}var o=t.width,a=t.height,s=t.channels,u=!1;"shape"in e?(rt(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],a=e.shape[1],3===e.shape.length&&(s=e.shape[2],rt(s>0&&s<=4,"invalid number of channels"),u=!0),rt(o>=0&&o<=i.maxTextureSize,"invalid width"),rt(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in e&&(o=a=e.radius,rt(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,rt(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in e&&(a=e.height,rt(a>=0&&a<=i.maxTextureSize,"invalid height")),"channels"in e&&(s=e.channels,rt(s>0&&s<=4,"invalid number of channels"),u=!0)),t.width=0|o,t.height=0|a,t.channels=0|s;var c=!1;if("format"in e){var l=e.format;rt(r.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),rt.parameter(l,m,"invalid texture format");var f=t.internalformat=m[l];t.format=E[f],l in d&&("type"in e||(t.type=d[l])),l in v&&(t.compressed=!0),c=!0}!u&&c?t.channels=jr[t.format]:u&&!c?t.channels!==zr[t.format]&&(t.format=t.internalformat=zr[t.channels]):c&&u&&rt(t.channels===jr[t.format],"number of channels inconsistent with specified format")}}function k(t){n.pixelStorei(Mr,t.flipY),n.pixelStorei(Ir,t.premultiplyAlpha),n.pixelStorei(Or,t.colorSpace),n.pixelStorei(Pr,t.unpackAlignment)}function P(){T.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function M(e,n){var r=null;if(ri(n)?r=n:n&&(rt.type(n,"object","invalid pixel data type"),C(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),ri(n.data)&&(r=n.data)),rt(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){rt(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,s=a.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||s-e.yOffset,e.needsCopy=!0,rt(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<s&&e.width>0&&e.width<=o&&e.height>0&&e.height<=s,"copy texture read out of bounds")}else if(r){if(t(r))e.channels=e.channels||4,e.data=r,"type"in n||e.type!==sr||(e.type=ii(r));else if(Xr(r))e.channels=e.channels||4,oi(e,r),e.alignment=1,e.needsFree=!0;else if(we(r)){var u=r.data;Array.isArray(u)||e.type!==sr||(e.type=ii(u));var c,l,f,p,h,d,m=r.shape,v=r.stride;3===m.length?(f=m[2],d=v[2]):(rt(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),f=1,d=1),c=m[0],l=m[1],p=v[0],h=v[1],e.alignment=1,e.width=c,e.height=l,e.channels=f,e.format=e.internalformat=zr[f],e.needsFree=!0,ui(e,u,p,h,d,r.offset)}else if(Jr(r)||Qr(r)||$r(r))Jr(r)||Qr(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(ti(r))e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(ei(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(ni(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(Yr(r)){var g=e.width||r[0].length,y=e.height||r.length,_=e.channels;_=An(r[0][0])?_||r[0][0].length:_||1;for(var b=Ee.shape(r),x=1,w=0;w<b.length;++w)x*=b[w];var S=ai(e,x);Ee.flatten(r,b,"",S),si(e,S),e.alignment=1,e.width=g,e.height=y,e.channels=_,e.format=e.internalformat=zr[_],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===lr?rt(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Xn&&rt(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function I(t,e,r){var i=t.element,a=t.data,s=t.internalformat,u=t.format,c=t.type,l=t.width,f=t.height;k(t),i?n.texImage2D(e,r,u,u,c,i):t.compressed?n.compressedTexImage2D(e,r,s,l,f,0,a):t.needsCopy?(o(),n.copyTexImage2D(e,r,u,t.xOffset,t.yOffset,l,f,0)):n.texImage2D(e,r,u,l,f,0,u,c,a||null)}function O(t,e,r,i,a){var s=t.element,u=t.data,c=t.internalformat,l=t.format,f=t.type,p=t.width,h=t.height;k(t),s?n.texSubImage2D(e,a,r,i,l,f,s):t.compressed?n.compressedTexSubImage2D(e,a,r,i,c,p,h,u):t.needsCopy?(o(),n.copyTexSubImage2D(e,a,r,i,t.xOffset,t.yOffset,p,h)):n.texSubImage2D(e,a,r,i,p,h,l,f,u)}var L=[];function R(){return L.pop()||new P}function D(t){t.needsFree&&zt.freeType(t.data),P.call(t),L.push(t)}function z(){T.call(this),this.genMipmaps=!1,this.mipmapHint=Tr,this.mipmask=0,this.images=Array(16)}function j(t,e,n){var r=t.images[0]=R();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function N(t,e){var n=null;if(ri(e))n=t.images[0]=R(),A(n,t),M(n,e),t.mipmask=1;else if(C(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,i=0;i<r.length;++i)n=t.images[i]=R(),A(n,t),n.width>>=i,n.height>>=i,M(n,r[i]),t.mipmask|=1<<i;else n=t.images[0]=R(),A(n,t),M(n,e),t.mipmask=1;A(t,t.images[0]),!t.compressed||t.internalformat!==Yn&&t.internalformat!==Kn&&t.internalformat!==Jn&&t.internalformat!==Qn||rt(t.width%4===0&&t.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function F(t,e){for(var n=t.images,r=0;r<n.length;++r){if(!n[r])return;I(n[r],e,r)}}var B=[];function U(){var t=B.pop()||new z;T.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function V(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&D(e[n]),e[n]=null;B.push(t)}function G(){this.minFilter=yr,this.magFilter=yr,this.wrapS=dr,this.wrapT=dr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Tr}function q(t,e){if("min"in e){var n=e.min;rt.parameter(n,p),t.minFilter=p[n],Dr.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var r=e.mag;rt.parameter(r,f),t.magFilter=f[r]}var o=t.wrapS,a=t.wrapT;if("wrap"in e){var s=e.wrap;"string"===typeof s?(rt.parameter(s,l),o=a=l[s]):Array.isArray(s)&&(rt.parameter(s[0],l),rt.parameter(s[1],l),o=l[s[0]],a=l[s[1]])}else{if("wrapS"in e){var u=e.wrapS;rt.parameter(u,l),o=l[u]}if("wrapT"in e){var h=e.wrapT;rt.parameter(h,l),a=l[h]}}if(t.wrapS=o,t.wrapT=a,"anisotropic"in e){var d=e.anisotropic;rt("number"===typeof d&&d>=1&&d<=i.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var m=!1;switch(typeof e.mipmap){case"string":rt.parameter(e.mipmap,c,"invalid mipmap hint"),t.mipmapHint=c[e.mipmap],t.genMipmaps=!0,m=!0;break;case"boolean":m=t.genMipmaps=e.mipmap;break;case"object":rt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,m=!0;break;default:rt.raise("invalid mipmap type")}m&&!("min"in e)&&(t.minFilter=br)}}function Z(t,e){n.texParameteri(e,gr,t.minFilter),n.texParameteri(e,vr,t.magFilter),n.texParameteri(e,fr,t.wrapS),n.texParameteri(e,pr,t.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(e,kr,t.anisotropic),t.genMipmaps&&(n.hint(Er,t.mipmapHint),n.generateMipmap(e))}var H=0,W={},X=i.maxTextureUnits,Y=Array(X).map((function(){return null}));function K(t){T.call(this),this.mipmask=0,this.internalformat=On,this.id=H++,this.refCount=1,this.target=t,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new G,u.profile&&(this.stats={size:0})}function J(t){n.activeTexture(Rr),n.bindTexture(t.target,t.texture)}function Q(){var t=Y[0];t?n.bindTexture(t.target,t.texture):n.bindTexture(Pn,null)}function $(t){var e=t.texture;rt(e,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(n.activeTexture(Rr+r),n.bindTexture(i,null),Y[r]=null),n.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete W[t.id],s.textureCount--}function tt(t,e){var r=new K(Pn);function o(t,e){var n=r.texInfo;G.call(n);var a=U();return"number"===typeof t?j(a,0|t,"number"===typeof e?0|e:0|t):t?(rt.type(t,"object","invalid arguments to regl.texture"),q(n,t),N(a,t)):j(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,A(r,a),rt.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,J(r),F(a,Pn),Z(n,Pn),Q(),V(a),u.profile&&(r.stats.size=ci(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=_[r.internalformat],o.type=b[r.type],o.mag=x[n.magFilter],o.min=w[n.minFilter],o.wrapS=S[n.wrapS],o.wrapT=S[n.wrapT],o}function a(t,e,n,i){rt(!!t,"must specify image data");var a=0|e,s=0|n,u=0|i,c=R();return A(c,r),c.width=0,c.height=0,M(c,t),c.width=c.width||(r.width>>u)-a,c.height=c.height||(r.height>>u)-s,rt(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),rt(a>=0&&s>=0&&a+c.width<=r.width&&s+c.height<=r.height,"texture.subimage write out of bounds"),rt(r.mipmask&1<<u,"missing mipmap data"),rt(c.data||c.element||c.needsCopy,"missing image data"),J(r),O(c,Pn,a,s,u),Q(),D(c),o}function c(t,e){var i=0|t,a=0|e||i;if(i===r.width&&a===r.height)return o;o.width=r.width=i,o.height=r.height=a,J(r);for(var s=0;r.mipmask>>s;++s){var c=i>>s,l=a>>s;if(!c||!l)break;n.texImage2D(Pn,s,r.format,c,l,0,r.format,r.type,null)}return Q(),u.profile&&(r.stats.size=ci(r.internalformat,r.type,i,a,!1,!1)),o}return W[r.id]=r,s.textureCount++,o(t,e),o.subimage=a,o.resize=c,o._reglType="texture2d",o._texture=r,u.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o}function et(t,e,r,o,a,c){var l=new K(Mn);W[l.id]=l,s.cubeCount++;var f=new Array(6);function p(t,e,n,r,o,a){var s,c=l.texInfo;for(G.call(c),s=0;s<6;++s)f[s]=U();if("number"!==typeof t&&t)if("object"===typeof t)if(e)N(f[0],t),N(f[1],e),N(f[2],n),N(f[3],r),N(f[4],o),N(f[5],a);else if(q(c,t),C(l,t),"faces"in t){var h=t.faces;for(rt(Array.isArray(h)&&6===h.length,"cube faces must be a length 6 array"),s=0;s<6;++s)rt("object"===typeof h[s]&&!!h[s],"invalid input for cube map face"),A(f[s],l),N(f[s],h[s])}else for(s=0;s<6;++s)N(f[s],t);else rt.raise("invalid arguments to cube map");else{var d=0|t||1;for(s=0;s<6;++s)j(f[s],d,d)}for(A(l,f[0]),i.npotTextureCube||rt(Cn(l.width)&&Cn(l.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?l.mipmask=(f[0].width<<1)-1:l.mipmask=f[0].mipmask,rt.textureCube(l,c,f,i),l.internalformat=f[0].internalformat,p.width=f[0].width,p.height=f[0].height,J(l),s=0;s<6;++s)F(f[s],In+s);for(Z(c,Mn),Q(),u.profile&&(l.stats.size=ci(l.internalformat,l.type,p.width,p.height,c.genMipmaps,!0)),p.format=_[l.internalformat],p.type=b[l.type],p.mag=x[c.magFilter],p.min=w[c.minFilter],p.wrapS=S[c.wrapS],p.wrapT=S[c.wrapT],s=0;s<6;++s)V(f[s]);return p}function h(t,e,n,r,i){rt(!!e,"must specify image data"),rt("number"===typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|n,a=0|r,s=0|i,u=R();return A(u,l),u.width=0,u.height=0,M(u,e),u.width=u.width||(l.width>>s)-o,u.height=u.height||(l.height>>s)-a,rt(l.type===u.type&&l.format===u.format&&l.internalformat===u.internalformat,"incompatible format for texture.subimage"),rt(o>=0&&a>=0&&o+u.width<=l.width&&a+u.height<=l.height,"texture.subimage write out of bounds"),rt(l.mipmask&1<<s,"missing mipmap data"),rt(u.data||u.element||u.needsCopy,"missing image data"),J(l),O(u,In+t,o,a,s),Q(),D(u),p}function d(t){var e=0|t;if(e!==l.width){p.width=l.width=e,p.height=l.height=e,J(l);for(var r=0;r<6;++r)for(var i=0;l.mipmask>>i;++i)n.texImage2D(In+r,i,l.format,e>>i,e>>i,0,l.format,l.type,null);return Q(),u.profile&&(l.stats.size=ci(l.internalformat,l.type,p.width,p.height,!1,!0)),p}}return p(t,e,r,o,a,c),p.subimage=h,p.resize=d,p._reglType="textureCube",p._texture=l,u.profile&&(p.stats=l.stats),p.destroy=function(){l.decRef()},p}function nt(){for(var t=0;t<X;++t)n.activeTexture(Rr+t),n.bindTexture(Pn,null),Y[t]=null;Se(W).forEach($),s.cubeCount=0,s.textureCount=0}function it(){for(var t=0;t<X;++t){var e=Y[t];e&&(e.bindCount=0,e.unit=-1,Y[t]=null)}Se(W).forEach((function(t){t.texture=n.createTexture(),n.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!==(t.mipmask&1<<e))if(t.target===Pn)n.texImage2D(Pn,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)n.texImage2D(In+r,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);Z(t.texInfo,t.target)}))}return e(K.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var r=0;r<X;++r){var i=Y[r];if(i){if(i.bindCount>0)continue;i.unit=-1}Y[r]=t,e=r;break}e>=X&&rt.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<e+1&&(s.maxTextureUnits=e+1),t.unit=e,n.activeTexture(Rr+e),n.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$(this)}}),u.profile&&(s.getTotalTextureSize=function(){var t=0;return Object.keys(W).forEach((function(e){t+=W[e].stats.size})),t}),{create2D:tt,createCube:et,clear:nt,getTexture:function(t){return null},restore:it}}Wr[jn]=2,Wr[Nn]=2,Wr[Fn]=2,Wr[Zn]=4,Wr[Yn]=.5,Wr[Kn]=.5,Wr[Jn]=1,Wr[Qn]=1,Wr[$n]=.5,Wr[tr]=1,Wr[er]=1,Wr[nr]=.5,Wr[rr]=.25,Wr[ir]=.5,Wr[or]=.25,Wr[ar]=.5;var fi=36161,pi=32854,hi=32855,di=36194,mi=33189,vi=36168,gi=34041,yi=35907,_i=34836,bi=34842,xi=34843,wi=[];function Si(t,e,n){return wi[t]*e*n}wi[pi]=2,wi[hi]=2,wi[di]=2,wi[mi]=2,wi[vi]=1,wi[gi]=4,wi[yi]=4,wi[_i]=16,wi[bi]=8,wi[xi]=6;var Ei=function(t,e,n,r,i){var o={rgba4:pi,rgb565:di,"rgb5 a1":hi,depth:mi,stencil:vi,"depth stencil":gi};e.ext_srgb&&(o["srgba"]=yi),e.ext_color_buffer_half_float&&(o["rgba16f"]=bi,o["rgb16f"]=xi),e.webgl_color_buffer_float&&(o["rgba32f"]=_i);var a=[];Object.keys(o).forEach((function(t){var e=o[t];a[e]=t}));var s=0,u={};function c(t){this.id=s++,this.refCount=1,this.renderbuffer=t,this.format=pi,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function l(e){var n=e.renderbuffer;rt(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(fi,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete u[e.id],r.renderbufferCount--}function f(e,s){var l=new c(t.createRenderbuffer());function f(e,r){var s=0,u=0,c=pi;if("object"===typeof e&&e){var p=e;if("shape"in p){var h=p.shape;rt(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),s=0|h[0],u=0|h[1]}else"radius"in p&&(s=u=0|p.radius),"width"in p&&(s=0|p.width),"height"in p&&(u=0|p.height);"format"in p&&(rt.parameter(p.format,o,"invalid renderbuffer format"),c=o[p.format])}else"number"===typeof e?(s=0|e,u="number"===typeof r?0|r:s):e?rt.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(rt(s>0&&u>0&&s<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==l.width||u!==l.height||c!==l.format)return f.width=l.width=s,f.height=l.height=u,l.format=c,t.bindRenderbuffer(fi,l.renderbuffer),t.renderbufferStorage(fi,c,s,u),rt(0===t.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=Si(l.format,l.width,l.height)),f.format=a[l.format],f}function p(e,r){var o=0|e,a=0|r||o;return o===l.width&&a===l.height||(rt(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),f.width=l.width=o,f.height=l.height=a,t.bindRenderbuffer(fi,l.renderbuffer),t.renderbufferStorage(fi,l.format,o,a),rt(0===t.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=Si(l.format,l.width,l.height))),f}return u[l.id]=l,r.renderbufferCount++,f(e,s),f.resize=p,f._reglType="renderbuffer",f._renderbuffer=l,i.profile&&(f.stats=l.stats),f.destroy=function(){l.decRef()},f}function p(){Se(u).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(fi,e.renderbuffer),t.renderbufferStorage(fi,e.format,e.width,e.height)})),t.bindRenderbuffer(fi,null)}return c.prototype.decRef=function(){--this.refCount<=0&&l(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var t=0;return Object.keys(u).forEach((function(e){t+=u[e].stats.size})),t}),{create:f,clear:function(){Se(u).forEach(l)},restore:p}},Ti=36160,Ai=36161,Ci=3553,ki=34069,Pi=36064,Mi=36096,Ii=36128,Oi=33306,Li=36053,Ri=36054,Di=36055,zi=36057,ji=36061,Ni=36193,Fi=5121,Bi=5126,Ui=6407,Vi=6408,Gi=6402,qi=[Ui,Vi],Zi=[];Zi[Vi]=4,Zi[Ui]=3;var Hi=[];Hi[Fi]=1,Hi[Bi]=4,Hi[Ni]=2;var Wi=32854,Xi=32855,Yi=36194,Ki=33189,Ji=36168,Qi=34041,$i=35907,to=34836,eo=34842,no=34843,ro=[Wi,Xi,Yi,$i,eo,no,to],io={};function oo(t,n,r,i,o,a){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var l=["uint8"];function f(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=0,i=0;e?(r=e.width,i=e.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function p(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function h(t,e,n){if(t)if(t.texture){var r=t.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);rt(i===e&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=t.renderbuffer._renderbuffer;rt(a.width===e&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function d(e,n){n&&(n.texture?t.framebufferTexture2D(Ti,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(Ti,e,Ai,n.renderbuffer._renderbuffer.renderbuffer))}function m(t){var e=Ci,n=null,r=null,i=t;"object"===typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),rt.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,rt(e===Ci)):"textureCube"===o?(n=i,rt(e>=ki&&e<ki+6,"invalid cube map target")):"renderbuffer"===o?(r=i,e=Ai):rt.raise("invalid regl object for attachment"),new f(e,n,r)}function v(t,e,n,r,a){if(n){var s=i.create2D({width:t,height:e,format:r,type:a});return s._texture.refCount=0,new f(Ci,s,null)}var u=o.create({width:t,height:e,format:r});return u._renderbuffer.refCount=0,new f(Ai,null,u)}function g(t){return t&&(t.texture||t.renderbuffer)}function y(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}n.oes_texture_half_float&&l.push("half float","float16"),n.oes_texture_float&&l.push("float","float32");var _=0,b={};function x(){this.id=_++,b[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function w(t){t.colorAttachments.forEach(p),p(t.depthAttachment),p(t.stencilAttachment),p(t.depthStencilAttachment)}function S(e){var n=e.framebuffer;rt(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,a.framebufferCount--,delete b[e.id]}function E(e){var n;t.bindFramebuffer(Ti,e.framebuffer);var i=e.colorAttachments;for(n=0;n<i.length;++n)d(Pi+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)t.framebufferTexture2D(Ti,Pi+n,Ci,null,0);t.framebufferTexture2D(Ti,Oi,Ci,null,0),t.framebufferTexture2D(Ti,Mi,Ci,null,0),t.framebufferTexture2D(Ti,Ii,Ci,null,0),d(Mi,e.depthAttachment),d(Ii,e.stencilAttachment),d(Oi,e.depthStencilAttachment);var o=t.checkFramebufferStatus(Ti);t.isContextLost()||o===Li||rt.raise("framebuffer configuration not supported, status = "+io[o]),t.bindFramebuffer(Ti,s.next?s.next.framebuffer:null),s.cur=s.next,t.getError()}function T(t,i){var o=new x;function f(t,e){var i;rt(s.next!==o,"can not update framebuffer which is currently in use");var a=0,p=0,d=!0,y=!0,_=null,b=!0,x="rgba",S="uint8",T=1,A=null,C=null,k=null,P=!1;if("number"===typeof t)a=0|t,p=0|e||a;else if(t){rt.type(t,"object","invalid arguments for framebuffer");var M=t;if("shape"in M){var I=M.shape;rt(Array.isArray(I)&&I.length>=2,"invalid shape for framebuffer"),a=I[0],p=I[1]}else"radius"in M&&(a=p=M.radius),"width"in M&&(a=M.width),"height"in M&&(p=M.height);("color"in M||"colors"in M)&&(_=M.color||M.colors,Array.isArray(_)&&rt(1===_.length||n.webgl_draw_buffers,"multiple render targets not supported")),_||("colorCount"in M&&(T=0|M.colorCount,rt(T>0,"invalid color buffer count")),"colorTexture"in M&&(b=!!M.colorTexture,x="rgba4"),"colorType"in M&&(S=M.colorType,b?(rt(n.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),rt(n.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(rt(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),x="rgba16f"):"float"!==S&&"float32"!==S||(rt(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),x="rgba32f"),rt.oneOf(S,l,"invalid color type")),"colorFormat"in M&&(x=M.colorFormat,u.indexOf(x)>=0?b=!0:c.indexOf(x)>=0?b=!1:b?rt.oneOf(M.colorFormat,u,"invalid color format for texture"):rt.oneOf(M.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in M||"depthStencilTexture"in M)&&(P=!(!M.depthTexture&&!M.depthStencilTexture),rt(!P||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in M&&("boolean"===typeof M.depth?d=M.depth:(A=M.depth,y=!1)),"stencil"in M&&("boolean"===typeof M.stencil?y=M.stencil:(C=M.stencil,d=!1)),"depthStencil"in M&&("boolean"===typeof M.depthStencil?d=y=M.depthStencil:(k=M.depthStencil,d=!1,y=!1))}else a=p=1;var O=null,L=null,R=null,D=null;if(Array.isArray(_))O=_.map(m);else if(_)O=[m(_)];else for(O=new Array(T),i=0;i<T;++i)O[i]=v(a,p,b,x,S);rt(n.webgl_draw_buffers||O.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),rt(O.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||O[0].width,p=p||O[0].height,A?L=m(A):d&&!y&&(L=v(a,p,P,"depth","uint32")),C?R=m(C):y&&!d&&(R=v(a,p,!1,"stencil","uint8")),k?D=m(k):!A&&!C&&y&&d&&(D=v(a,p,P,"depth stencil","depth stencil")),rt(!!A+!!C+!!k<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var z=null;for(i=0;i<O.length;++i)if(h(O[i],a,p),rt(!O[i]||O[i].texture&&qi.indexOf(O[i].texture._texture.format)>=0||O[i].renderbuffer&&ro.indexOf(O[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),O[i]&&O[i].texture){var j=Zi[O[i].texture._texture.format]*Hi[O[i].texture._texture.type];null===z?z=j:rt(z===j,"all color attachments much have the same number of bits per pixel.")}return h(L,a,p),rt(!L||L.texture&&L.texture._texture.format===Gi||L.renderbuffer&&L.renderbuffer._renderbuffer.format===Ki,"invalid depth attachment for framebuffer object"),h(R,a,p),rt(!R||R.renderbuffer&&R.renderbuffer._renderbuffer.format===Ji,"invalid stencil attachment for framebuffer object"),h(D,a,p),rt(!D||D.texture&&D.texture._texture.format===Qi||D.renderbuffer&&D.renderbuffer._renderbuffer.format===Qi,"invalid depth-stencil attachment for framebuffer object"),w(o),o.width=a,o.height=p,o.colorAttachments=O,o.depthAttachment=L,o.stencilAttachment=R,o.depthStencilAttachment=D,f.color=O.map(g),f.depth=g(L),f.stencil=g(R),f.depthStencil=g(D),f.width=o.width,f.height=o.height,E(o),f}function p(t,e){rt(s.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),r=Math.max(0|e||n,1);if(n===o.width&&r===o.height)return f;for(var i=o.colorAttachments,a=0;a<i.length;++a)y(i[a],n,r);return y(o.depthAttachment,n,r),y(o.stencilAttachment,n,r),y(o.depthStencilAttachment,n,r),o.width=f.width=n,o.height=f.height=r,E(o),f}return a.framebufferCount++,f(t,i),e(f,{resize:p,_reglType:"framebuffer",_framebuffer:o,destroy:function(){S(o),w(o)},use:function(t){s.setFBO({framebuffer:f},t)}})}function A(t){var o=Array(6);function a(t){var r;rt(o.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var c,f={color:null},p=0,h=null,d="rgba",m="uint8",v=1;if("number"===typeof t)p=0|t;else if(t){rt.type(t,"object","invalid arguments for framebuffer");var g=t;if("shape"in g){var y=g.shape;rt(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),rt(y[0]===y[1],"cube framebuffer must be square"),p=y[0]}else"radius"in g&&(p=0|g.radius),"width"in g?(p=0|g.width,"height"in g&&rt(g.height===p,"must be square")):"height"in g&&(p=0|g.height);("color"in g||"colors"in g)&&(h=g.color||g.colors,Array.isArray(h)&&rt(1===h.length||n.webgl_draw_buffers,"multiple render targets not supported")),h||("colorCount"in g&&(v=0|g.colorCount,rt(v>0,"invalid color buffer count")),"colorType"in g&&(rt.oneOf(g.colorType,l,"invalid color type"),m=g.colorType),"colorFormat"in g&&(d=g.colorFormat,rt.oneOf(g.colorFormat,u,"invalid color format for texture"))),"depth"in g&&(f.depth=g.depth),"stencil"in g&&(f.stencil=g.stencil),"depthStencil"in g&&(f.depthStencil=g.depthStencil)}else p=1;if(h)if(Array.isArray(h))for(c=[],r=0;r<h.length;++r)c[r]=h[r];else c=[h];else{c=Array(v);var _={radius:p,format:d,type:m};for(r=0;r<v;++r)c[r]=i.createCube(_)}for(f.color=Array(c.length),r=0;r<c.length;++r){var b=c[r];rt("function"===typeof b&&"textureCube"===b._reglType,"invalid cube map"),p=p||b.width,rt(b.width===p&&b.height===p,"invalid cube map shape"),f.color[r]={target:ki,data:c[r]}}for(r=0;r<6;++r){for(var x=0;x<c.length;++x)f.color[x].target=ki+r;r>0&&(f.depth=o[0].depth,f.stencil=o[0].stencil,f.depthStencil=o[0].depthStencil),o[r]?o[r](f):o[r]=T(f)}return e(a,{width:p,height:p,color:c})}function c(t){var e,n=0|t;if(rt(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(e=0;e<i.length;++e)i[e].resize(n);for(e=0;e<6;++e)o[e].resize(n);return a.width=a.height=n,a}return a(t),e(a,{faces:o,resize:c,_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})}function C(){s.cur=null,s.next=null,s.dirty=!0,Se(b).forEach((function(e){e.framebuffer=t.createFramebuffer(),E(e)}))}return e(s,{getFramebuffer:function(t){if("function"===typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof x)return e}return null},create:T,createCube:A,clear:function(){Se(b).forEach(S)},restore:C})}io[Li]="complete",io[Ri]="incomplete attachment",io[zi]="incomplete dimensions",io[Di]="incomplete, missing attachment",io[ji]="unsupported";var ao=5126,so=34962;function uo(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ao,this.offset=0,this.stride=0,this.divisor=0}function co(e,n,r,i,o){for(var a=r.maxAttributes,s=new Array(a),u=0;u<a;++u)s[u]=new uo;var c=0,l={},f={Record:uo,scope:{},state:s,currentVAO:null,targetVAO:null,restore:h()?b:function(){},createVAO:x,getVAO:m,destroyBuffer:p,setVAO:h()?v:g,clear:h()?y:function(){}};function p(t){for(var n=0;n<s.length;++n){var r=s[n];r.buffer===t&&(e.disableVertexAttribArray(n),r.buffer=null)}}function h(){return n.oes_vertex_array_object}function d(){return n.angle_instanced_arrays}function m(t){return"function"===typeof t&&t._vao?t._vao:null}function v(t){if(t!==f.currentVAO){var e=h();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),f.currentVAO=t}}function g(t){if(t!==f.currentVAO){if(t)t.bindAttrs();else for(var n=d(),r=0;r<s.length;++r){var i=s[r];i.buffer?(e.enableVertexAttribArray(r),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&n.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}f.currentVAO=t}}function y(){Se(l).forEach((function(t){t.destroy()}))}function _(){this.id=++c,this.attributes=[];var t=h();this.vao=t?t.createVertexArrayOES():null,l[this.id]=this,this.buffers=[]}function b(){var t=h();t&&Se(l).forEach((function(t){t.refresh()}))}function x(e){var r=new _;function s(e){rt(Array.isArray(e),"arguments to vertex array constructor must be an array"),rt(e.length<a,"too many attributes"),rt(e.length>0,"must specify at least one attribute");for(var i=0;i<r.buffers.length;++i)r.buffers[i].destroy();r.buffers.length=0;var u=r.attributes;u.length=e.length;for(var c=0;c<e.length;++c){var l=e[c],f=u[c]=new uo;if(Array.isArray(l)||t(l)||we(l)){var p=o.create(l,so,!1,!0);f.buffer=o.getBuffer(p),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1,r.buffers.push(p)}else o.getBuffer(l)?(f.buffer=o.getBuffer(l),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1):o.getBuffer(l.buffer)?(f.buffer=o.getBuffer(l.buffer),f.size=0|(+l.size||f.buffer.dimension),f.normalized=!!l.normalized||!1,"type"in l?(rt.parameter(l.type,Be,"invalid buffer type"),f.type=Be[l.type]):f.type=f.buffer.dtype,f.offset=0|(l.offset||0),f.stride=0|(l.stride||0),f.divisor=0|(l.divisor||0),f.state=1,rt(f.size>=1&&f.size<=4,"size must be between 1 and 4"),rt(f.offset>=0,"invalid offset"),rt(f.stride>=0&&f.stride<=255,"stride must be between 0 and 255"),rt(f.divisor>=0,"divisor must be positive"),rt(!f.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in l?(rt(c>0,"first attribute must not be a constant"),f.x=+l.x||0,f.y=+l.y||0,f.z=+l.z||0,f.w=+l.w||0,f.state=2):rt(!1,"invalid attribute spec for location "+c)}return r.refresh(),s}return i.vaoCount+=1,s.destroy=function(){r.destroy()},s._vao=r,s._reglType="vao",s(e)}return _.prototype.bindAttrs=function(){for(var t=d(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(e.enableVertexAttribArray(r),e.bindBuffer(so,i.buffer.buffer),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),t&&t.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<a;++o)e.disableVertexAttribArray(o)},_.prototype.refresh=function(){var t=h();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),f.currentVAO=this)},_.prototype.destroy=function(){if(this.vao){var t=h();this===f.currentVAO&&(f.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}l[this.id]&&(delete l[this.id],i.vaoCount-=1)},f}var lo=35632,fo=35633,po=35718,ho=35721;function mo(t,e,n,r){var i={},o={};function a(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function s(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function u(n,r,a){var s=n===lo?i:o,u=s[r];if(!u){var c=e.str(r);u=t.createShader(n),t.shaderSource(u,c),t.compileShader(u),rt.shaderError(t,u,c,n,a),s[r]=u}return u}var c={},l=[],f=0;function p(t,e){this.id=f++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function h(n,i,o){var c,l,f=u(lo,n.fragId),p=u(fo,n.vertId),h=n.program=t.createProgram();if(t.attachShader(h,f),t.attachShader(h,p),o)for(c=0;c<o.length;++c){var d=o[c];t.bindAttribLocation(h,d[0],d[1])}t.linkProgram(h),rt.linkError(t,h,e.str(n.fragId),e.str(n.vertId),i);var m=t.getProgramParameter(h,po);r.profile&&(n.stats.uniformsCount=m);var v=n.uniforms;for(c=0;c<m;++c)if(l=t.getActiveUniform(h,c),l)if(l.size>1)for(var g=0;g<l.size;++g){var y=l.name.replace("[0]","["+g+"]");s(v,new a(y,e.id(y),t.getUniformLocation(h,y),l))}else s(v,new a(l.name,e.id(l.name),t.getUniformLocation(h,l.name),l));var _=t.getProgramParameter(h,ho);r.profile&&(n.stats.attributesCount=_);var b=n.attributes;for(c=0;c<_;++c)l=t.getActiveAttrib(h,c),l&&s(b,new a(l.name,e.id(l.name),t.getAttribLocation(h,l.name),l))}function d(){i={},o={};for(var t=0;t<l.length;++t)h(l[t],null,l[t].attributes.map((function(t){return[t.location,t.name]})))}return r.profile&&(n.getMaxUniformsCount=function(){var t=0;return l.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},n.getMaxAttributesCount=function(){var t=0;return l.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);Se(i).forEach(e),i={},Se(o).forEach(e),o={},l.forEach((function(e){t.deleteProgram(e.program)})),l.length=0,c={},n.shaderCount=0},program:function(t,e,r,i){rt.command(t>=0,"missing vertex shader",r),rt.command(e>=0,"missing fragment shader",r);var o=c[e];o||(o=c[e]={});var a=o[t];if(a&&!i)return a;var s=new p(e,t);return n.shaderCount++,h(s,r,i),a||(o[t]=s),l.push(s),s},restore:d,shader:u,frag:-1,vert:-1}}var vo=6408,go=5121,yo=3333,_o=5126;function bo(e,n,r,i,o,a,s){function u(u){var c;null===n.next?(rt(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=go):(rt(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(rt(c===go||c===_o,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===_o&&rt(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):rt(c===go,"Reading from a framebuffer is only allowed for the type 'uint8'"));var l=0,f=0,p=i.framebufferWidth,h=i.framebufferHeight,d=null;t(u)?d=u:u&&(rt.type(u,"object","invalid arguments to regl.read()"),l=0|u.x,f=0|u.y,rt(l>=0&&l<i.framebufferWidth,"invalid x offset for regl.read"),rt(f>=0&&f<i.framebufferHeight,"invalid y offset for regl.read"),p=0|(u.width||i.framebufferWidth-l),h=0|(u.height||i.framebufferHeight-f),d=u.data||null),d&&(c===go?rt(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===_o&&rt(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),rt(p>0&&p+l<=i.framebufferWidth,"invalid width for read pixels"),rt(h>0&&h+f<=i.framebufferHeight,"invalid height for read pixels"),r();var m=p*h*4;return d||(c===go?d=new Uint8Array(m):c===_o&&(d=d||new Float32Array(m))),rt.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),rt(d.byteLength>=m,"data buffer for regl.read() too small"),e.pixelStorei(yo,4),e.readPixels(l,f,p,h,vo,c,d),d}function c(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=u(t)})),e}function l(t){return t&&"framebuffer"in t?c(t):u(t)}return l}function xo(t){return Array.prototype.slice.call(t)}function wo(t){return xo(t).join("")}function So(){var t=0,n=[],r=[];function i(e){for(var i=0;i<r.length;++i)if(r[i]===e)return n[i];var o="g"+t++;return n.push(o),r.push(e),o}function o(){var n=[];function r(){n.push.apply(n,xo(arguments))}var i=[];function o(){var e="v"+t++;return i.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,xo(arguments)),n.push(";")),e}return e(r,{def:o,toString:function(){return wo([i.length>0?"var "+i.join(",")+";":"",wo(n)])}})}function a(){var t=o(),n=o(),r=t.toString,i=n.toString;function a(e,r){n(e,r,"=",t.def(e,r),";")}return e((function(){t.apply(t,xo(arguments))}),{def:t.def,entry:t,exit:n,save:a,set:function(e,n,r){a(e,n),t(e,n,"=",r,";")},toString:function(){return r()+i()}})}function s(){var t=wo(arguments),n=a(),r=a(),i=n.toString,o=r.toString;return e(n,{then:function(){return n.apply(n,xo(arguments)),this},else:function(){return r.apply(r,xo(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),wo(["if(",t,"){",i(),"}",e])}})}var u=o(),c={};function l(t,n){var r=[];function i(){var t="a"+r.length;return r.push(t),t}n=n||0;for(var o=0;o<n;++o)i();var s=a(),u=s.toString,l=c[t]=e(s,{arg:i,toString:function(){return wo(["function(",r.join(),"){",u(),"}"])}});return l}function f(){var t=['"use strict";',u,"return {"];Object.keys(c).forEach((function(e){t.push('"',e,'":',c[e].toString(),",")})),t.push("}");var e=wo(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),i=Function.apply(null,n.concat(e));return i.apply(null,r)}return{global:u,link:i,block:o,proc:l,scope:a,cond:s,compile:f}}var Eo="xyzw".split(""),To=5121,Ao=1,Co=2,ko=0,Po=1,Mo=2,Io=3,Oo=4,Lo="dither",Ro="blend.enable",Do="blend.color",zo="blend.equation",jo="blend.func",No="depth.enable",Fo="depth.func",Bo="depth.range",Uo="depth.mask",Vo="colorMask",Go="cull.enable",qo="cull.face",Zo="frontFace",Ho="lineWidth",Wo="polygonOffset.enable",Xo="polygonOffset.offset",Yo="sample.alpha",Ko="sample.enable",Jo="sample.coverage",Qo="stencil.enable",$o="stencil.mask",ta="stencil.func",ea="stencil.opFront",na="stencil.opBack",ra="scissor.enable",ia="scissor.box",oa="viewport",aa="profile",sa="framebuffer",ua="vert",ca="frag",la="elements",fa="primitive",pa="count",ha="offset",da="instances",ma="vao",va="Width",ga="Height",ya=sa+va,_a=sa+ga,ba=oa+va,xa=oa+ga,wa="drawingBuffer",Sa=wa+va,Ea=wa+ga,Ta=[jo,zo,ta,ea,na,Jo,oa,ia,Xo],Aa=34962,Ca=34963,ka=35632,Pa=35633,Ma=3553,Ia=34067,Oa=2884,La=3042,Ra=3024,Da=2960,za=2929,ja=3089,Na=32823,Fa=32926,Ba=32928,Ua=5126,Va=35664,Ga=35665,qa=35666,Za=5124,Ha=35667,Wa=35668,Xa=35669,Ya=35670,Ka=35671,Ja=35672,Qa=35673,$a=35674,ts=35675,es=35676,ns=35678,rs=35680,is=4,os=1028,as=1029,ss=2304,us=2305,cs=32775,ls=32776,fs=519,ps=7680,hs=0,ds=1,ms=32774,vs=513,gs=36160,ys=36064,_s={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},bs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],xs={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ws={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ss={frag:ka,vert:Pa},Es={cw:ss,ccw:us};function Ts(e){return Array.isArray(e)||t(e)||we(e)}function As(t){return t.sort((function(t,e){return t===oa?-1:e===oa?1:t<e?-1:1}))}function Cs(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function ks(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function Ps(t){return new Cs(!1,!1,!1,t)}function Ms(t,e){var n=t.type;if(n===ko){var r=t.data.length;return new Cs(!0,r>=1,r>=2,e)}if(n===Oo){var i=t.data;return new Cs(i.thisDep,i.contextDep,i.propDep,e)}return new Cs(n===Io,n===Mo,n===Po,e)}var Is=new Cs(!1,!1,!1,(function(){}));function Os(t,e,n,r,i,o,a,s,u,c,l,f,p,h,d){var m=c.Record,v={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(v.min=cs,v.max=ls);var g=n.angle_instanced_arrays,y=n.webgl_draw_buffers,_={dirty:!0,profile:d.profile},b={},x=[],w={},S={};function E(t){return t.replace(".","_")}function T(t,e,n){var r=E(t);x.push(t),b[r]=_[r]=!!n,w[r]=e}function A(t,e,n){var r=E(t);x.push(t),Array.isArray(n)?(_[r]=n.slice(),b[r]=n.slice()):_[r]=b[r]=n,S[r]=e}T(Lo,Ra),T(Ro,La),A(Do,"blendColor",[0,0,0,0]),A(zo,"blendEquationSeparate",[ms,ms]),A(jo,"blendFuncSeparate",[ds,hs,ds,hs]),T(No,za,!0),A(Fo,"depthFunc",vs),A(Bo,"depthRange",[0,1]),A(Uo,"depthMask",!0),A(Vo,Vo,[!0,!0,!0,!0]),T(Go,Oa),A(qo,"cullFace",as),A(Zo,Zo,us),A(Ho,Ho,1),T(Wo,Na),A(Xo,"polygonOffset",[0,0]),T(Yo,Fa),T(Ko,Ba),A(Jo,"sampleCoverage",[1,!1]),T(Qo,Da),A($o,"stencilMask",-1),A(ta,"stencilFunc",[fs,0,-1]),A(ea,"stencilOpSeparate",[os,ps,ps,ps]),A(na,"stencilOpSeparate",[as,ps,ps,ps]),T(ra,ja),A(ia,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),A(oa,oa,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var C={gl:t,context:p,strings:e,next:b,current:_,draw:f,elements:o,buffer:i,shader:l,attributes:c.state,vao:c,uniforms:u,framebuffer:s,extensions:n,timer:h,isBufferArgs:Ts},k={primTypes:un,compareFuncs:xs,blendFuncs:_s,blendEquations:v,stencilOps:ws,glTypes:Be,orientationType:Es};rt.optional((function(){C.isArrayLike=An})),y&&(k.backBuffer=[as],k.drawBuffer=Tt(r.maxDrawbuffers,(function(t){return 0===t?[0]:Tt(t,(function(t){return ys+t}))})));var P=0;function M(){var t=So(),n=t.link,r=t.global;t.id=P++,t.batchId="0";var i=n(C),o=t.shared={props:"a0"};Object.keys(C).forEach((function(t){o[t]=r.def(i,".",t)})),rt.optional((function(){t.CHECK=n(rt),t.commandStr=rt.guessCommand(),t.command=n(t.commandStr),t.assert=function(t,e,r){t("if(!(",e,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},k.invalidBlendCombinations=bs}));var a=t.next={},s=t.current={};Object.keys(S).forEach((function(t){Array.isArray(_[t])&&(a[t]=r.def(o.next,".",t),s[t]=r.def(o.current,".",t))}));var u=t.constants={};Object.keys(k).forEach((function(t){u[t]=r.def(JSON.stringify(k[t]))})),t.invoke=function(e,r){switch(r.type){case ko:var i=["this",o.context,o.props,t.batchId];return e.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case Po:return e.def(o.props,r.data);case Mo:return e.def(o.context,r.data);case Io:return e.def("this",r.data);case Oo:return r.data.append(t,e),r.data.ref}},t.attribCache={};var l={};return t.scopeAttrib=function(t){var r=e.id(t);if(r in l)return l[r];var i=c.scope[r];i||(i=c.scope[r]=new m);var o=l[r]=n(i);return o},t}function I(t){var e,n=t.static,r=t.dynamic;if(aa in n){var i=!!n[aa];e=Ps((function(t,e){return i})),e.enable=i}else if(aa in r){var o=r[aa];e=Ms(o,(function(t,e){return t.invoke(e,o)}))}return e}function O(t,e){var n=t.static,r=t.dynamic;if(sa in n){var i=n[sa];return i?(i=s.getFramebuffer(i),rt.command(i,"invalid framebuffer object"),Ps((function(t,e){var n=t.link(i),r=t.shared;e.set(r.framebuffer,".next",n);var o=r.context;return e.set(o,"."+ya,n+".width"),e.set(o,"."+_a,n+".height"),n}))):Ps((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var r=n.context;return e.set(r,"."+ya,r+"."+Sa),e.set(r,"."+_a,r+"."+Ea),"null"}))}if(sa in r){var o=r[sa];return Ms(o,(function(t,e){var n=t.invoke(e,o),r=t.shared,i=r.framebuffer,a=e.def(i,".getFramebuffer(",n,")");rt.optional((function(){t.assert(e,"!"+n+"||"+a,"invalid framebuffer object")})),e.set(i,".next",a);var s=r.context;return e.set(s,"."+ya,a+"?"+a+".width:"+s+"."+Sa),e.set(s,"."+_a,a+"?"+a+".height:"+s+"."+Ea),a}))}return null}function L(t,e,n){var r=t.static,i=t.dynamic;function o(t){if(t in r){var o=r[t];rt.commandType(o,"object","invalid "+t,n.commandStr);var a,s,u=!0,c=0|o.x,l=0|o.y;return"width"in o?(a=0|o.width,rt.command(a>=0,"invalid "+t,n.commandStr)):u=!1,"height"in o?(s=0|o.height,rt.command(s>=0,"invalid "+t,n.commandStr)):u=!1,new Cs(!u&&e&&e.thisDep,!u&&e&&e.contextDep,!u&&e&&e.propDep,(function(t,e){var n=t.shared.context,r=a;"width"in o||(r=e.def(n,".",ya,"-",c));var i=s;return"height"in o||(i=e.def(n,".",_a,"-",l)),[c,l,r,i]}))}if(t in i){var f=i[t],p=Ms(f,(function(e,n){var r=e.invoke(n,f);rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)}));var i=e.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",ya,"-",o,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",_a,"-",a,")");return rt.optional((function(){e.assert(n,s+">=0&&"+u+">=0","invalid "+t)})),[o,a,s,u]}));return e&&(p.thisDep=p.thisDep||e.thisDep,p.contextDep=p.contextDep||e.contextDep,p.propDep=p.propDep||e.propDep),p}return e?new Cs(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",ya),e.def(n,".",_a)]})):null}var a=o(oa);if(a){var s=a;a=new Cs(a.thisDep,a.contextDep,a.propDep,(function(t,e){var n=s.append(t,e),r=t.shared.context;return e.set(r,"."+ba,n[2]),e.set(r,"."+xa,n[3]),n}))}return{viewport:a,scissor_box:o(ia)}}function R(t,e){var n=t.static,r="string"===typeof n[ca]&&"string"===typeof n[ua];if(r){if(Object.keys(e.dynamic).length>0)return null;var i=e.static,o=Object.keys(i);if(o.length>0&&"number"===typeof i[o[0]]){for(var a=[],s=0;s<o.length;++s)rt("number"===typeof i[o[s]],"must specify all vertex attribute locations when using vaos"),a.push([0|i[o[s]],o[s]]);return a}}return null}function D(t,n,r){var i=t.static,o=t.dynamic;function a(t){if(t in i){var n=e.id(i[t]);rt.optional((function(){l.shader(Ss[t],n,rt.guessCommand())}));var r=Ps((function(){return n}));return r.id=n,r}if(t in o){var a=o[t];return Ms(a,(function(e,n){var r=e.invoke(n,a),i=n.def(e.shared.strings,".id(",r,")");return rt.optional((function(){n(e.shared.shader,".shader(",Ss[t],",",i,",",e.command,");")})),i}))}return null}var s,u=a(ca),c=a(ua),f=null;return ks(u)&&ks(c)?(f=l.program(c.id,u.id,null,r),s=Ps((function(t,e){return t.link(f)}))):s=new Cs(u&&u.thisDep||c&&c.thisDep,u&&u.contextDep||c&&c.contextDep,u&&u.propDep||c&&c.propDep,(function(t,e){var n,r,i=t.shared.shader;n=u?u.append(t,e):e.def(i,".",ca),r=c?c.append(t,e):e.def(i,".",ua);var o=i+".program("+r+","+n;return rt.optional((function(){o+=","+t.command})),e.def(o+")")})),{frag:u,vert:c,progVar:s,program:f}}function z(t,e){var n=t.static,r=t.dynamic;function i(){if(la in n){var t=n[la];Ts(t)?t=o.getElements(o.create(t,!0)):t&&(t=o.getElements(t),rt.command(t,"invalid elements",e.commandStr));var i=Ps((function(e,n){if(t){var r=e.link(t);return e.ELEMENTS=r,r}return e.ELEMENTS=null,null}));return i.value=t,i}if(la in r){var a=r[la];return Ms(a,(function(t,e){var n=t.shared,r=n.isBufferArgs,i=n.elements,o=t.invoke(e,a),s=e.def("null"),u=e.def(r,"(",o,")"),c=t.cond(u).then(s,"=",i,".createStream(",o,");").else(s,"=",i,".getElements(",o,");");return rt.optional((function(){t.assert(c.else,"!"+o+"||"+s,"invalid elements")})),e.entry(c),e.exit(t.cond(u).then(i,".destroyStream(",s,");")),t.ELEMENTS=s,s}))}return null}var a=i();function s(){if(fa in n){var t=n[fa];return rt.commandParameter(t,un,"invalid primitve",e.commandStr),Ps((function(e,n){return un[t]}))}if(fa in r){var i=r[fa];return Ms(i,(function(t,e){var n=t.constants.primTypes,r=t.invoke(e,i);return rt.optional((function(){t.assert(e,r+" in "+n,"invalid primitive, must be one of "+Object.keys(un))})),e.def(n,"[",r,"]")}))}return a?ks(a)?a.value?Ps((function(t,e){return e.def(t.ELEMENTS,".primType")})):Ps((function(){return is})):new Cs(a.thisDep,a.contextDep,a.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",is)})):null}function u(t,i){if(t in n){var o=0|n[t];return rt.command(!i||o>=0,"invalid "+t,e.commandStr),Ps((function(t,e){return i&&(t.OFFSET=o),o}))}if(t in r){var s=r[t];return Ms(s,(function(e,n){var r=e.invoke(n,s);return i&&(e.OFFSET=r,rt.optional((function(){e.assert(n,r+">=0","invalid "+t)}))),r}))}return i&&a?Ps((function(t,e){return t.OFFSET="0",0})):null}var c=u(ha,!0);function l(){if(pa in n){var t=0|n[pa];return rt.command("number"===typeof t&&t>=0,"invalid vertex count",e.commandStr),Ps((function(){return t}))}if(pa in r){var i=r[pa];return Ms(i,(function(t,e){var n=t.invoke(e,i);return rt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(a){if(ks(a)){if(a)return c?new Cs(c.thisDep,c.contextDep,c.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return rt.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):Ps((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var o=Ps((function(){return-1}));return rt.optional((function(){o.MISSING=!0})),o}var s=new Cs(a.thisDep||c.thisDep,a.contextDep||c.contextDep,a.propDep||c.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return rt.optional((function(){s.DYNAMIC=!0})),s}return null}return{elements:a,primitive:s(),count:l(),instances:u(da,!1),offset:c}}function j(t,e){var n=t.static,i=t.dynamic,o={};return x.forEach((function(t){var a=E(t);function s(e,r){if(t in n){var s=e(n[t]);o[a]=Ps((function(){return s}))}else if(t in i){var u=i[t];o[a]=Ms(u,(function(t,e){return r(t,e,t.invoke(e,u))}))}}switch(t){case Go:case Ro:case Lo:case Qo:case No:case ra:case Wo:case Yo:case Ko:case Uo:return s((function(n){return rt.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,r){return rt.optional((function(){e.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+t,e.commandStr)})),r}));case Fo:return s((function(n){return rt.commandParameter(n,xs,"invalid "+t,e.commandStr),xs[n]}),(function(e,n,r){var i=e.constants.compareFuncs;return rt.optional((function(){e.assert(n,r+" in "+i,"invalid "+t+", must be one of "+Object.keys(xs))})),n.def(i,"[",r,"]")}));case Bo:return s((function(t){return rt.command(An(t)&&2===t.length&&"number"===typeof t[0]&&"number"===typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")}));var r=e.def("+",n,"[0]"),i=e.def("+",n,"[1]");return[r,i]}));case jo:return s((function(t){rt.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,r="srcAlpha"in t?t.srcAlpha:t.src,i="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return rt.commandParameter(n,_s,a+".srcRGB",e.commandStr),rt.commandParameter(r,_s,a+".srcAlpha",e.commandStr),rt.commandParameter(i,_s,a+".dstRGB",e.commandStr),rt.commandParameter(o,_s,a+".dstAlpha",e.commandStr),rt.command(-1===bs.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",e.commandStr),[_s[n],_s[i],_s[r],_s[o]]}),(function(e,n,r){var i=e.constants.blendFuncs;function o(o,a){var s=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return rt.optional((function(){e.assert(n,s+" in "+i,"invalid "+t+"."+o+a+", must be one of "+Object.keys(_s))})),s}rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),s=o("dst","RGB");rt.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(i,"[",a,"]"),c=n.def(i,"[",o("src","Alpha"),"]"),l=n.def(i,"[",s,"]"),f=n.def(i,"[",o("dst","Alpha"),"]");return[u,l,c,f]}));case zo:return s((function(n){return"string"===typeof n?(rt.commandParameter(n,v,"invalid "+t,e.commandStr),[v[n],v[n]]):"object"===typeof n?(rt.commandParameter(n.rgb,v,t+".rgb",e.commandStr),rt.commandParameter(n.alpha,v,t+".alpha",e.commandStr),[v[n.rgb],v[n.alpha]]):void rt.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,r){var i=e.constants.blendEquations,o=n.def(),a=n.def(),s=e.cond("typeof ",r,'==="string"');return rt.optional((function(){function n(t,n,r){e.assert(t,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(v))}n(s.then,t,r),e.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+t),n(s.else,t+".rgb",r+".rgb"),n(s.else,t+".alpha",r+".alpha")})),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]}));case Do:return s((function(t){return rt.command(An(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),Tt(4,(function(e){return+t[e]}))}),(function(t,e,n){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),Tt(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case $o:return s((function(t){return rt.commandType(t,"number",a,e.commandStr),0|t}),(function(t,e,n){return rt.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case ta:return s((function(n){rt.commandType(n,"object",a,e.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return rt.commandParameter(r,xs,t+".cmp",e.commandStr),rt.commandType(i,"number",t+".ref",e.commandStr),rt.commandType(o,"number",t+".mask",e.commandStr),[xs[r],i,o]}),(function(t,e,n){var r=t.constants.compareFuncs;rt.optional((function(){function i(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")}));var i=e.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",ps),o=e.def(n,".ref|0"),a=e.def('"mask" in ',n,"?",n,".mask|0:-1");return[i,o,a]}));case ea:case na:return s((function(n){rt.commandType(n,"object",a,e.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return rt.commandParameter(r,ws,t+".fail",e.commandStr),rt.commandParameter(i,ws,t+".zfail",e.commandStr),rt.commandParameter(o,ws,t+".zpass",e.commandStr),[t===na?as:os,ws[r],ws[i],ws[o]]}),(function(e,n,r){var i=e.constants.stencilOps;function o(o){return rt.optional((function(){e.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+t+"."+o+", must be one of "+Object.keys(ws))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",ps)}return rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[t===na?as:os,o("fail"),o("zfail"),o("zpass")]}));case Xo:return s((function(t){rt.commandType(t,"object",a,e.commandStr);var n=0|t.factor,r=0|t.units;return rt.commandType(n,"number",a+".factor",e.commandStr),rt.commandType(r,"number",a+".units",e.commandStr),[n,r]}),(function(e,n,r){rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)}));var i=n.def(r,".factor|0"),o=n.def(r,".units|0");return[i,o]}));case qo:return s((function(t){var n=0;return"front"===t?n=os:"back"===t&&(n=as),rt.command(!!n,a,e.commandStr),n}),(function(t,e,n){return rt.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',os,":",as)}));case Ho:return s((function(t){return rt.command("number"===typeof t&&t>=r.lineWidthDims[0]&&t<=r.lineWidthDims[1],"invalid line width, must be a positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return rt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")})),n}));case Zo:return s((function(t){return rt.commandParameter(t,Es,a,e.commandStr),Es[t]}),(function(t,e,n){return rt.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?'+ss+":"+us)}));case Vo:return s((function(t){return rt.command(An(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),Tt(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Jo:return s((function(t){rt.command("object"===typeof t&&t,a,e.commandStr);var n="value"in t?t.value:1,r=!!t.invert;return rt.command("number"===typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,r]}),(function(t,e,n){rt.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")}));var r=e.def('"value" in ',n,"?+",n,".value:1"),i=e.def("!!",n,".invert");return[r,i]}))}})),o}function N(t,e){var n=t.static,r=t.dynamic,i={};return Object.keys(n).forEach((function(t){var r,o=n[t];if("number"===typeof o||"boolean"===typeof o)r=Ps((function(){return o}));else if("function"===typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=Ps((function(t){return t.link(o)})):"framebuffer"===a||"framebufferCube"===a?(rt.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),r=Ps((function(t){return t.link(o.color[0])}))):rt.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else An(o)?r=Ps((function(e){var n=e.global.def("[",Tt(o.length,(function(n){return rt.command("number"===typeof o[n]||"boolean"===typeof o[n],"invalid uniform "+t,e.commandStr),o[n]})),"]");return n})):rt.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);r.value=o,i[t]=r})),Object.keys(r).forEach((function(t){var e=r[t];i[t]=Ms(e,(function(t,n){return t.invoke(n,e)}))})),i}function F(t,n){var r=t.static,o=t.dynamic,a={};return Object.keys(r).forEach((function(t){var o=r[t],s=e.id(t),u=new m;if(Ts(o))u.state=Ao,u.buffer=i.getBuffer(i.create(o,Aa,!1,!0)),u.type=0;else{var c=i.getBuffer(o);if(c)u.state=Ao,u.buffer=c,u.type=0;else if(rt.command("object"===typeof o&&o,"invalid data for attribute "+t,n.commandStr),"constant"in o){var l=o.constant;u.buffer="null",u.state=Co,"number"===typeof l?u.x=l:(rt.command(An(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+t,n.commandStr),Eo.forEach((function(t,e){e<l.length&&(u[t]=l[e])})))}else{c=Ts(o.buffer)?i.getBuffer(i.create(o.buffer,Aa,!1,!0)):i.getBuffer(o.buffer),rt.command(!!c,'missing buffer for attribute "'+t+'"',n.commandStr);var f=0|o.offset;rt.command(f>=0,'invalid offset for attribute "'+t+'"',n.commandStr);var p=0|o.stride;rt.command(p>=0&&p<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',n.commandStr);var h=0|o.size;rt.command(!("size"in o)||h>0&&h<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',n.commandStr);var d=!!o.normalized,v=0;"type"in o&&(rt.commandParameter(o.type,Be,"invalid type for attribute "+t,n.commandStr),v=Be[o.type]);var y=0|o.divisor;"divisor"in o&&(rt.command(0===y||g,'cannot specify divisor for attribute "'+t+'", instancing not supported',n.commandStr),rt.command(y>=0,'invalid divisor for attribute "'+t+'"',n.commandStr)),rt.optional((function(){var e=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach((function(n){rt.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+t+'" (valid parameters are '+r+")",e)}))})),u.buffer=c,u.state=Ao,u.size=h,u.normalized=d,u.type=v||c.dtype,u.offset=f,u.stride=p,u.divisor=y}}a[t]=Ps((function(t,e){var n=t.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach((function(t){r[t]=u[t]})),u.buffer&&(r.buffer=t.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(o).forEach((function(t){var e=o[t];function n(n,r){var i=n.invoke(r,e),o=n.shared,a=n.constants,s=o.isBufferArgs,u=o.buffer;rt.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')}));var c={isStream:r.def(!1)},l=new m;l.state=Ao,Object.keys(l).forEach((function(t){c[t]=r.def(""+l[t])}));var f=c.buffer,p=c.type;function h(t){r(c[t],"=",i,".",t,"|0;")}return r("if(",s,"(",i,")){",c.isStream,"=true;",f,"=",u,".createStream(",Aa,",",i,");",p,"=",f,".dtype;","}else{",f,"=",u,".getBuffer(",i,");","if(",f,"){",p,"=",f,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",Co,";","if(typeof "+i+'.constant === "number"){',c[Eo[0]],"=",i,".constant;",Eo.slice(1).map((function(t){return c[t]})).join("="),"=0;","}else{",Eo.map((function(t,e){return c[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",f,"=",u,".createStream(",Aa,",",i,".buffer);","}else{",f,"=",u,".getBuffer(",i,".buffer);","}",p,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",f,".dtype;",c.normalized,"=!!",i,".normalized;"),h("size"),h("offset"),h("stride"),h("divisor"),r("}}"),r.exit("if(",c.isStream,"){",u,".destroyStream(",f,");","}"),c}a[t]=Ms(e,n)})),a}function B(t,e){var n=t.static,r=t.dynamic;if(ma in n){var i=n[ma];return null!==i&&null===c.getVAO(i)&&(i=c.createVAO(i)),Ps((function(t){return t.link(c.getVAO(i))}))}if(ma in r){var o=r[ma];return Ms(o,(function(t,e){var n=t.invoke(e,o);return e.def(t.shared.vao+".getVAO("+n+")")}))}return null}function U(t){var e=t.static,n=t.dynamic,r={};return Object.keys(e).forEach((function(t){var n=e[t];r[t]=Ps((function(t,e){return"number"===typeof n||"boolean"===typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];r[t]=Ms(e,(function(t,n){return t.invoke(n,e)}))})),r}function V(t,e,r,i,o){var a=t.static,s=t.dynamic;rt.optional((function(){var t=[sa,ua,ca,la,fa,ha,pa,da,aa,ma].concat(x);function e(e){Object.keys(e).forEach((function(e){rt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',o.commandStr)}))}e(a),e(s)}));var u=R(t,e),l=O(t,o),f=L(t,l,o),p=z(t,o),h=j(t,o),d=D(t,o,u);function m(t){var e=f[t];e&&(h[t]=e)}m(oa),m(E(ia));var v=Object.keys(h).length>0,g={framebuffer:l,draw:p,shader:d,state:h,dirty:v,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(g.profile=I(t,o),g.uniforms=N(r,o),g.drawVAO=g.scopeVAO=B(t,o),!g.drawVAO&&d.program&&!u&&n.angle_instanced_arrays){var y=!0,_=d.program.attributes.map((function(t){var n=e.static[t];return y=y&&!!n,n}));if(y&&_.length>0){var b=c.getVAO(c.createVAO(_));g.drawVAO=new Cs(null,null,null,(function(t,e){return t.link(b)})),g.useVAO=!0}}return u?g.useVAO=!0:g.attributes=F(e,o),g.context=U(i,o),g}function G(t,e,n){var r=t.shared,i=r.context,o=t.scope();Object.keys(n).forEach((function(r){e.save(i,"."+r);var a=n[r];o(i,".",r,"=",a.append(t,e),";")})),e(o)}function q(t,e,n,r){var i,o=t.shared,a=o.gl,s=o.framebuffer;y&&(i=e.def(o.extensions,".webgl_draw_buffers"));var u,c=t.constants,l=c.drawBuffer,f=c.backBuffer;u=n?n.append(t,e):e.def(s,".next"),r||e("if(",u,"!==",s,".cur){"),e("if(",u,"){",a,".bindFramebuffer(",gs,",",u,".framebuffer);"),y&&e(i,".drawBuffersWEBGL(",l,"[",u,".colorAttachments.length]);"),e("}else{",a,".bindFramebuffer(",gs,",null);"),y&&e(i,".drawBuffersWEBGL(",f,");"),e("}",s,".cur=",u,";"),r||e("}")}function Z(t,e,n){var r=t.shared,i=r.gl,o=t.current,a=t.next,s=r.current,u=r.next,c=t.cond(s,".dirty");x.forEach((function(e){var r,l,f=E(e);if(!(f in n.state))if(f in a){r=a[f],l=o[f];var p=Tt(_[f].length,(function(t){return c.def(r,"[",t,"]")}));c(t.cond(p.map((function(t,e){return t+"!=="+l+"["+e+"]"})).join("||")).then(i,".",S[f],"(",p,");",p.map((function(t,e){return l+"["+e+"]="+t})).join(";"),";"))}else{r=c.def(u,".",f);var h=t.cond(r,"!==",s,".",f);c(h),f in w?h(t.cond(r).then(i,".enable(",w[f],");").else(i,".disable(",w[f],");"),s,".",f,"=",r,";"):h(i,".",S[f],"(",r,");",s,".",f,"=",r,";")}})),0===Object.keys(n.state).length&&c(s,".dirty=false;"),e(c)}function H(t,e,n,r){var i=t.shared,o=t.current,a=i.current,s=i.gl;As(Object.keys(n)).forEach((function(i){var u=n[i];if(!r||r(u)){var c=u.append(t,e);if(w[i]){var l=w[i];ks(u)?e(s,c?".enable(":".disable(",l,");"):e(t.cond(c).then(s,".enable(",l,");").else(s,".disable(",l,");")),e(a,".",i,"=",c,";")}else if(An(c)){var f=o[i];e(s,".",S[i],"(",c,");",c.map((function(t,e){return f+"["+e+"]="+t})).join(";"),";")}else e(s,".",S[i],"(",c,");",a,".",i,"=",c,";")}}))}function W(t,e){g&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function X(t,e,n,r,i){var o,a,s,u=t.shared,c=t.stats,l=u.current,f=u.timer,p=n.profile;function d(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function m(t){o=e.def(),t(o,"=",d(),";"),"string"===typeof i?t(c,".count+=",i,";"):t(c,".count++;"),h&&(r?(a=e.def(),t(a,"=",f,".getNumPendingQueries();")):t(f,".beginQuery(",c,");"))}function v(t){t(c,".cpuTime+=",d(),"-",o,";"),h&&(r?t(f,".pushScopeStats(",a,",",f,".getNumPendingQueries(),",c,");"):t(f,".endQuery();"))}function g(t){var n=e.def(l,".profile");e(l,".profile=",t,";"),e.exit(l,".profile=",n,";")}if(p){if(ks(p))return void(p.enable?(m(e),v(e.exit),g("true")):g("false"));s=p.append(t,e),g(s)}else s=e.def(l,".profile");var y=t.block();m(y),e("if(",s,"){",y,"}");var _=t.block();v(_),e.exit("if(",s,"){",_,"}")}function Y(t,e,n,r,i){var o=t.shared;function a(t){switch(t){case Va:case Ha:case Ka:return 2;case Ga:case Wa:case Ja:return 3;case qa:case Xa:case Qa:return 4;default:return 1}}function s(n,r,i){var a=o.gl,s=e.def(n,".location"),u=e.def(o.attributes,"[",s,"]"),c=i.state,l=i.buffer,f=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];function h(){e("if(!",u,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,o=i.type;if(n=i.size?e.def(i.size,"||",r):r,e("if(",u,".type!==",o,"||",u,".size!==",n,"||",p.map((function(t){return u+"."+t+"!=="+i[t]})).join("||"),"){",a,".bindBuffer(",Aa,",",l,".buffer);",a,".vertexAttribPointer(",[s,n,o,i.normalized,i.stride,i.offset],");",u,".type=",o,";",u,".size=",n,";",p.map((function(t){return u+"."+t+"="+i[t]+";"})).join(""),"}"),g){var c=i.divisor;e("if(",u,".divisor!==",c,"){",t.instancing,".vertexAttribDivisorANGLE(",[s,c],");",u,".divisor=",c,";}")}}function d(){e("if(",u,".buffer){",a,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",Eo.map((function(t,e){return u+"."+t+"!=="+f[e]})).join("||"),"){",a,".vertexAttrib4f(",s,",",f,");",Eo.map((function(t,e){return u+"."+t+"="+f[e]+";"})).join(""),"}")}c===Ao?h():c===Co?d():(e("if(",c,"===",Ao,"){"),h(),e("}else{"),d(),e("}"))}r.forEach((function(r){var o,u=r.name,c=n.attributes[u];if(c){if(!i(c))return;o=c.append(t,e)}else{if(!i(Is))return;var l=t.scopeAttrib(u);rt.optional((function(){t.assert(e,l+".state","missing attribute "+u)})),o={},Object.keys(new m).forEach((function(t){o[t]=e.def(l,".",t)}))}s(t.link(r),a(r.info.type),o)}))}function K(t,n,r,i,o){for(var a,s=t.shared,u=s.gl,c=0;c<i.length;++c){var l,f=i[c],p=f.name,h=f.info.type,d=r.uniforms[p],m=t.link(f),v=m+".location";if(d){if(!o(d))continue;if(ks(d)){var g=d.value;if(rt.command(null!==g&&"undefined"!==typeof g,'missing uniform "'+p+'"',t.commandStr),h===ns||h===rs){rt.command("function"===typeof g&&(h===ns&&("texture2d"===g._reglType||"framebuffer"===g._reglType)||h===rs&&("textureCube"===g._reglType||"framebufferCube"===g._reglType)),"invalid texture for uniform "+p,t.commandStr);var y=t.link(g._texture||g.color[0]._texture);n(u,".uniform1i(",v,",",y+".bind());"),n.exit(y,".unbind();")}else if(h===$a||h===ts||h===es){rt.optional((function(){rt.command(An(g),"invalid matrix for uniform "+p,t.commandStr),rt.command(h===$a&&4===g.length||h===ts&&9===g.length||h===es&&16===g.length,"invalid length for matrix uniform "+p,t.commandStr)}));var _=t.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),b=2;h===ts?b=3:h===es&&(b=4),n(u,".uniformMatrix",b,"fv(",v,",false,",_,");")}else{switch(h){case Ua:rt.commandType(g,"number","uniform "+p,t.commandStr),a="1f";break;case Va:rt.command(An(g)&&2===g.length,"uniform "+p,t.commandStr),a="2f";break;case Ga:rt.command(An(g)&&3===g.length,"uniform "+p,t.commandStr),a="3f";break;case qa:rt.command(An(g)&&4===g.length,"uniform "+p,t.commandStr),a="4f";break;case Ya:rt.commandType(g,"boolean","uniform "+p,t.commandStr),a="1i";break;case Za:rt.commandType(g,"number","uniform "+p,t.commandStr),a="1i";break;case Ka:rt.command(An(g)&&2===g.length,"uniform "+p,t.commandStr),a="2i";break;case Ha:rt.command(An(g)&&2===g.length,"uniform "+p,t.commandStr),a="2i";break;case Ja:rt.command(An(g)&&3===g.length,"uniform "+p,t.commandStr),a="3i";break;case Wa:rt.command(An(g)&&3===g.length,"uniform "+p,t.commandStr),a="3i";break;case Qa:rt.command(An(g)&&4===g.length,"uniform "+p,t.commandStr),a="4i";break;case Xa:rt.command(An(g)&&4===g.length,"uniform "+p,t.commandStr),a="4i";break}n(u,".uniform",a,"(",v,",",An(g)?Array.prototype.slice.call(g):g,");")}continue}l=d.append(t,n)}else{if(!o(Is))continue;l=n.def(s.uniforms,"[",e.id(p),"]")}h===ns?n("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}"):h===rs&&n("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}"),rt.optional((function(){function e(e,r){t.assert(n,e,'bad data or missing for uniform "'+p+'".  '+r)}function r(t){e("typeof "+l+'==="'+t+'"',"invalid type, expected "+t)}function i(n,r){e(s.isArrayLike+"("+l+")&&"+l+".length==="+n,"invalid vector, should have length "+n,t.commandStr)}function o(n){e("typeof "+l+'==="function"&&'+l+'._reglType==="texture'+(n===Ma?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(h){case Za:r("number");break;case Ha:i(2,"number");break;case Wa:i(3,"number");break;case Xa:i(4,"number");break;case Ua:r("number");break;case Va:i(2,"number");break;case Ga:i(3,"number");break;case qa:i(4,"number");break;case Ya:r("boolean");break;case Ka:i(2,"boolean");break;case Ja:i(3,"boolean");break;case Qa:i(4,"boolean");break;case $a:i(4,"number");break;case ts:i(9,"number");break;case es:i(16,"number");break;case ns:o(Ma);break;case rs:o(Ia);break}}));var x=1;switch(h){case ns:case rs:var w=n.def(l,"._texture");n(u,".uniform1i(",v,",",w,".bind());"),n.exit(w,".unbind();");continue;case Za:case Ya:a="1i";break;case Ha:case Ka:a="2i",x=2;break;case Wa:case Ja:a="3i",x=3;break;case Xa:case Qa:a="4i",x=4;break;case Ua:a="1f";break;case Va:a="2f",x=2;break;case Ga:a="3f",x=3;break;case qa:a="4f",x=4;break;case $a:a="Matrix2fv";break;case ts:a="Matrix3fv";break;case es:a="Matrix4fv";break}if(n(u,".uniform",a,"(",v,","),"M"===a.charAt(0)){var S=Math.pow(h-$a+2,2),E=t.global.def("new Float32Array(",S,")");n("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",Tt(S,(function(t){return E+"["+t+"]="+l+"["+t+"]"})),",",E,")")}else n(x>1?Tt(x,(function(t){return l+"["+t+"]"})):l);n(");")}}function J(t,e,n,r){var i=t.shared,o=i.gl,a=i.draw,s=r.draw;function u(){var i,u=s.elements,c=e;return u?((u.contextDep&&r.contextDynamic||u.propDep)&&(c=n),i=u.append(t,c)):i=c.def(a,".",la),i&&c("if("+i+")"+o+".bindBuffer("+Ca+","+i+".buffer.buffer);"),i}function c(){var i,o=s.count,u=e;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(u=n),i=o.append(t,u),rt.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(u,i+">=0","missing vertex count")}))):(i=u.def(a,".",pa),rt.optional((function(){t.assert(u,i+">=0","missing vertex count")}))),i}var l=u();function f(i){var o=s[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(a,".",i)}var p,h,d=f(fa),m=f(ha),v=c();if("number"===typeof v){if(0===v)return}else n("if(",v,"){"),n.exit("}");g&&(p=f(da),h=t.instancing);var y=l+".type",_=s.elements&&ks(s.elements);function b(){function t(){n(h,".drawElementsInstancedANGLE(",[d,v,y,m+"<<(("+y+"-"+To+")>>1)",p],");")}function e(){n(h,".drawArraysInstancedANGLE(",[d,m,v,p],");")}l?_?t():(n("if(",l,"){"),t(),n("}else{"),e(),n("}")):e()}function x(){function t(){n(o+".drawElements("+[d,v,y,m+"<<(("+y+"-"+To+")>>1)"]+");")}function e(){n(o+".drawArrays("+[d,m,v]+");")}l?_?t():(n("if(",l,"){"),t(),n("}else{"),e(),n("}")):e()}g&&("number"!==typeof p||p>=0)?"string"===typeof p?(n("if(",p,">0){"),b(),n("}else if(",p,"<0){"),x(),n("}")):b():x()}function Q(t,e,n,r,i){var o=M(),a=o.proc("body",i);return rt.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),g&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),t(o,a,n,r),o.compile().body}function $(t,e,n,r){W(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),Y(t,e,n,r.attributes,(function(){return!0}))),K(t,e,n,r.uniforms,(function(){return!0})),J(t,e,e,n)}function tt(t,e){var n=t.proc("draw",1);W(t,n),G(t,n,e.context),q(t,n,e.framebuffer),Z(t,n,e),H(t,n,e.state),X(t,n,e,!1,!0);var r=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",r,".program);"),e.shader.program)$(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(t.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",t.link((function(n){return Q($,t,e,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;")}function et(t,e,n,r){function i(){return!0}t.batchId="a1",W(t,e),Y(t,e,n,r.attributes,i),K(t,e,n,r.uniforms,i),J(t,e,e,n)}function nt(t,e,n,r){W(t,e);var i=n.contextDep,o=e.def(),a="a0",s="a1",u=e.def();t.shared.props=u,t.batchId=o;var c=t.scope(),l=t.scope();function f(t){return t.contextDep&&i||t.propDep}function p(t){return!f(t)}if(e(c.entry,"for(",o,"=0;",o,"<",s,";++",o,"){",u,"=",a,"[",o,"];",l,"}",c.exit),n.needsContext&&G(t,l,n.context),n.needsFramebuffer&&q(t,l,n.framebuffer),H(t,l,n.state,f),n.profile&&f(n.profile)&&X(t,l,n,!1,!0),r)n.useVAO?n.drawVAO?f(n.drawVAO)?l(t.shared.vao,".setVAO(",n.drawVAO.append(t,l),");"):c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):c(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(c(t.shared.vao,".setVAO(null);"),Y(t,c,n,r.attributes,p),Y(t,l,n,r.attributes,f)),K(t,c,n,r.uniforms,p),K(t,l,n,r.uniforms,f),J(t,c,l,n);else{var h=t.global.def("{}"),d=n.shader.progVar.append(t,l),m=l.def(d,".id"),v=l.def(h,"[",m,"]");l(t.shared.gl,".useProgram(",d,".program);","if(!",v,"){",v,"=",h,"[",m,"]=",t.link((function(e){return Q(et,t,n,e,2)})),"(",d,");}",v,".call(this,a0[",o,"],",o,");")}}function it(t,e){var n=t.proc("batch",2);t.batchId="0",W(t,n);var r=!1,i=!0;Object.keys(e.context).forEach((function(t){r=r||e.context[t].propDep})),r||(G(t,n,e.context),i=!1);var o=e.framebuffer,a=!1;function s(t){return t.contextDep&&r||t.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||q(t,n,o)):q(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(r=!0),Z(t,n,e),H(t,n,e.state,(function(t){return!s(t)})),e.profile&&s(e.profile)||X(t,n,e,!1,"a1"),e.contextDep=r,e.needsContext=i,e.needsFramebuffer=a;var u=e.shader.progVar;if(u.contextDep&&r||u.propDep)nt(t,n,e,null);else{var c=u.append(t,n);if(n(t.shared.gl,".useProgram(",c,".program);"),e.shader.program)nt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var l=t.global.def("{}"),f=n.def(c,".id"),p=n.def(l,"[",f,"]");n(t.cond(p).then(p,".call(this,a0,a1);").else(p,"=",l,"[",f,"]=",t.link((function(n){return Q(nt,t,e,n,2)})),"(",c,");",p,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;")}function ot(t,n){var r=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;function a(e){var o=n.shader[e];o&&r.set(i.shader,"."+e,o.append(t,r))}G(t,r,n.context),n.framebuffer&&n.framebuffer.append(t,r),As(Object.keys(n.state)).forEach((function(e){var o=n.state[e],a=o.append(t,r);An(a)?a.forEach((function(n,i){r.set(t.next[e],"["+i+"]",n)})):r.set(i.next,"."+e,a)})),X(t,r,n,!0,!0),[la,ha,pa,da,fa].forEach((function(e){var o=n.draw[e];o&&r.set(i.draw,"."+e,""+o.append(t,r))})),Object.keys(n.uniforms).forEach((function(o){r.set(i.uniforms,"["+e.id(o)+"]",n.uniforms[o].append(t,r))})),Object.keys(n.attributes).forEach((function(e){var i=n.attributes[e].append(t,r),o=t.scopeAttrib(e);Object.keys(new m).forEach((function(t){r.set(o,"."+t,i[t])}))})),n.scopeVAO&&r.set(i.vao,".targetVAO",n.scopeVAO.append(t,r)),a(ua),a(ca),Object.keys(n.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",t.shared.context,",a0,",t.batchId,");")}function at(t){if("object"===typeof t&&!An(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(ht.isDynamic(t[e[n]]))return!0;return!1}}function st(t,e,n){var r=e.static[n];if(r&&at(r)){var i=t.global,o=Object.keys(r),a=!1,s=!1,u=!1,c=t.global.def("{}");o.forEach((function(e){var n=r[e];if(ht.isDynamic(n)){"function"===typeof n&&(n=r[e]=ht.unbox(n));var o=Ms(n,null);a=a||o.thisDep,u=u||o.propDep,s=s||o.contextDep}else{switch(i(c,".",e,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(t.link(n));break}i(";")}})),e.dynamic[n]=new ht.DynamicVariable(Oo,{thisDep:a,contextDep:s,propDep:u,ref:c,append:l}),delete e.static[n]}function l(t,e){o.forEach((function(n){var i=r[n];if(ht.isDynamic(i)){var o=t.invoke(e,i);e(c,".",n,"=",o,";")}}))}}function ut(t,e,n,r,i){var o=M();o.stats=o.link(i),Object.keys(e.static).forEach((function(t){st(o,e,t)})),Ta.forEach((function(e){st(o,t,e)}));var a=V(t,e,n,r,o);return tt(o,a),ot(o,a),it(o,a),o.compile()}return{next:b,current:_,procs:function(){var t=M(),e=t.proc("poll"),i=t.proc("refresh"),o=t.block();e(o),i(o);var a,s=t.shared,u=s.gl,c=s.next,l=s.current;o(l,".dirty=false;"),q(t,e),q(t,i,null,!0),g&&(a=t.link(g)),n.oes_vertex_array_object&&i(t.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var f=0;f<r.maxAttributes;++f){var p=i.def(s.attributes,"[",f,"]"),h=t.cond(p,".buffer");h.then(u,".enableVertexAttribArray(",f,");",u,".bindBuffer(",Aa,",",p,".buffer.buffer);",u,".vertexAttribPointer(",f,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(u,".disableVertexAttribArray(",f,");",u,".vertexAttrib4f(",f,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),i(h),g&&i(a,".vertexAttribDivisorANGLE(",f,",",p,".divisor);")}return i(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(w).forEach((function(n){var r=w[n],a=o.def(c,".",n),s=t.block();s("if(",a,"){",u,".enable(",r,")}else{",u,".disable(",r,")}",l,".",n,"=",a,";"),i(s),e("if(",a,"!==",l,".",n,"){",s,"}")})),Object.keys(S).forEach((function(n){var r,a,s=S[n],f=_[n],p=t.block();if(p(u,".",s,"("),An(f)){var h=f.length;r=t.global.def(c,".",n),a=t.global.def(l,".",n),p(Tt(h,(function(t){return r+"["+t+"]"})),");",Tt(h,(function(t){return a+"["+t+"]="+r+"["+t+"];"})).join("")),e("if(",Tt(h,(function(t){return r+"["+t+"]!=="+a+"["+t+"]"})).join("||"),"){",p,"}")}else r=o.def(c,".",n),a=o.def(l,".",n),p(r,");",l,".",n,"=",r,";"),e("if(",r,"!==",a,"){",p,"}");i(p)})),t.compile()}(),compile:ut}}function Ls(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Rs=34918,Ds=34919,zs=35007,js=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function r(){return n.pop()||e.ext_disjoint_timer_query.createQueryEXT()}function i(t){n.push(t)}var o=[];function a(t){var n=r();e.ext_disjoint_timer_query.beginQueryEXT(zs,n),o.push(n),h(o.length-1,o.length,t)}function s(){e.ext_disjoint_timer_query.endQueryEXT(zs)}function u(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var c=[];function l(){return c.pop()||new u}function f(t){c.push(t)}var p=[];function h(t,e,n){var r=l();r.startQueryIndex=t,r.endQueryIndex=e,r.sum=0,r.stats=n,p.push(r)}var d=[],m=[];function v(){var t,n,r=o.length;if(0!==r){m.length=Math.max(m.length,r+1),d.length=Math.max(d.length,r+1),d[0]=0,m[0]=0;var a=0;for(t=0,n=0;n<o.length;++n){var s=o[n];e.ext_disjoint_timer_query.getQueryObjectEXT(s,Ds)?(a+=e.ext_disjoint_timer_query.getQueryObjectEXT(s,Rs),i(s)):o[t++]=s,d[n+1]=a,m[n+1]=t}for(o.length=t,t=0,n=0;n<p.length;++n){var u=p[n],c=u.startQueryIndex,l=u.endQueryIndex;u.sum+=d[l]-d[c];var h=m[c],v=m[l];v===h?(u.stats.gpuTime+=u.sum/1e6,f(u)):(u.startQueryIndex=h,u.endQueryIndex=v,p[t++]=u)}p.length=t}}return{beginQuery:a,endQuery:s,pushScopeStats:h,update:v,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},Ns=16384,Fs=256,Bs=1024,Us=34962,Vs="webglcontextlost",Gs="webglcontextrestored",qs=1,Zs=2,Hs=3;function Ws(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function Xs(t){var n=St(t);if(!n)return null;var r=n.gl,i=r.getContextAttributes(),o=r.isContextLost(),a=Et(r,n);if(!a)return null;var s=vt(),u=Ls(),c=a.extensions,l=js(r,c),f=mt(),p=r.drawingBufferWidth,h=r.drawingBufferHeight,d={tick:0,time:0,viewportWidth:p,viewportHeight:h,framebufferWidth:p,framebufferHeight:h,drawingBufferWidth:p,drawingBufferHeight:h,pixelRatio:n.pixelRatio},m={},v={elements:null,primitive:4,count:-1,offset:0,instances:-1},g=xe(r,c),y=tn(r,u,n,b),_=co(r,c,g,u,y);function b(t){return _.destroyBuffer(t)}var x=xn(r,c,y,u),w=mo(r,s,u,n),S=li(r,c,g,(function(){A.procs.poll()}),d,u,n),E=Ei(r,c,g,u,n),T=oo(r,c,g,S,E,u),A=Os(r,s,c,g,y,x,S,T,m,_,w,v,d,l,n),C=bo(r,T,A.procs.poll,d,i,c,g),k=A.next,P=r.canvas,M=[],I=[],O=[],L=[n.onDestroy],R=null;function D(){if(0===M.length)return l&&l.update(),void(R=null);R=dt.next(D),W();for(var t=M.length-1;t>=0;--t){var e=M[t];e&&e(d,null,0)}r.flush(),l&&l.update()}function z(){!R&&M.length>0&&(R=dt.next(D))}function j(){R&&(dt.cancel(D),R=null)}function N(t){t.preventDefault(),o=!0,j(),I.forEach((function(t){t()}))}function F(t){r.getError(),o=!1,a.restore(),w.restore(),y.restore(),S.restore(),E.restore(),T.restore(),_.restore(),l&&l.restore(),A.procs.refresh(),z(),O.forEach((function(t){t()}))}function B(){M.length=0,j(),P&&(P.removeEventListener(Vs,N),P.removeEventListener(Gs,F)),w.clear(),T.clear(),E.clear(),S.clear(),x.clear(),y.clear(),_.clear(),l&&l.clear(),L.forEach((function(t){t()}))}function U(t){function n(t){var n=e({},t);function r(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(r){n[t+"."+r]=e[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in t&&(n.vao=t.vao),n}function r(t){var e={},n={};return Object.keys(t).forEach((function(r){var i=t[r];ht.isDynamic(i)?n[r]=ht.unbox(i,r):e[r]=i})),{dynamic:n,static:e}}rt(!!t,"invalid args to regl({...})"),rt.type(t,"object","invalid args to regl({...})");var i=r(t.context||{}),a=r(t.uniforms||{}),s=r(t.attributes||{}),u=r(n(t)),c={gpuTime:0,cpuTime:0,count:0},l=A.compile(u,s,a,i,c),f=l.draw,p=l.batch,h=l.scope,d=[];function m(t){while(d.length<t)d.push(null);return d}function v(t,e){var n;if(o&&rt.raise("context lost"),"function"===typeof t)return h.call(this,null,t,0);if("function"===typeof e)if("number"===typeof t)for(n=0;n<t;++n)h.call(this,null,e,n);else{if(!Array.isArray(t))return h.call(this,t,e,0);for(n=0;n<t.length;++n)h.call(this,t[n],e,n)}else if("number"===typeof t){if(t>0)return p.call(this,m(0|t),0|t)}else{if(!Array.isArray(t))return f.call(this,t);if(t.length)return p.call(this,t,t.length)}}return e(v,{stats:c})}P&&(P.addEventListener(Vs,N,!1),P.addEventListener(Gs,F,!1));var V=T.setFBO=U({framebuffer:ht.define.call(null,qs,"framebuffer")});function G(t,e){var n=0;A.procs.poll();var i=e.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=Ns),"depth"in e&&(r.clearDepth(+e.depth),n|=Fs),"stencil"in e&&(r.clearStencil(0|e.stencil),n|=Bs),rt(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function q(t){if(rt("object"===typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var n=0;n<6;++n)V(e({framebuffer:t.framebuffer.faces[n]},t),G);else V(t,G);else G(null,t)}function Z(t){function e(){var e=Ws(M,t);function n(){var t=Ws(M,n);M[t]=M[M.length-1],M.length-=1,M.length<=0&&j()}rt(e>=0,"cannot cancel a frame twice"),M[e]=n}return rt.type(t,"function","regl.frame() callback must be a function"),M.push(t),z(),{cancel:e}}function H(){var t=k.viewport,e=k.scissor_box;t[0]=t[1]=e[0]=e[1]=0,d.viewportWidth=d.framebufferWidth=d.drawingBufferWidth=t[2]=e[2]=r.drawingBufferWidth,d.viewportHeight=d.framebufferHeight=d.drawingBufferHeight=t[3]=e[3]=r.drawingBufferHeight}function W(){d.tick+=1,d.time=Y(),H(),A.procs.poll()}function X(){H(),A.procs.refresh(),l&&l.update()}function Y(){return(mt()-f)/1e3}function K(t,e){var n;switch(rt.type(e,"function","listener callback must be a function"),t){case"frame":return Z(e);case"lost":n=I;break;case"restore":n=O;break;case"destroy":n=L;break;default:rt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}X();var J=e(U,{clear:q,prop:ht.define.bind(null,qs),context:ht.define.bind(null,Zs),this:ht.define.bind(null,Hs),draw:U({}),buffer:function(t){return y.create(t,Us,!1,!1)},elements:function(t){return x.create(t,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:E.create,framebuffer:T.create,framebufferCube:T.createCube,vao:_.createVAO,attributes:i,frame:Z,on:K,limits:g,hasExtension:function(t){return g.extensions.indexOf(t.toLowerCase())>=0},read:C,destroy:B,_gl:r,_refresh:X,poll:function(){W(),l&&l.update()},now:Y,stats:u});return n.onDone(null,J),J}return Xs}))},fdMe:function(t,e,n){"use strict";function r(t,e){var n=e.callback;return n&&(t.dataArray=t.dataArray.map(n)),t}n.d(e,"a",(function(){return r}))},fo6e:function(t,e){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function r(t){return n.test(t)}t.exports=r},g4R6:function(t,e){function n(t,e,n){return t===t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}t.exports=n},gFfm:function(t,e){function n(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(!1===e(t[n],n,t))break;return t}t.exports=n},gMG2:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r={},i={},o=34,a=10,s=13;function u(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function c(t,e){var n=u(t);return function(r,i){return e(n(r),i,t)}}function l(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function f(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function p(t){return t<0?"-"+f(-t,6):t>9999?"+"+f(t,6):f(t,4)}function h(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":p(t.getUTCFullYear(),4)+"-"+f(t.getUTCMonth()+1,2)+"-"+f(t.getUTCDate(),2)+(i?"T"+f(e,2)+":"+f(n,2)+":"+f(r,2)+"."+f(i,3)+"Z":r?"T"+f(e,2)+":"+f(n,2)+":"+f(r,2)+"Z":n||e?"T"+f(e,2)+":"+f(n,2)+"Z":"")}var d=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function f(t,e){var n,r,i=p(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?c(t,e):u(t)}));return i.columns=r||[],i}function p(t,e){var u,c=[],l=t.length,f=0,p=0,h=l<=0,d=!1;function m(){if(h)return i;if(d)return d=!1,r;var e,u,c=f;if(t.charCodeAt(c)===o){while(f++<l&&t.charCodeAt(f)!==o||t.charCodeAt(++f)===o);return(e=f)>=l?h=!0:(u=t.charCodeAt(f++))===a?d=!0:u===s&&(d=!0,t.charCodeAt(f)===a&&++f),t.slice(c+1,e-1).replace(/""/g,'"')}while(f<l){if((u=t.charCodeAt(e=f++))===a)d=!0;else if(u===s)d=!0,t.charCodeAt(f)===a&&++f;else if(u!==n)continue;return t.slice(c,e)}return h=!0,t.slice(c,l)}t.charCodeAt(l-1)===a&&--l,t.charCodeAt(l-1)===s&&--l;while((u=m())!==i){var v=[];while(u!==r&&u!==i)v.push(u),u=m();e&&null==(v=e(v,p++))||c.push(v)}return c}function d(e,n){return e.map((function(e){return n.map((function(t){return _(e[t])})).join(t)}))}function m(e,n){return null==n&&(n=l(e)),[n.map(_).join(t)].concat(d(e,n)).join("\n")}function v(t,e){return null==e&&(e=l(t)),d(t,e).join("\n")}function g(t){return t.map(y).join("\n")}function y(e){return e.map(_).join(t)}function _(t){return null==t?"":t instanceof Date?h(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:f,parseRows:p,format:m,formatBody:v,formatRows:g,formatRow:y,formatValue:_}},m=d(","),v=m.parse,g=(m.parseRows,m.format,m.formatBody,m.formatRows,m.formatRow,m.formatValue,n("5zYK"));function y(t,e){var n=v(t);return Object(g["a"])(n,e)}},gzZq:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2"),i=n("FV85"),o=n("D9lx"),a=n("LKzl"),s=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!==typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!==typeof t)throw new Error(r.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=i.BindingTypeEnum.Function,e},t.prototype.toAutoFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(e){var n=function(){return e.container.get(t)};return n},new a.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=t,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}();e.BindingToSyntax=s},h1nZ:function(t,e,n){"use strict";var r=n("fX6N");n.d(e,"container",(function(){return r["c"]})),n.d(e,"createSceneContainer",(function(){return r["b"]})),n.d(e,"createLayerContainer",(function(){return r["a"]})),n.d(e,"lazyInject",(function(){return r["d"]}));n("+em5");var i=n("bB6j");n.d(e,"TYPES",(function(){return i["a"]}));n("8/Fi");var o=n("PUg6");n.d(e,"BlendType",(function(){return o["a"]}));var a=n("cZlC");n.d(e,"AttributeType",(function(){return a["a"]})),n.d(e,"ScaleTypes",(function(){return a["b"]})),n.d(e,"StyleScaleType",(function(){return a["c"]}));var s=n("O1je");n.o(s,"CameraUniform")&&n.d(e,"CameraUniform",(function(){return s["CameraUniform"]})),n.o(s,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return s["CityBuildingLayer"]})),n.o(s,"Control")&&n.d(e,"Control",(function(){return s["Control"]})),n.o(s,"CoordinateSystem")&&n.d(e,"CoordinateSystem",(function(){return s["CoordinateSystem"]})),n.o(s,"CoordinateUniform")&&n.d(e,"CoordinateUniform",(function(){return s["CoordinateUniform"]})),n.o(s,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return s["HeatmapLayer"]})),n.o(s,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return s["ImageLayer"]})),n.o(s,"LineLayer")&&n.d(e,"LineLayer",(function(){return s["LineLayer"]})),n.o(s,"Logo")&&n.d(e,"Logo",(function(){return s["Logo"]})),n.o(s,"MapServiceEvent")&&n.d(e,"MapServiceEvent",(function(){return s["MapServiceEvent"]})),n.o(s,"Marker")&&n.d(e,"Marker",(function(){return s["Marker"]})),n.o(s,"PointLayer")&&n.d(e,"PointLayer",(function(){return s["PointLayer"]})),n.o(s,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return s["PolygonLayer"]})),n.o(s,"Popup")&&n.d(e,"Popup",(function(){return s["Popup"]})),n.o(s,"PositionType")&&n.d(e,"PositionType",(function(){return s["PositionType"]})),n.o(s,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return s["RasterLayer"]})),n.o(s,"Scale")&&n.d(e,"Scale",(function(){return s["Scale"]})),n.o(s,"Scene")&&n.d(e,"Scene",(function(){return s["Scene"]})),n.o(s,"SceneEventList")&&n.d(e,"SceneEventList",(function(){return s["SceneEventList"]})),n.o(s,"Zoom")&&n.d(e,"Zoom",(function(){return s["Zoom"]})),n.o(s,"gl")&&n.d(e,"gl",(function(){return s["gl"]}));var u=n("L56e");n.d(e,"MapServiceEvent",(function(){return u["a"]}));var c=n("HthE");n.d(e,"CoordinateSystem",(function(){return c["a"]})),n.d(e,"CoordinateUniform",(function(){return c["b"]}));var l=n("/33/");n.o(l,"CameraUniform")&&n.d(e,"CameraUniform",(function(){return l["CameraUniform"]})),n.o(l,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return l["CityBuildingLayer"]})),n.o(l,"Control")&&n.d(e,"Control",(function(){return l["Control"]})),n.o(l,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return l["HeatmapLayer"]})),n.o(l,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return l["ImageLayer"]})),n.o(l,"LineLayer")&&n.d(e,"LineLayer",(function(){return l["LineLayer"]})),n.o(l,"Logo")&&n.d(e,"Logo",(function(){return l["Logo"]})),n.o(l,"Marker")&&n.d(e,"Marker",(function(){return l["Marker"]})),n.o(l,"PointLayer")&&n.d(e,"PointLayer",(function(){return l["PointLayer"]})),n.o(l,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return l["PolygonLayer"]})),n.o(l,"Popup")&&n.d(e,"Popup",(function(){return l["Popup"]})),n.o(l,"PositionType")&&n.d(e,"PositionType",(function(){return l["PositionType"]})),n.o(l,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return l["RasterLayer"]})),n.o(l,"Scale")&&n.d(e,"Scale",(function(){return l["Scale"]})),n.o(l,"Scene")&&n.d(e,"Scene",(function(){return l["Scene"]})),n.o(l,"SceneEventList")&&n.d(e,"SceneEventList",(function(){return l["SceneEventList"]})),n.o(l,"Zoom")&&n.d(e,"Zoom",(function(){return l["Zoom"]})),n.o(l,"gl")&&n.d(e,"gl",(function(){return l["gl"]}));var f=n("EfZ0");n.d(e,"CameraUniform",(function(){return f["a"]}));var p=n("riiI");n.o(p,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return p["CityBuildingLayer"]})),n.o(p,"Control")&&n.d(e,"Control",(function(){return p["Control"]})),n.o(p,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return p["HeatmapLayer"]})),n.o(p,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return p["ImageLayer"]})),n.o(p,"LineLayer")&&n.d(e,"LineLayer",(function(){return p["LineLayer"]})),n.o(p,"Logo")&&n.d(e,"Logo",(function(){return p["Logo"]})),n.o(p,"Marker")&&n.d(e,"Marker",(function(){return p["Marker"]})),n.o(p,"PointLayer")&&n.d(e,"PointLayer",(function(){return p["PointLayer"]})),n.o(p,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return p["PolygonLayer"]})),n.o(p,"Popup")&&n.d(e,"Popup",(function(){return p["Popup"]})),n.o(p,"PositionType")&&n.d(e,"PositionType",(function(){return p["PositionType"]})),n.o(p,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return p["RasterLayer"]})),n.o(p,"Scale")&&n.d(e,"Scale",(function(){return p["Scale"]})),n.o(p,"Scene")&&n.d(e,"Scene",(function(){return p["Scene"]})),n.o(p,"SceneEventList")&&n.d(e,"SceneEventList",(function(){return p["SceneEventList"]})),n.o(p,"Zoom")&&n.d(e,"Zoom",(function(){return p["Zoom"]})),n.o(p,"gl")&&n.d(e,"gl",(function(){return p["gl"]}));var h=n("eg+a");n.d(e,"SceneEventList",(function(){return h["a"]}));var d=n("bYl4");n.o(d,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return d["CityBuildingLayer"]})),n.o(d,"Control")&&n.d(e,"Control",(function(){return d["Control"]})),n.o(d,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return d["HeatmapLayer"]})),n.o(d,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return d["ImageLayer"]})),n.o(d,"LineLayer")&&n.d(e,"LineLayer",(function(){return d["LineLayer"]})),n.o(d,"Logo")&&n.d(e,"Logo",(function(){return d["Logo"]})),n.o(d,"Marker")&&n.d(e,"Marker",(function(){return d["Marker"]})),n.o(d,"PointLayer")&&n.d(e,"PointLayer",(function(){return d["PointLayer"]})),n.o(d,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return d["PolygonLayer"]})),n.o(d,"Popup")&&n.d(e,"Popup",(function(){return d["Popup"]})),n.o(d,"PositionType")&&n.d(e,"PositionType",(function(){return d["PositionType"]})),n.o(d,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return d["RasterLayer"]})),n.o(d,"Scale")&&n.d(e,"Scale",(function(){return d["Scale"]})),n.o(d,"Scene")&&n.d(e,"Scene",(function(){return d["Scene"]})),n.o(d,"Zoom")&&n.d(e,"Zoom",(function(){return d["Zoom"]})),n.o(d,"gl")&&n.d(e,"gl",(function(){return d["gl"]}));var m=n("FI6e");n.o(m,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return m["CityBuildingLayer"]})),n.o(m,"Control")&&n.d(e,"Control",(function(){return m["Control"]})),n.o(m,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return m["HeatmapLayer"]})),n.o(m,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return m["ImageLayer"]})),n.o(m,"LineLayer")&&n.d(e,"LineLayer",(function(){return m["LineLayer"]})),n.o(m,"Logo")&&n.d(e,"Logo",(function(){return m["Logo"]})),n.o(m,"Marker")&&n.d(e,"Marker",(function(){return m["Marker"]})),n.o(m,"PointLayer")&&n.d(e,"PointLayer",(function(){return m["PointLayer"]})),n.o(m,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return m["PolygonLayer"]})),n.o(m,"Popup")&&n.d(e,"Popup",(function(){return m["Popup"]})),n.o(m,"PositionType")&&n.d(e,"PositionType",(function(){return m["PositionType"]})),n.o(m,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return m["RasterLayer"]})),n.o(m,"Scale")&&n.d(e,"Scale",(function(){return m["Scale"]})),n.o(m,"Scene")&&n.d(e,"Scene",(function(){return m["Scene"]})),n.o(m,"Zoom")&&n.d(e,"Zoom",(function(){return m["Zoom"]})),n.o(m,"gl")&&n.d(e,"gl",(function(){return m["gl"]}));var v=n("D+ow");n.o(v,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return v["CityBuildingLayer"]})),n.o(v,"Control")&&n.d(e,"Control",(function(){return v["Control"]})),n.o(v,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return v["HeatmapLayer"]})),n.o(v,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return v["ImageLayer"]})),n.o(v,"LineLayer")&&n.d(e,"LineLayer",(function(){return v["LineLayer"]})),n.o(v,"Logo")&&n.d(e,"Logo",(function(){return v["Logo"]})),n.o(v,"Marker")&&n.d(e,"Marker",(function(){return v["Marker"]})),n.o(v,"PointLayer")&&n.d(e,"PointLayer",(function(){return v["PointLayer"]})),n.o(v,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return v["PolygonLayer"]})),n.o(v,"Popup")&&n.d(e,"Popup",(function(){return v["Popup"]})),n.o(v,"PositionType")&&n.d(e,"PositionType",(function(){return v["PositionType"]})),n.o(v,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return v["RasterLayer"]})),n.o(v,"Scale")&&n.d(e,"Scale",(function(){return v["Scale"]})),n.o(v,"Scene")&&n.d(e,"Scene",(function(){return v["Scene"]})),n.o(v,"Zoom")&&n.d(e,"Zoom",(function(){return v["Zoom"]})),n.o(v,"gl")&&n.d(e,"gl",(function(){return v["gl"]}));var g=n("AFH1");n.d(e,"PositionType",(function(){return g["a"]}));var y=n("8uyu");n.o(y,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return y["CityBuildingLayer"]})),n.o(y,"Control")&&n.d(e,"Control",(function(){return y["Control"]})),n.o(y,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return y["HeatmapLayer"]})),n.o(y,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return y["ImageLayer"]})),n.o(y,"LineLayer")&&n.d(e,"LineLayer",(function(){return y["LineLayer"]})),n.o(y,"Logo")&&n.d(e,"Logo",(function(){return y["Logo"]})),n.o(y,"Marker")&&n.d(e,"Marker",(function(){return y["Marker"]})),n.o(y,"PointLayer")&&n.d(e,"PointLayer",(function(){return y["PointLayer"]})),n.o(y,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return y["PolygonLayer"]})),n.o(y,"Popup")&&n.d(e,"Popup",(function(){return y["Popup"]})),n.o(y,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return y["RasterLayer"]})),n.o(y,"Scale")&&n.d(e,"Scale",(function(){return y["Scale"]})),n.o(y,"Scene")&&n.d(e,"Scene",(function(){return y["Scene"]})),n.o(y,"Zoom")&&n.d(e,"Zoom",(function(){return y["Zoom"]})),n.o(y,"gl")&&n.d(e,"gl",(function(){return y["gl"]}));var _=n("J7lC");n.o(_,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return _["CityBuildingLayer"]})),n.o(_,"Control")&&n.d(e,"Control",(function(){return _["Control"]})),n.o(_,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return _["HeatmapLayer"]})),n.o(_,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return _["ImageLayer"]})),n.o(_,"LineLayer")&&n.d(e,"LineLayer",(function(){return _["LineLayer"]})),n.o(_,"Logo")&&n.d(e,"Logo",(function(){return _["Logo"]})),n.o(_,"Marker")&&n.d(e,"Marker",(function(){return _["Marker"]})),n.o(_,"PointLayer")&&n.d(e,"PointLayer",(function(){return _["PointLayer"]})),n.o(_,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return _["PolygonLayer"]})),n.o(_,"Popup")&&n.d(e,"Popup",(function(){return _["Popup"]})),n.o(_,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return _["RasterLayer"]})),n.o(_,"Scale")&&n.d(e,"Scale",(function(){return _["Scale"]})),n.o(_,"Scene")&&n.d(e,"Scene",(function(){return _["Scene"]})),n.o(_,"Zoom")&&n.d(e,"Zoom",(function(){return _["Zoom"]})),n.o(_,"gl")&&n.d(e,"gl",(function(){return _["gl"]}));var b=n("QGbF");n.o(b,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return b["CityBuildingLayer"]})),n.o(b,"Control")&&n.d(e,"Control",(function(){return b["Control"]})),n.o(b,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return b["HeatmapLayer"]})),n.o(b,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return b["ImageLayer"]})),n.o(b,"LineLayer")&&n.d(e,"LineLayer",(function(){return b["LineLayer"]})),n.o(b,"Logo")&&n.d(e,"Logo",(function(){return b["Logo"]})),n.o(b,"Marker")&&n.d(e,"Marker",(function(){return b["Marker"]})),n.o(b,"PointLayer")&&n.d(e,"PointLayer",(function(){return b["PointLayer"]})),n.o(b,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return b["PolygonLayer"]})),n.o(b,"Popup")&&n.d(e,"Popup",(function(){return b["Popup"]})),n.o(b,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return b["RasterLayer"]})),n.o(b,"Scale")&&n.d(e,"Scale",(function(){return b["Scale"]})),n.o(b,"Scene")&&n.d(e,"Scene",(function(){return b["Scene"]})),n.o(b,"Zoom")&&n.d(e,"Zoom",(function(){return b["Zoom"]})),n.o(b,"gl")&&n.d(e,"gl",(function(){return b["gl"]}));n("V1cb");var x=n("bzyH");n.o(x,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return x["CityBuildingLayer"]})),n.o(x,"Control")&&n.d(e,"Control",(function(){return x["Control"]})),n.o(x,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return x["HeatmapLayer"]})),n.o(x,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return x["ImageLayer"]})),n.o(x,"LineLayer")&&n.d(e,"LineLayer",(function(){return x["LineLayer"]})),n.o(x,"Logo")&&n.d(e,"Logo",(function(){return x["Logo"]})),n.o(x,"Marker")&&n.d(e,"Marker",(function(){return x["Marker"]})),n.o(x,"PointLayer")&&n.d(e,"PointLayer",(function(){return x["PointLayer"]})),n.o(x,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return x["PolygonLayer"]})),n.o(x,"Popup")&&n.d(e,"Popup",(function(){return x["Popup"]})),n.o(x,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return x["RasterLayer"]})),n.o(x,"Scale")&&n.d(e,"Scale",(function(){return x["Scale"]})),n.o(x,"Scene")&&n.d(e,"Scene",(function(){return x["Scene"]})),n.o(x,"Zoom")&&n.d(e,"Zoom",(function(){return x["Zoom"]})),n.o(x,"gl")&&n.d(e,"gl",(function(){return x["gl"]}));var w=n("0eqD");n.o(w,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return w["CityBuildingLayer"]})),n.o(w,"Control")&&n.d(e,"Control",(function(){return w["Control"]})),n.o(w,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return w["HeatmapLayer"]})),n.o(w,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return w["ImageLayer"]})),n.o(w,"LineLayer")&&n.d(e,"LineLayer",(function(){return w["LineLayer"]})),n.o(w,"Logo")&&n.d(e,"Logo",(function(){return w["Logo"]})),n.o(w,"Marker")&&n.d(e,"Marker",(function(){return w["Marker"]})),n.o(w,"PointLayer")&&n.d(e,"PointLayer",(function(){return w["PointLayer"]})),n.o(w,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return w["PolygonLayer"]})),n.o(w,"Popup")&&n.d(e,"Popup",(function(){return w["Popup"]})),n.o(w,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return w["RasterLayer"]})),n.o(w,"Scale")&&n.d(e,"Scale",(function(){return w["Scale"]})),n.o(w,"Scene")&&n.d(e,"Scene",(function(){return w["Scene"]})),n.o(w,"Zoom")&&n.d(e,"Zoom",(function(){return w["Zoom"]})),n.o(w,"gl")&&n.d(e,"gl",(function(){return w["gl"]}));var S=n("/Uc5");n.o(S,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return S["CityBuildingLayer"]})),n.o(S,"Control")&&n.d(e,"Control",(function(){return S["Control"]})),n.o(S,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return S["HeatmapLayer"]})),n.o(S,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return S["ImageLayer"]})),n.o(S,"LineLayer")&&n.d(e,"LineLayer",(function(){return S["LineLayer"]})),n.o(S,"Logo")&&n.d(e,"Logo",(function(){return S["Logo"]})),n.o(S,"Marker")&&n.d(e,"Marker",(function(){return S["Marker"]})),n.o(S,"PointLayer")&&n.d(e,"PointLayer",(function(){return S["PointLayer"]})),n.o(S,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return S["PolygonLayer"]})),n.o(S,"Popup")&&n.d(e,"Popup",(function(){return S["Popup"]})),n.o(S,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return S["RasterLayer"]})),n.o(S,"Scale")&&n.d(e,"Scale",(function(){return S["Scale"]})),n.o(S,"Scene")&&n.d(e,"Scene",(function(){return S["Scene"]})),n.o(S,"Zoom")&&n.d(e,"Zoom",(function(){return S["Zoom"]})),n.o(S,"gl")&&n.d(e,"gl",(function(){return S["gl"]}));var E=n("RMtq");n.o(E,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return E["CityBuildingLayer"]})),n.o(E,"Control")&&n.d(e,"Control",(function(){return E["Control"]})),n.o(E,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return E["HeatmapLayer"]})),n.o(E,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return E["ImageLayer"]})),n.o(E,"LineLayer")&&n.d(e,"LineLayer",(function(){return E["LineLayer"]})),n.o(E,"Logo")&&n.d(e,"Logo",(function(){return E["Logo"]})),n.o(E,"Marker")&&n.d(e,"Marker",(function(){return E["Marker"]})),n.o(E,"PointLayer")&&n.d(e,"PointLayer",(function(){return E["PointLayer"]})),n.o(E,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return E["PolygonLayer"]})),n.o(E,"Popup")&&n.d(e,"Popup",(function(){return E["Popup"]})),n.o(E,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return E["RasterLayer"]})),n.o(E,"Scale")&&n.d(e,"Scale",(function(){return E["Scale"]})),n.o(E,"Scene")&&n.d(e,"Scene",(function(){return E["Scene"]})),n.o(E,"Zoom")&&n.d(e,"Zoom",(function(){return E["Zoom"]})),n.o(E,"gl")&&n.d(e,"gl",(function(){return E["gl"]}));var T=n("1jvM");n.o(T,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return T["CityBuildingLayer"]})),n.o(T,"Control")&&n.d(e,"Control",(function(){return T["Control"]})),n.o(T,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return T["HeatmapLayer"]})),n.o(T,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return T["ImageLayer"]})),n.o(T,"LineLayer")&&n.d(e,"LineLayer",(function(){return T["LineLayer"]})),n.o(T,"Logo")&&n.d(e,"Logo",(function(){return T["Logo"]})),n.o(T,"Marker")&&n.d(e,"Marker",(function(){return T["Marker"]})),n.o(T,"PointLayer")&&n.d(e,"PointLayer",(function(){return T["PointLayer"]})),n.o(T,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return T["PolygonLayer"]})),n.o(T,"Popup")&&n.d(e,"Popup",(function(){return T["Popup"]})),n.o(T,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return T["RasterLayer"]})),n.o(T,"Scale")&&n.d(e,"Scale",(function(){return T["Scale"]})),n.o(T,"Scene")&&n.d(e,"Scene",(function(){return T["Scene"]})),n.o(T,"Zoom")&&n.d(e,"Zoom",(function(){return T["Zoom"]})),n.o(T,"gl")&&n.d(e,"gl",(function(){return T["gl"]}));n("bPkA");var A=n("PSsN");n.o(A,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return A["CityBuildingLayer"]})),n.o(A,"Control")&&n.d(e,"Control",(function(){return A["Control"]})),n.o(A,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return A["HeatmapLayer"]})),n.o(A,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return A["ImageLayer"]})),n.o(A,"LineLayer")&&n.d(e,"LineLayer",(function(){return A["LineLayer"]})),n.o(A,"Logo")&&n.d(e,"Logo",(function(){return A["Logo"]})),n.o(A,"Marker")&&n.d(e,"Marker",(function(){return A["Marker"]})),n.o(A,"PointLayer")&&n.d(e,"PointLayer",(function(){return A["PointLayer"]})),n.o(A,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return A["PolygonLayer"]})),n.o(A,"Popup")&&n.d(e,"Popup",(function(){return A["Popup"]})),n.o(A,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return A["RasterLayer"]})),n.o(A,"Scale")&&n.d(e,"Scale",(function(){return A["Scale"]})),n.o(A,"Scene")&&n.d(e,"Scene",(function(){return A["Scene"]})),n.o(A,"Zoom")&&n.d(e,"Zoom",(function(){return A["Zoom"]})),n.o(A,"gl")&&n.d(e,"gl",(function(){return A["gl"]}));var C=n("6NqC");n.o(C,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return C["CityBuildingLayer"]})),n.o(C,"Control")&&n.d(e,"Control",(function(){return C["Control"]})),n.o(C,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return C["HeatmapLayer"]})),n.o(C,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return C["ImageLayer"]})),n.o(C,"LineLayer")&&n.d(e,"LineLayer",(function(){return C["LineLayer"]})),n.o(C,"Logo")&&n.d(e,"Logo",(function(){return C["Logo"]})),n.o(C,"Marker")&&n.d(e,"Marker",(function(){return C["Marker"]})),n.o(C,"PointLayer")&&n.d(e,"PointLayer",(function(){return C["PointLayer"]})),n.o(C,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return C["PolygonLayer"]})),n.o(C,"Popup")&&n.d(e,"Popup",(function(){return C["Popup"]})),n.o(C,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return C["RasterLayer"]})),n.o(C,"Scale")&&n.d(e,"Scale",(function(){return C["Scale"]})),n.o(C,"Scene")&&n.d(e,"Scene",(function(){return C["Scene"]})),n.o(C,"Zoom")&&n.d(e,"Zoom",(function(){return C["Zoom"]})),n.o(C,"gl")&&n.d(e,"gl",(function(){return C["gl"]}));var k=n("bTtR");n.o(k,"CityBuildingLayer")&&n.d(e,"CityBuildingLayer",(function(){return k["CityBuildingLayer"]})),n.o(k,"Control")&&n.d(e,"Control",(function(){return k["Control"]})),n.o(k,"HeatmapLayer")&&n.d(e,"HeatmapLayer",(function(){return k["HeatmapLayer"]})),n.o(k,"ImageLayer")&&n.d(e,"ImageLayer",(function(){return k["ImageLayer"]})),n.o(k,"LineLayer")&&n.d(e,"LineLayer",(function(){return k["LineLayer"]})),n.o(k,"Logo")&&n.d(e,"Logo",(function(){return k["Logo"]})),n.o(k,"Marker")&&n.d(e,"Marker",(function(){return k["Marker"]})),n.o(k,"PointLayer")&&n.d(e,"PointLayer",(function(){return k["PointLayer"]})),n.o(k,"PolygonLayer")&&n.d(e,"PolygonLayer",(function(){return k["PolygonLayer"]})),n.o(k,"Popup")&&n.d(e,"Popup",(function(){return k["Popup"]})),n.o(k,"RasterLayer")&&n.d(e,"RasterLayer",(function(){return k["RasterLayer"]})),n.o(k,"Scale")&&n.d(e,"Scale",(function(){return k["Scale"]})),n.o(k,"Scene")&&n.d(e,"Scene",(function(){return k["Scene"]})),n.o(k,"Zoom")&&n.d(e,"Zoom",(function(){return k["Zoom"]})),n.o(k,"gl")&&n.d(e,"gl",(function(){return k["gl"]}));var P=n("o+pz");n.d(e,"gl",(function(){return P["a"]}))},h7MG:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("doU7"),i=n("MON2"),o=n("FV85"),a=n("xfSm"),s=n("qK8v"),u=n("ujMp"),c=n("oy+k"),l=n("GXnB"),f=n("yMAV"),p=n("fbrv"),h=n("xiII"),d=n("dX1H");function m(t){return t._bindingDictionary}function v(t,e,n,r,i,o){var s=t?a.MULTI_INJECT_TAG:a.INJECT_TAG,u=new l.Metadata(s,n),c=new d.Target(e,r,n,u);if(void 0!==i){var f=new l.Metadata(i,o);c.metadata.push(f)}return c}function g(t,e,n,i,o){var a=b(n.container,o.serviceIdentifier),s=[];return a.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"===typeof o.serviceIdentifier&&t.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(o.serviceIdentifier).toSelf(),a=b(n.container,o.serviceIdentifier)),s=e?a:a.filter((function(t){var e=new h.Request(t.serviceIdentifier,n,i,t,o);return t.constraint(e)})),y(o.serviceIdentifier,s,o,n.container),s}function y(t,e,n,o){switch(e.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return e;var a=u.getServiceIdentifierAsString(t),s=i.NOT_REGISTERED;throw s+=u.listMetadataForTarget(a,n),s+=u.listRegisteredBindingsForServiceIdentifier(o,a,b),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return e;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return e;a=u.getServiceIdentifierAsString(t),s=i.AMBIGUOUS_MATCH+" "+a;throw s+=u.listRegisteredBindingsForServiceIdentifier(o,a,b),new Error(s)}}function _(t,e,n,r,a,s){var u,c;if(null===a){u=g(t,e,r,null,s),c=new h.Request(n,r,null,u,s);var l=new f.Plan(r,c);r.addPlan(l)}else u=g(t,e,r,a,s),c=a.addChildRequest(s.serviceIdentifier,u,s);u.forEach((function(e){var n=null;if(s.isArray())n=c.addChildRequest(e.serviceIdentifier,e,s);else{if(e.cache)return;n=c}if(e.type===o.BindingTypeEnum.Instance&&null!==e.implementationType){var a=p.getDependencies(t,e.implementationType);if(!r.container.options.skipBaseClassChecks){var u=p.getBaseClassDependencyCount(t,e.implementationType);if(a.length<u){var l=i.ARGUMENTS_LENGTH_MISMATCH(p.getFunctionName(e.implementationType));throw new Error(l)}}a.forEach((function(e){_(t,!1,e.serviceIdentifier,r,n,e)}))}}))}function b(t,e){var n=[],r=m(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=b(t.parent,e)),n}function x(t,e,n,r,i,o,a,l){void 0===l&&(l=!1);var f=new c.Context(e),p=v(n,r,i,"",o,a);try{return _(t,l,i,f,null,p),f}catch(h){throw s.isStackOverflowExeption(h)&&f.plan&&u.circularDependencyToException(f.plan.rootRequest),h}}function w(t,e,n,r){var i=new d.Target(o.TargetTypeEnum.Variable,"",e,new l.Metadata(n,r)),a=new c.Context(t),s=new h.Request(e,a,null,[],i);return s}e.getBindingDictionary=m,e.plan=x,e.createMockRequest=w},iegG:function(t,e){function n(t){var e=t.target||t.srcElement;e.__resizeRAF__&&cancelAnimationFrame(e.__resizeRAF__),e.__resizeRAF__=requestAnimationFrame((function(){var n=e.__resizeTrigger__,r=n&&n.__resizeListeners__;r&&r.forEach((function(e){e.call(n,t)}))}))}e=function(t,e){var r,i=this,o=i.document,a=o.attachEvent;function s(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",n)}if("undefined"!==typeof navigator&&(r=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!t.__resizeListeners__)if(t.__resizeListeners__=[],a)t.__resizeTrigger__=t,t.attachEvent("onresize",n);else{"static"===getComputedStyle(t).position&&(t.style.position="relative");var u=t.__resizeTrigger__=o.createElement("object");u.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),u.setAttribute("class","resize-sensor"),u.setAttribute("tabindex","-1"),u.__resizeElement__=t,u.onload=s,u.type="text/html",r&&t.appendChild(u),u.data="about:blank",r||t.appendChild(u)}t.__resizeListeners__.push(e)};t.exports="undefined"===typeof window?e:e.bind(window),t.exports.unbind=function(t,e){var r=document.attachEvent,i=t.__resizeListeners__||[];if(e){var o=i.indexOf(e);-1!==o&&i.splice(o,1)}else i=t.__resizeListeners__=[];if(!i.length){if(r)t.detachEvent("onresize",n);else if(t.__resizeTrigger__){var a=t.__resizeTrigger__.contentDocument,s=a&&a.defaultView;s&&(s.removeEventListener("resize",n),delete s.__resizeTrigger__),t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)}delete t.__resizeListeners__}}},"iz+Y":function(t,e,n){t.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},"jIg/":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(t){return function(e,n,a){var s=new i.Metadata(r.MULTI_INJECT_TAG,t);"number"===typeof a?o.tagParameter(e,n,a,s):o.tagProperty(e,n,s)}}e.multiInject=a},jYx5:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(){return function(t,e,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"===typeof n?o.tagParameter(t,e,n,a):o.tagProperty(t,e,a)}}e.optional=a},"jbM+":function(t,e,n){var r=n("R/W3");function i(t,e){var n=null==t?0:t.length;return!!n&&r(t,e,0)>-1}t.exports=i},"k5/I":function(t,e,n){"use strict";n.d(e,"a",(function(){return E})),n.d(e,"b",(function(){return I})),n.d(e,"e",(function(){return R})),n.d(e,"f",(function(){return j})),n.d(e,"c",(function(){return V})),n.d(e,"d",(function(){return et}));var r,i=n("lSNA"),o=n.n(i),a=n("lwsE"),s=n.n(a),u=n("W8MJ"),c=n.n(u),l=n("7W2i"),f=n.n(l),p=n("a1gu"),h=n.n(p),d=n("Nsbk"),m=n.n(d),v=n("h1nZ"),g=n("Hel2"),y=n("uhBA");function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t){var e=w();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function w(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(function(t){t["TOPRIGHT"]="topright",t["TOPLEFT"]="topleft",t["BOTTOMRIGHT"]="bottomright",t["BOTTOMLEFT"]="bottomleft"})(r||(r={}));var S=0,E=function(t){f()(n,t);var e=x(n);function n(t){var r;return s()(this,n),r=e.call(this),r.controlOption=void 0,r.container=void 0,r.sceneContainer=void 0,r.mapsService=void 0,r.renderService=void 0,r.layerService=void 0,r.controlService=void 0,r.isShow=void 0,r.controlOption=b(b({},r.getDefault()),t||{}),r}return c()(n,[{key:"getDefault",value:function(){return{position:r.TOPRIGHT,name:"".concat(S++)}}},{key:"setPosition",value:function(t){var e=this.controlService;return e&&e.removeControl(this),this.controlOption.position=t,e&&e.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(t){this.mapsService=t.get(v["TYPES"].IMapService),this.renderService=t.get(v["TYPES"].IRendererService),this.layerService=t.get(v["TYPES"].ILayerService),this.controlService=t.get(v["TYPES"].IControlService),this.sceneContainer=t,this.isShow=!0,this.container=this.onAdd();var e=this.container,n=this.controlOption.position,r=this.controlService.controlCorners[n];return g["a"].addClass(e,"l7-control"),-1!==n.indexOf("bottom")?r.insertBefore(e,r.firstChild):r.appendChild(e),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var t=this.container;g["a"].addClass(t,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var t=this.container;g["a"].removeClass(t,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;g["a"].remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(t){if(this.mapsService&&t&&t.screenX>0&&t.screenY>0){var e=this.mapsService.getContainer();null!==e&&e.focus()}}}]),n}(y["EventEmitter"]),T=n("PJYZ"),A=n.n(T);function C(t){var e=k();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function k(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(function(t){f()(n,t);var e=C(n);function n(t){var r;return s()(this,n),r=e.call(this,t),r.layerControlInputs=void 0,r.layers=void 0,r.lastZIndex=void 0,r.handlingClick=void 0,r.layersLink=void 0,r.baseLayersList=void 0,r.separator=void 0,r.overlaysList=void 0,r.form=void 0,r.layerControlInputs=[],r.layers=[],r.lastZIndex=0,r.handlingClick=!1,r.initLayers(),Object(g["h"])(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],A()(r)),r}c()(n,[{key:"getDefault",value:function(){return{collapsed:!0,position:v["PositionType"].TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var t=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach((function(e){e.layer.on("remove",t.onLayerChange),e.layer.on("add",t.onLayerChange)})),this.container}},{key:"addVisualLayer",value:function(t,e){return this.addLayer(t,e,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var t=this.renderService.getViewportSize(),e=t.height;g["a"].addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var n=e-(this.container.offsetTop+50);return n<this.form.clientHeight?(g["a"].addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=n+"px"):g["a"].removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return g["a"].removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var t=this;this.mapsService&&(this.mapsService.off("click",this.collapse),this.layers.forEach((function(e){e.layer.off("remove",t.onLayerChange),e.layer.off("add",t.onLayerChange)})))}},{key:"initLayout",value:function(){var t="l7-control-layers",e=this.container=g["a"].create("div",t),n=this.controlOption.collapsed;e.setAttribute("aria-haspopup","true");var r=this.form=g["a"].create("form",t+"-list");n&&(this.mapsService.on("click",this.collapse),e.addEventListener("mouseenter",this.expand),e.addEventListener("mouseleave",this.collapse)),this.layersLink=g["a"].create("a",t+"-toggle",e);var i=this.layersLink;i.title="Layers",n||this.expand(),this.baseLayersList=g["a"].create("div",t+"-base",r),this.separator=g["a"].create("div",t+"-separator",r),this.overlaysList=g["a"].create("div",t+"-overlays",r),e.appendChild(r)}},{key:"initLayers",value:function(){var t=this,e=this.controlOption,n=e.baseLayers,r=void 0===n?{}:n,i=e.overlayers,o=void 0===i?{}:i;Object.keys(r).forEach((function(e,n){t.addLayer(r[e],e,!1)})),Object.keys(o).forEach((function(e,n){t.addLayer(o[e],e,!0)}))}},{key:"update",value:function(){if(!this.container)return this;var t,e,n,r;g["a"].empty(this.baseLayersList),g["a"].empty(this.overlaysList),this.layerControlInputs=[];var i=0;for(n=0;n<this.layers.length;n++)r=this.layers[n],this.addItem(r),e=e||r.overlay,t=t||!r.overlay,i+=r.overlay?0:1;return this.controlOption.hideSingleBase&&(t=t&&i>1,this.baseLayersList.style.display=t?"":"none"),this.separator.style.display=e&&t?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var t,e,n=this.layerControlInputs,r=this.mapsService.getZoom(),i=n.length-1;i>=0;i--)if(t=n[i],e=this.layerService.getLayer(t.layerId),e&&e.inited){var o=e.getMinZoom(),a=e.getMaxZoom();t.disabled=r<o||r>a}}},{key:"addLayer",value:function(t,e,n){this.mapsService&&(t.on("add",this.onLayerChange),t.on("remove",this.onLayerChange)),this.layers.push({layer:t,name:e,overlay:n});var r=this.controlOption,i=r.sortLayers,o=r.sortFunction,a=r.autoZIndex;i&&this.layers.sort((function(t,e){return o(t.layer,e.layer,t.name,e.name)})),a&&t.setZIndex&&(this.lastZIndex++,t.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(t){this.handlingClick||this.update();var e=this.layerService.getLayer(t.target.layerId),n=(null===e||void 0===e?void 0:e.overlay)?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this.emit(n,e)}},{key:"createRadioElement",value:function(t,e){var n='<input type="radio" class="l7-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild}},{key:"addItem",value:function(t){var e,n=document.createElement("label"),r=this.layerService.getLayer(t.layer.id),i=r&&r.inited&&t.layer.isVisible();t.overlay?(e=document.createElement("input"),e.type="checkbox",e.className="l7-control-layers-selector",e.defaultChecked=i):e=this.createRadioElement("l7-base-layers",i),this.layerControlInputs.push(e),e.layerId=t.layer.id,e.addEventListener("click",this.onInputClick);var o=document.createElement("span");o.innerHTML=" "+t.name;var a=document.createElement("div");n.appendChild(a),a.appendChild(e),a.appendChild(o);var s=t.overlay?this.overlaysList:this.baseLayersList;return s.appendChild(n),this.checkDisabledLayers(),n}},{key:"onInputClick",value:function(){var t,e,n=this.layerControlInputs,r=[],i=[];this.handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this.layerService.getLayer(t.layerId),t.checked?r.push(e):t.checked||i.push(e);i.forEach((function(t){t.hide()})),r.forEach((function(t){t.show()})),this.handlingClick=!1}}])})(E);function P(t){var e=M();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var I=function(t){f()(n,t);var e=P(n);function n(){return s()(this,n),e.apply(this,arguments)}return c()(n,[{key:"getDefault",value:function(){return{position:r.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var t="l7-control-logo",e=g["a"].create("div",t),n=g["a"].create("a","l7-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://antv.alipay.com/l7",n.setAttribute("aria-label","AntV logo"),n.setAttribute("rel","noopener nofollow"),e.appendChild(n),e}},{key:"onRemove",value:function(){return null}}]),n}(E);function O(t){var e=L();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function L(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var R=function(t){f()(n,t);var e=O(n);function n(t){var r;return s()(this,n),r=e.call(this,t),r.mScale=void 0,r.iScale=void 0,Object(g["h"])(["update"],A()(r)),r}return c()(n,[{key:"getDefault",value:function(){return{position:r.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var t="l7-control-scale",e=g["a"].create("div",t);this.addScales(t+"-line",e);var n=this.controlOption.updateWhenIdle;return this.mapsService.on(n?"moveend":"mapmove",this.update),this.mapsService.on(n?"zoomend":"zoomchange",this.update),this.update(),e}},{key:"onRemove",value:function(){var t=this.controlOption.updateWhenIdle;this.mapsService.off(t?"zoomend":"zoomchange",this.update),this.mapsService.off(t?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var t=this.mapsService,e=this.controlOption.maxWidth,n=t.getSize()[1]/2,r=t.containerToLngLat([0,n]),i=t.containerToLngLat([e,n]),o=Object(g["p"])([r.lng,r.lat],[i.lng,i.lat]);this.updateScales(o)}},{key:"updateScales",value:function(t){var e=this.controlOption,n=e.metric,r=e.imperial;n&&t&&this.updateMetric(t),r&&t&&this.updateImperial(t)}},{key:"updateMetric",value:function(t){var e=this.getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this.updateScale(this.mScale,n,e/t)}},{key:"updateImperial",value:function(t){var e,n,r,i=3.2808399*t;i>5280?(e=i/5280,n=this.getRoundNum(e),this.updateScale(this.iScale,n+" mi",n/e)):(r=this.getRoundNum(i),this.updateScale(this.iScale,r+" ft",r/i))}},{key:"updateScale",value:function(t,e,n){var r=this.controlOption.maxWidth;t.style.width=Math.round(r*n)+"px",t.innerHTML=e}},{key:"getRoundNum",value:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}},{key:"addScales",value:function(t,e){var n=this.controlOption,r=n.metric,i=n.imperial;r&&(this.mScale=g["a"].create("div",t,e)),i&&(this.iScale=g["a"].create("div",t,e))}}]),n}(E);function D(t){var e=z();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function z(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var j=function(t){f()(n,t);var e=D(n);function n(t){var r;return s()(this,n),r=e.call(this,t),r.disabled=void 0,r.zoomInButton=void 0,r.zoomOutButton=void 0,Object(g["h"])(["updateDisabled","zoomIn","zoomOut"],A()(r)),r}return c()(n,[{key:"getDefault",value:function(){return{position:r.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var t="l7-control-zoom",e=g["a"].create("div",t+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,t+"-in",e,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,t+"-out",e,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),e}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(t,e,n,r,i){var o=g["a"].create("a",n,r);return o.innerHTML=t,o.title=e,o.href="javascript:void(0)",o.addEventListener("click",i),o}},{key:"updateDisabled",value:function(){var t=this.mapsService,e="l7-disabled";g["a"].removeClass(this.zoomInButton,e),g["a"].removeClass(this.zoomOutButton,e),(this.disabled||t.getZoom()<=t.getMinZoom())&&g["a"].addClass(this.zoomOutButton,e),(this.disabled||t.getZoom()>=t.getMaxZoom())&&g["a"].addClass(this.zoomInButton,e)}}]),n}(E);function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function B(t){var e=U();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function U(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var V=function(t){f()(n,t);var e=B(n);function n(t){var r;return s()(this,n),r=e.call(this),r.markerOption=void 0,r.defaultMarker=void 0,r.popup=void 0,r.mapsService=void 0,r.lngLat=void 0,r.scene=void 0,r.added=!1,r.eventHandle=function(t){r.emit(t.type,{target:t,data:r.markerOption.extData,lngLat:r.lngLat})},r.markerOption=F(F({},r.getDefault()),t),Object(g["h"])(["update","onMove","onUp","addDragHandler","onMapClick"],A()(r)),r.init(),r}return c()(n,[{key:"getDefault",value:function(){return{element:void 0,anchor:g["f"].BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(t){this.scene=t,this.mapsService=t.get(v["TYPES"].IMapService);var e=this.markerOption,n=e.element;e.draggable;return this.mapsService.getMarkerContainer().appendChild(n),this.registerMarkerEvent(n),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var t=this.markerOption.element;return t&&g["a"].remove(t),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(t){return this.lngLat=t,Array.isArray(t)&&(this.lngLat={lng:t[0],lat:t[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(t){var e=this;if(!this.added)return this.once("added",(function(){e.setElement(t)})),this;var n=this.markerOption.element;return n&&g["a"].remove(n),this.markerOption.element=t,this.init(),this.mapsService.getMarkerContainer().appendChild(t),this.registerMarkerEvent(t),this.update(),this}},{key:"openPopup",value:function(){var t=this;if(!this.added)return this.once("added",(function(){t.openPopup()})),this;var e=this.popup;return e?(e.isOpen()||e.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var t=this;this.added||this.once("added",(function(){t.closePopup()}));var e=this.popup;return e&&e.remove(),this}},{key:"setPopup",value:function(t){return this.popup=t,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var t=this.popup;return t?(t.isOpen()?t.remove():t.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(t){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(t){this.markerOption.extData=t}},{key:"update",value:function(){if(this.mapsService){var t=this.markerOption,e=t.element,n=t.anchor;this.updatePosition(),g["a"].setTransform(e,"".concat(g["e"][n]))}}},{key:"onMapClick",value:function(t){var e=this.markerOption.element;this.popup&&e&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var t=this.markerOption,e=t.element,n=t.offsets,r=this.lngLat,i=r.lng,o=r.lat,a=this.mapsService.getBounds(),s=this.mapsService.getZoom();if((i<a[0][0]||i>a[1][0]||o<a[0][1]||o>a[1][1])&&s>3)e&&(e.style.display="none");else{var u=this.mapsService.lngLatToContainer([i,o]);e&&(e.style.display="block",e.style.left=u.x+n[0]+"px",e.style.top=u.y-n[1]+"px")}}}},{key:"init",value:function(){var t=this,e=this.markerOption.element,n=this.markerOption,r=n.color,i=n.anchor;if(!e){this.defaultMarker=!0,e=g["a"].create("div"),this.markerOption.element=e;var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","48px"),o.setAttributeNS(null,"width","48px"),o.setAttributeNS(null,"viewBox","0 0 1024 1024");var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),a.setAttributeNS(null,"fill",r),o.appendChild(a),e.appendChild(o)}g["a"].addClass(e,"l7-marker"),e.addEventListener("click",(function(e){t.onMapClick(e)})),e.addEventListener("click",this.eventHandle),Object(g["g"])(e,i,"marker")}},{key:"registerMarkerEvent",value:function(t){t.addEventListener("mousemove",this.eventHandle),t.addEventListener("click",this.eventHandle),t.addEventListener("mousedown",this.eventHandle),t.addEventListener("mouseup",this.eventHandle),t.addEventListener("dblclick",this.eventHandle),t.addEventListener("contextmenu",this.eventHandle),t.addEventListener("mouseover",this.eventHandle),t.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var t=this.getElement();t.removeEventListener("mousemove",this.eventHandle),t.removeEventListener("click",this.eventHandle),t.removeEventListener("mousedown",this.eventHandle),t.removeEventListener("mouseup",this.eventHandle),t.removeEventListener("dblclick",this.eventHandle),t.removeEventListener("contextmenu",this.eventHandle),t.removeEventListener("mouseover",this.eventHandle),t.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(t){throw new Error("Method not implemented.")}},{key:"onUp",value:function(t){throw new Error("Method not implemented.")}}]),n}(y["EventEmitter"]),G=n("QkVN"),q=n.n(G),Z=n("mpbz"),H=n.n(Z);function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Y(t){var e=K();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function K(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(function(t){f()(n,t);var e=Y(n);function n(t){var r,i;return s()(this,n),i=e.call(this),i.markers=[],i.markerLayerOption=void 0,i.clusterIndex=void 0,i.points=[],i.clusterMarkers=[],i.mapsService=void 0,i.scene=void 0,i.zoom=void 0,i.bbox=void 0,i.markerLayerOption=q()(i.getDefault(),t),Object(g["h"])(["update"],A()(i)),i.zoom=(null===(r=i.markerLayerOption.clusterOption)||void 0===r?void 0:r.zoom)||-99,i}c()(n,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(t){return this.scene=t,this.mapsService=t.get(v["TYPES"].IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(t){var e=this.markerLayerOption.cluster;e&&this.addPoint(t,this.markers.length),this.markers.push(t)}},{key:"removeMarker",value:function(t){this.markers.indexOf(t);var e=this.markers.indexOf(t);e>-1&&this.markers.splice(e,1)}},{key:"getMarkers",value:function(){var t=this.markerLayerOption.cluster;return t?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var t=this;this.getMarkers().forEach((function(e){e.addTo(t.scene)}))}},{key:"clear",value:function(){this.markers.forEach((function(t){t.remove()})),this.clusterMarkers.forEach((function(t){t.remove()})),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(t,e){var n=t.getLnglat(),r=n.lng,i=n.lat,o={geometry:{type:"Point",coordinates:[r,i]},properties:X(X({},t.getExtData()),{},{marker_id:e})};this.points.push(o)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var t=this.markerLayerOption.clusterOption,e=t.radius,n=t.minZoom,r=void 0===n?0:n,i=t.maxZoom;this.clusterIndex=new H.a({radius:e,minZoom:r,maxZoom:i}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(t,e){var n=this,r=t[0].concat(t[1]),i=this.clusterIndex.getClusters(r,e);this.clusterMarkers.forEach((function(t){t.remove()})),this.clusterMarkers=[],i.forEach((function(t){var e,r=n.markerLayerOption.clusterOption,i=r.field,a=r.method;if(t.properties&&(null===(e=t.properties)||void 0===e?void 0:e.cluster_id)){var s,u=n.getLeaves(null===(s=t.properties)||void 0===s?void 0:s.cluster_id);if(t.properties.clusterData=u,i&&a){var c=null===u||void 0===u?void 0:u.map((function(t){var e=o()({},i,t.properties[i]);return e})),l=g["c"].getColumn(c,i),f=g["c"].getSatByColumn(a,l),p="point_"+a;t.properties[p]=f.toFixed(2)}}var h=n.clusterMarker(t);n.clusterMarkers.push(h),h.addTo(n.scene)}))}},{key:"getLeaves",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t?this.clusterIndex.getLeaves(t,e,n):null}},{key:"clusterMarker",value:function(t){var e=this.markerLayerOption.clusterOption,n=e,r=n.element,i=void 0===r?this.generateElement.bind(this):r,o=new V({element:i(t)}).setLnglat({lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1]});return o}},{key:"normalMarker",value:function(t){var e=t.properties.marker_id;return this.markers[e]}},{key:"update",value:function(){var t=this.mapsService.getZoom(),e=this.mapsService.getBounds();(!this.bbox||Math.abs(t-this.zoom)>=1||!Object(g["i"])(this.bbox,e))&&(this.bbox=Object(g["q"])(e,.5),this.zoom=Math.floor(t),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(t){var e=g["a"].create("div","l7-marker-cluster"),n=g["a"].create("div","",e),r=g["a"].create("span","",n),i=this.markerLayerOption.clusterOption,o=i.field,a=i.method;t.properties.point_count=t.properties.point_count||1;var s=o&&a?t.properties["point_"+a]||t.properties[o]:t.properties.point_count;return r.textContent=s,e}}])})(y["EventEmitter"]);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $(t){var e=tt();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}function tt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var et=function(t){f()(n,t);var e=$(n);function n(t){var r;return s()(this,n),r=e.call(this),r.popupOption=void 0,r.mapsService=void 0,r.lngLat=void 0,r.content=void 0,r.closeButton=void 0,r.timeoutInstance=void 0,r.container=void 0,r.tip=void 0,r.scene=void 0,r.popupOption=Q(Q({},r.getdefault()),t),Object(g["h"])(["update","onClickClose","remove"],A()(r)),r}return c()(n,[{key:"addTo",value:function(t){var e=this;return this.mapsService=t.get(v["TYPES"].IMapService),this.mapsService.on("camerachange",this.update),this.scene=t,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout((function(){e.mapsService.on("click",e.onClickClose)}),30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(t){var e,n=window.document.createDocumentFragment(),r=window.document.createElement("body");r.innerHTML=t;while(1){if(e=r.firstChild,!e)break;n.appendChild(e)}return this.setDOMContent(n)}},{key:"setLnglat",value:function(t){return this.lngLat=t,Array.isArray(t)&&(this.lngLat={lng:t[0],lat:t[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(t){return this.setDOMContent(window.document.createTextNode(t))}},{key:"setMaxWidth",value:function(t){return this.popupOption.maxWidth=t,this.update(),this}},{key:"setDOMContent",value:function(t){return this.createContent(),this.content.appendChild(t),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&g["a"].remove(this.content),this.content=g["a"].create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=g["a"].create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(t,e,n){var r=window.document.createElement(t);return void 0!==e&&(r.className=e),n&&n.appendChild(r),r}},{key:"removeDom",value:function(t){t.parentNode&&t.parentNode.removeChild(t)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:g["f"].BOTTOM,className:""}}},{key:"onClickClose",value:function(t){t.stopPropagation&&t.stopPropagation(),this.remove()}},{key:"update",value:function(){var t=this,e=this.lngLat,n=this.popupOption,r=n.className,i=n.maxWidth,o=n.anchor;if(this.mapsService&&e&&this.content){var a=this.mapsService.getMarkerContainer();!this.container&&a&&(this.container=this.creatDom("div","l7-popup",a.parentNode),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),r&&r.split(" ").forEach((function(e){return t.container.classList.add(e)})),["mousemove","mousedown","mouseup","click"].forEach((function(e){t.container.addEventListener(e,(function(t){t.stopPropagation()}))}))),i&&this.container.style.maxWidth!==i&&(this.container.style.maxWidth=i),this.updatePosition(),g["a"].setTransform(this.container,"".concat(g["e"][o])),Object(g["g"])(this.container,o,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var t=this.lngLat,e=t.lng,n=t.lat,r=this.popupOption.offsets,i=this.mapsService.lngLatToContainer([e,n]);this.container.style.left=i.x+r[0]+"px",this.container.style.top=i.y-r[1]+"px"}}}]),n}(y["EventEmitter"]);n("BGjm")('/* @antv/l7-component */\n.l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n }\n\n.l7-marker {\n\tposition: absolute !important;\n\ttop: 0;\n\tleft: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n    -webkit-flex-direction: column-reverse;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: reverse;\n        -ms-flex-direction: column-reverse;\n            flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n\t/* layers control */\n\n.l7-control-layers {\n\t-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);\n\t        box-shadow: 0 1px 5px rgba(0,0,0,0.4);\n\tbackground: #fff;\n\tborder-radius: 5px;\n\t}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n    -webkit-flex-direction: column;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n\n\n.l7-popup-anchor-left {\n    -webkit-flex-direction: row;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n    -webkit-flex-direction: row-reverse;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: reverse;\n        -ms-flex-direction: row-reverse;\n            flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-flex;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-top: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n\t-webkit-align-self: flex-start;\n\t-ms-flex-item-align: start;\n\t    align-self: flex-start;\n\tborder-top: none;\n\tborder-left: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n\t-webkit-align-self: flex-end;\n\t-ms-flex-item-align: end;\n\t    align-self: flex-end;\n\tborder-top: none;\n\tborder-right: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-bottom: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n\t-webkit-align-self: flex-start;\n\t-ms-flex-item-align: start;\n\t    align-self: flex-start;\n\tborder-bottom: none;\n\tborder-left: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n\t-webkit-align-self: flex-end;\n\t-ms-flex-item-align: end;\n\t    align-self: flex-end;\n\tborder-bottom: none;\n\tborder-right: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-left: none;\n\tborder-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-right: none;\n\tborder-left-color: #fff;\n}\n\n.l7-popup-close-button {\n\tposition: absolute;\n\tright: 0;\n\ttop: 0;\n\tborder: 0;\n\tpadding: 0;\n\tfont-size: 25px;\n\tline-height: 20px;\n\tborder-radius: 0 3px 0 0;\n\tcursor: pointer;\n\tbackground-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n\tbackground-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n\tposition: relative;\n\tbackground: #fff;\n\tborder-radius: 3px;\n\t-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\t        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\tpadding: 10px 10px 15px;\n\tpointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n\tborder-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n\tborder-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n\tborder-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n\tborder-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n\tdisplay: none;\n}\n\n.l7-popup-track-pointer * {\n\tpointer-events: none;\n\t-webkit-user-select: none;\n\t   -moz-user-select: none;\n\t    -ms-user-select: none;\n\t        user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n\tdisplay: -webkit-box;\n\tdisplay: -webkit-flex;\n\tdisplay: -ms-flexbox;\n\tdisplay: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n\tdisplay: none;\n}\n\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n\t-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);\n\t        box-shadow: 0 1px 5px rgba(0,0,0,0.65);\n\tborder-radius: 4px;\n\t}\n.l7-bar a,\n.l7-bar a:hover {\n\tbackground-color: #fff;\n\twidth: 30px;\n\theight: 30px;\n  font-size: 20px;\n\tdisplay: block;\n\ttext-align: center;\n\ttext-decoration: none;\n\tcolor: #8E9DAB;\n\t}\n.l7-bar a,\n.l7-control-layers-toggle {\n\tbackground-position: 50% 50%;\n\tbackground-repeat: no-repeat;\n\tdisplay: block;\n\t}\n.l7-bar a:hover {\n\tbackground-color: #f4f4f4;\n\t}\n.l7-bar a:first-child {\n\tborder-top-left-radius: 2px;\n\tborder-top-right-radius: 2px;\n\t}\n.l7-bar a:last-child {\n\tborder-bottom-left-radius: 2px;\n\tborder-bottom-right-radius: 2px;\n\tborder-bottom: none;\n\t}\n.l7-bar a.l7-disabled {\n\tcursor: default;\n\tbackground-color: #f4f4f4;\n\tcolor: #bbb;\n\t}\n\n\n/* control positioning */\n\n.l7-control-container {\n\tfont: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n\tdisplay: none;\n}\n.l7-control {\n\tposition: relative;\n\tz-index: 800;\n\tpointer-events: visiblePainted; /* IE 9-10 doesn\'t have auto */\n\tpointer-events: auto;\n\t}\n.l7-control {\n\tfloat: left;\n\tclear: both;\n\t}.l7-top,\n  .l7-bottom {\n    position: absolute;\n    z-index: 1000;\n    pointer-events: none;\n    }\n  .l7-top {\n    top: 0;\n    }\n  .l7-right {\n    right: 0;\n    }\n  .l7-bottom {\n    bottom: 0;\n    }\n  .l7-left {\n    left: 0;\n    }\n\n  .l7-control {\n    float: left;\n    clear: both;\n    }\n  .l7-right .l7-control {\n    float: right;\n    }\n  .l7-top .l7-control {\n    margin-top: 10px;\n    }\n  .l7-bottom .l7-control {\n    margin-bottom: 10px;\n    }\n  .l7-left .l7-control {\n    margin-left: 10px;\n    }\n  .l7-right .l7-control {\n    margin-right: 10px;\n    }\n\n  /* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n\tbackground: #fff;\n\tbackground: rgba(255, 255, 255, 0.7);\n\tmargin: 0;\n\t}\n.l7-control-attribution,\n.l7-control-scale-line {\n\tpadding: 0 5px;\n  color: #333;\n\t}\n.l7-control-attribution a {\n\ttext-decoration: none;\n\t}\n.l7-control-attribution a:hover {\n\ttext-decoration: underline;\n\t}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n\t}\n.l7-left .l7-control-scale {\n\tmargin-left: 5px;\n\t}\n.l7-bottom .l7-control-scale {\n\tmargin-bottom: 5px;\n\t}\n.l7-control-scale-line {\n\tborder: 2px solid #000;\n  border-top: none;\n  color: #000;\n\tline-height: 1.1;\n\tpadding: 2px 5px 1px;\n\tfont-size: 11px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\t-webkit-box-sizing: border-box;\n\t        box-sizing: border-box;\n\n\tbackground: #fff;\n\t}\n.l7-control-scale-line:not(:first-child) {\n\tborder-top: 2px solid #777;\n\tborder-bottom: none;\n\tmargin-top: -2px;\n\t}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n\tborder-bottom: 2px solid #777;\n\t}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n\t-webkit-box-shadow: none;\n\t        box-shadow: none;\n\t}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n\tborder: 2px solid rgba(0,0,0,0.2);\n\tbackground-clip: padding-box;\n  }\n  /*logo */\n\n  .l7-ctrl-logo {\n    background-size: 100% 100%;\n    width: 89px;\n    height: 16px;\n    margin: 0 0 -3px -3px;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    background-repeat: no-repeat;\n    cursor: pointer;\n    background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC\');\n}\n\n\n\t/* layers control */\n\n.l7-control-layers {\n\t-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);\n\t        box-shadow: 0 1px 8px rgba(0,0,0,0.4);\n\tbackground: #fff;\n\tborder-radius: 2px;\n\t}\n.l7-control-layers-toggle {\n\tbackground-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC\');\n\twidth: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n\t}\n\n.l7-touch .l7-control-layers-toggle {\n\twidth: 44px;\n\theight: 44px;\n\t}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n\tdisplay: none;\n\t}\n.l7-control-layers-expanded .l7-control-layers-list {\n\tdisplay: block;\n\tposition: relative;\n\t}\n.l7-control-layers-expanded {\n\tpadding: 6px 10px 6px 6px;\n\tcolor: #59626B;\n\tbackground: #fff;\n\t}\n.l7-control-layers-scrollbar {\n\toverflow-y: scroll;\n\toverflow-x: hidden;\n\tpadding-right: 5px;\n\t}\n.l7-control-layers-selector {\n\tmargin-top: 2px;\n\tposition: relative;\n\ttop: 1px;\n\t}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n  }\n  .l7-control-layers label input[type="radio"],\n  .l7-control-layers label input[type="checkbox"] {\n  width: 14px;\n  height: 14px;\n  margin: 0;\n}\n.l7-control-layers-separator {\n\theight: 0;\n\tborder-top: 1px solid #D8D8D8;\n\tmargin: 5px -10px 5px -6px;\n}\n.mapboxgl-ctrl-logo {\n  display: none !important;\n }\n .amap-logo{\n  display: none !important;\n }\n\n\n')},"kQ+U":function(t,e,n){"use strict";n.d(e,"a",(function(){return ht}));var r,i,o,a,s,u,c,l,f,p,h,d,m,v,g=n("lSNA"),y=n.n(g),_=n("lwsE"),b=n.n(_),x=n("W8MJ"),w=n.n(x),S=n("k5/I"),E=n("h1nZ"),T=n("o0o1"),A=n.n(T),C=n("yXPU"),k=n.n(C),P=n("4cb6"),M=n("fbvF"),I=n.n(M),O=function(){function t(e,n){b()(this,t),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,o=n.stride,a=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return w()(t,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),L=(r={},y()(r,E["gl"].POINTS,"points"),y()(r,E["gl"].LINES,"lines"),y()(r,E["gl"].LINE_LOOP,"line loop"),y()(r,E["gl"].LINE_STRIP,"line strip"),y()(r,E["gl"].TRIANGLES,"triangles"),y()(r,E["gl"].TRIANGLE_FAN,"triangle fan"),y()(r,E["gl"].TRIANGLE_STRIP,"triangle strip"),r),R=(i={},y()(i,E["gl"].STATIC_DRAW,"static"),y()(i,E["gl"].DYNAMIC_DRAW,"dynamic"),y()(i,E["gl"].STREAM_DRAW,"stream"),i),D=(o={},y()(o,E["gl"].BYTE,"int8"),y()(o,E["gl"].UNSIGNED_INT,"int16"),y()(o,E["gl"].INT,"int32"),y()(o,E["gl"].UNSIGNED_BYTE,"uint8"),y()(o,E["gl"].UNSIGNED_SHORT,"uint16"),y()(o,E["gl"].UNSIGNED_INT,"uint32"),y()(o,E["gl"].FLOAT,"float"),o),z=(a={},y()(a,E["gl"].ALPHA,"alpha"),y()(a,E["gl"].LUMINANCE,"luminance"),y()(a,E["gl"].LUMINANCE_ALPHA,"luminance alpha"),y()(a,E["gl"].RGB,"rgb"),y()(a,E["gl"].RGBA,"rgba"),y()(a,E["gl"].RGBA4,"rgba4"),y()(a,E["gl"].RGB5_A1,"rgb5 a1"),y()(a,E["gl"].RGB565,"rgb565"),y()(a,E["gl"].DEPTH_COMPONENT,"depth"),y()(a,E["gl"].DEPTH_STENCIL,"depth stencil"),a),j=(s={},y()(s,E["gl"].DONT_CARE,"dont care"),y()(s,E["gl"].NICEST,"nice"),y()(s,E["gl"].FASTEST,"fast"),s),N=(u={},y()(u,E["gl"].NEAREST,"nearest"),y()(u,E["gl"].LINEAR,"linear"),y()(u,E["gl"].LINEAR_MIPMAP_LINEAR,"mipmap"),y()(u,E["gl"].NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),y()(u,E["gl"].LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),y()(u,E["gl"].NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),u),F=(c={},y()(c,E["gl"].REPEAT,"repeat"),y()(c,E["gl"].CLAMP_TO_EDGE,"clamp"),y()(c,E["gl"].MIRRORED_REPEAT,"mirror"),c),B=(l={},y()(l,E["gl"].NONE,"none"),y()(l,E["gl"].BROWSER_DEFAULT_WEBGL,"browser"),l),U=(f={},y()(f,E["gl"].NEVER,"never"),y()(f,E["gl"].ALWAYS,"always"),y()(f,E["gl"].LESS,"less"),y()(f,E["gl"].LEQUAL,"lequal"),y()(f,E["gl"].GREATER,"greater"),y()(f,E["gl"].GEQUAL,"gequal"),y()(f,E["gl"].EQUAL,"equal"),y()(f,E["gl"].NOTEQUAL,"notequal"),f),V=(p={},y()(p,E["gl"].FUNC_ADD,"add"),y()(p,E["gl"].MIN_EXT,"min"),y()(p,E["gl"].MAX_EXT,"max"),y()(p,E["gl"].FUNC_SUBTRACT,"subtract"),y()(p,E["gl"].FUNC_REVERSE_SUBTRACT,"reverse subtract"),p),G=(h={},y()(h,E["gl"].ZERO,"zero"),y()(h,E["gl"].ONE,"one"),y()(h,E["gl"].SRC_COLOR,"src color"),y()(h,E["gl"].ONE_MINUS_SRC_COLOR,"one minus src color"),y()(h,E["gl"].SRC_ALPHA,"src alpha"),y()(h,E["gl"].ONE_MINUS_SRC_ALPHA,"one minus src alpha"),y()(h,E["gl"].DST_COLOR,"dst color"),y()(h,E["gl"].ONE_MINUS_DST_COLOR,"one minus dst color"),y()(h,E["gl"].DST_ALPHA,"dst alpha"),y()(h,E["gl"].ONE_MINUS_DST_ALPHA,"one minus dst alpha"),y()(h,E["gl"].CONSTANT_COLOR,"constant color"),y()(h,E["gl"].ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),y()(h,E["gl"].CONSTANT_ALPHA,"constant alpha"),y()(h,E["gl"].ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),y()(h,E["gl"].SRC_ALPHA_SATURATE,"src alpha saturate"),h),q=(d={},y()(d,E["gl"].NEVER,"never"),y()(d,E["gl"].ALWAYS,"always"),y()(d,E["gl"].LESS,"less"),y()(d,E["gl"].LEQUAL,"lequal"),y()(d,E["gl"].GREATER,"greater"),y()(d,E["gl"].GEQUAL,"gequal"),y()(d,E["gl"].EQUAL,"equal"),y()(d,E["gl"].NOTEQUAL,"notequal"),d),Z=(m={},y()(m,E["gl"].ZERO,"zero"),y()(m,E["gl"].KEEP,"keep"),y()(m,E["gl"].REPLACE,"replace"),y()(m,E["gl"].INVERT,"invert"),y()(m,E["gl"].INCR,"increment"),y()(m,E["gl"].DECR,"decrement"),y()(m,E["gl"].INCR_WRAP,"increment wrap"),y()(m,E["gl"].DECR_WRAP,"decrement wrap"),m),H=(v={},y()(v,E["gl"].FRONT,"front"),y()(v,E["gl"].BACK,"back"),v),W=function(){function t(e,n){b()(this,t),this.buffer=void 0;var r=n.data,i=n.usage,o=n.type;this.buffer=e.buffer({data:r,usage:R[i||E["gl"].STATIC_DRAW],type:D[o||E["gl"].UNSIGNED_BYTE]})}return w()(t,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var e=t.data,n=t.offset;this.buffer.subdata(e,n)}}]),t}(),X=function(){function t(e,n){b()(this,t),this.elements=void 0;var r=n.data,i=n.usage,o=n.type,a=n.count;this.elements=e.elements({data:r,usage:R[i||E["gl"].STATIC_DRAW],type:D[o||E["gl"].UNSIGNED_BYTE],count:a})}return w()(t,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var e=t.data;this.elements.subdata(e)}},{key:"destroy",value:function(){}}]),t}(),Y=function(){function t(e,n){b()(this,t),this.framebuffer=void 0;var r=n.width,i=n.height,o=n.color,a=n.colors,s=(n.depth,n.stencil,{width:r,height:i});Array.isArray(a)&&(s.colors=a.map((function(t){return t.get()}))),o&&"boolean"!==typeof o&&(s.color=o.get()),this.framebuffer=e.framebuffer(s)}return w()(t,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.framebuffer.resize(e,n)}}]),t}(),K=n("cDf5"),J=n.n(K),Q=n("c6wG"),$=n.n(Q),tt=n("YO3V"),et=n.n(tt);function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){y()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var it,ot,at,st=function(){function t(e,n){b()(this,t),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=e;var r=n.vs,i=n.fs,o=n.attributes,a=n.uniforms,s=n.primitive,u=n.count,c=n.elements,l=n.depth,f=n.blend,p=n.stencil,h=n.cull,d=n.instances,m={};this.options=n,a&&(this.uniforms=this.extractUniforms(a),Object.keys(a).forEach((function(t){m[t]=e.prop(t)})));var v={};Object.keys(o).forEach((function(t){v[t]=o[t].get()}));var g={attributes:v,frag:i,uniforms:m,vert:r,primitive:L[void 0===s?E["gl"].TRIANGLES:s]};d&&(g.instances=d),u&&(g.count=u),c&&(g.elements=c.get()),this.initDepthDrawParams({depth:l},g),this.initBlendDrawParams({blend:f},g),this.initStencilDrawParams({stencil:p},g),this.initCullDrawParams({cull:h},g),this.drawCommand=e(g),this.drawParams=g}return w()(t,[{key:"addUniforms",value:function(t){this.uniforms=rt(rt({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var e=rt(rt({},this.uniforms),this.extractUniforms(t.uniforms||{})),n={};Object.keys(e).forEach((function(t){var r=J()(e[t]);"boolean"===r||"number"===r||Array.isArray(e[t])||e[t].BYTES_PER_ELEMENT?n[t]=e[t]:n[t]=e[t].get()})),this.drawCommand(n)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach((function(t){t.destroy()})),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,e){var n=t.depth;n&&(e.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:U[n.func||E["gl"].LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,e){var n=t.blend;if(n){var r=n.enable,i=n.func,o=n.equation,a=n.color,s=void 0===a?[0,0,0,0]:a;e.blend={enable:!!r,func:{srcRGB:G[i&&i.srcRGB||E["gl"].SRC_ALPHA],srcAlpha:G[i&&i.srcAlpha||E["gl"].SRC_ALPHA],dstRGB:G[i&&i.dstRGB||E["gl"].ONE_MINUS_SRC_ALPHA],dstAlpha:G[i&&i.dstAlpha||E["gl"].ONE_MINUS_SRC_ALPHA]},equation:{rgb:V[o&&o.rgb||E["gl"].FUNC_ADD],alpha:V[o&&o.alpha||E["gl"].FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(t,e){var n=t.stencil;if(n){var r=n.enable,i=n.mask,o=void 0===i?-1:i,a=n.func,s=void 0===a?{cmp:E["gl"].ALWAYS,ref:0,mask:-1}:a,u=n.opFront,c=void 0===u?{fail:E["gl"].KEEP,zfail:E["gl"].KEEP,zpass:E["gl"].KEEP}:u,l=n.opBack,f=void 0===l?{fail:E["gl"].KEEP,zfail:E["gl"].KEEP,zpass:E["gl"].KEEP}:l;e.stencil={enable:!!r,mask:o,func:rt(rt({},s),{},{cmp:q[s.cmp]}),opFront:{fail:Z[c.fail],zfail:Z[c.zfail],zpass:Z[c.zpass]},opBack:{fail:Z[f.fail],zfail:Z[f.zfail],zpass:Z[f.zpass]}}}}},{key:"initCullDrawParams",value:function(t,e){var n=t.cull;if(n){var r=n.enable,i=n.face,o=void 0===i?E["gl"].BACK:i;e.cull={enable:!!r,face:H[o]}}}},{key:"extractUniforms",value:function(t){var e=this,n={};return Object.keys(t).forEach((function(r){e.extractUniformsRecursively(r,t[r],n,"")})),n}},{key:"extractUniformsRecursively",value:function(t,e,n,r){var i=this;null===e||"number"===typeof e||"boolean"===typeof e||Array.isArray(e)&&"number"===typeof e[0]||$()(e)||""===e||"resize"in e?n["".concat(r&&r+".").concat(t)]=e:(et()(e)&&Object.keys(e).forEach((function(o){i.extractUniformsRecursively(o,e[o],n,"".concat(r&&r+".").concat(t))})),Array.isArray(e)&&e.forEach((function(e,o){Object.keys(e).forEach((function(a){i.extractUniformsRecursively(a,e[a],n,"".concat(r&&r+".").concat(t,"[").concat(o,"]"))}))})))}}]),t}(),ut=function(){function t(e,n){b()(this,t),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,o=void 0===i?E["gl"].UNSIGNED_BYTE:i,a=n.width,s=n.height,u=n.flipY,c=void 0!==u&&u,l=n.format,f=void 0===l?E["gl"].RGBA:l,p=n.mipmap,h=void 0!==p&&p,d=n.wrapS,m=void 0===d?E["gl"].CLAMP_TO_EDGE:d,v=n.wrapT,g=void 0===v?E["gl"].CLAMP_TO_EDGE:v,y=n.aniso,_=void 0===y?0:y,x=n.alignment,w=void 0===x?1:x,S=n.premultiplyAlpha,T=void 0!==S&&S,A=n.mag,C=void 0===A?E["gl"].NEAREST:A,k=n.min,P=void 0===k?E["gl"].NEAREST:k,M=n.colorSpace,I=void 0===M?E["gl"].BROWSER_DEFAULT_WEBGL:M;this.width=a,this.height=s;var O={width:a,height:s,type:D[o],format:z[f],wrapS:F[m],wrapT:F[g],mag:N[C],min:N[P],alignment:w,flipY:c,colorSpace:B[I],premultiplyAlpha:T,aniso:_};r&&(O.data=r),"number"===typeof h?O.mipmap=j[h]:"boolean"===typeof h&&(O.mipmap=h),this.texture=e.texture(O)}return w()(t,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.texture.resize(e,n),this.width=e,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),t}(),ct=(it=Object(P["injectable"])(),it((at=function(){function t(){var e=this;b()(this,t),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(t){return new st(e.gl,t)},this.createAttribute=function(t){return new O(e.gl,t)},this.createBuffer=function(t){return new W(e.gl,t)},this.createElements=function(t){return new X(e.gl,t)},this.createTexture2D=function(t){return new ut(e.gl,t)},this.createFramebuffer=function(t){return new Y(e.gl,t)},this.useFramebuffer=function(t,n){e.gl({framebuffer:t?t.get():null})(n)},this.clear=function(t){var n=t.color,r=t.depth,i=t.stencil,o=t.framebuffer,a=void 0===o?null:o,s={color:n,depth:r,stencil:i};s.framebuffer=null===a?a:a.get(),e.gl.clear(s)},this.viewport=function(t){var n=t.x,r=t.y,i=t.width,o=t.height;e.gl._gl.viewport(n,r,i,o),e.width=i,e.height=o,e.gl._refresh()},this.readPixels=function(t){var n=t.framebuffer,r=t.x,i=t.y,o=t.width,a=t.height,s={x:r,y:i,width:o,height:a};return n&&(s.framebuffer=n.get()),e.gl.read(s)},this.getViewportSize=function(){return{width:e.gl._gl.drawingBufferWidth,height:e.gl._gl.drawingBufferHeight}},this.getContainer=function(){var t;return null===(t=e.canvas)||void 0===t?void 0:t.parentElement},this.getCanvas=function(){return e.canvas},this.getGLContext=function(){return e.gl._gl},this.destroy=function(){e.gl.destroy()}}return w()(t,[{key:"init",value:function(){var t=k()(A.a.mark((function t(e,n){var r=this;return A.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.canvas=e,t.next=3,new Promise((function(t,e){I()({canvas:r.canvas,attributes:{alpha:!0,antialias:n.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:n.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(n,r){!n&&r||e(n),t(r)}})}));case 3:this.gl=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),t}(),ot=at))||ot),lt=n("Hel2");function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){y()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht=function(){function t(e){b()(this,t),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var n=e.id,r=e.map,i=Object(E["createSceneContainer"])();this.container=i,r.setContainer(i,n),i.bind(E["TYPES"].IRendererService).to(ct).inSingletonScope(),this.sceneService=i.get(E["TYPES"].ISceneService),this.mapService=i.get(E["TYPES"].IMapService),this.iconService=i.get(E["TYPES"].IIconService),this.fontService=i.get(E["TYPES"].IFontService),this.controlService=i.get(E["TYPES"].IControlService),this.layerService=i.get(E["TYPES"].ILayerService),this.markerService=i.get(E["TYPES"].IMarkerService),this.interactionService=i.get(E["TYPES"].IInteractionService),this.popupService=i.get(E["TYPES"].IPopupService),this.initComponent(n),this.sceneService.init(e),this.initControl()}return w()(t,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(t){return this.sceneService.exportPng(t)}},{key:"exportMap",value:function(t){return this.sceneService.exportPng(t)}},{key:"registerRenderService",value:function(t){var e=this;if(this.sceneService.loaded){var n=new t(this);n.init()}else this.on("loaded",(function(){var n=new t(e);n.init()}))}},{key:"addLayer",value:function(t){var e=Object(E["createLayerContainer"])(this.container);t.setContainer(e),this.sceneService.addLayer(t)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(t){this.layerService.remove(t)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(t,e){this.iconService.addImage(t,e)}},{key:"hasImage",value:function(t){this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,e){this.fontService.addIconGlyphs(e)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"on",value:function(t,e){-1===E["SceneEventList"].indexOf(t)?this.mapService.on(t,e):this.sceneService.on(t,e)}},{key:"off",value:function(t,e){-1===E["SceneEventList"].indexOf(t)?this.mapService.off(t,e):this.sceneService.off(t,e)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(t){return this.mapService.setCenter(t)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t){this.mapService.panTo(t)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,e){var n=this.sceneService.getSceneConfig(),r=n.fitBoundsOptions,i=n.animate;this.mapService.fitBounds(t,e||pt(pt({},r),{},{animate:i}))}},{key:"setZoomAndCenter",value:function(t,e){this.mapService.setZoomAndCenter(t,e)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,e){this.container.bind(E["TYPES"].IPostProcessingPass).to(t).whenTargetNamed(e)}},{key:"initComponent",value:function(t){this.controlService.init({container:lt["a"].getContainer(t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),e=t.logoVisible,n=t.logoPosition;e&&this.addControl(new S["b"]({position:n}))}},{key:"map",get:function(){return this.mapService.map}}]),t}()},l94r:function(t,e,n){"use strict";n.d(e,"a",(function(){return z}));var r=n("lSNA"),i=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),u=n.n(s),c=n("7W2i"),l=n.n(c),f=n("a1gu"),p=n.n(f),h=n("Nsbk"),d=n.n(h),m=n("4qC0"),v=n.n(m),g=n("lSCD"),y=n.n(g),_=n("BkRI"),b=n.n(_),x=n("xp6e"),w=n("Hel2"),S=n("uhBA"),E=n("rlAn"),T=n("qxNg");function A(t){if(0===t.length)throw new Error("max requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]>e&&(e=t[n]);return e}function C(t){if(0===t.length)throw new Error("min requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]<e&&(e=t[n]);return e}function k(t){if(0===t.length)return 0;for(var e,n=t[0],r=0,i=1;i<t.length;i++)e=n+1*t[i],Math.abs(n)>=Math.abs(t[i])?r+=n-e+t[i]:r+=t[i]-e+n,n=e;return n+1*r}function P(t){if(0===t.length)throw new Error("mean requires at least one data point");return k(t)/t.length}var M={min:C,max:A,mean:P,sum:k};function I(t,e){return t.map((function(t){return 1*t[e]}))}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t){var e=D();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var z=function(t){l()(n,t);var e=R(n);function n(t,r){var i;return a()(this,n),i=e.call(this),i.data=void 0,i.extent=void 0,i.hooks={init:new x["c"]},i.parser={type:"geojson"},i.transforms=[],i.cluster=!1,i.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},i.originData=void 0,i.rawData=void 0,i.clusterIndex=void 0,i.originData=t,i.initCfg(r),i.hooks.init.tap("parser",(function(){i.excuteParser()})),i.hooks.init.tap("cluster",(function(){i.initCluster()})),i.hooks.init.tap("transform",(function(){i.executeTrans()})),i.init(),i}return u()(n,[{key:"setData",value:function(t,e){this.rawData=t,this.originData=t,this.initCfg(e),this.init(),this.emit("update")}},{key:"getClusters",value:function(t){return this.clusterIndex.getClusters(this.extent,t)}},{key:"getClustersLeaves",value:function(t){return this.clusterIndex.getLeaves(t,1/0)}},{key:"updateClusterData",value:function(t){var e=this,n=this.clusterOptions,r=n.method,i=void 0===r?"sum":r,o=n.field,a=this.clusterIndex.getClusters(this.extent,Math.floor(t));this.clusterOptions.zoom=t,a.forEach((function(t){t.id||(t.properties.point_count=1)})),(o||y()(i))&&(a=a.map((function(t){var n=t.id;if(n){var r,a=e.clusterIndex.getLeaves(n,1/0),s=a.map((function(t){return t.properties}));if(v()(i)&&o){var u=I(s,o);r=M[i](u)}y()(i)&&(r=i(s)),t.properties.stat=r}else t.properties.point_count=1;return t}))),this.data=Object(E["getParser"])("geojson")({type:"FeatureCollection",features:a}),this.executeTrans()}},{key:"getFeatureById",value:function(t){var e=this.parser.type,n=void 0===e?"geojson":e;if("geojson"!==n||this.cluster)return t<this.data.dataArray.length?this.data.dataArray[t]:"null";var r=t<this.originData.features.length?this.originData.features[t]:"null",i=b()(r);if(0!==this.transforms.length){var o=this.data.dataArray.find((function(e){return e._id===t}));i.properties=o}return i}},{key:"getFeatureId",value:function(t,e){var n=this.data.dataArray.find((function(e){return e[t]===name}));return null===n||void 0===n?void 0:n._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(t){t&&(t.parser&&(this.parser=t.parser),t.transforms&&(this.transforms=t.transforms),this.cluster=t.cluster||!1,t.clusterOptions&&(this.cluster=!0,this.clusterOptions=L(L({},this.clusterOptions),t.clusterOptions)))}},{key:"excuteParser",value:function(){var t=this.parser,e=t.type||"geojson",n=Object(E["getParser"])(e);this.data=n(this.originData,t),this.extent=Object(w["l"])(this.data.dataArray)}},{key:"executeTrans",value:function(){var t=this,e=this.transforms;e.forEach((function(e){var n=e.type,r=Object(E["getTransform"])(n)(t.data,e);Object.assign(t.data,r)}))}},{key:"initCluster",value:function(){if(this.cluster){var t=this.clusterOptions||{};this.clusterIndex=Object(T["a"])(this.data,t)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),n}(S["EventEmitter"])},lJbI:function(t,e,n){"use strict";function r(t,e){var n=e.extent,r=e.width,i=e.height,o=e.min,a=e.max,s={_id:1,dataArray:[{_id:1,data:Array.from(t),width:r,height:i,min:o,max:a,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return s}n.d(e,"a",(function(){return r}))},mNvP:function(t,e,n){(function(t,e){var n;(function(n){(function(t){var r="object"===typeof e?e:"object"===typeof self?self:"object"===typeof this?this:Function("return this;")(),i=o(n);function o(t,e){return function(n,r){"function"!==typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}"undefined"===typeof r.Reflect?r.Reflect=n:i=o(r.Reflect,i),t(i)})((function(e){var n=Object.prototype.hasOwnProperty,r="function"===typeof Symbol,i=r&&"undefined"!==typeof Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&"undefined"!==typeof Symbol.iterator?Symbol.iterator:"@@iterator",a="function"===typeof Object.create,s={__proto__:[]}instanceof Array,u=!a&&!s,c={create:a?function(){return ot(Object.create(null))}:s?function(){return ot({__proto__:null})}:function(){return ot({})},has:u?function(t,e){return n.call(t,e)}:function(t,e){return e in t},get:u?function(t,e){return n.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},l=Object.getPrototypeOf(Function),f="object"===typeof t&&Object({NODE_ENV:"production"})&&"true"===Object({NODE_ENV:"production"})["REFLECT_METADATA_USE_MAP_POLYFILL"],p=f||"function"!==typeof Map||"function"!==typeof Map.prototype.entries?nt():Map,h=f||"function"!==typeof Set||"function"!==typeof Set.prototype.entries?rt():Set,d=f||"function"!==typeof WeakMap?it():WeakMap,m=new d;function v(t,e,n,r){if(j(n)){if(!H(t))throw new TypeError;if(!X(e))throw new TypeError;return A(t,e)}if(!H(t))throw new TypeError;if(!B(e))throw new TypeError;if(!B(r)&&!j(r)&&!N(r))throw new TypeError;return N(r)&&(r=void 0),n=Z(n),C(t,e,n,r)}function g(t,e){function n(n,r){if(!B(n))throw new TypeError;if(!j(r)&&!Y(r))throw new TypeError;L(t,e,n,r)}return n}function y(t,e,n,r){if(!B(n))throw new TypeError;return j(r)||(r=Z(r)),L(t,e,n,r)}function _(t,e,n){if(!B(e))throw new TypeError;return j(n)||(n=Z(n)),P(t,e,n)}function b(t,e,n){if(!B(e))throw new TypeError;return j(n)||(n=Z(n)),M(t,e,n)}function x(t,e,n){if(!B(e))throw new TypeError;return j(n)||(n=Z(n)),I(t,e,n)}function w(t,e,n){if(!B(e))throw new TypeError;return j(n)||(n=Z(n)),O(t,e,n)}function S(t,e){if(!B(t))throw new TypeError;return j(e)||(e=Z(e)),R(t,e)}function E(t,e){if(!B(t))throw new TypeError;return j(e)||(e=Z(e)),D(t,e)}function T(t,e,n){if(!B(e))throw new TypeError;j(n)||(n=Z(n));var r=k(e,n,!1);if(j(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=m.get(e);return i.delete(n),i.size>0||m.delete(e),!0}function A(t,e){for(var n=t.length-1;n>=0;--n){var r=t[n],i=r(e);if(!j(i)&&!N(i)){if(!X(i))throw new TypeError;e=i}}return e}function C(t,e,n,r){for(var i=t.length-1;i>=0;--i){var o=t[i],a=o(e,n,r);if(!j(a)&&!N(a)){if(!B(a))throw new TypeError;r=a}}return r}function k(t,e,n){var r=m.get(t);if(j(r)){if(!n)return;r=new p,m.set(t,r)}var i=r.get(e);if(j(i)){if(!n)return;i=new p,r.set(e,i)}return i}function P(t,e,n){var r=M(t,e,n);if(r)return!0;var i=et(e);return!N(i)&&P(t,i,n)}function M(t,e,n){var r=k(e,n,!1);return!j(r)&&G(r.has(t))}function I(t,e,n){var r=M(t,e,n);if(r)return O(t,e,n);var i=et(e);return N(i)?void 0:I(t,i,n)}function O(t,e,n){var r=k(e,n,!1);if(!j(r))return r.get(t)}function L(t,e,n,r){var i=k(n,r,!0);i.set(t,e)}function R(t,e){var n=D(t,e),r=et(t);if(null===r)return n;var i=R(r,e);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new h,a=[],s=0,u=n;s<u.length;s++){var c=u[s],l=o.has(c);l||(o.add(c),a.push(c))}for(var f=0,p=i;f<p.length;f++){c=p[f],l=o.has(c);l||(o.add(c),a.push(c))}return a}function D(t,e){var n=[],r=k(t,e,!1);if(j(r))return n;var i=r.keys(),o=J(i),a=0;while(1){var s=$(o);if(!s)return n.length=a,n;var u=Q(s);try{n[a]=u}catch(c){try{tt(o)}finally{throw c}}a++}}function z(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function j(t){return void 0===t}function N(t){return null===t}function F(t){return"symbol"===typeof t}function B(t){return"object"===typeof t?null!==t:"function"===typeof t}function U(t,e){switch(z(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n=3===e?"string":5===e?"number":"default",r=K(t,i);if(void 0!==r){var o=r.call(t,n);if(B(o))throw new TypeError;return o}return V(t,"default"===n?"number":n)}function V(t,e){if("string"===e){var n=t.toString;if(W(n)){var r=n.call(t);if(!B(r))return r}var i=t.valueOf;if(W(i)){r=i.call(t);if(!B(r))return r}}else{i=t.valueOf;if(W(i)){r=i.call(t);if(!B(r))return r}var o=t.toString;if(W(o)){r=o.call(t);if(!B(r))return r}}throw new TypeError}function G(t){return!!t}function q(t){return""+t}function Z(t){var e=U(t,3);return F(e)?e:q(e)}function H(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function W(t){return"function"===typeof t}function X(t){return"function"===typeof t}function Y(t){switch(z(t)){case 3:return!0;case 4:return!0;default:return!1}}function K(t,e){var n=t[e];if(void 0!==n&&null!==n){if(!W(n))throw new TypeError;return n}}function J(t){var e=K(t,o);if(!W(e))throw new TypeError;var n=e.call(t);if(!B(n))throw new TypeError;return n}function Q(t){return t.value}function $(t){var e=t.next();return!e.done&&e}function tt(t){var e=t["return"];e&&e.call(t)}function et(t){var e=Object.getPrototypeOf(t);if("function"!==typeof t||t===l)return e;if(e!==l)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!==typeof i||i===t?e:i}function nt(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,i)},e.prototype.entries=function(){return new n(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function i(t,e){return e}function a(t,e){return[t,e]}}function rt(){return function(){function t(){this._map=new p}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}()}function it(){var t=16,e=c.create(),r=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){var n=o(t,!0);return n[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+u()}while(c.has(e,t));return e[t]=!0,t}function o(t,e){if(!n.call(t,r)){if(!e)return;Object.defineProperty(t,r,{value:c.create()})}return t[r]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function s(t){return"function"===typeof Uint8Array?"undefined"!==typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!==typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t)}function u(){var e=s(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<t;++r){var i=e[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function ot(t){return t.__=void 0,delete t.__,t}e("decorate",v),e("metadata",g),e("defineMetadata",y),e("hasMetadata",_),e("hasOwnMetadata",b),e("getMetadata",x),e("getOwnMetadata",w),e("getMetadataKeys",S),e("getOwnMetadataKeys",E),e("deleteMetadata",T)}))})(n||(n={}))}).call(this,n("Q2Ig"),n("yLpj"))},mhV4:function(t,e,n){var r=n("ZK94");function i(t){var e,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=o(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(e=0;e<t.geometries.length;e++)n+=i(t.geometries[e]);return n}}function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(a(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(a(t[n]))}return e}function a(t){var e,n,i,o,a,u,c,l=0,f=t.length;if(f>2){for(c=0;c<f;c++)c===f-2?(o=f-2,a=f-1,u=0):c===f-1?(o=f-1,a=0,u=1):(o=c,a=c+1,u=c+2),e=t[o],n=t[a],i=t[u],l+=(s(i[0])-s(e[0]))*Math.sin(s(n[1]));l=l*r.RADIUS*r.RADIUS/2}return l}function s(t){return t*Math.PI/180}t.exports.geometry=i,t.exports.ring=a},mpbz:function(t,e,n){(function(e,n){t.exports=n()})(0,(function(){"use strict";function t(n,r,i,o,a,s){if(!(a-o<=i)){var u=o+a>>1;e(n,r,u,o,a,s%2),t(n,r,i,o,u-1,s+1),t(n,r,i,u+1,a,s+1)}}function e(t,r,i,o,a,s){while(a>o){if(a-o>600){var u=a-o+1,c=i-o+1,l=Math.log(u),f=.5*Math.exp(2*l/3),p=.5*Math.sqrt(l*f*(u-f)/u)*(c-u/2<0?-1:1),h=Math.max(o,Math.floor(i-c*f/u+p)),d=Math.min(a,Math.floor(i+(u-c)*f/u+p));e(t,r,i,h,d,s)}var m=r[2*i+s],v=o,g=a;n(t,r,o,i),r[2*a+s]>m&&n(t,r,o,a);while(v<g){n(t,r,v,g),v++,g--;while(r[2*v+s]<m)v++;while(r[2*g+s]>m)g--}r[2*o+s]===m?n(t,r,o,g):(g++,n(t,r,g,a)),g<=i&&(o=g+1),i<=g&&(a=g-1)}}function n(t,e,n,i){r(t,n,i),r(e,2*n,2*i),r(e,2*n+1,2*i+1)}function r(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function i(t,e,n,r,i,o,a){var s,u,c=[0,t.length-1,0],l=[];while(c.length){var f=c.pop(),p=c.pop(),h=c.pop();if(p-h<=a)for(var d=h;d<=p;d++)s=e[2*d],u=e[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var m=Math.floor((h+p)/2);s=e[2*m],u=e[2*m+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[m]);var v=(f+1)%2;(0===f?n<=s:r<=u)&&(c.push(h),c.push(m-1),c.push(v)),(0===f?i>=s:o>=u)&&(c.push(m+1),c.push(p),c.push(v))}}return l}function o(t,e,n,r,i,o){var s=[0,t.length-1,0],u=[],c=i*i;while(s.length){var l=s.pop(),f=s.pop(),p=s.pop();if(f-p<=o)for(var h=p;h<=f;h++)a(e[2*h],e[2*h+1],n,r)<=c&&u.push(t[h]);else{var d=Math.floor((p+f)/2),m=e[2*d],v=e[2*d+1];a(m,v,n,r)<=c&&u.push(t[d]);var g=(l+1)%2;(0===l?n-i<=m:r-i<=v)&&(s.push(p),s.push(d-1),s.push(g)),(0===l?n+i>=m:r+i>=v)&&(s.push(d+1),s.push(f),s.push(g))}}return u}function a(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}var s=function(t){return t[0]},u=function(t){return t[1]},c=function(e,n,r,i,o){void 0===n&&(n=s),void 0===r&&(r=u),void 0===i&&(i=64),void 0===o&&(o=Float64Array),this.nodeSize=i,this.points=e;for(var a=e.length<65536?Uint16Array:Uint32Array,c=this.ids=new a(e.length),l=this.coords=new o(2*e.length),f=0;f<e.length;f++)c[f]=f,l[2*f]=n(e[f]),l[2*f+1]=r(e[f]);t(c,l,i,0,c.length-1,0)};c.prototype.range=function(t,e,n,r){return i(this.ids,this.coords,t,e,n,r,this.nodeSize)},c.prototype.within=function(t,e,n){return o(this.ids,this.coords,t,e,n,this.nodeSize)};var l={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},f=function(t){this.options=b(Object.create(l),t),this.trees=new Array(this.options.maxZoom+1)};function p(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function h(t,e){var n=t.geometry.coordinates,r=n[0],i=n[1];return{x:v(r),y:g(i),zoom:1/0,index:e,parentId:-1}}function d(t){return{type:"Feature",id:t.id,properties:m(t),geometry:{type:"Point",coordinates:[y(t.x),_(t.y)]}}}function m(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return b(b({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function v(t){return t/360+.5}function g(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function y(t){return 360*(t-.5)}function _(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function b(t,e){for(var n in e)t[n]=e[n];return t}function x(t){return t.x}function w(t){return t.y}return f.prototype.load=function(t){var e=this.options,n=e.log,r=e.minZoom,i=e.maxZoom,o=e.nodeSize;n&&console.time("total time");var a="prepare "+t.length+" points";n&&console.time(a),this.points=t;for(var s=[],u=0;u<t.length;u++)t[u].geometry&&s.push(h(t[u],u));this.trees[i+1]=new c(s,x,w,o,Float32Array),n&&console.timeEnd(a);for(var l=i;l>=r;l--){var f=+Date.now();s=this._cluster(s,l),this.trees[l]=new c(s,x,w,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",l,s.length,+Date.now()-f)}return n&&console.timeEnd("total time"),this},f.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],c=u.range(v(n),g(o),v(i),g(r)),l=[],f=0,p=c;f<p.length;f+=1){var h=p[f],m=u.points[h];l.push(m.numPoints?d(m):this.points[m.index])}return l},f.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),u=[],c=0,l=s;c<l.length;c+=1){var f=l[c],p=i.points[f];p.parentId===t&&u.push(p.numPoints?d(p):this.points[p.index])}if(0===u.length)throw new Error(r);return u},f.prototype.getLeaves=function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},f.prototype.getTile=function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options,a=o.extent,s=o.radius,u=s/a,c=(n-u)/i,l=(n+1+u)/i,f={features:[]};return this._addTileFeatures(r.range((e-u)/i,c,(e+1+u)/i,l),r.points,e,n,i,f),0===e&&this._addTileFeatures(r.range(1-u/i,c,1,l),r.points,i,n,i,f),e===i-1&&this._addTileFeatures(r.range(0,c,u/i,l),r.points,-1,n,i,f),f.features.length?f:null},f.prototype.getClusterExpansionZoom=function(t){var e=this._getOriginZoom(t)-1;while(e<=this.options.maxZoom){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},f.prototype._appendLeaves=function(t,e,n,r,i){for(var o=this.getChildren(e),a=0,s=o;a<s.length;a+=1){var u=s[a],c=u.properties;if(c&&c.cluster?i+c.point_count<=r?i+=c.point_count:i=this._appendLeaves(t,c.cluster_id,n,r,i):i<r?i++:t.push(u),t.length===n)break}return i},f.prototype._addTileFeatures=function(t,e,n,r,i,o){for(var a=0,s=t;a<s.length;a+=1){var u=s[a],c=e[u],l=c.numPoints,f={type:1,geometry:[[Math.round(this.options.extent*(c.x*i-n)),Math.round(this.options.extent*(c.y*i-r))]],tags:l?m(c):this.points[c.index].properties},p=void 0;l?p=c.id:this.options.generateId?p=c.index:this.points[c.index].id&&(p=this.points[c.index].id),void 0!==p&&(f.id=p),o.features.push(f)}},f.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},f.prototype._cluster=function(t,e){for(var n=[],r=this.options,i=r.radius,o=r.extent,a=r.reduce,s=r.minPoints,u=i/(o*Math.pow(2,e)),c=0;c<t.length;c++){var l=t[c];if(!(l.zoom<=e)){l.zoom=e;for(var f=this.trees[e+1],h=f.within(l.x,l.y,u),d=l.numPoints||1,m=d,v=0,g=h;v<g.length;v+=1){var y=g[v],_=f.points[y];_.zoom>e&&(m+=_.numPoints||1)}if(m>=s){for(var b=l.x*d,x=l.y*d,w=a&&d>1?this._map(l,!0):null,S=(c<<5)+(e+1)+this.points.length,E=0,T=h;E<T.length;E+=1){var A=T[E],C=f.points[A];if(!(C.zoom<=e)){C.zoom=e;var k=C.numPoints||1;b+=C.x*k,x+=C.y*k,C.parentId=S,a&&(w||(w=this._map(l,!0)),a(w,this._map(C)))}}l.parentId=S,n.push(p(b/m,x/m,S,m,w))}else if(n.push(l),m>1)for(var P=0,M=h;P<M.length;P+=1){var I=M[P],O=f.points[I];O.zoom<=e||(O.zoom=e,n.push(O))}}}return n},f.prototype._getOriginId=function(t){return t-this.points.length>>5},f.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},f.prototype._map=function(t,e){if(t.numPoints)return e?b({},t.properties):t.properties;var n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?b({},r):r},f}))},"n+fv":function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"length",(function(){return a})),n.d(e,"fromValues",(function(){return s})),n.d(e,"copy",(function(){return u})),n.d(e,"set",(function(){return c})),n.d(e,"add",(function(){return l})),n.d(e,"subtract",(function(){return f})),n.d(e,"multiply",(function(){return p})),n.d(e,"divide",(function(){return h})),n.d(e,"ceil",(function(){return d})),n.d(e,"floor",(function(){return m})),n.d(e,"min",(function(){return v})),n.d(e,"max",(function(){return g})),n.d(e,"round",(function(){return y})),n.d(e,"scale",(function(){return _})),n.d(e,"scaleAndAdd",(function(){return b})),n.d(e,"distance",(function(){return x})),n.d(e,"squaredDistance",(function(){return w})),n.d(e,"squaredLength",(function(){return S})),n.d(e,"negate",(function(){return E})),n.d(e,"inverse",(function(){return T})),n.d(e,"normalize",(function(){return A})),n.d(e,"dot",(function(){return C})),n.d(e,"cross",(function(){return k})),n.d(e,"lerp",(function(){return P})),n.d(e,"hermite",(function(){return M})),n.d(e,"bezier",(function(){return I})),n.d(e,"random",(function(){return O})),n.d(e,"transformMat4",(function(){return L})),n.d(e,"transformMat3",(function(){return R})),n.d(e,"transformQuat",(function(){return D})),n.d(e,"rotateX",(function(){return z})),n.d(e,"rotateY",(function(){return j})),n.d(e,"rotateZ",(function(){return N})),n.d(e,"angle",(function(){return F})),n.d(e,"zero",(function(){return B})),n.d(e,"str",(function(){return U})),n.d(e,"exactEquals",(function(){return V})),n.d(e,"equals",(function(){return G})),n.d(e,"sub",(function(){return q})),n.d(e,"mul",(function(){return Z})),n.d(e,"div",(function(){return H})),n.d(e,"dist",(function(){return W})),n.d(e,"sqrDist",(function(){return X})),n.d(e,"len",(function(){return Y})),n.d(e,"sqrLen",(function(){return K})),n.d(e,"forEach",(function(){return J}));var r=n("yU0y");function i(){var t=new r["a"](3);return r["a"]!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=new r["a"](3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function s(t,e,n){var i=new r["a"](3);return i[0]=t,i[1]=e,i[2]=n,i}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function l(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function f(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function p(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function h(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function d(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function m(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function v(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function g(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function y(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function _(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function b(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function x(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function w(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function S(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function E(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function T(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function A(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function C(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function k(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function P(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function M(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*l,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*l,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*l,t}function I(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,f=3*u*a,p=u*o;return t[0]=e[0]*c+n[0]*l+r[0]*f+i[0]*p,t[1]=e[1]*c+n[1]*l+r[1]*f+i[1]*p,t[2]=e[2]*c+n[2]*l+r[2]*f+i[2]*p,t}function O(t,e){e=e||1;var n=2*r["c"]()*Math.PI,i=2*r["c"]()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t}function L(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function R(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function D(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,f=o*s-r*c,p=r*u-i*s,h=i*p-o*f,d=o*l-r*p,m=r*f-i*l,v=2*a;return l*=v,f*=v,p*=v,h*=2,d*=2,m*=2,t[0]=s+l+h,t[1]=u+f+d,t[2]=c+p+m,t}function z(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function j(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function N(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function F(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i),c=Math.sqrt(o*o+a*a+s*s),l=u*c,f=l&&C(t,e)/l;return Math.acos(Math.min(Math.max(f,-1),1))}function B(t){return t[0]=0,t[1]=0,t[2]=0,t}function U(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function V(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function G(t,e){var n=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r["b"]*Math.max(1,Math.abs(o),Math.abs(u))}var q=f,Z=p,H=h,W=x,X=w,Y=a,K=S,J=function(){var t=i();return function(e,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}()},n2J3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(){return function(t,e,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(t,e,n,a)}}e.unmanaged=a},"o+pz":function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t["DEPTH_BUFFER_BIT"]=256]="DEPTH_BUFFER_BIT",t[t["STENCIL_BUFFER_BIT"]=1024]="STENCIL_BUFFER_BIT",t[t["COLOR_BUFFER_BIT"]=16384]="COLOR_BUFFER_BIT",t[t["POINTS"]=0]="POINTS",t[t["LINES"]=1]="LINES",t[t["LINE_LOOP"]=2]="LINE_LOOP",t[t["LINE_STRIP"]=3]="LINE_STRIP",t[t["TRIANGLES"]=4]="TRIANGLES",t[t["TRIANGLE_STRIP"]=5]="TRIANGLE_STRIP",t[t["TRIANGLE_FAN"]=6]="TRIANGLE_FAN",t[t["ZERO"]=0]="ZERO",t[t["ONE"]=1]="ONE",t[t["SRC_COLOR"]=768]="SRC_COLOR",t[t["ONE_MINUS_SRC_COLOR"]=769]="ONE_MINUS_SRC_COLOR",t[t["SRC_ALPHA"]=770]="SRC_ALPHA",t[t["ONE_MINUS_SRC_ALPHA"]=771]="ONE_MINUS_SRC_ALPHA",t[t["DST_ALPHA"]=772]="DST_ALPHA",t[t["ONE_MINUS_DST_ALPHA"]=773]="ONE_MINUS_DST_ALPHA",t[t["DST_COLOR"]=774]="DST_COLOR",t[t["ONE_MINUS_DST_COLOR"]=775]="ONE_MINUS_DST_COLOR",t[t["SRC_ALPHA_SATURATE"]=776]="SRC_ALPHA_SATURATE",t[t["FUNC_ADD"]=32774]="FUNC_ADD",t[t["BLEND_EQUATION"]=32777]="BLEND_EQUATION",t[t["BLEND_EQUATION_RGB"]=32777]="BLEND_EQUATION_RGB",t[t["BLEND_EQUATION_ALPHA"]=34877]="BLEND_EQUATION_ALPHA",t[t["FUNC_SUBTRACT"]=32778]="FUNC_SUBTRACT",t[t["FUNC_REVERSE_SUBTRACT"]=32779]="FUNC_REVERSE_SUBTRACT",t[t["MAX_EXT"]=32776]="MAX_EXT",t[t["MIN_EXT"]=32775]="MIN_EXT",t[t["BLEND_DST_RGB"]=32968]="BLEND_DST_RGB",t[t["BLEND_SRC_RGB"]=32969]="BLEND_SRC_RGB",t[t["BLEND_DST_ALPHA"]=32970]="BLEND_DST_ALPHA",t[t["BLEND_SRC_ALPHA"]=32971]="BLEND_SRC_ALPHA",t[t["CONSTANT_COLOR"]=32769]="CONSTANT_COLOR",t[t["ONE_MINUS_CONSTANT_COLOR"]=32770]="ONE_MINUS_CONSTANT_COLOR",t[t["CONSTANT_ALPHA"]=32771]="CONSTANT_ALPHA",t[t["ONE_MINUS_CONSTANT_ALPHA"]=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t["BLEND_COLOR"]=32773]="BLEND_COLOR",t[t["ARRAY_BUFFER"]=34962]="ARRAY_BUFFER",t[t["ELEMENT_ARRAY_BUFFER"]=34963]="ELEMENT_ARRAY_BUFFER",t[t["ARRAY_BUFFER_BINDING"]=34964]="ARRAY_BUFFER_BINDING",t[t["ELEMENT_ARRAY_BUFFER_BINDING"]=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t["STREAM_DRAW"]=35040]="STREAM_DRAW",t[t["STATIC_DRAW"]=35044]="STATIC_DRAW",t[t["DYNAMIC_DRAW"]=35048]="DYNAMIC_DRAW",t[t["BUFFER_SIZE"]=34660]="BUFFER_SIZE",t[t["BUFFER_USAGE"]=34661]="BUFFER_USAGE",t[t["CURRENT_VERTEX_ATTRIB"]=34342]="CURRENT_VERTEX_ATTRIB",t[t["FRONT"]=1028]="FRONT",t[t["BACK"]=1029]="BACK",t[t["FRONT_AND_BACK"]=1032]="FRONT_AND_BACK",t[t["CULL_FACE"]=2884]="CULL_FACE",t[t["BLEND"]=3042]="BLEND",t[t["DITHER"]=3024]="DITHER",t[t["STENCIL_TEST"]=2960]="STENCIL_TEST",t[t["DEPTH_TEST"]=2929]="DEPTH_TEST",t[t["SCISSOR_TEST"]=3089]="SCISSOR_TEST",t[t["POLYGON_OFFSET_FILL"]=32823]="POLYGON_OFFSET_FILL",t[t["SAMPLE_ALPHA_TO_COVERAGE"]=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t["SAMPLE_COVERAGE"]=32928]="SAMPLE_COVERAGE",t[t["NO_ERROR"]=0]="NO_ERROR",t[t["INVALID_ENUM"]=1280]="INVALID_ENUM",t[t["INVALID_VALUE"]=1281]="INVALID_VALUE",t[t["INVALID_OPERATION"]=1282]="INVALID_OPERATION",t[t["OUT_OF_MEMORY"]=1285]="OUT_OF_MEMORY",t[t["CW"]=2304]="CW",t[t["CCW"]=2305]="CCW",t[t["LINE_WIDTH"]=2849]="LINE_WIDTH",t[t["ALIASED_POINT_SIZE_RANGE"]=33901]="ALIASED_POINT_SIZE_RANGE",t[t["ALIASED_LINE_WIDTH_RANGE"]=33902]="ALIASED_LINE_WIDTH_RANGE",t[t["CULL_FACE_MODE"]=2885]="CULL_FACE_MODE",t[t["FRONT_FACE"]=2886]="FRONT_FACE",t[t["DEPTH_RANGE"]=2928]="DEPTH_RANGE",t[t["DEPTH_WRITEMASK"]=2930]="DEPTH_WRITEMASK",t[t["DEPTH_CLEAR_VALUE"]=2931]="DEPTH_CLEAR_VALUE",t[t["DEPTH_FUNC"]=2932]="DEPTH_FUNC",t[t["STENCIL_CLEAR_VALUE"]=2961]="STENCIL_CLEAR_VALUE",t[t["STENCIL_FUNC"]=2962]="STENCIL_FUNC",t[t["STENCIL_FAIL"]=2964]="STENCIL_FAIL",t[t["STENCIL_PASS_DEPTH_FAIL"]=2965]="STENCIL_PASS_DEPTH_FAIL",t[t["STENCIL_PASS_DEPTH_PASS"]=2966]="STENCIL_PASS_DEPTH_PASS",t[t["STENCIL_REF"]=2967]="STENCIL_REF",t[t["STENCIL_VALUE_MASK"]=2963]="STENCIL_VALUE_MASK",t[t["STENCIL_WRITEMASK"]=2968]="STENCIL_WRITEMASK",t[t["STENCIL_BACK_FUNC"]=34816]="STENCIL_BACK_FUNC",t[t["STENCIL_BACK_FAIL"]=34817]="STENCIL_BACK_FAIL",t[t["STENCIL_BACK_PASS_DEPTH_FAIL"]=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t["STENCIL_BACK_PASS_DEPTH_PASS"]=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t["STENCIL_BACK_REF"]=36003]="STENCIL_BACK_REF",t[t["STENCIL_BACK_VALUE_MASK"]=36004]="STENCIL_BACK_VALUE_MASK",t[t["STENCIL_BACK_WRITEMASK"]=36005]="STENCIL_BACK_WRITEMASK",t[t["VIEWPORT"]=2978]="VIEWPORT",t[t["SCISSOR_BOX"]=3088]="SCISSOR_BOX",t[t["COLOR_CLEAR_VALUE"]=3106]="COLOR_CLEAR_VALUE",t[t["COLOR_WRITEMASK"]=3107]="COLOR_WRITEMASK",t[t["UNPACK_ALIGNMENT"]=3317]="UNPACK_ALIGNMENT",t[t["PACK_ALIGNMENT"]=3333]="PACK_ALIGNMENT",t[t["MAX_TEXTURE_SIZE"]=3379]="MAX_TEXTURE_SIZE",t[t["MAX_VIEWPORT_DIMS"]=3386]="MAX_VIEWPORT_DIMS",t[t["SUBPIXEL_BITS"]=3408]="SUBPIXEL_BITS",t[t["RED_BITS"]=3410]="RED_BITS",t[t["GREEN_BITS"]=3411]="GREEN_BITS",t[t["BLUE_BITS"]=3412]="BLUE_BITS",t[t["ALPHA_BITS"]=3413]="ALPHA_BITS",t[t["DEPTH_BITS"]=3414]="DEPTH_BITS",t[t["STENCIL_BITS"]=3415]="STENCIL_BITS",t[t["POLYGON_OFFSET_UNITS"]=10752]="POLYGON_OFFSET_UNITS",t[t["POLYGON_OFFSET_FACTOR"]=32824]="POLYGON_OFFSET_FACTOR",t[t["TEXTURE_BINDING_2D"]=32873]="TEXTURE_BINDING_2D",t[t["SAMPLE_BUFFERS"]=32936]="SAMPLE_BUFFERS",t[t["SAMPLES"]=32937]="SAMPLES",t[t["SAMPLE_COVERAGE_VALUE"]=32938]="SAMPLE_COVERAGE_VALUE",t[t["SAMPLE_COVERAGE_INVERT"]=32939]="SAMPLE_COVERAGE_INVERT",t[t["COMPRESSED_TEXTURE_FORMATS"]=34467]="COMPRESSED_TEXTURE_FORMATS",t[t["DONT_CARE"]=4352]="DONT_CARE",t[t["FASTEST"]=4353]="FASTEST",t[t["NICEST"]=4354]="NICEST",t[t["GENERATE_MIPMAP_HINT"]=33170]="GENERATE_MIPMAP_HINT",t[t["BYTE"]=5120]="BYTE",t[t["UNSIGNED_BYTE"]=5121]="UNSIGNED_BYTE",t[t["SHORT"]=5122]="SHORT",t[t["UNSIGNED_SHORT"]=5123]="UNSIGNED_SHORT",t[t["INT"]=5124]="INT",t[t["UNSIGNED_INT"]=5125]="UNSIGNED_INT",t[t["FLOAT"]=5126]="FLOAT",t[t["DEPTH_COMPONENT"]=6402]="DEPTH_COMPONENT",t[t["ALPHA"]=6406]="ALPHA",t[t["RGB"]=6407]="RGB",t[t["RGBA"]=6408]="RGBA",t[t["LUMINANCE"]=6409]="LUMINANCE",t[t["LUMINANCE_ALPHA"]=6410]="LUMINANCE_ALPHA",t[t["UNSIGNED_SHORT_4_4_4_4"]=32819]="UNSIGNED_SHORT_4_4_4_4",t[t["UNSIGNED_SHORT_5_5_5_1"]=32820]="UNSIGNED_SHORT_5_5_5_1",t[t["UNSIGNED_SHORT_5_6_5"]=33635]="UNSIGNED_SHORT_5_6_5",t[t["FRAGMENT_SHADER"]=35632]="FRAGMENT_SHADER",t[t["VERTEX_SHADER"]=35633]="VERTEX_SHADER",t[t["MAX_VERTEX_ATTRIBS"]=34921]="MAX_VERTEX_ATTRIBS",t[t["MAX_VERTEX_UNIFORM_VECTORS"]=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t["MAX_VARYING_VECTORS"]=36348]="MAX_VARYING_VECTORS",t[t["MAX_COMBINED_TEXTURE_IMAGE_UNITS"]=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t["MAX_VERTEX_TEXTURE_IMAGE_UNITS"]=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t["MAX_TEXTURE_IMAGE_UNITS"]=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t["MAX_FRAGMENT_UNIFORM_VECTORS"]=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t["SHADER_TYPE"]=35663]="SHADER_TYPE",t[t["DELETE_STATUS"]=35712]="DELETE_STATUS",t[t["LINK_STATUS"]=35714]="LINK_STATUS",t[t["VALIDATE_STATUS"]=35715]="VALIDATE_STATUS",t[t["ATTACHED_SHADERS"]=35717]="ATTACHED_SHADERS",t[t["ACTIVE_UNIFORMS"]=35718]="ACTIVE_UNIFORMS",t[t["ACTIVE_ATTRIBUTES"]=35721]="ACTIVE_ATTRIBUTES",t[t["SHADING_LANGUAGE_VERSION"]=35724]="SHADING_LANGUAGE_VERSION",t[t["CURRENT_PROGRAM"]=35725]="CURRENT_PROGRAM",t[t["NEVER"]=512]="NEVER",t[t["LESS"]=513]="LESS",t[t["EQUAL"]=514]="EQUAL",t[t["LEQUAL"]=515]="LEQUAL",t[t["GREATER"]=516]="GREATER",t[t["NOTEQUAL"]=517]="NOTEQUAL",t[t["GEQUAL"]=518]="GEQUAL",t[t["ALWAYS"]=519]="ALWAYS",t[t["KEEP"]=7680]="KEEP",t[t["REPLACE"]=7681]="REPLACE",t[t["INCR"]=7682]="INCR",t[t["DECR"]=7683]="DECR",t[t["INVERT"]=5386]="INVERT",t[t["INCR_WRAP"]=34055]="INCR_WRAP",t[t["DECR_WRAP"]=34056]="DECR_WRAP",t[t["VENDOR"]=7936]="VENDOR",t[t["RENDERER"]=7937]="RENDERER",t[t["VERSION"]=7938]="VERSION",t[t["NEAREST"]=9728]="NEAREST",t[t["LINEAR"]=9729]="LINEAR",t[t["NEAREST_MIPMAP_NEAREST"]=9984]="NEAREST_MIPMAP_NEAREST",t[t["LINEAR_MIPMAP_NEAREST"]=9985]="LINEAR_MIPMAP_NEAREST",t[t["NEAREST_MIPMAP_LINEAR"]=9986]="NEAREST_MIPMAP_LINEAR",t[t["LINEAR_MIPMAP_LINEAR"]=9987]="LINEAR_MIPMAP_LINEAR",t[t["TEXTURE_MAG_FILTER"]=10240]="TEXTURE_MAG_FILTER",t[t["TEXTURE_MIN_FILTER"]=10241]="TEXTURE_MIN_FILTER",t[t["TEXTURE_WRAP_S"]=10242]="TEXTURE_WRAP_S",t[t["TEXTURE_WRAP_T"]=10243]="TEXTURE_WRAP_T",t[t["TEXTURE_2D"]=3553]="TEXTURE_2D",t[t["TEXTURE"]=5890]="TEXTURE",t[t["TEXTURE_CUBE_MAP"]=34067]="TEXTURE_CUBE_MAP",t[t["TEXTURE_BINDING_CUBE_MAP"]=34068]="TEXTURE_BINDING_CUBE_MAP",t[t["TEXTURE_CUBE_MAP_POSITIVE_X"]=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t["TEXTURE_CUBE_MAP_NEGATIVE_X"]=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t["TEXTURE_CUBE_MAP_POSITIVE_Y"]=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t["TEXTURE_CUBE_MAP_NEGATIVE_Y"]=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t["TEXTURE_CUBE_MAP_POSITIVE_Z"]=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t["TEXTURE_CUBE_MAP_NEGATIVE_Z"]=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t["MAX_CUBE_MAP_TEXTURE_SIZE"]=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t["TEXTURE0"]=33984]="TEXTURE0",t[t["TEXTURE1"]=33985]="TEXTURE1",t[t["TEXTURE2"]=33986]="TEXTURE2",t[t["TEXTURE3"]=33987]="TEXTURE3",t[t["TEXTURE4"]=33988]="TEXTURE4",t[t["TEXTURE5"]=33989]="TEXTURE5",t[t["TEXTURE6"]=33990]="TEXTURE6",t[t["TEXTURE7"]=33991]="TEXTURE7",t[t["TEXTURE8"]=33992]="TEXTURE8",t[t["TEXTURE9"]=33993]="TEXTURE9",t[t["TEXTURE10"]=33994]="TEXTURE10",t[t["TEXTURE11"]=33995]="TEXTURE11",t[t["TEXTURE12"]=33996]="TEXTURE12",t[t["TEXTURE13"]=33997]="TEXTURE13",t[t["TEXTURE14"]=33998]="TEXTURE14",t[t["TEXTURE15"]=33999]="TEXTURE15",t[t["TEXTURE16"]=34e3]="TEXTURE16",t[t["TEXTURE17"]=34001]="TEXTURE17",t[t["TEXTURE18"]=34002]="TEXTURE18",t[t["TEXTURE19"]=34003]="TEXTURE19",t[t["TEXTURE20"]=34004]="TEXTURE20",t[t["TEXTURE21"]=34005]="TEXTURE21",t[t["TEXTURE22"]=34006]="TEXTURE22",t[t["TEXTURE23"]=34007]="TEXTURE23",t[t["TEXTURE24"]=34008]="TEXTURE24",t[t["TEXTURE25"]=34009]="TEXTURE25",t[t["TEXTURE26"]=34010]="TEXTURE26",t[t["TEXTURE27"]=34011]="TEXTURE27",t[t["TEXTURE28"]=34012]="TEXTURE28",t[t["TEXTURE29"]=34013]="TEXTURE29",t[t["TEXTURE30"]=34014]="TEXTURE30",t[t["TEXTURE31"]=34015]="TEXTURE31",t[t["ACTIVE_TEXTURE"]=34016]="ACTIVE_TEXTURE",t[t["REPEAT"]=10497]="REPEAT",t[t["CLAMP_TO_EDGE"]=33071]="CLAMP_TO_EDGE",t[t["MIRRORED_REPEAT"]=33648]="MIRRORED_REPEAT",t[t["FLOAT_VEC2"]=35664]="FLOAT_VEC2",t[t["FLOAT_VEC3"]=35665]="FLOAT_VEC3",t[t["FLOAT_VEC4"]=35666]="FLOAT_VEC4",t[t["INT_VEC2"]=35667]="INT_VEC2",t[t["INT_VEC3"]=35668]="INT_VEC3",t[t["INT_VEC4"]=35669]="INT_VEC4",t[t["BOOL"]=35670]="BOOL",t[t["BOOL_VEC2"]=35671]="BOOL_VEC2",t[t["BOOL_VEC3"]=35672]="BOOL_VEC3",t[t["BOOL_VEC4"]=35673]="BOOL_VEC4",t[t["FLOAT_MAT2"]=35674]="FLOAT_MAT2",t[t["FLOAT_MAT3"]=35675]="FLOAT_MAT3",t[t["FLOAT_MAT4"]=35676]="FLOAT_MAT4",t[t["SAMPLER_2D"]=35678]="SAMPLER_2D",t[t["SAMPLER_CUBE"]=35680]="SAMPLER_CUBE",t[t["VERTEX_ATTRIB_ARRAY_ENABLED"]=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t["VERTEX_ATTRIB_ARRAY_SIZE"]=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t["VERTEX_ATTRIB_ARRAY_STRIDE"]=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t["VERTEX_ATTRIB_ARRAY_TYPE"]=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t["VERTEX_ATTRIB_ARRAY_NORMALIZED"]=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t["VERTEX_ATTRIB_ARRAY_POINTER"]=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t["VERTEX_ATTRIB_ARRAY_BUFFER_BINDING"]=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t["COMPILE_STATUS"]=35713]="COMPILE_STATUS",t[t["LOW_FLOAT"]=36336]="LOW_FLOAT",t[t["MEDIUM_FLOAT"]=36337]="MEDIUM_FLOAT",t[t["HIGH_FLOAT"]=36338]="HIGH_FLOAT",t[t["LOW_INT"]=36339]="LOW_INT",t[t["MEDIUM_INT"]=36340]="MEDIUM_INT",t[t["HIGH_INT"]=36341]="HIGH_INT",t[t["FRAMEBUFFER"]=36160]="FRAMEBUFFER",t[t["RENDERBUFFER"]=36161]="RENDERBUFFER",t[t["RGBA4"]=32854]="RGBA4",t[t["RGB5_A1"]=32855]="RGB5_A1",t[t["RGB565"]=36194]="RGB565",t[t["DEPTH_COMPONENT16"]=33189]="DEPTH_COMPONENT16",t[t["STENCIL_INDEX"]=6401]="STENCIL_INDEX",t[t["STENCIL_INDEX8"]=36168]="STENCIL_INDEX8",t[t["DEPTH_STENCIL"]=34041]="DEPTH_STENCIL",t[t["RENDERBUFFER_WIDTH"]=36162]="RENDERBUFFER_WIDTH",t[t["RENDERBUFFER_HEIGHT"]=36163]="RENDERBUFFER_HEIGHT",t[t["RENDERBUFFER_INTERNAL_FORMAT"]=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t["RENDERBUFFER_RED_SIZE"]=36176]="RENDERBUFFER_RED_SIZE",t[t["RENDERBUFFER_GREEN_SIZE"]=36177]="RENDERBUFFER_GREEN_SIZE",t[t["RENDERBUFFER_BLUE_SIZE"]=36178]="RENDERBUFFER_BLUE_SIZE",t[t["RENDERBUFFER_ALPHA_SIZE"]=36179]="RENDERBUFFER_ALPHA_SIZE",t[t["RENDERBUFFER_DEPTH_SIZE"]=36180]="RENDERBUFFER_DEPTH_SIZE",t[t["RENDERBUFFER_STENCIL_SIZE"]=36181]="RENDERBUFFER_STENCIL_SIZE",t[t["FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE"]=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t["FRAMEBUFFER_ATTACHMENT_OBJECT_NAME"]=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t["FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL"]=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t["FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE"]=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t["COLOR_ATTACHMENT0"]=36064]="COLOR_ATTACHMENT0",t[t["DEPTH_ATTACHMENT"]=36096]="DEPTH_ATTACHMENT",t[t["STENCIL_ATTACHMENT"]=36128]="STENCIL_ATTACHMENT",t[t["DEPTH_STENCIL_ATTACHMENT"]=33306]="DEPTH_STENCIL_ATTACHMENT",t[t["NONE"]=0]="NONE",t[t["FRAMEBUFFER_COMPLETE"]=36053]="FRAMEBUFFER_COMPLETE",t[t["FRAMEBUFFER_INCOMPLETE_ATTACHMENT"]=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t["FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"]=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t["FRAMEBUFFER_INCOMPLETE_DIMENSIONS"]=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t["FRAMEBUFFER_UNSUPPORTED"]=36061]="FRAMEBUFFER_UNSUPPORTED",t[t["FRAMEBUFFER_BINDING"]=36006]="FRAMEBUFFER_BINDING",t[t["RENDERBUFFER_BINDING"]=36007]="RENDERBUFFER_BINDING",t[t["MAX_RENDERBUFFER_SIZE"]=34024]="MAX_RENDERBUFFER_SIZE",t[t["INVALID_FRAMEBUFFER_OPERATION"]=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t["UNPACK_FLIP_Y_WEBGL"]=37440]="UNPACK_FLIP_Y_WEBGL",t[t["UNPACK_PREMULTIPLY_ALPHA_WEBGL"]=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t["CONTEXT_LOST_WEBGL"]=37442]="CONTEXT_LOST_WEBGL",t[t["UNPACK_COLORSPACE_CONVERSION_WEBGL"]=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t["BROWSER_DEFAULT_WEBGL"]=37444]="BROWSER_DEFAULT_WEBGL"}(r||(r={}))},"oCl/":function(t,e,n){var r=n("CH3K"),i=n("LcsW"),o=n("MvSz"),a=n("0ycA"),s=Object.getOwnPropertySymbols,u=s?function(t){var e=[];while(t)r(e,o(t)),t=i(t);return e}:a;t.exports=u},oShl:function(t,e,n){var r=n("Nsbk"),i=n("SksO"),o=n("xfeJ"),a=n("sXyB");function s(e){var n="function"===typeof Map?new Map:void 0;return t.exports=s=function(t){if(null===t||!o(t))return t;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return a(t,arguments,r(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},s(e)}t.exports=s},oaX6:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(t){return function(e,n,a){var s=new i.Metadata(r.NAME_TAG,t);o.tagParameter(e,n,a,s)}}e.targetName=a},"otv/":function(t,e,n){var r=n("nmnc"),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;function a(t){return o?Object(o.call(t)):{}}t.exports=a},"oy+k":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("d9O0"),i=function(){function t(t){this.id=r.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=i},q4HE:function(t,e){var n="\\ud800-\\udfff",r="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",a=r+i+o,s="\\ufe0e\\ufe0f",u="["+n+"]",c="["+a+"]",l="\\ud83c[\\udffb-\\udfff]",f="(?:"+c+"|"+l+")",p="[^"+n+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",d="[\\ud800-\\udbff][\\udc00-\\udfff]",m="\\u200d",v=f+"?",g="["+s+"]?",y="(?:"+m+"(?:"+[p,h,d].join("|")+")"+g+v+")*",_=g+v+y,b="(?:"+[p+c+"?",c,h,d,u].join("|")+")",x=RegExp(l+"(?="+l+")|"+b+_,"g");function w(t){var e=x.lastIndex=0;while(x.test(t))++e;return e}t.exports=w},qK8v:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2");function i(t){return t instanceof RangeError||t.message===r.STACK_OVERFLOW}e.isStackOverflowExeption=i},qRkn:function(t,e,n){var r=n("3cYt"),i={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"},o=r(i);t.exports=o},qd8s:function(t,e,n){(function(t,n){var r=200,i="__lodash_hash_undefined__",o=800,a=16,s=9007199254740991,u="[object Arguments]",c="[object Array]",l="[object AsyncFunction]",f="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",m="[object GeneratorFunction]",v="[object Map]",g="[object Number]",y="[object Null]",_="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",E="[object Undefined]",T="[object WeakMap]",A="[object ArrayBuffer]",C="[object DataView]",k="[object Float32Array]",P="[object Float64Array]",M="[object Int8Array]",I="[object Int16Array]",O="[object Int32Array]",L="[object Uint8Array]",R="[object Uint8ClampedArray]",D="[object Uint16Array]",z="[object Uint32Array]",j=/[\\^$.*+?()[\]{}|]/g,N=/^\[object .+?Constructor\]$/,F=/^(?:0|[1-9]\d*)$/,B={};B[k]=B[P]=B[M]=B[I]=B[O]=B[L]=B[R]=B[D]=B[z]=!0,B[u]=B[c]=B[A]=B[f]=B[C]=B[p]=B[h]=B[d]=B[v]=B[g]=B[_]=B[x]=B[w]=B[S]=B[T]=!1;var U="object"==typeof t&&t&&t.Object===Object&&t,V="object"==typeof self&&self&&self.Object===Object&&self,G=U||V||Function("return this")(),q=e&&!e.nodeType&&e,Z=q&&"object"==typeof n&&n&&!n.nodeType&&n,H=Z&&Z.exports===q,W=H&&U.process,X=function(){try{var t=Z&&Z.require&&Z.require("util").types;return t||W&&W.binding&&W.binding("util")}catch(e){}}(),Y=X&&X.isTypedArray;function K(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function J(t,e){var n=-1,r=Array(t);while(++n<t)r[n]=e(n);return r}function Q(t){return function(e){return t(e)}}function $(t,e){return null==t?void 0:t[e]}function tt(t,e){return function(n){return t(e(n))}}var et=Array.prototype,nt=Function.prototype,rt=Object.prototype,it=G["__core-js_shared__"],ot=nt.toString,at=rt.hasOwnProperty,st=function(){var t=/[^.]+$/.exec(it&&it.keys&&it.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ut=rt.toString,ct=ot.call(Object),lt=RegExp("^"+ot.call(at).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ft=H?G.Buffer:void 0,pt=G.Symbol,ht=G.Uint8Array,dt=ft?ft.allocUnsafe:void 0,mt=tt(Object.getPrototypeOf,Object),vt=Object.create,gt=rt.propertyIsEnumerable,yt=et.splice,_t=pt?pt.toStringTag:void 0,bt=function(){try{var t=be(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),xt=ft?ft.isBuffer:void 0,wt=Math.max,St=Date.now,Et=be(G,"Map"),Tt=be(Object,"create"),At=function(){function t(){}return function(e){if(!Ge(e))return{};if(vt)return vt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function Ct(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function kt(){this.__data__=Tt?Tt(null):{},this.size=0}function Pt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Mt(t){var e=this.__data__;if(Tt){var n=e[t];return n===i?void 0:n}return at.call(e,t)?e[t]:void 0}function It(t){var e=this.__data__;return Tt?void 0!==e[t]:at.call(e,t)}function Ot(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Tt&&void 0===e?i:e,this}function Lt(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function Rt(){this.__data__=[],this.size=0}function Dt(t){var e=this.__data__,n=te(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():yt.call(e,n,1),--this.size,!0}function zt(t){var e=this.__data__,n=te(e,t);return n<0?void 0:e[n][1]}function jt(t){return te(this.__data__,t)>-1}function Nt(t,e){var n=this.__data__,r=te(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function Ft(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function Bt(){this.size=0,this.__data__={hash:new Ct,map:new(Et||Lt),string:new Ct}}function Ut(t){var e=_e(this,t)["delete"](t);return this.size-=e?1:0,e}function Vt(t){return _e(this,t).get(t)}function Gt(t){return _e(this,t).has(t)}function qt(t,e){var n=_e(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Zt(t){var e=this.__data__=new Lt(t);this.size=e.size}function Ht(){this.__data__=new Lt,this.size=0}function Wt(t){var e=this.__data__,n=e["delete"](t);return this.size=e.size,n}function Xt(t){return this.__data__.get(t)}function Yt(t){return this.__data__.has(t)}function Kt(t,e){var n=this.__data__;if(n instanceof Lt){var i=n.__data__;if(!Et||i.length<r-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ft(i)}return n.set(t,e),this.size=n.size,this}function Jt(t,e){var n=je(t),r=!n&&ze(t),i=!n&&!r&&Be(t),o=!n&&!r&&!i&&He(t),a=n||r||i||o,s=a?J(t.length,String):[],u=s.length;for(var c in t)!e&&!at.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Se(c,u))||s.push(c);return s}function Qt(t,e,n){(void 0!==n&&!De(t[e],n)||void 0===n&&!(e in t))&&ee(t,e,n)}function $t(t,e,n){var r=t[e];at.call(t,e)&&De(r,n)&&(void 0!==n||e in t)||ee(t,e,n)}function te(t,e){var n=t.length;while(n--)if(De(t[n][0],e))return n;return-1}function ee(t,e,n){"__proto__"==e&&bt?bt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}Ct.prototype.clear=kt,Ct.prototype["delete"]=Pt,Ct.prototype.get=Mt,Ct.prototype.has=It,Ct.prototype.set=Ot,Lt.prototype.clear=Rt,Lt.prototype["delete"]=Dt,Lt.prototype.get=zt,Lt.prototype.has=jt,Lt.prototype.set=Nt,Ft.prototype.clear=Bt,Ft.prototype["delete"]=Ut,Ft.prototype.get=Vt,Ft.prototype.has=Gt,Ft.prototype.set=qt,Zt.prototype.clear=Ht,Zt.prototype["delete"]=Wt,Zt.prototype.get=Xt,Zt.prototype.has=Yt,Zt.prototype.set=Kt;var ne=ye();function re(t){return null==t?void 0===t?E:y:_t&&_t in Object(t)?xe(t):Pe(t)}function ie(t){return qe(t)&&re(t)==u}function oe(t){if(!Ge(t)||Ae(t))return!1;var e=Ue(t)?lt:N;return e.test(Re(t))}function ae(t){return qe(t)&&Ve(t.length)&&!!B[re(t)]}function se(t){if(!Ge(t))return ke(t);var e=Ce(t),n=[];for(var r in t)("constructor"!=r||!e&&at.call(t,r))&&n.push(r);return n}function ue(t,e,n,r,i){t!==e&&ne(e,(function(o,a){if(i||(i=new Zt),Ge(o))ce(t,e,a,n,ue,r,i);else{var s=r?r(Ie(t,a),o,a+"",t,e,i):void 0;void 0===s&&(s=o),Qt(t,a,s)}}),Xe)}function ce(t,e,n,r,i,o,a){var s=Ie(t,n),u=Ie(e,n),c=a.get(u);if(c)Qt(t,n,c);else{var l=o?o(s,u,n+"",t,e,a):void 0,f=void 0===l;if(f){var p=je(u),h=!p&&Be(u),d=!p&&!h&&He(u);l=u,p||h||d?je(s)?l=s:Fe(s)?l=me(s):h?(f=!1,l=pe(u,!0)):d?(f=!1,l=de(u,!0)):l=[]:Ze(u)||ze(u)?(l=s,ze(s)?l=We(s):Ge(s)&&!Ue(s)||(l=we(u))):f=!1}f&&(a.set(u,l),i(l,u,r,o,a),a["delete"](u)),Qt(t,n,l)}}function le(t,e){return Oe(Me(t,e,Je),t+"")}var fe=bt?function(t,e){return bt(t,"toString",{configurable:!0,enumerable:!1,value:Ke(e),writable:!0})}:Je;function pe(t,e){if(e)return t.slice();var n=t.length,r=dt?dt(n):new t.constructor(n);return t.copy(r),r}function he(t){var e=new t.constructor(t.byteLength);return new ht(e).set(new ht(t)),e}function de(t,e){var n=e?he(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function me(t,e){var n=-1,r=t.length;e||(e=Array(r));while(++n<r)e[n]=t[n];return e}function ve(t,e,n,r){var i=!n;n||(n={});var o=-1,a=e.length;while(++o<a){var s=e[o],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),i?ee(n,s,u):$t(n,s,u)}return n}function ge(t){return le((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&Ee(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);while(++r<i){var s=n[r];s&&t(e,s,r,o)}return e}))}function ye(t){return function(e,n,r){var i=-1,o=Object(e),a=r(e),s=a.length;while(s--){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}function _e(t,e){var n=t.__data__;return Te(e)?n["string"==typeof e?"string":"hash"]:n.map}function be(t,e){var n=$(t,e);return oe(n)?n:void 0}function xe(t){var e=at.call(t,_t),n=t[_t];try{t[_t]=void 0;var r=!0}catch(o){}var i=ut.call(t);return r&&(e?t[_t]=n:delete t[_t]),i}function we(t){return"function"!=typeof t.constructor||Ce(t)?{}:At(mt(t))}function Se(t,e){var n=typeof t;return e=null==e?s:e,!!e&&("number"==n||"symbol"!=n&&F.test(t))&&t>-1&&t%1==0&&t<e}function Ee(t,e,n){if(!Ge(n))return!1;var r=typeof e;return!!("number"==r?Ne(n)&&Se(e,n.length):"string"==r&&e in n)&&De(n[e],t)}function Te(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Ae(t){return!!st&&st in t}function Ce(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||rt;return t===n}function ke(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}function Pe(t){return ut.call(t)}function Me(t,e,n){return e=wt(void 0===e?t.length-1:e,0),function(){var r=arguments,i=-1,o=wt(r.length-e,0),a=Array(o);while(++i<o)a[i]=r[e+i];i=-1;var s=Array(e+1);while(++i<e)s[i]=r[i];return s[e]=n(a),K(t,this,s)}}function Ie(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}var Oe=Le(fe);function Le(t){var e=0,n=0;return function(){var r=St(),i=a-(r-n);if(n=r,i>0){if(++e>=o)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Re(t){if(null!=t){try{return ot.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function De(t,e){return t===e||t!==t&&e!==e}var ze=ie(function(){return arguments}())?ie:function(t){return qe(t)&&at.call(t,"callee")&&!gt.call(t,"callee")},je=Array.isArray;function Ne(t){return null!=t&&Ve(t.length)&&!Ue(t)}function Fe(t){return qe(t)&&Ne(t)}var Be=xt||Qe;function Ue(t){if(!Ge(t))return!1;var e=re(t);return e==d||e==m||e==l||e==b}function Ve(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=s}function Ge(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function qe(t){return null!=t&&"object"==typeof t}function Ze(t){if(!qe(t)||re(t)!=_)return!1;var e=mt(t);if(null===e)return!0;var n=at.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ot.call(n)==ct}var He=Y?Q(Y):ae;function We(t){return ve(t,Xe(t))}function Xe(t){return Ne(t)?Jt(t,!0):se(t)}var Ye=ge((function(t,e,n,r){ue(t,e,n,r)}));function Ke(t){return function(){return t}}function Je(t){return t}function Qe(){return!1}n.exports=Ye}).call(this,n("yLpj"),n("YuTi")(t))},qxNg:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("lSNA"),i=n.n(r),o=n("mpbz"),a=n.n(o);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){var n=e.radius,r=void 0===n?40:n,i=e.maxZoom,o=void 0===i?18:i,s=e.minZoom,c=void 0===s?0:s,f=e.zoom,p=void 0===f?2:f;if(t.pointIndex){var h=t.pointIndex.getClusters(t.extent,Math.floor(p));return t.dataArray=l(h),t}var d=new a.a({radius:r,minZoom:c,maxZoom:o}),m={type:"FeatureCollection",features:[]};return m.features=t.dataArray.map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t.coordinates},properties:u({},t)}})),d.load(m.features),d}function l(t){return t.map((function(t,e){return u({coordinates:t.geometry.coordinates,_id:e+1},t.properties)}))}},riiI:function(t,e){},rlAn:function(t,e,n){"use strict";var r=n("ISu3"),i=n("gMG2"),o=n("5gLl"),a=n("BpBL"),s=n("5zYK"),u=n("lJbI"),c=n("l94r"),l=n("qxNg"),f=n("Y8BV"),p=n("VIsB"),h=n("+VLl"),d=n("aF1E"),m=n("fdMe");n.d(e,"getTransform",(function(){return r["b"]})),n.d(e,"getParser",(function(){return r["a"]}));n("U1ZX");e["default"]=c["a"],Object(r["c"])("geojson",o["a"]),Object(r["c"])("image",a["a"]),Object(r["c"])("csv",i["a"]),Object(r["c"])("json",s["a"]),Object(r["c"])("raster",u["a"]),Object(r["d"])("cluster",l["a"]),Object(r["d"])("filter",f["a"]),Object(r["d"])("join",d["a"]),Object(r["d"])("map",m["a"]),Object(r["d"])("grid",p["a"]),Object(r["d"])("hexagon",h["a"])},rxlC:function(t,e,n){"use strict";t.exports=i,t.exports.default=i;var r=1e20;function i(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,n,r,i,o,s){for(var u=0;u<e;u++){for(var c=0;c<n;c++)r[c]=t[c*e+u];for(a(r,i,o,s,n),c=0;c<n;c++)t[c*e+u]=i[c]}for(c=0;c<n;c++){for(u=0;u<e;u++)r[u]=t[c*e+u];for(a(r,i,o,s,e),u=0;u<e;u++)t[c*e+u]=Math.sqrt(i[u])}}function a(t,e,n,i,o){n[0]=0,i[0]=-r,i[1]=+r;for(var a=1,s=0;a<o;a++){var u=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);while(u<=i[s])s--,u=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);s++,n[s]=a,i[s]=u,i[s+1]=+r}for(a=0,s=0;a<o;a++){while(i[s+1]<a)s++;e[a]=(a-n[s])*(a-n[s])+t[n[s]]}}i.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var a=e.data[4*i+3]/255;this.gridOuter[i]=1===a?0:0===a?r:Math.pow(Math.max(0,.5-a),2),this.gridInner[i]=1===a?r:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var s=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return n}},sGsY:function(t,e,n){"use strict";var r=n("lSNA"),i=n.n(r),o=n("pVnL"),a=n.n(o),s=n("q1tI"),u=n("TSYQ"),c=n.n(u),l=n("H84U"),f=n("B6l+"),p=n.n(f),h=function(t){var e,n=t.value,r=t.formatter,i=t.precision,o=t.decimalSeparator,a=t.groupSeparator,u=void 0===a?"":a,c=t.prefixCls;if("function"===typeof r)e=r(n);else{var l=String(n),f=l.match(/^(-?)(\d*)(\.(\d+))?$/);if(f&&"-"!==l){var h=f[1],d=f[2]||"0",m=f[4]||"";d=d.replace(/\B(?=(\d{3})+(?!\d))/g,u),"number"===typeof i&&(m=p()(m,i,"0").slice(0,i)),m&&(m="".concat(o).concat(m)),e=[s["createElement"]("span",{key:"int",className:"".concat(c,"-content-value-int")},h,d),m&&s["createElement"]("span",{key:"decimal",className:"".concat(c,"-content-value-decimal")},m)]}else e=l}return s["createElement"]("span",{className:"".concat(c,"-content-value")},e)},d=h,m=function(t){var e=t.prefixCls,n=t.className,r=t.style,o=t.valueStyle,u=t.value,l=void 0===u?0:u,f=t.title,p=t.valueRender,h=t.prefix,m=t.suffix,v=t.direction,g=t.onMouseEnter,y=t.onMouseLeave,_=s["createElement"](d,a()({},t,{value:l})),b=c()(e,n,i()({},"".concat(e,"-rtl"),"rtl"===v));return s["createElement"]("div",{className:b,style:r,onMouseEnter:g,onMouseLeave:y},f&&s["createElement"]("div",{className:"".concat(e,"-title")},f),s["createElement"]("div",{style:o,className:"".concat(e,"-content")},h&&s["createElement"]("span",{className:"".concat(e,"-content-prefix")},h),p?p(_):_,m&&s["createElement"]("span",{className:"".concat(e,"-content-suffix")},m)))};m.defaultProps={decimalSeparator:".",groupSeparator:","};var v=Object(l["c"])({prefixCls:"statistic"})(m),g=v,y=n("lwsE"),_=n.n(y),b=n("W8MJ"),x=n.n(b),w=n("7W2i"),S=n.n(w),E=n("LQ03"),T=n.n(E),A=n("J4zp"),C=n.n(A),k=n("QQZ/"),P=n.n(k),M=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function I(t,e){var n=t,r=/\[[^\]]*]/g,i=(e.match(r)||[]).map((function(t){return t.slice(1,-1)})),o=e.replace(r,"[]"),a=M.reduce((function(t,e){var r=C()(e,2),i=r[0],o=r[1];if(-1!==t.indexOf(i)){var a=Math.floor(n/o);return n-=a*o,t.replace(new RegExp("".concat(i,"+"),"g"),(function(t){var e=t.length;return P()(a.toString(),e,"0")}))}return t}),o),s=0;return a.replace(r,(function(){var t=i[s];return s+=1,t}))}function O(t,e){var n=e.format,r=void 0===n?"":n,i=new Date(t).getTime(),o=Date.now(),a=Math.max(i-o,0);return I(a,r)}var L=n("0n0R"),R=1e3/30;function D(t){return new Date(t).getTime()}var z=function(t){S()(n,t);var e=T()(n);function n(){var t;return _()(this,n),t=e.apply(this,arguments),t.syncTimer=function(){var e=t.props.value,n=D(e);n>=Date.now()?t.startTimer():t.stopTimer()},t.startTimer=function(){t.countdownId||(t.countdownId=window.setInterval((function(){t.forceUpdate()}),R))},t.stopTimer=function(){var e=t.props,n=e.onFinish,r=e.value;if(t.countdownId){clearInterval(t.countdownId),t.countdownId=void 0;var i=D(r);n&&i<Date.now()&&n()}},t.formatCountdown=function(e,n){var r=t.props.format;return O(e,a()(a()({},n),{format:r}))},t.valueRender=function(t){return Object(L["a"])(t,{title:void 0})},t}return x()(n,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return s["createElement"](g,a()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),n}(s["Component"]);z.defaultProps={format:"HH:mm:ss"};var j=z;g.Countdown=j;e["a"]=g},sKgW:function(t,e){var n=9007199254740991,r=Math.floor;function i(t,e){var i="";if(!t||e<1||e>n)return i;do{e%2&&(i+=t),e=r(e/2),e&&(t+=t)}while(e);return i}t.exports=i},sXyB:function(t,e,n){var r=n("SksO"),i=n("b48C");function o(e,n,a){return i()?t.exports=o=Reflect.construct:t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=Function.bind.apply(t,i),a=new o;return n&&r(a,n.prototype),a},o.apply(null,arguments)}t.exports=o},sgoq:function(t,e,n){var r=n("asDA"),i=n("TKrE"),o=n("6nK8"),a="['\u2019]",s=RegExp(a,"g");function u(t){return function(e){return r(o(i(e).replace(s,"")),t,"")}}t.exports=u},sxDa:function(t,e,n){"use strict";n.d(e,"e",(function(){return Rr})),n.d(e,"f",(function(){return Yr})),n.d(e,"d",(function(){return Ln})),n.d(e,"a",(function(){return me})),n.d(e,"c",(function(){return rn})),n.d(e,"g",(function(){return hi})),n.d(e,"b",(function(){return We}));var r,i,o,a,s,u,c=n("h1nZ"),l=n("lwsE"),f=n.n(l),p=n("W8MJ"),h=n.n(p),d=n("7W2i"),m=n.n(d),v=n("a1gu"),g=n.n(v),y=n("Nsbk"),_=n.n(y),b=n("QILm"),x=n.n(b),w=n("lSNA"),S=n.n(w),E=n("yG8O"),T=n.n(E),A=n("PJYZ"),C=n.n(A),k=n("U+yc"),P=n.n(k),M=(n("1ABj"),n("GoyQ")),I=n.n(M),O=n("lSCD"),L=n.n(O),R=n("xp6e"),D=n("Hel2"),z=n("uhBA"),j=n("4U9+"),N=n.n(j),F=n("4cb6");function B(t){return t.map((function(t){return"string"===typeof t&&(t=[t,{}]),t}))}var U,V,G,q,Z,H,W,X,Y,K=(r=Object(F["injectable"])(),i=Object(F["inject"])(c["TYPES"].IGlobalConfigService),r((u=function(){function t(){f()(this,t),T()(this,"configService",s,this),this.enabled=void 0}return h()(t,[{key:"apply",value:function(t,e){var n=this,r=(e.rendererService,e.postProcessingPassFactory),i=e.normalPassFactory;t.hooks.init.tap("MultiPassRendererPlugin",(function(){var e=t.getLayerConfig(),o=e.enableMultiPassRenderer,a=e.passes,s=void 0===a?[]:a;n.enabled=!!o&&!1!==t.getLayerConfig().enableMultiPassRenderer,n.enabled&&(t.multiPassRenderer=n.createMultiPassRenderer(t,s,r,i),t.multiPassRenderer.setRenderFlag(!0))})),t.hooks.beforeRender.tap("MultiPassRendererPlugin",(function(){}))}},{key:"createMultiPassRenderer",value:function(t,e,n,r){var i=t.multiPassRenderer,o=t.getLayerConfig(),a=o.enablePicking;o.enableTAA;return a&&i.add(r("pixelPicking")),i}}]),t}(),a=u,s=P()(a.prototype,"configService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=a))||o),J=(U={},S()(U,c["BlendType"].additive,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE,srcAlpha:1,dstAlpha:1}}),S()(U,c["BlendType"].normal,{enable:!0,func:{srcRGB:c["gl"].SRC_ALPHA,dstRGB:c["gl"].ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),S()(U,c["BlendType"].subtractive,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE,srcAlpha:c["gl"].ZERO,dstAlpha:c["gl"].ONE_MINUS_SRC_COLOR},equation:{rgb:c["gl"].FUNC_SUBTRACT,alpha:c["gl"].FUNC_SUBTRACT}}),S()(U,c["BlendType"].max,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE},equation:{rgb:c["gl"].MAX_EXT}}),S()(U,c["BlendType"].min,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE},equation:{rgb:c["gl"].MIN_EXT}}),U),Q={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}};function $(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=tt(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function tt(t,e){if(t){if("string"===typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function it(t){var e=ot();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function ot(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var at,st,ut,ct,lt,ft,pt=0,ht=(V=Object(c["lazyInject"])(c["TYPES"].ILogService),G=Object(c["lazyInject"])(c["TYPES"].IGlobalConfigService),q=Object(c["lazyInject"])(c["TYPES"].IShaderModuleService),Y=function(t){m()(n,t);var e=it(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f()(this,n),t=e.call(this),t.id="".concat(pt++),t.name="".concat(pt),t.type=void 0,t.visible=!0,t.zIndex=0,t.minZoom=void 0,t.maxZoom=void 0,t.inited=!1,t.layerModelNeedUpdate=!1,t.pickedFeatureID=null,t.selectedFeatureID=null,t.styleNeedUpdate=!1,t.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},t.hooks={init:new R["b"],afterInit:new R["b"],beforeRender:new R["b"],beforeRenderData:new R["d"],afterRender:new R["c"],beforePickingEncode:new R["c"],afterPickingEncode:new R["c"],beforeHighlight:new R["c"](["pickedColor"]),afterHighlight:new R["c"],beforeSelect:new R["c"](["pickedColor"]),afterSelect:new R["c"],beforeDestroy:new R["c"],afterDestroy:new R["c"]},t.models=[],t.multiPassRenderer=void 0,t.plugins=void 0,t.sourceOption=void 0,t.layerModel=void 0,T()(t,"logger",H,C()(t)),T()(t,"configService",W,C()(t)),T()(t,"shaderModuleService",X,C()(t)),t.cameraService=void 0,t.coordinateService=void 0,t.iconService=void 0,t.fontService=void 0,t.rendererService=void 0,t.layerService=void 0,t.interactionService=void 0,t.mapService=void 0,t.styleAttributeService=void 0,t.layerSource=void 0,t.postProcessingPassFactory=void 0,t.normalPassFactory=void 0,t.animateOptions={enable:!1},t.container=void 0,t.encodedData=void 0,t.configSchema=void 0,t.currentPickId=null,t.rawConfig=void 0,t.needUpdateConfig=void 0,t.pendingStyleAttributes=[],t.scaleOptions={},t.animateStartTime=void 0,t.aniamateStatus=!1,t.sourceEvent=function(){t.dataState.dataSourceNeedUpdate=!0;var e=t.getLayerConfig(),n=e.autoFit,r=e.fitBoundsOptions;n&&t.fitBounds(r),t.emit("dataUpdate"),t.reRender()},t.name=r.name||t.id,t.zIndex=r.zIndex||0,t.rawConfig=r,t}return h()(n,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(t){if(this.inited){var e=this.container.get(c["TYPES"].SceneID);this.configService.setLayerConfig(e,this.id,rt(rt(rt({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),t)),this.needUpdateConfig={}}else this.needUpdateConfig=rt(rt({},this.needUpdateConfig),t)}},{key:"setContainer",value:function(t){this.container=t}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(t){return this.plugins.push(t),this}},{key:"init",value:function(){var t=this,e=this.container.get(c["TYPES"].SceneID),n=this.rawConfig.enableMultiPassRenderer,r=void 0!==n&&n;this.configService.setLayerConfig(e,this.id,{enableMultiPassRenderer:r}),this.iconService=this.container.get(c["TYPES"].IIconService),this.fontService=this.container.get(c["TYPES"].IFontService),this.rendererService=this.container.get(c["TYPES"].IRendererService),this.layerService=this.container.get(c["TYPES"].ILayerService),this.interactionService=this.container.get(c["TYPES"].IInteractionService),this.mapService=this.container.get(c["TYPES"].IMapService),this.cameraService=this.container.get(c["TYPES"].ICameraService),this.coordinateService=this.container.get(c["TYPES"].ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(c["TYPES"].IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(c["TYPES"].IFactoryNormalPass),this.styleAttributeService=this.container.get(c["TYPES"].IStyleAttributeService),this.multiPassRenderer=this.container.get(c["TYPES"].IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach((function(e){var n=e.attributeName,r=e.attributeField,i=e.attributeValues,o=e.updateOptions;t.styleAttributeService.updateStyleAttribute(n,{scale:rt({field:r},t.splitValuesAndCallbackInAttribute(i,t.getLayerConfig()[n]))},o)})),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(c["TYPES"].ILayerPlugin);var i,o=$(this.plugins);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(s){o.e(s)}finally{o.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(rt(rt({},this.getDefaultConfig()),this.rawConfig));var t=this.getLayerConfig(),e=t.animateOption;(null===e||void 0===e?void 0:e.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(t,e,n){return this.updateStyleAttribute("color",t,e,n),this}},{key:"size",value:function(t,e,n){return this.updateStyleAttribute("size",t,e,n),this}},{key:"filter",value:function(t,e,n){return this.updateStyleAttribute("filter",t,e,n),this}},{key:"shape",value:function(t,e,n){return this.updateStyleAttribute("shape",t,e,n),this}},{key:"label",value:function(t,e,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:t,attributeValues:e,updateOptions:n}),this}},{key:"animate",value:function(t){var e={};return I()(t)?(e.enable=!0,e=rt(rt({},e),t)):e.enable=t,this.updateLayerConfig({animateOption:e}),this}},{key:"source",value:function(t,e){return this.sourceOption={data:t,options:e},this}},{key:"setData",value:function(t,e){var n=this;return this.inited?this.layerSource.setData(t,e):this.on("inited",(function(){n.layerSource.setData(t,e)})),this}},{key:"style",value:function(t){var e=this,n=t.passes,r=x()(t,["passes"]);return n&&B(n).forEach((function(t){var n=e.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(t[0]);n&&n.updateOptions(t[1])})),this.rawConfig=rt(rt({},this.rawConfig),r),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(t,e){return I()(t)?this.scaleOptions=rt(rt({},this.scaleOptions),t):this.scaleOptions[t]=e,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(t){var e={};return e.enableHighlight=!!I()(t)||t,I()(t)?(e.enableHighlight=!0,t.color&&(e.highlightColor=t.color)):e.enableHighlight=!!t,this.updateLayerConfig(e),this}},{key:"setActive",value:function(t,e){var n=this;if(I()(t)){var r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o;this.updateLayerConfig({highlightColor:I()(e)?e.color:this.getLayerConfig().highlightColor}),this.pick({x:i,y:a})}else this.updateLayerConfig({pickedFeatureID:t,highlightColor:I()(e)?e.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(D["k"])(t)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"select",value:function(t){var e={};return e.enableSelect=!!I()(t)||t,I()(t)?(e.enableSelect=!0,t.color&&(e.selectColor=t.color)):e.enableSelect=!!t,this.updateLayerConfig(e),this}},{key:"setSelect",value:function(t,e){var n=this;if(I()(t)){var r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o;this.updateLayerConfig({selectColor:I()(e)?e.color:this.getLayerConfig().selectColor}),this.pick({x:i,y:a})}else this.updateLayerConfig({pickedFeatureID:t,selectColor:I()(e)?e.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(D["k"])(t)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"setBlend",value:function(t){this.updateLayerConfig({blend:t}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(t){return this.zIndex=t,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(t){this.currentPickId=t}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(t){this.selectedFeatureID=t}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var t=this.mapService.getZoom(),e=this.getLayerConfig(),n=e.visible,r=e.minZoom,i=void 0===r?-1/0:r,o=e.maxZoom,a=void 0===o?1/0:o;return!!n&&t>=i&&t<=a}},{key:"setMinZoom",value:function(t){return this.updateLayerConfig({minZoom:t}),this}},{key:"getMinZoom",value:function(){var t=this.getLayerConfig(),e=t.minZoom;return e}},{key:"getMaxZoom",value:function(){var t=this.getLayerConfig(),e=t.maxZoom;return e}},{key:"get",value:function(t){var e=this.getLayerConfig();return e[t]}},{key:"setMaxZoom",value:function(t){return this.updateLayerConfig({maxZoom:t}),this}},{key:"fitBounds",value:function(t){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var e=this.getSource(),n=e.extent,r=n.some((function(t){return Math.abs(t)===1/0}));return r||this.mapService.fitBounds([[n[0],n[1]],[n[2],n[3]]],t),this}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach((function(t){return t.destroy()})),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter((function(t){return t.needRescale||t.needRemapping||t.needRegenerateVertices})).length}},{key:"setSource",value:function(t){this.layerSource=t;var e=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(e),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(t){this.encodedData=t}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=N()([Q,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(t){var e=this.styleAttributeService.getLayerAttributeScale(t);if(!e)return[];if(e.ticks){var n=e.ticks().map((function(n){return S()({value:n},t,e(n))}));return n}if(e.invertExtent){var r=e.range().map((function(n){return S()({value:e.invertExtent(n)},t,n)}));return r}}},{key:"pick",value:function(t){var e=t.x,n=t.y;this.interactionService.triggerHover({x:e,y:n})}},{key:"buildLayerModel",value:function(t){var e=t.moduleName,n=t.vertexShader,r=t.fragmentShader,i=t.triangulation,o=x()(t,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(e,{vs:n,fs:r});var a=this.shaderModuleService.getModule(e),s=a.vs,u=a.fs,l=a.uniforms,f=this.rendererService.createModel,p=this.styleAttributeService.createAttributesAndIndices(this.encodedData,i),h=p.attributes,d=p.elements;return f(rt({attributes:h,uniforms:l,fs:u,vs:s,elements:d,blend:J[c["BlendType"].normal]},o))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(t){var e=this.getLayerConfig(),n=e.enableHighlight,r=void 0===n||n,i=e.enableSelect,o=void 0===i||i,a=-1!==this.eventNames().indexOf(t)||-1!==this.eventNames().indexOf("un"+t);return"click"!==t&&"dblclick"!==t||!o||(a=!0),"mousemove"!==t||!r&&-1===this.eventNames().indexOf("mouseenter")&&-1===this.eventNames().indexOf("unmousemove")&&-1===this.eventNames().indexOf("mouseout")||(a=!0),this.isVisible()&&a}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var t=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach((function(e){e.draw({uniforms:t.layerModel.getUninforms()})})),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(t,e){return{values:L()(t)?void 0:t||e,callback:L()(t)?t:void 0}}},{key:"updateStyleAttribute",value:function(t,e,n,r){this.inited?this.styleAttributeService.updateStyleAttribute(t,{scale:rt({field:e},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[e]))},r):this.pendingStyleAttributes.push({attributeName:t,attributeField:e,attributeValues:n,updateOptions:r})}}]),n}(z["EventEmitter"]),Z=Y,H=P()(Z.prototype,"logger",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=P()(Z.prototype,"configService",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=P()(Z.prototype,"shaderModuleService",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z),dt=(at=Object(c["lazyInject"])(c["TYPES"].IGlobalConfigService),st=Object(c["lazyInject"])(c["TYPES"].IShaderModuleService),ft=function(){function t(e){f()(this,t),this.triangulation=void 0,this.layer=void 0,T()(this,"configService",ct,this),T()(this,"shaderModuleService",lt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=e,this.rendererService=e.getContainer().get(c["TYPES"].IRendererService),this.styleAttributeService=e.getContainer().get(c["TYPES"].IStyleAttributeService),this.mapService=e.getContainer().get(c["TYPES"].IMapService),this.iconService=e.getContainer().get(c["TYPES"].IIconService),this.fontService=e.getContainer().get(c["TYPES"].IFontService),this.cameraService=e.getContainer().get(c["TYPES"].ICameraService),this.layerService=e.getContainer().get(c["TYPES"].ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return h()(t,[{key:"getBlend",value:function(){var t=this.layer.getLayerConfig(),e=t.blend,n=void 0===e?"normal":e;return J[c["BlendType"][n]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption;e.enable&&this.layer.setAnimateStartTime()}}]),t}(),ut=ft,ct=P()(ut.prototype,"configService",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=P()(ut.prototype,"shaderModuleService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut),mt=n("J4zp"),vt=n.n(mt),gt=n("RIqP"),yt=n.n(gt),_t=n("VmRL"),bt=n.n(_t),xt=n("IOcx"),wt=xt["b"].create(),St=(xt["b"].create(),xt["b"].create()),Et=xt["b"].create(),Tt=xt["b"].create();function At(t,e,n,r,i){xt["b"].add(t,n,r),xt["b"].normalize(t,t),e=xt["b"].fromValues(-t[1],t[0]);var o=xt["b"].fromValues(-n[1],n[0]);return[i/xt["b"].dot(e,o),e]}function Ct(t,e){return xt["b"].set(t,-e[1],e[0])}function kt(t,e,n){return xt["b"].sub(t,e,n),xt["b"].normalize(t,t),t}function Pt(t,e){return t[0]===e[0]&&t[1]===e[1]}var Mt,It,Ot,Lt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f()(this,t),this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=xt["b"].fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1}return h()(t,[{key:"extrude",value:function(t){var e={positions:[],indices:[],normals:[]};if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,r=1,i=0;r<n;r++){var o=t[r-1],a=t[r],s=r<t.length-1?t[r+1]:null;if(!Pt(o,a)){var u=this.segment(e,i,o,a,s);i+=u}}if(this.dash)for(var c=0;c<e.positions.length/6;c++)e.positions[6*c+5]=this.totalDistance;return e}},{key:"segment",value:function(t,e,n,r,i){var o=0,a=t.indices,s=t.positions,u=t.normals,c="square"===this.cap,l="bevel"===this.join,f=Object(D["d"])([r[0],r[1]]),p=Object(D["d"])([n[0],n[1]]);kt(St,f,p);var h=0;if(this.dash&&(h=this.lineSegmentDistance(f,p),this.totalDistance+=h),this.normal||(this.normal=xt["b"].create(),Ct(this.normal,St)),!this.started)if(this.started=!0,c){var d=xt["b"].create(),m=xt["b"].create();xt["b"].add(d,this.normal,St),xt["b"].add(m,this.normal,St),u.push(m[0],m[1],0),u.push(d[0],d[1],0),s.push(n[0],n[1],0,this.totalDistance-h,-this.thickness,0),s.push(n[0],n[1],0,this.totalDistance-h,this.thickness,0)}else this.extrusions(s,u,n,this.normal,this.thickness,this.totalDistance-h);if(a.push(e+0,e+1,e+2),i){var v=Object(D["d"])([i[0],i[1]]);Pt(f,v)&&xt["b"].add(v,f,xt["b"].normalize(v,xt["b"].subtract(v,f,p))),kt(Et,v,f);var g=At(Tt,xt["b"].create(),St,Et,this.thickness),y=vt()(g,2),_=y[0],b=y[1],x=xt["b"].dot(Tt,this.normal)<0?-1:1,w=l;if(!w&&"miter"===this.join){var S=_;S>this.miterLimit&&(w=!0)}w?(u.push(this.normal[0],this.normal[1],0),u.push(b[0],b[1],0),s.push(r[0],r[1],0,this.totalDistance,-this.thickness*x,0),s.push(r[0],r[1],0,this.totalDistance,this.thickness*x,0),a.push.apply(a,yt()(this.lastFlip!==-x?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),Ct(wt,Et),xt["b"].copy(this.normal,wt),u.push(this.normal[0],this.normal[1],0),s.push(r[0],r[1],0,this.totalDistance,-this.thickness*x,0),o+=3):(this.extrusions(s,u,r,b,_,this.totalDistance),a.push.apply(a,yt()(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),x=-1,xt["b"].copy(this.normal,b),o+=2),this.lastFlip=x}else{if(Ct(this.normal,St),c){var E=xt["b"].create(),T=xt["b"].create();xt["b"].sub(T,St,this.normal),xt["b"].add(E,St,this.normal),u.push(T[0],T[1],0),u.push(E[0],E[1],0),s.push(r[0],r[1],0,this.totalDistance,this.thickness,0),s.push(r[0],r[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(s,u,r,this.normal,this.thickness,this.totalDistance);a.push.apply(a,yt()(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),o+=2}return o}},{key:"extrusions",value:function(t,e,n,r,i,o){e.push(r[0],r[1],0),e.push(r[0],r[1],0),t.push(n[0],n[1],0,o,-i,0),t.push(n[0],n[1],0,o,i,0)}},{key:"lineSegmentDistance",value:function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}}]),t}(),Rt=n("UB5X"),Dt=n.n(Rt);function zt(t){if(Dt()(t[0]))return t;if(Dt()(t[0][0]))throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8");if(Dt()(t[0][0][0])){var e=t,n=0,r=0,i=0;return e.forEach((function(t){t.forEach((function(t){n+=t[0],r+=t[1],i++}))})),[n/i,r/i,0]}throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8")}function jt(t){var e=t[0][0],n=t[0][t[0].length-1];e[0]===n[0]&&e[1]===n[1]&&(t[0]=t[0].slice(0,t[0].length-1));for(var r=t[0].length,i=bt.a.flatten(t),o=i.vertices,a=i.dimensions,s=[],u=[],c=0;c<o.length/a;c++)2===a?s.push(o[2*c],o[2*c+1],1):s.push(o[3*c],o[3*c+1],1);var l=bt()(i.vertices,i.holes,i.dimensions);u.push.apply(u,yt()(l));for(var f=function(t){var e=i.vertices.slice(t*a,(t+1)*a),n=i.vertices.slice((t+1)*a,(t+2)*a);0===n.length&&(n=i.vertices.slice(0,a));var r=s.length/3;s.push(e[0],e[1],1,n[0],n[1],1,e[0],e[1],0,n[0],n[1],0),u.push.apply(u,yt()([0,2,1,2,3,1].map((function(t){return t+r}))))},p=0;p<r;p++)f(p);return{positions:s,index:u}}function Nt(t){var e=bt.a.flatten(t),n=bt()(e.vertices,e.holes,e.dimensions);return{positions:e.vertices,index:n}}function Ft(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t[0][0],r=t[0][t[0].length-1];n[0]===r[0]&&n[1]===r[1]&&(t[0]=t[0].slice(0,t[0].length-1));for(var i=t[0].length,o=bt.a.flatten(t),a=o.vertices,s=o.dimensions,u=[],c=[],l=[],f=0;f<a.length/s;f++)2===s?u.push(a[2*f],a[2*f+1],1,-1,-1):u.push(a[3*f],a[3*f+1],1,-1,-1),l.push(0,0,1);var p=bt()(o.vertices,o.holes,o.dimensions);c.push.apply(c,yt()(p));for(var h=function(t){var n=o.vertices.slice(t*s,(t+1)*s),r=o.vertices.slice((t+1)*s,(t+2)*s);0===r.length&&(r=o.vertices.slice(0,s));var i=u.length/5;u.push(n[0],n[1],1,0,0,r[0],r[1],1,.1,0,n[0],n[1],0,0,.8,r[0],r[1],0,.1,.8);var a=Bt([r[0],r[1],1],[n[0],n[1],0],[n[0],n[1],1],e);l.push.apply(l,yt()(a).concat(yt()(a),yt()(a),yt()(a))),c.push.apply(c,yt()([1,2,0,3,2,1].map((function(t){return t+i}))))},d=0;d<i;d++)h(d);return{positions:u,index:c,normals:l}}function Bt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=xt["c"].create(),o=xt["c"].create(),a=xt["c"].create();r&&(t=Object(D["o"])(t),e=Object(D["o"])(e),n=Object(D["o"])(n));var s=xt["c"].fromValues.apply(xt["c"],yt()(t)),u=xt["c"].fromValues.apply(xt["c"],yt()(e)),c=xt["c"].fromValues.apply(xt["c"],yt()(n));xt["c"].sub(i,c,u),xt["c"].sub(o,s,u),xt["c"].cross(a,i,o);var l=xt["c"].create();return xt["c"].normalize(l,a),l}function Ut(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2*Math.PI/t,r=[],i=0;i<t;i++)r.push(n*i+e*Math.PI/12);var o=r.map((function(t){var e=Math.sin(t+Math.PI/4),n=Math.cos(t+Math.PI/4);return[e,n,0]}));return o}function Vt(){return Ut(30)}function Gt(){return Ut(4)}function qt(){return Ut(3)}function Zt(){return Ut(6,1)}function Ht(){return Ut(5)}(function(t){t["CYLINDER"]="cylinder",t["SQUARECOLUMN"]="squareColumn",t["TRIANGLECOLUMN"]="triangleColumn",t["HEXAGONCOLUMN"]="hexagonColumn",t["PENTAGONCOLUMN"]="pentagonColumn"})(It||(It={})),function(t){t["CIRCLE"]="circle",t["SQUARE"]="square",t["TRIANGLE"]="triangle",t["HEXAGON"]="hexagon",t["PENTAGON"]="pentagon"}(Ot||(Ot={}));var Wt=(Mt={},S()(Mt,Ot.CIRCLE,Vt),S()(Mt,Ot.HEXAGON,Zt),S()(Mt,Ot.TRIANGLE,qt),S()(Mt,Ot.SQUARE,Gt),S()(Mt,Ot.PENTAGON,Ht),S()(Mt,It.CYLINDER,Vt),S()(Mt,It.HEXAGONCOLUMN,Zt),S()(Mt,It.TRIANGLECOLUMN,qt),S()(Mt,It.SQUARECOLUMN,Gt),S()(Mt,It.PENTAGONCOLUMN,Ht),Mt),Xt={};function Yt(t){var e=zt(t.coordinates);return{vertices:[].concat(yt()(e),yt()(e),yt()(e),yt()(e)),indices:[0,1,2,2,3,0],size:e.length}}function Kt(t){var e=t.shape,n=oe(e,!1),r=n.positions,i=n.index,o=n.normals;return{vertices:r,indices:i,normals:o,size:5}}function Jt(t){var e=zt(t.coordinates);return{vertices:yt()(e),indices:[0],size:e.length}}function Qt(t){var e=t.coordinates,n=e;Array.isArray(n[0][0])&&(n=e[0]);var r=new Lt({dash:!0,join:"bevel"}),i=r.extrude(n);return{vertices:i.positions,indices:i.indices,normals:i.normals,size:6}}function $t(t){var e=t.coordinates,n=bt.a.flatten(e),r=n.vertices,i=n.dimensions,o=n.holes;return{indices:bt()(r,o,i),vertices:r,size:i}}function te(t){var e=t.coordinates,n=Ft(e,!0),r=n.positions,i=n.index,o=n.normals;return{vertices:r,indices:i,normals:o,size:5}}function ee(t){var e=t.shape,n=ae(e),r=n.positions,i=n.index;return{vertices:r,indices:i,size:3}}function ne(t){var e=t.coordinates,n=[].concat(yt()(e[0]),[0,0,1,e[1][0],e[0][1],0,1,1],yt()(e[1]),[0,1,0],yt()(e[0]),[0,0,1],yt()(e[1]),[0,1,0,e[0][0],e[1][1],0,0,0]),r=[0,1,2,3,4,5];return{vertices:n,indices:r,size:5}}function re(t){for(var e=30,n=t.coordinates,r=[],i=[],o=function(t){r.push(t,1,t,n[0][0],n[0][1],n[1][0],n[1][1],t,-1,t,n[0][0],n[0][1],n[1][0],n[1][1]),t!==e-1&&i.push.apply(i,yt()([0,1,2,1,3,2].map((function(e){return 2*t+e}))))},a=0;a<e;a++)o(a);return{vertices:r,indices:i,size:7}}function ie(t){var e=t.coordinates;2===e.length&&e.push(0);t.size;var n=se(-1,1),r=se(1,1),i=se(-1,-1),o=se(1,-1),a=[].concat(yt()(e),yt()(n),yt()(e),yt()(i),yt()(e),yt()(o),yt()(e),yt()(r)),s=[0,1,2,3,0,2];return{vertices:a,indices:s,size:5}}function oe(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Xt&&Xt[t])return Xt[t];var n=Wt[t]?Wt[t]():Wt.cylinder(),r=Ft([n],e);return Xt[t]=r,r}function ae(t){var e=["cylinder","triangleColumn","hexagonColumn","squareColumn"],n=Wt[t]?Wt[t]():Wt.circle(),r=-1===e.indexOf(t)?Nt([n]):jt([n]);return r}function se(t,e){var n=(t+1)/2,r=(e+1)/2;return[n,r]}function ue(t){var e=ce();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function ce(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var le='uniform float u_opacity: 1.0;\nuniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];\nuniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];\nuniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];\nuniform float u_near : 0;\nuniform float u_far : 1;\nvarying vec4 v_Color;\nvarying vec2 v_texCoord;\nuniform float u_Zoom : 1;\nuniform float u_time;\n\n#pragma include "picking"\n\nvec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {\n    float s = step(hot, n);\n    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);\n\n    return mix(darkColor, color, s);\n}\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);\n}\n\nfloat LinearizeDepth()\n{\n    float z = gl_FragCoord.z * 2.0 - 1.0;\n    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));\n}\n\nvec3 fog(vec3 color, vec3 fogColor, float depth){\n    float fogFactor=clamp(depth,0.0,1.0);\n    vec3 output_color=mix(fogColor,color,fogFactor);\n    return output_color;\n}\n\nfloat sdRect(vec2 p, vec2 sz) {\n  vec2 d = abs(p) - sz;\n  float outside = length(max(d, 0.));\n  float inside = min(max(d.x, d.y), 0.);\n  return outside + inside;\n}\n\nvoid main() {\n  gl_FragColor = v_Color;\n  vec3 baseColor = u_baseColor.xyz;\n  vec3 brightColor = u_brightColor.xyz;\n  vec3 windowColor = u_windowColor.xyz;\n  float targetColId = 5.;\n  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;\n  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);\n  if(v_texCoord.x < 0.) { //\u9876\u90e8\u989c\u8272\n       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);\n       gl_FragColor = vec4( foggedColor, v_Color.w);\n  }else { // \u4fa7\u9762\u989c\u8272\n        vec2 st = v_texCoord;\n        vec2  UvScale = v_texCoord;\n        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));\n        float tStart = 0.25 * tStep;\n        float tEnd = 0.75 * tStep;\n        float u = mod(UvScale.x, tStep);\n        float v = mod(UvScale.y, tStep);\n        float ux = floor(UvScale.x/tStep);\n        float uy = floor(UvScale.y/tStep);\n        float n = random(vec2(ux,uy));\n        float lightP = u_time;\n        float head = 1.0- step(0.005,st.y);\n        /*step3*/\n        // \u5c06\u7a97\u6237\u989c\u8272\u548c\u5899\u9762\u989c\u8272\u533a\u522b\u5f00\u6765\n        float sU = step(tStart, u) - step(tEnd, u);\n        float sV = step(tStart, v) - step(tEnd, v);\n        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));\n        float dist = sdRect(vec2(u,v), windowSize);\n        float s = sU * sV;\n\n        float curColId = floor(UvScale.x / tStep);\n        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);\n\n        float mLightP = mod(lightP, 2.);\n        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);\n        if(ux == targetColId){\n            n =0.;\n        }\n        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );\n        float hot = smoothstep(1.0,0.0,timeP);\n        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);\n        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);\n        float sFinal = s * sCol * sRow;\n        color += mix(baseColor, brightColor, sFinal*n);\n        if (st.y<0.01){\n        color = baseColor;\n         }\n        if(head ==1.0) { // \u9876\u90e8\u4eae\u7ebf\n            color = brightColor;\n        }\n        color = color * v_Color.rgb;\n\n        vec3 foggedColor = fog(color,fogColor,depth);\n\n        gl_FragColor = vec4(foggedColor,1.0);\n  }\n  gl_FragColor.a *= u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',fe='precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\n\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n\nvarying vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n   v_texCoord = a_Uv;\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',pe=function(t){m()(n,t);var e=ue(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.baseColor,i=void 0===r?"rgb(16,16,16)":r,o=t.brightColor,a=void 0===o?"rgb(255,176,38)":o,s=t.windowColor,u=void 0===s?"rgb(30,60,89)":s,c=t.time,l=void 0===c?0:c;return{u_opacity:n,u_baseColor:Object(D["r"])(i),u_brightColor:Object(D["r"])(a),u_windowColor:Object(D["r"])(u),u_time:this.layer.getLayerAnimateTime()||l}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:fe,fragmentShader:le,triangulation:te})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?10:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){t.size;return[n[3],n[4]]}}})}}]),n}(dt);function he(t){var e=de();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function de(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var me=function(t){m()(n,t);var e=he(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="PolygonLayer",t}return h()(n,[{key:"buildModels",value:function(){this.layerModel=new pe(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(t){this.updateLayerConfig({time:t})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),n}(ht);function ve(t){var e=ge();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function ge(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var ye='precision highp float;\n// \u591a\u8fb9\u5f62\u9876\u70b9\u5750\u6807\nattribute vec3 a_Position;\n// \u591a\u8fb9\u5f62\u7ecf\u7eac\u5ea6\u5750\u6807\nattribute vec3 a_Pos;\nattribute float a_Size;\nattribute vec4 a_Color;\nuniform vec2 u_radius;\nuniform float u_coverage: 0.9;\nuniform float u_angle: 0;\nuniform mat4 u_ModelMatrix;\nvarying vec4 v_color;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  v_color = a_Color;\n\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\n  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\n  vec4 project_pos = project_position(vec4(a_Pos.xy + offset, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(project_pos);\n\n  setPickingColor(a_PickingColor);\n}\n',_e='precision highp float;\nvarying vec4 v_color;\nuniform float u_opacity: 1;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a *= u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',be=function(t){m()(n,t);var e=ve(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.coverage,r=t.angle;return{u_opacity:e||1,u_coverage:n||.9,u_angle:r||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:ye,fragmentShader:_e,triangulation:ee,depth:{enable:!1},primitive:c["gl"].TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:c["AttributeType"].Attribute,descriptor:{name:"a_Pos",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e){var n=t.coordinates;return[n[0],n[1],0]}}})}}]),n}(dt);function xe(t){var e=we();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function we(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Se='precision highp float;\n// \u591a\u8fb9\u5f62\u9876\u70b9\u5750\u6807\nattribute vec3 a_Position;\n// \u591a\u8fb9\u5f62\u7ecf\u7eac\u5ea6\u5750\u6807\nattribute vec3 a_Pos;\n\nattribute vec3 a_Normal;\nattribute float a_Size;\nattribute vec4 a_Color;\nuniform vec2 u_radius;\nuniform float u_coverage: 0.9;\nuniform float u_angle: 0;\nuniform mat4 u_ModelMatrix;\nvarying vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\n  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\n  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));\n  float lightWeight = calc_lighting(project_pos);\n  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);\n\n  gl_Position = project_common_position_to_clipspace(project_pos);\n  setPickingColor(a_PickingColor);\n}\n',Ee='precision highp float;\nvarying vec4 v_color;\nuniform float u_opacity: 1;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a *= u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Te=function(t){m()(n,t);var e=xe(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.coverage,r=t.angle;return{u_opacity:e||1,u_coverage:n||1,u_angle:r||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Se,fragmentShader:Ee,triangulation:Kt,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size;return Array.isArray(i)?[i[0]]:[i]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:c["AttributeType"].Attribute,descriptor:{name:"a_Pos",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e){var n=t.coordinates;return[n[0],n[1],0]}}})}}]),n}(dt);function Ae(t,e){for(var n=[],r=[],i=[],o=t+1,a=e+1,s=t/2,u=e/2,c=0;c<a;c++)for(var l=c-u,f=0;f<o;f++){var p=f-s;r.push(p/s,-l/u,0),i.push(f/t),i.push(1-c/e)}for(var h=0;h<e;h++)for(var d=0;d<t;d++){var m=d+o*h,v=d+o*(h+1),g=d+1+o*(h+1),y=d+1+o*h;n.push(m,v,y),n.push(v,g,y)}return{vertices:r,indices:n,uvs:i}}function Ce(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ce(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pe(t){var e=Me();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Me(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ie="uniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\nuniform float u_opacity;\nvarying vec2 v_texCoord;\nvarying float v_intensity;\n\nvoid main(){\n   \n     float intensity = texture2D(u_texture, v_texCoord).r;\n    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));\n    gl_FragColor = color;\n    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;\n     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;\n\n}\n",Oe='precision highp float;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nuniform sampler2D u_texture;\nvarying vec2 v_texCoord;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_InverseViewProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrixUncentered;\nvarying float v_intensity;\n\nvec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {\n    float t2 = t * t;\n    float one_minus_t = 1.0 - t;\n    float one_minus_t2 = one_minus_t * one_minus_t;\n    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);\n}\nvec2 toBezier(float t, vec4 p){\n    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));\n}\n#pragma include "projection"\nvoid main() {\n  v_texCoord = a_Uv;\n\n  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));\n\n\n  vec4 p1 = vec4(pos, 0.0, 1.0);\n\tvec4 p2 = vec4(pos, 1.0, 1.0);\n\n\tvec4 inverseP1 = u_InverseViewProjectionMatrix * p1;\n\tvec4 inverseP2 = u_InverseViewProjectionMatrix * p2;\n\n  inverseP1 = inverseP1 / inverseP1.w;\n\tinverseP2 = inverseP2 / inverseP2.w;\n\n\tfloat zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);\n\tvec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);\n\n  vec4 b= vec4(0.5000, 0, 1, 0.5000);\n  float fh;\n\n  v_intensity = texture2D(u_texture, v_texCoord).r;\n  fh = toBezier(v_intensity, b).y;\n  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);\n\n}\n',Le="uniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\nuniform float u_opacity;\nvarying vec2 v_texCoord;\nvarying float v_intensity;\n\nvoid main(){\n     float intensity = texture2D(u_texture, v_texCoord).r;\n    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));\n    gl_FragColor =color;\n    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;\n\n}\n",Re="precision highp float;\nuniform float u_intensity;\nvarying float v_weight;\nvarying vec2 v_extrude;\n#define GAUSS_COEF  0.3989422804014327\nvoid main(){\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);\n    gl_FragColor = vec4(val, 1., 1., 1.);\n}\n",De='precision highp float;\nattribute vec3 a_Position;\nattribute float a_Size;\nattribute vec2 a_Dir;\nuniform float u_intensity;\nuniform float u_radius;\nvarying vec2 v_extrude;\nvarying float v_weight;\nuniform mat4 u_ModelMatrix;\n\n#define GAUSS_COEF  0.3989422804014327\n\n#pragma include "projection"\n\nvoid main(){\n    v_weight = a_Size;\n    float ZERO = 1.0 / 255.0 / 16.0;\n    float extrude_x = a_Dir.x * 2.0 -1.0;\n    float extrude_y = a_Dir.y * 2.0 -1.0;\n    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));\n    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;\n    v_extrude = extrude_dir * S;\n\n    vec2 offset = project_pixel(v_extrude * u_radius);\n    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n}\n',ze="precision highp float;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nuniform sampler2D u_texture;\nvarying vec2 v_texCoord;\nvarying float v_intensity;\nvoid main() {\n  v_texCoord = a_Uv;\n  v_intensity = texture2D(u_texture, v_texCoord).r;\n  gl_Position = vec4(a_Position.xy, 0, 1.);\n}\n",je=function(t){m()(n,t);var e=Pe(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.texture=void 0,t.colorTexture=void 0,t.heatmapFramerBuffer=void 0,t.intensityModel=void 0,t.colorModel=void 0,t.shapeType=void 0,t}return h()(n,[{key:"render",value:function(){var t=this,e=this.rendererService,n=e.clear,r=e.useFramebuffer;r(this.heatmapFramerBuffer,(function(){n({color:[0,0,0,0],depth:1,stencil:0,framebuffer:t.heatmapFramerBuffer}),t.drawIntensityMode()})),this.layer.styleNeedUpdate&&this.updateColorTexture(),"heatmap"===this.shapeType?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var t,e=this.rendererService,n=e.createFramebuffer,r=(e.clear,e.getViewportSize),i=e.createTexture2D,o=(e.useFramebuffer,this.styleAttributeService.getLayerStyleAttribute("shape")),a=(null===o||void 0===o||null===(t=o.scale)||void 0===t?void 0:t.field)||"heatmap";this.shapeType=a,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel="heatmap"===a?this.buildHeatmapColor():this.build3dHeatMap();var s=this.layer.getLayerConfig(),u=s.rampColors,l=(Object(D["m"])(u),r()),f=l.width,p=l.height;return this.heatmapFramerBuffer=n({color:i({width:Math.floor(f/4),height:Math.floor(p/4),wrapS:c["gl"].CLAMP_TO_EDGE,wrapT:c["gl"].CLAMP_TO_EDGE,min:c["gl"].LINEAR,mag:c["gl"].LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:c["AttributeType"].Attribute,descriptor:{name:"a_Dir",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){return[n[3],n[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?1:i;return[o]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:De,fragmentShader:Re,triangulation:ie,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:c["gl"].ONE,srcAlpha:1,dstRGB:c["gl"].ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:ze,fs:Le});var t=this.shaderModuleService.getModule("heatmapColor"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService,o=i.createAttribute,a=i.createElements,s=i.createBuffer,u=i.createModel;return u({vs:e,fs:n,attributes:{a_Position:o({buffer:s({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:c["gl"].FLOAT}),size:3}),a_Uv:o({buffer:s({data:[0,1,1,1,0,0,1,0],type:c["gl"].FLOAT}),size:2})},uniforms:ke({},r),depth:{enable:!1},blend:this.getBlend(),count:6,elements:a({data:[0,2,1,2,3,1],type:c["gl"].UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.intensity,r=void 0===n?10:n,i=t.radius,o=void 0===i?5:i;this.intensityModel.draw({uniforms:{u_opacity:e||1,u_radius:o,u_intensity:r}})}},{key:"drawColorMode",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity;this.colorModel.draw({uniforms:{u_opacity:e||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=xt["a"].invert(xt["a"].create(),xt["a"].fromValues.apply(xt["a"],yt()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:e||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:yt()(n)}})}},{key:"build3dHeatMap",value:function(){var t=this.rendererService.getViewportSize,e=t(),n=e.width,r=e.height,i=Ae(n/4,r/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Oe,fs:Ie});var o=this.shaderModuleService.getModule("heatmap3dColor"),a=o.vs,s=o.fs,u=o.uniforms,l=this.rendererService,f=l.createAttribute,p=l.createElements,h=l.createBuffer,d=l.createModel;return d({vs:a,fs:s,attributes:{a_Position:f({buffer:h({data:i.vertices,type:c["gl"].FLOAT}),size:3}),a_Uv:f({buffer:h({data:i.uvs,type:c["gl"].FLOAT}),size:2})},primitive:c["gl"].TRIANGLES,uniforms:ke({},u),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:c["gl"].SRC_ALPHA,srcAlpha:1,dstRGB:c["gl"].ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:p({data:i.indices,type:c["gl"].UNSIGNED_INT,count:i.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var t=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var e=this.layer.getLayerConfig(),n=e.rampColors,r=Object(D["m"])(n);this.colorTexture=t({data:new Uint8Array(r.data),width:r.width,height:r.height,wrapS:c["gl"].CLAMP_TO_EDGE,wrapT:c["gl"].CLAMP_TO_EDGE,min:c["gl"].NEAREST,mag:c["gl"].NEAREST,flipY:!1})}}]),n}(dt);function Ne(t){var e=Fe();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Fe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Be='precision highp float;\nvarying vec4 v_color;\nuniform float u_opacity: 1;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a *= u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Ue='precision highp float;\n// \u591a\u8fb9\u5f62\u9876\u70b9\u5750\u6807\nattribute vec3 a_Position;\n// \u591a\u8fb9\u5f62\u7ecf\u7eac\u5ea6\u5750\u6807\nattribute vec3 a_Pos;\nattribute float a_Size;\nattribute vec4 a_Color;\nuniform vec2 u_radius;\nuniform float u_coverage: 0.9;\nuniform float u_angle: 0;\nuniform mat4 u_ModelMatrix;\nvarying vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nvoid main() {\n  v_color = a_Color;\n    \n  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\n  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));\n  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\n  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));\n  setPickingColor(a_PickingColor);\n}\n',Ve=function(t){m()(n,t);var e=Ne(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.coverage,r=t.angle;return{u_opacity:e||1,u_coverage:n||.9,u_angle:r||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Ue,fragmentShader:Be,triangulation:ee,depth:{enable:!1},primitive:c["gl"].TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:c["AttributeType"].Attribute,descriptor:{name:"a_Pos",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e){var n=t.coordinates;return[n[0],n[1],0]}}})}}]),n}(dt),Ge={heatmap:je,heatmap3d:je,grid:be,grid3d:Te,hexagon:Ve},qe=Ge;function Ze(t){var e=He();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function He(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var We=function(t){m()(n,t);var e=Ze(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="HeatMapLayer",t}return h()(n,[{key:"buildModels",value:function(){var t=this.getModelType();this.layerModel=new qe[t](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var t=this,e=this.getModelType();return"heatmap"===e?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach((function(e){return e.draw({uniforms:t.layerModel.getUninforms()})})),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var t,e=this.styleAttributeService.getLayerStyleAttribute("shape"),n=this.getLayerConfig(),r=n.shape3d,i=this.getSource(),o=i.data.type,a=(null===e||void 0===e||null===(t=e.scale)||void 0===t?void 0:t.field)||"heatmap";return"heatmap"===a||"heatmap3d"===a?"heatmap":"hexagon"===o?-1===(null===r||void 0===r?void 0:r.indexOf(a))?"hexagon":"grid3d":"grid"===o?-1===(null===r||void 0===r?void 0:r.indexOf(a))?"grid":"grid3d":"heatmap"}}]),n}(ht);function Xe(t){var e=Ye();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Ye(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ke="precision mediump float;\nuniform float u_opacity: 1.0;\nuniform sampler2D u_texture;\nvarying vec2 v_texCoord;\nvoid main() {\n  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));\n  gl_FragColor = color;\n}\n",Je='precision highp float;\nuniform mat4 u_ModelMatrix;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n   v_texCoord = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n}\n',Qe=function(t){m()(n,t);var e=Xe(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.texture=void 0,t}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity;return{u_opacity:e||1,u_texture:this.texture}}},{key:"initModels",value:function(){var t=this,e=this.layer.getSource(),n=this.rendererService.createTexture2D;return this.texture=n({height:0,width:0}),e.data.images.then((function(e){t.texture=n({data:e[0],width:e[0].width,height:e[0].height}),t.layerService.renderLayers()})),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Je,fragmentShader:Ke,triangulation:ne,primitive:c["gl"].TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){return[n[3],n[4]]}}})}}]),n}(dt),$e={image:Qe},tn=$e;function en(t){var e=nn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function nn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var rn=function(t){m()(n,t);var e=en(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="ImageLayer",t}return h()(n,[{key:"buildModels",value:function(){var t=this.getModelType();this.layerModel=new tn[t](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),e={image:{}};return e[t]}},{key:"getModelType",value:function(){return"image"}}]),n}(ht);function on(t){var e=an();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function an(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var sn='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nvarying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n  if(u_line_type == LineTypeDash) {\n   float flag = 0.;\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',un='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = 0.314;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  return mid;\n}\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\nvec2 interpolate (vec2 source, vec2 target, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n  vec2 source = a_Instance.rg;\n  vec2 target =  a_Instance.ba;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  if(u_line_type == LineTypeDash) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n    }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));\n  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  setPickingColor(a_PickingColor);\n}\n',cn={solid:0,dash:1},ln=function(t){m()(n,t);var e=on(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.lineType,r=void 0===n?"solid":n,i=t.dashArray,o=void 0===i?[10,5]:i;return 2===o.length&&o.push(0,0),{u_opacity:e||1,segmentNumber:30,u_line_type:cn[r||"solid"],u_dash_array:o,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:un,fragmentShader:sn,triangulation:re,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Instance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(t,e,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}(dt);function fn(t){var e=pn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function pn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var hn='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform mat4 u_ModelMatrix;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n   if(u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  setPickingColor(a_PickingColor);\n}\n',dn='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nvarying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n  if(u_line_type == LineTypeDash) {\n   float flag = 0.;\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',mn={solid:0,dash:1},vn=function(t){m()(n,t);var e=fn(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.lineType,r=void 0===n?"solid":n,i=t.dashArray,o=void 0===i?[10,5]:i;return 2===o.length&&o.push(0,0),{u_opacity:e||1,segmentNumber:30,u_line_type:mn[r]||0,u_dash_array:o}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:hn,fragmentShader:dn,triangulation:re,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Instance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(t,e,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}(dt);function gn(t){var e=yn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function yn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var _n='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nvarying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n  if(u_line_type == LineTypeDash) {\n   float flag = 0.;\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',bn='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n    vec2 x = mix(source, target, ratio);\n    vec2 center = mix(source, target, 0.5);\n    float dSourceCenter = distance(source, center);\n    float dXCenter = distance(x, center);\n    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n     float vertex_height = paraboloid(source, target, segmentRatio);\n\n    return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n    );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) *\n    sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\nvec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  if(abs(angularDist - PI) < 0.001) {\n    return (1.0 - t) * source + t * target;\n  }\n  float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n  float b = sin(t * angularDist) / sin(angularDist);\n  vec2 sin_source = sin(source);\n  vec2 cos_source = cos(source);\n  vec2 sin_target = sin(target);\n  vec2 cos_target = cos(target);\n  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n  float z = a * sin_source.y + b * sin_target.y;\n  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n}\n\nvoid main() {\n  v_color = a_Color;\n  vec2 source = radians(a_Instance.rg);\n  vec2 target = radians(a_Instance.ba);\n  float angularDist = getAngularDist(source, target);\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  if(u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  v_distance_ratio = segmentIndex / segmentNumber;\n  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));\n  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));\n  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n  setPickingColor(a_PickingColor);\n}\n\n',xn={solid:0,dash:1},wn=function(t){m()(n,t);var e=gn(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.lineType,r=void 0===n?"solid":n,i=t.dashArray,o=void 0===i?[10,5]:i;return 2===o.length&&o.push(0,0),{u_opacity:e||1,segmentNumber:30,u_line_type:xn[r]||0,u_dash_array:o}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:bn,fragmentShader:_n,triangulation:re,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Instance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(t,e,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}(dt);function Sn(t){var e=En();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function En(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Tn='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nuniform float u_opacity : 1.0;\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\n\n// dash\nuniform float u_dash_offset : 0.0;\nuniform float u_dash_ratio : 0.1;\nvarying float v_distance_ratio;\nvarying vec4 v_dash_array;\nvarying float v_side;\n\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n// [animate, duration, interval, trailLength],\nvoid main() {\n  gl_FragColor = v_color;\n  // anti-alias\n  float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= u_opacity * blur ;\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n // dash line\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',An='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\n// dash line\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5.\uff0c0, 0];\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec4 v_dash_array;\nvarying vec2 v_normal;\nvarying float v_distance_ratio;\nvarying float v_side;\n\n\nvoid main() {\n\n  if(u_line_type == LineTypeDash) {\n    v_distance_ratio = a_Distance / a_Total_Distance;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = a_Distance / a_Total_Distance;\n  }\n  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));\n  v_color = a_Color;\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n  vec2 offset = project_pixel(size.xy);\n  v_side = a_Miter * a_Size.x;\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',Cn={solid:0,dash:1},kn=function(t){m()(n,t);var e=Sn(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.lineType,r=void 0===n?"solid":n,i=t.dashArray,o=void 0===i?[10,5,0,0]:i;return 2===o.length&&o.push(0,0),{u_opacity:e||1,u_line_type:Cn[r],u_dash_array:o}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:An,fragmentShader:Tn,triangulation:Qt,primitive:c["gl"].TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getLayerConfig();t.lineType;this.styleAttributeService.registerStyleAttribute({name:"distance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Distance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){return[n[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){var i=t.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0],o[1]]:[o,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:c["AttributeType"].Attribute,descriptor:{name:"a_Miter",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){return[n[4]]}}})}}]),n}(dt),Pn={arc:ln,arc3d:vn,greatcircle:wn,line:kn},Mn=Pn;function In(t){var e=On();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function On(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ln=function(t){m()(n,t);var e=In(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="LineLayer",t}return h()(n,[{key:"buildModels",value:function(){var t=this.getModelType();this.layerModel=new Mn[t](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),e={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return e[t]}},{key:"getModelType",value:function(){var t,e=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null===e||void 0===e||null===(t=e.scale)||void 0===t?void 0:t.field;return n||"line"}}]),n}(ht);function Rn(t){var e=Dn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Dn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var zn='varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a *= u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',jn='precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform mat4 u_ModelMatrix;\nvarying vec4 v_color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec3 size = a_Size * a_Position;\n\n  vec2 offset = project_pixel(size.xy);\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);\n\n  float lightWeight = calc_lighting(pos);\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  gl_Position = project_common_position_to_clipspace(pos);\n  setPickingColor(a_PickingColor);\n}\n',Nn=function(t){m()(n,t);var e=Rn(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity;return{u_opacity:e||1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:jn,fragmentShader:zn,triangulation:Kt,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n,r){var i=t.size;if(i){var o=[];return Array.isArray(i)&&(o=2===i.length?[i[0],i[0],i[1]]:i),Array.isArray(i)||(o=[i]),o}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:c["AttributeType"].Attribute,descriptor:{name:"a_Pos",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e){var n=zt(t.coordinates);return[n[0],n[1],0]}}})}}]),n}(dt);function Fn(t){var e=Bn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Bn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Un="#define Animate 0.0\n\nuniform float u_blur : 0;\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 1;\nuniform vec4 u_stroke_color : [0, 0, 0, 0];\nuniform float u_stroke_opacity : 1;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  lowp float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  // gl_FragColor = v_color * color_t;\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n  if(u_aimate.x == Animate) {\n    float d = length(v_data.xy);\n    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);\n    gl_FragColor = vec4(gl_FragColor.xyz, intensity);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n",Vn='attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec2 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\nuniform mat4 u_ModelMatrix;\n\nuniform float u_stroke_width : 2;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // unpack color(vec2)\n  v_color = a_Color;\n  vec2 extrude = a_Extrude;\n\n  float shape_type = a_Shape;\n\n  float newSize = setPickingSize(a_Size);\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width));\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  // TODO: billboard\n  // anti-alias\n  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);\n\n  // construct point coords\n  v_data = vec4(extrude, antialiasblur,shape_type);\n\n  setPickingColor(a_PickingColor);\n}\n',Gn=function(t){m()(n,t);var e=Fn(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.stroke,i=void 0===r?"rgb(0,0,0,0)":r,o=t.strokeWidth,a=void 0===o?1:o,s=t.strokeOpacity,u=void 0===s?1:s;return{u_opacity:n,u_stroke_width:a,u_stroke_color:Object(D["r"])(i),u_stroke_opacity:u}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption;return{u_aimate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Yt)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:Vn,fragmentShader:Un,triangulation:Yt,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:c["AttributeType"].Attribute,descriptor:{name:"a_Extrude",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){var i=[1,1,-1,1,-1,-1,1,-1],o=r%4*2;return[i[o],i[o+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?5:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:c["AttributeType"].Attribute,descriptor:{name:"a_Shape",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,n,r,i){var o=e.shape,a=void 0===o?2:o,s=t.layer.getLayerConfig().shape2d,u=s.indexOf(a);return[u]}}})}}]),n}(dt);function qn(t){var e=Zn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Zn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Hn='\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_stroke_width : 1;\nuniform vec4 u_stroke_color : [1, 1, 1, 1];\nuniform float u_stroke_opacity : 1;\nuniform float u_opacity : 1;\n\nvarying float v_size;\n#pragma include "picking"\nvoid main(){\nvec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\nvec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;\nfloat distance = length(fragmentPosition);\nfloat distanceSqrd = distance * distance;\nfloat radius = 1.;\nfloat r = 1.0 - smoothstep(radius-(radius*0.01),\n                         radius+(radius*0.01),\n                         distanceSqrd);\n  vec4 textureColor=texture2D(u_texture,pos);\n  if(v_color == vec4(1.0)){\n        gl_FragColor= vec4(textureColor.xyz, textureColor.w);\n  }else {\n        gl_FragColor= step(0.01, textureColor.z) * v_color;\n  }\n  gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Wn='precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform float u_stroke_width : 1;\nvarying float v_size;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   v_size = a_Size;\n\n   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',Xn=function(t){m()(n,t);var e=qn(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.texture=void 0,t}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity;return{u_opacity:e||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var t=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",(function(){t.updateTexture(),t.layer.render()})),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Wn,fragmentShader:Hn,triangulation:Jt,primitive:c["gl"].POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size;return Array.isArray(i)?[i[0]]:[i]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(e,n,r,i){var o=t.fontService.mapping,a=e.shape,s=t.fontService.getGlyph(a),u=o[s],c=u.x,l=u.y;return[c,l]}}})}},{key:"updateTexture",value:function(){var t=this.rendererService.createTexture2D,e=this.fontService.canvas;this.texture=t({data:e,mag:c["gl"].LINEAR,min:c["gl"].LINEAR,width:e.width,height:e.height})}},{key:"initIconFontGlyphs",value:function(){var t=this,e=this.layer.getLayerConfig(),n=e.fontWeight,r=void 0===n?"normal":n,i=e.fontFamily,o=void 0===i?"sans-serif":i,a=this.layer.getEncodedData(),s=[];a.forEach((function(e){var n=e.shape,r=void 0===n?"":n;r=r.toString();var i=t.fontService.getGlyph(r);-1===s.indexOf(i)&&s.push(i)})),this.fontService.setFontOptions({characterSet:s,fontWeight:r,fontFamily:o,fontSize:48})}}]),n}(dt);function Yn(t){var e=Kn();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Kn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Jn='\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_stroke_width : 1;\nuniform vec4 u_stroke_color : [1, 1, 1, 1];\nuniform float u_stroke_opacity : 1;\nuniform float u_opacity : 1;\n\nvarying float v_size;\n#pragma include "picking"\nvoid main(){\nvec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\nvec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;\nfloat distance = length(fragmentPosition);\nfloat distanceSqrd = distance * distance;\nfloat radius = 1.;\nfloat r = 1.0 - smoothstep(radius-(radius*0.01),\n                         radius+(radius*0.01),\n                         distanceSqrd);\n  vec4 textureColor=texture2D(u_texture,pos);\n  if(v_color == vec4(1.0)){\n        gl_FragColor= vec4(textureColor.xyz, textureColor.w);\n  }else {\n        gl_FragColor= step(0.01, textureColor.z) * v_color;\n  }\n  gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Qn='precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform float u_stroke_width : 1;\nvarying float v_size;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   v_size = a_Size;\n\n   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',$n=function(t){m()(n,t);var e=Yn(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.texture=void 0,t.updateTexture=function(){var e=t.rendererService.createTexture2D;t.texture&&t.texture.destroy(),t.texture=e({data:t.iconService.getCanvas(),mag:c["gl"].LINEAR,min:c["gl"].LINEAR,width:1024,height:t.iconService.canvasHeight||128}),t.layer.render()},t}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity;return this.rendererService.getDirty()&&this.texture.update(),{u_opacity:e||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Qn,fragmentShader:Jn,triangulation:Jt,primitive:c["gl"].POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?5:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(e,n,r,i){var o=t.iconService.getIconMap(),a=e.shape,s=o[a]||{x:0,y:0},u=s.x,c=s.y;return[u,c]}}})}}]),n}(dt);function tr(t){var e=er();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function er(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var nr='\nuniform float u_opacity : 1;\nvarying vec4 v_color;\n#pragma include "picking"\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a =gl_FragColor.a * u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',rr='\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n#pragma include "projection"\n#pragma include "picking"\nvoid main() {\n  v_color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n  gl_Position = project_common_position_to_clipspace(project_pos);\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n    setPickingColor(a_PickingColor);\n}\n';function ir(t){var e=t.coordinates;return{vertices:yt()(e),indices:[0],size:e.length}}var or=function(t){m()(n,t);var e=tr(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.stroke,i=void 0===r?"rgb(0,0,0,0)":r,o=t.strokeWidth,a=void 0===o?1:o;return{u_opacity:n,u_stroke_width:a,u_stroke_color:Object(D["r"])(i)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:rr,fragmentShader:nr,triangulation:ir,depth:{enable:!1},primitive:c["gl"].POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:c["BlendType"].additive}}}]),n}(dt);function ar(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=sr(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function sr(t,e){if(t){if("string"===typeof t)return ur(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ur(t,e):void 0}}function ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var cr=function(){function t(e,n,r){f()(this,t),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var i=this.boxCells;this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(n/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0}return h()(t,[{key:"insert",value:function(t,e,n,r,i){this.forEachCell(e,n,r,i,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}},{key:"query",value:function(t,e,n,r,i){return this.queryHitTest(t,e,n,r,!1,i)}},{key:"hitTest",value:function(t,e,n,r,i){return this.queryHitTest(t,e,n,r,!0,i)}},{key:"insertBoxCell",value:function(t,e,n,r,i,o){this.boxCells[i].push(o)}},{key:"queryHitTest",value:function(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});return o?a.filter(o):a}var u={hitTest:i,seenUids:{box:{},circle:{}}};return this.forEachCell(t,e,n,r,this.queryCell,a,u,o),i?a.length>0:a}},{key:"queryCell",value:function(t,e,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c){var l,f=this.bboxes,p=ar(c);try{for(p.s();!(l=p.n()).done;){var h=l.value;if(!u.box[h]){u.box[h]=!0;var d=4*h;if(t<=f[d+2]&&e<=f[d+3]&&n>=f[d+0]&&r>=f[d+1]&&(!s||s(this.boxKeys[h]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[h],x1:f[d],y1:f[d+1],x2:f[d+2],y2:f[d+3]})}}}}catch(m){p.e(m)}finally{p.f()}}return!1}},{key:"forEachCell",value:function(t,e,n,r,i,o,a,s){for(var u=this.convertToXCellCoord(t),c=this.convertToYCellCoord(e),l=this.convertToXCellCoord(n),f=this.convertToYCellCoord(r),p=u;p<=l;p++)for(var h=c;h<=f;h++){var d=this.xCellCount*h+p;if(i.call(this,t,e,n,r,d,o,a,s))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),t}(),lr=cr,fr=function(){function t(e,n){f()(this,t),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=e,this.height=n,this.viewportPadding=Math.max(e,n),this.grid=new lr(e+this.viewportPadding,n+this.viewportPadding,25),this.screenRightBoundary=e+this.viewportPadding,this.screenBottomBoundary=n+this.viewportPadding,this.gridRightBoundary=e+2*this.viewportPadding,this.gridBottomBoundary=n+2*this.viewportPadding}return h()(t,[{key:"placeCollisionBox",value:function(t){var e=t.x1+t.anchorPointX+this.viewportPadding,n=t.y1+t.anchorPointY+this.viewportPadding,r=t.x2+t.anchorPointX+this.viewportPadding,i=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(e,n,r,i)||this.grid.hitTest(e,n,r,i)?{box:[]}:{box:[e,n,r,i]}}},{key:"insertCollisionBox",value:function(t,e){var n={featureIndex:e};this.grid.insert(n,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,e,n){var r=xt["d"].fromValues(e,n,0,1),i=xt["d"].create(),o=xt["a"].fromValues.apply(xt["a"],yt()(t));return xt["d"].transformMat4(i,r,o),{x:(i[0]/i[3]+1)/2*this.width+this.viewportPadding,y:(-i[1]/i[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}}]),t}();function pr(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=hr(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function hr(t,e){if(t){if("string"===typeof t)return dr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dr(t,e):void 0}}function dr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mr(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break;default:e=.5}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5}return{horizontalAlign:e,verticalAlign:n}}function vr(t,e,n,r,i){if(i){var o=t[r],a=o.glyph;if(a)for(var s=e[a].advance*o.scale,u=(t[r].x+s)*i,c=n;c<=r;c++)t[c].x-=u}}function gr(t,e,n,r,i,o,a){var s,u=(e-n)*i,c=(-r*a+.5)*o,l=pr(t);try{for(l.s();!(s=l.n()).done;){var f=s.value;f.x+=u,f.y+=c}}catch(p){l.e(p)}finally{l.f()}}function yr(t,e,n,r,i,o,a){var s=-8,u=0,c=s,l=0,f=t.positionedGlyphs,p="right"===o?1:"left"===o?0:.5,h=f.length;n.forEach((function(t){if(t.split("").forEach((function(t){var n=e[t],r=0;n&&(f.push({glyph:t,x:u,y:c+r,vertical:!1,scale:1,metrics:n}),u+=n.advance+a)})),f.length!==h){var n=u-a;l=Math.max(n,l),vr(f,e,h,f.length-1,p)}u=0,c+=r}));var d=mr(i),m=d.horizontalAlign,v=d.verticalAlign;gr(f,p,m,v,l,r,n.length);var g=c-s;t.top+=-v*g,t.bottom=t.top+g,t.left+=-m*l,t.right=t.left+l}function _r(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],s=t.split("\n"),u=[],c={positionedGlyphs:u,top:a[1],bottom:a[1],left:a[0],right:a[0],lineCount:s.length,text:t};return yr(c,e,s,n,r,i,o),!!u.length&&c}function br(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,i=t.positionedGlyphs,o=void 0===i?[]:i,a=[],s=pr(o);try{for(s.s();!(e=s.n()).done;){var u=e.value,c=u.metrics,l=4,f=c.advance*u.scale/2,p=r?[u.x+f,u.y]:[0,0],h=r?[0,0]:[u.x+f+n[0],u.y+n[1]],d=(0-l)*u.scale-f+h[0],m=(0-l)*u.scale+h[1],v=d+c.width*u.scale,g=m+c.height*u.scale,y={x:d,y:m},_={x:v,y:m},b={x:d,y:g},x={x:v,y:g};a.push({tl:y,tr:_,bl:b,br:x,tex:c,glyphOffset:p})}}catch(w){s.e(w)}finally{s.f()}return a}function xr(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=wr(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function wr(t,e){if(t){if("string"===typeof t)return Sr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sr(t,e):void 0}}function Sr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Er(t){var e=Tr();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Tr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ar='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform float u_stroke_opacity: 1.0;\nuniform vec4 u_stroke : [0, 0, 0, 1];\nuniform float u_strokeWidth : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\n#pragma include "picking"\nvoid main() {\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Cr='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // \u6587\u672c\u7f29\u653e\u6bd4\u4f8b\n  float fontScale = a_Size / FONT_SIZE;\n   v_fontScale = fontScale;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  gl_Position = vec4(projected_position.xy / projected_position.w\n    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function kr(t){var e=this,n=t.id,r=[],i=[];if(!e.glyphInfoMap||!e.glyphInfoMap[n])return{vertices:[],indices:[],size:7};var o=e.glyphInfoMap[n].centroid,a=2===o.length?[o[0],o[1],0]:o;return e.glyphInfoMap[n].glyphQuads.forEach((function(t,e){r.push.apply(r,yt()(a).concat([t.tex.x,t.tex.y+t.tex.height,t.tl.x,t.tl.y],yt()(a),[t.tex.x+t.tex.width,t.tex.y+t.tex.height,t.tr.x,t.tr.y],yt()(a),[t.tex.x+t.tex.width,t.tex.y,t.br.x,t.br.y],yt()(a),[t.tex.x,t.tex.y,t.bl.x,t.bl.y])),i.push(0+4*e,1+4*e,2+4*e,2+4*e,3+4*e,0+4*e)})),{vertices:r,indices:i,size:7}}var Pr=function(t){m()(n,t);var e=Er(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.glyphInfo=void 0,t.glyphInfoMap={},t.texture=void 0,t.currentZoom=-1,t.extent=void 0,t.textureHeight=0,t.textCount=0,t.preTextStyle={},t.buildModels=function(){return t.initGlyph(),t.updateTexture(),t.filterGlyphs(),[t.layer.buildLayerModel({moduleName:"pointText",vertexShader:Cr,fragmentShader:Ar,triangulation:kr.bind(C()(t)),depth:{enable:!1},blend:t.getBlend()})]},t}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.stroke,i=void 0===r?"#fff":r,o=t.strokeWidth,a=void 0===o?0:o,s=t.strokeOpacity,u=void 0===s?1:s,c=t.textAnchor,l=void 0===c?"center":c,f=t.textAllowOverlap,p=void 0!==f&&f,h=t.halo,d=void 0===h?.5:h,m=t.gamma,v=void 0===m?2:m,g=this.fontService,y=g.canvas,_=g.mapping;return Object.keys(_).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(_).length),this.preTextStyle={textAnchor:l,textAllowOverlap:p},{u_opacity:n,u_stroke_opacity:u,u_sdf_map:this.texture,u_stroke:Object(D["r"])(i),u_halo_blur:d,u_gamma_scale:v,u_sdf_map_size:[y.width,y.height],u_strokeWidth:a}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var t=this.layer.getLayerConfig(),e=t.textAnchor,n=void 0===e?"center":e,r=t.textAllowOverlap,i=void 0===r||r;return this.preTextStyle={textAnchor:n,textAllowOverlap:i},this.buildModels()}},{key:"needUpdate",value:function(){var t=this.layer.getLayerConfig(),e=t.textAllowOverlap,n=void 0!==e&&e,r=this.mapService.getZoom(),i=this.mapService.getBounds(),o=Object(D["i"])(this.extent,i);return(!n&&(Math.abs(this.currentZoom-r)>1||!o)||n!==this.preTextStyle.textAllowOverlap)&&(this.reBuildModel(),!0)}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:c["AttributeType"].Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){return[n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?12:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:c["AttributeType"].Attribute,descriptor:{name:"a_tex",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){return[n[3],n[4]]}}})}},{key:"textExtent",value:function(){var t=this.mapService.getBounds();return Object(D["q"])(t,.5)}},{key:"initTextFont",value:function(){var t=this.layer.getLayerConfig(),e=t.fontWeight,n=void 0===e?"400":e,r=t.fontFamily,i=void 0===r?"sans-serif":r,o=this.layer.getEncodedData(),a=[];o.forEach((function(t){var e=t.shape,n=void 0===e?"":e;n=n.toString();var r,i=xr(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;-1===a.indexOf(o)&&a.push(o)}}catch(s){i.e(s)}finally{i.f()}})),this.fontService.setFontOptions({characterSet:a,fontWeight:n,fontFamily:i})}},{key:"generateGlyphLayout",value:function(){var t=this,e=this.fontService.mapping,n=this.layer.getLayerConfig(),r=n.spacing,i=void 0===r?2:r,o=n.textAnchor,a=void 0===o?"center":o,s=n.textOffset,u=this.layer.getEncodedData();this.glyphInfo=u.map((function(n){var r=n.shape,o=void 0===r?"":r,u=n.coordinates,c=n.id,l=n.size,f=void 0===l?1:l,p=_r(o.toString(),e,f,a,"center",i,s),h=br(p,s,!1);return n.shaping=p,n.glyphQuads=h,n.centroid=zt(u),t.glyphInfoMap[c]={shaping:p,glyphQuads:h,centroid:zt(u)},n}))}},{key:"filterGlyphs",value:function(){var t=this,e=this.layer.getLayerConfig(),n=e.padding,r=void 0===n?[4,4]:n,i=e.textAllowOverlap,o=void 0!==i&&i;if(!o){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var a=this.rendererService.getViewportSize(),s=a.width,u=a.height,c=new fr(s,u),l=this.glyphInfo.filter((function(e){var n=e.shaping,i=e.id,o=void 0===i?0:i,a=e.centroid,s=e.size,u=s/24,l=t.mapService.lngLatToContainer(a),f=c.placeCollisionBox({x1:n.left*u-r[0],x2:n.right*u+r[0],y1:n.top*u-r[1],y2:n.bottom*u+r[1],anchorPointX:l.x,anchorPointY:l.y}),p=f.box;return!(!p||!p.length)&&(c.insertCollisionBox(p,o),!0)}));l.forEach((function(e){t.glyphInfoMap[e.id]=e}))}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var t=this.rendererService.createTexture2D,e=this.fontService.canvas;this.textureHeight=e.height,this.texture&&this.texture.destroy(),this.texture=t({data:e,mag:c["gl"].LINEAR,min:c["gl"].LINEAR,width:e.width,height:e.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Cr,fragmentShader:Ar,triangulation:kr.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),n}(dt),Mr={fill:Gn,image:$n,normal:or,extrude:Nn,text:Pr,icon:Xn},Ir=Mr;function Or(t){var e=Lr();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Lr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Rr=function(t){m()(n,t);var e=Or(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="PointLayer",t}return h()(n,[{key:"buildModels",value:function(){var t=this.getModelType();this.layerModel=new Ir[t](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),e={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return e[t]}},{key:"getModelType",value:function(){var t=this.getEncodedData(),e=this.getLayerConfig(),n=e.shape2d,r=e.shape3d,i=this.iconService.getIconMap(),o=t.find((function(t){return t.hasOwnProperty("shape")}));if(o){var a=o.shape;return"dot"===a?"normal":-1!==(null===n||void 0===n?void 0:n.indexOf(a))?"fill":-1!==(null===r||void 0===r?void 0:r.indexOf(a))?"extrude":i.hasOwnProperty(a)?"image":""!==this.fontService.getGlyph(a)?"icon":"text"}return"normal"}}]),n}(ht);function Dr(t){var e=zr();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function zr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var jr='uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_Color;\n  gl_FragColor.a *= u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Nr='precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\n\nvarying vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',Fr=function(t){m()(n,t);var e=Dr(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e;return{u_opacity:n}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:Nr,fragmentShader:jr,triangulation:te})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e,n,r){var i=t.size,o=void 0===i?10:i;return Array.isArray(o)?[o[0]]:[o]}}})}}]),n}(dt);function Br(t){var e=Ur();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Ur(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Vr='uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_Color;\n  gl_FragColor.a *= u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Gr='attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\n\nvarying vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n\n',qr=function(t){m()(n,t);var e=Br(n);function n(){return f()(this,n),e.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e;return{u_opacity:n}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:Gr,fragmentShader:Vr,triangulation:$t,depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),n}(dt),Zr={fill:qr,line:kn,extrude:Fr,text:Pr,point_fill:Gn,point_image:$n,point_normal:or,point_extrude:Nn},Hr=Zr;function Wr(t){var e=Xr();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Xr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Yr=function(t){m()(n,t);var e=Wr(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="PolygonLayer",t}return h()(n,[{key:"buildModels",value:function(){var t=this.getModelType();this.layerModel=new Hr[t](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var t,e=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null===e||void 0===e||null===(t=e.scale)||void 0===t?void 0:t.field;return"fill"===n?"fill":"extrude"===n?"extrude":"line"===n?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var t=this.getEncodedData(),e=this.getLayerConfig(),n=e.shape2d,r=e.shape3d,i=this.iconService.getIconMap(),o=t.find((function(t){return t.hasOwnProperty("shape")}));if(o){var a=o.shape;return"dot"===a?"point_normal":-1!==(null===n||void 0===n?void 0:n.indexOf(a))?"point_fill":-1!==(null===r||void 0===r?void 0:r.indexOf(a))?"point_extrude":i.hasOwnProperty(a)?"point_image":"text"}return"fill"}}]),n}(ht);function Kr(t){var e=Jr();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Jr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Qr="precision mediump float;\nuniform float u_opacity: 1.0;\nuniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\nuniform float u_min;\nuniform float u_max;\nuniform vec2 u_domain;\nuniform float u_noDataValue;\nuniform bool u_clampLow: true;\nuniform bool u_clampHigh: true;\nvarying vec2 v_texCoord;\n\nvoid main() {\n\n  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;\n  if (value == u_noDataValue)\n    gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))\n    gl_FragColor = vec4(0, 0, 0, 0);\n  else {\n    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);\n    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));\n    gl_FragColor = color;\n    gl_FragColor.a =  gl_FragColor.a * u_opacity ;\n  }\n\n\n}\n",$r='precision highp float;\nuniform mat4 u_ModelMatrix;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n   v_texCoord = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n}\n',ti=function(t){m()(n,t);var e=Kr(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.texture=void 0,t.colorTexture=void 0,t}return h()(n,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.clampLow,i=void 0===r||r,o=t.clampHigh,a=void 0===o||o,s=t.noDataValue,u=void 0===s?-9999999:s,c=t.domain,l=void 0===c?[0,1]:c;return this.updateColorTexure(),{u_opacity:n||1,u_texture:this.texture,u_domain:l,u_clampLow:i,u_clampHigh:"undefined"!==typeof a?a:i,u_noDataValue:u,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var t=this.layer.getSource(),e=this.rendererService.createTexture2D,n=t.data.dataArray[0];this.texture=e({data:n.data,width:n.width,height:n.height,format:c["gl"].LUMINANCE,type:c["gl"].FLOAT});var r=this.layer.getLayerConfig(),i=r.rampColors,o=Object(D["m"])(i);return this.colorTexture=e({data:o.data,width:o.width,height:o.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:$r,fragmentShader:Qr,triangulation:ne,primitive:c["gl"].TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,e,n,r){return[n[3],n[4]]}}})}},{key:"updateColorTexure",value:function(){var t=this.rendererService.createTexture2D,e=this.layer.getLayerConfig(),n=e.rampColors,r=Object(D["m"])(n);this.colorTexture=t({data:r.data,width:r.width,height:r.height,flipY:!1})}}]),n}(dt),ei={raster:ti,raster3d:ti},ni=ei;function ri(t){var e=ii();return function(){var n,r=_()(t);if(e){var i=_()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function ii(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var oi,ai,si,ui,ci,li,fi,pi,hi=function(t){m()(n,t);var e=ri(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),t.type="RasterLayer",t}return h()(n,[{key:"buildModels",value:function(){var t=this.getModelType();this.layerModel=new ni[t](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),e={raster:{},raster3d:{}};return e[t]}},{key:"getModelType",value:function(){return"raster"}}]),n}(ht);function di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function mi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?di(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vi,gi,yi,_i=(oi=Object(F["injectable"])(),ai=Object(F["inject"])(c["TYPES"].IGlobalConfigService),si=Object(F["inject"])(c["TYPES"].ILogService),oi((pi=function(){function t(){f()(this,t),T()(this,"configService",li,this),T()(this,"logger",fi,this)}return h()(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tap("DataMappingPlugin",(function(){n.generateMaping(t,{styleAttributeService:r})})),t.hooks.beforeRenderData.tap("DataMappingPlugin",(function(){return t.dataState.dataMappingNeedUpdate=!1,n.generateMaping(t,{styleAttributeService:r}),!0})),t.hooks.beforeRender.tap("DataMappingPlugin",(function(){if(!t.layerModelNeedUpdate){var e=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter"),o=t.getSource().data.dataArray,a=e.filter((function(t){return t.needRemapping})),s=o;(null===i||void 0===i?void 0:i.needRemapping)&&(null===i||void 0===i?void 0:i.scale)&&(s=o.filter((function(t){return n.applyAttributeMapping(i,t)[0]}))),a.length&&((null===i||void 0===i?void 0:i.needRemapping)?(t.setEncodedData(n.mapping(e,s)),i.needRemapping=!1):t.setEncodedData(n.mapping(a,s,t.getEncodedData())),n.logger.debug("remapping finished"),t.emit("remapping",null))}}))}},{key:"generateMaping",value:function(t,e){var n=this,r=e.styleAttributeService,i=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter"),a=t.getSource().data.dataArray,s=a;(null===o||void 0===o?void 0:o.scale)&&(s=a.filter((function(t){return n.applyAttributeMapping(o,t)[0]}))),t.setEncodedData(this.mapping(i,s))}},{key:"mapping",value:function(t,e,n){var r=this;return e.map((function(e,i){var o=n?n[i]:{},a=mi({id:e._id,coordinates:e.coordinates},o);return t.filter((function(t){return void 0!==t.scale})).forEach((function(t){var n=r.applyAttributeMapping(t,e);t.needRemapping=!1,"color"===t.name&&(n=n.map((function(t){return Object(D["r"])(t)}))),a[t.name]=Array.isArray(n)&&1===n.length?n[0]:n})),a}))}},{key:"applyAttributeMapping",value:function(t,e){var n;if(!t.scale)return[];var r=(null===t||void 0===t||null===(n=t.scale)||void 0===n?void 0:n.scalers)||[],i=[];return r.forEach((function(n){var r,o=n.field;(e.hasOwnProperty(o)||"variable"===(null===(r=t.scale)||void 0===r?void 0:r.type))&&i.push(e[o])})),t.mapping?t.mapping(i):[]}}]),t}(),ci=pi,li=P()(ci.prototype,"configService",[ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fi=P()(ci.prototype,"logger",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ui=ci))||ui),bi=n("rlAn"),xi=(vi=Object(F["injectable"])(),vi((yi=function(){function t(){f()(this,t),this.mapService=void 0}return h()(t,[{key:"apply",value:function(t){var e=this;this.mapService=t.getContainer().get(c["TYPES"].IMapService),t.hooks.init.tap("DataSourcePlugin",(function(){var n=t.sourceOption,r=n.data,i=n.options;t.setSource(new bi["default"](r,i)),e.updateClusterData(t)})),t.hooks.beforeRenderData.tap("DataSourcePlugin",(function(){var n=e.updateClusterData(t),r=t.dataState.dataSourceNeedUpdate;return t.dataState.dataSourceNeedUpdate=!1,n||r}))}},{key:"updateClusterData",value:function(t){var e=t.getSource(),n=e.cluster,r=e.clusterOptions,i=r.zoom,o=void 0===i?0:i,a=r.maxZoom,s=void 0===a?16:a,u=this.mapService.getZoom()-1;return!!(n&&Math.abs(o-u)>1&&s>o)&&(e.updateClusterData(Math.floor(u)),!0)}}]),t}(),gi=yi))||gi),wi=n("7tbW"),Si=n.n(wi),Ei=n("4qC0"),Ti=n.n(Ei),Ai=n("J2iB"),Ci=n.n(Ai),ki=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Pi=function(t){return 1===t.length&&(t=Mi(t)),{left:function(e,n,r,i){null==r&&(r=0),null==i&&(i=e.length);while(r<i){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){null==r&&(r=0),null==i&&(i=e.length);while(r<i){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};function Mi(t){return function(e,n){return ki(t(e),n)}}var Ii=Pi(ki),Oi=Ii.right,Li=(Ii.left,Oi);var Ri=function(t){return null===t?NaN:+t},Di=function(t,e){var n,r,i,o=t.length,a=-1;if(null==e){while(++a<o)if(null!=(n=t[a])&&n>=n){r=i=n;while(++a<o)null!=(n=t[a])&&(r>n&&(r=n),i<n&&(i=n))}}else while(++a<o)if(null!=(n=e(t[a],a,t))&&n>=n){r=i=n;while(++a<o)null!=(n=e(t[a],a,t))&&(r>n&&(r=n),i<n&&(i=n))}return[r,i]},zi=Array.prototype,ji=(zi.slice,zi.map,Math.sqrt(50)),Ni=Math.sqrt(10),Fi=Math.sqrt(2),Bi=function(t,e,n){var r,i,o,a,s=-1;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=Ui(t,e,n))||!isFinite(a))return[];if(a>0){t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));while(++s<i)o[s]=(t+s)*a}else{t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));while(++s<i)o[s]=(t-s)/a}return r&&o.reverse(),o};function Ui(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=ji?10:o>=Ni?5:o>=Fi?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=ji?10:o>=Ni?5:o>=Fi?2:1)}function Vi(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=ji?i*=10:o>=Ni?i*=5:o>=Fi&&(i*=2),e<t?-i:i}var Gi=function(t,e,n){if(null==n&&(n=Ri),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t),s=+n(t[o+1],o+1,t);return a+(s-a)*(i-o)}};function qi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var Zi="$";function Hi(){}function Wi(t,e){var n=new Hi;if(t instanceof Hi)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)while(++i<o)n.set(i,t[i]);else while(++i<o)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}Hi.prototype=Wi.prototype={constructor:Hi,has:function(t){return Zi+t in this},get:function(t){return this[Zi+t]},set:function(t,e){return this[Zi+t]=e,this},remove:function(t){var e=Zi+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Zi&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Zi&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Zi&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Zi&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Zi&&++t;return t},empty:function(){for(var t in this)if(t[0]===Zi)return!1;return!0},each:function(t){for(var e in this)e[0]===Zi&&t(this[e],e.slice(1),this)}};var Xi=Wi;function Yi(){}var Ki=Xi.prototype;function Ji(t,e){var n=new Yi;if(t instanceof Yi)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)while(++r<i)n.add(t[r]);else while(++r<i)n.add(e(t[r],r,t))}return n}Yi.prototype=Ji.prototype={constructor:Yi,has:Ki.has,add:function(t){return t+="",this[Zi+t]=t,this},remove:Ki.remove,clear:Ki.clear,values:Ki.keys,size:Ki.size,empty:Ki.empty,each:Ki.each};var Qi=Array.prototype,$i=Qi.map,to=Qi.slice,eo={name:"implicit"};function no(){var t=Xi(),e=[],n=[],r=eo;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==eo)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Xi();var r,o,a=-1,s=n.length;while(++a<s)t.has(o=(r=n[a])+"")||t.set(o,e.push(r));return i},i.range=function(t){return arguments.length?(n=to.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return no(e,n).unknown(r)},qi.apply(i,arguments),i}var ro=n("FmoU");function io(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}var oo=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return io((n-r/e)*e,a,i,o,s)}},ao=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return io((n-r/e)*e,i,o,a,s)}},so=function(t){return function(){return t}};function uo(t,e){return function(n){return t+n*e}}function co(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function lo(t){return 1===(t=+t)?fo:function(e,n){return n-e?co(e,n,t):so(isNaN(e)?n:e)}}function fo(t,e){var n=e-t;return n?uo(t,n):so(isNaN(t)?e:t)}var po=function t(e){var n=lo(e);function r(t,e){var r=n((t=Object(ro["b"])(t)).r,(e=Object(ro["b"])(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=fo(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function ho(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Object(ro["b"])(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}ho(oo),ho(ao);var mo=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function vo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function go(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Ao(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var yo=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},_o=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},bo=function(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Ao(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},xo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wo=new RegExp(xo.source,"g");function So(t){return function(){return t}}function Eo(t){return function(e){return t(e)+""}}var To=function(t,e){var n,r,i,o=xo.lastIndex=wo.lastIndex=0,a=-1,s=[],u=[];t+="",e+="";while((n=xo.exec(t))&&(r=wo.exec(e)))(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:_o(n,r)})),o=wo.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?Eo(u[0].x):So(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Ao=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?so(e):("number"===r?_o:"string"===r?(n=Object(ro["a"])(e))?(e=n,po):To:e instanceof ro["a"]?po:e instanceof Date?yo:vo(e)?mo:Array.isArray(e)?go:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?bo:_o)(t,e)},Co=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},ko=function(t){return function(){return t}},Po=function(t){return+t},Mo=[0,1];function Io(t){return t}function Oo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ko(isNaN(e)?NaN:.5)}function Lo(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function Ro(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Oo(i,r),o=n(a,o)):(r=Oo(r,i),o=n(o,a)),function(t){return o(r(t))}}function Do(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());while(++a<r)i[a]=Oo(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Li(t,e,1,r)-1;return o[n](i[n](e))}}function zo(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function jo(){var t,e,n,r,i,o,a=Mo,s=Mo,u=Ao,c=Io;function l(){return r=Math.min(a.length,s.length)>2?Do:Ro,i=o=null,f}function f(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,u)))(t(c(e)))}return f.invert=function(n){return c(e((o||(o=r(s,a.map(t),_o)))(n)))},f.domain=function(t){return arguments.length?(a=$i.call(t,Po),c===Io||(c=Lo(a)),l()):a.slice()},f.range=function(t){return arguments.length?(s=to.call(t),l()):s.slice()},f.rangeRound=function(t){return s=to.call(t),u=Co,l()},f.clamp=function(t){return arguments.length?(c=t?Lo(a):Io,f):c!==Io},f.interpolate=function(t){return arguments.length?(u=t,l()):u},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,l()}}function No(t,e){return jo()(t,e)}var Fo=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bo(t){if(!(e=Fo.exec(t)))throw new Error("invalid format: "+t);var e;return new Uo({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Uo(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Bo.prototype=Uo.prototype,Uo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Vo,Go,qo,Zo,Ho=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Wo=function(t){return t=Ho(Math.abs(t)),t?t[1]:NaN},Xo=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Wo(e)/3)))-Wo(Math.abs(t)))},Yo=function(t,e){return function(n,r){var i=n.length,o=[],a=0,s=t[0],u=0;while(i>0&&s>0){if(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),(u+=s+1)>r)break;s=t[a=(a+1)%t.length]}return o.reverse().join(e)}},Ko=function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}},Jo=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(e+1):t},Qo=function(t,e){var n=Ho(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Vo=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Ho(t,Math.max(0,e+o-1))[0]},$o=function(t,e){var n=Ho(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},ta={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return $o(100*t,e)},r:$o,s:Qo,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},ea=function(t){return t},na=Array.prototype.map,ra=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],ia=function(t){var e=void 0===t.grouping||void 0===t.thousands?ea:Yo(na.call(t.grouping,Number),t.thousands+""),n=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",i=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?ea:Ko(na.call(t.numerals,String)),a=void 0===t.percent?"%":t.percent+"",s=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){t=Bo(t);var c=t.fill,l=t.align,f=t.sign,p=t.symbol,h=t.zero,d=t.width,m=t.comma,v=t.precision,g=t.trim,y=t.type;"n"===y?(m=!0,y="g"):ta[y]||(void 0===v&&(v=12),g=!0,y="g"),(h||"0"===c&&"="===l)&&(h=!0,c="0",l="=");var _="$"===p?n:"#"===p&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===p?r:/[%p]/.test(y)?a:"",x=ta[y],w=/[defgprs%]/.test(y);function S(t){var n,r,a,p=_,S=b;if("c"===y)S=x(t)+S,t="";else{t=+t;var E=t<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),v),g&&(t=Jo(t)),E&&0===+t&&"+"!==f&&(E=!1),p=(E?"("===f?f:s:"-"===f||"("===f?"":f)+p,S=("s"===y?ra[8+Vo/3]:"")+S+(E&&"("===f?")":""),w){n=-1,r=t.length;while(++n<r)if(a=t.charCodeAt(n),48>a||a>57){S=(46===a?i+t.slice(n+1):t.slice(n))+S,t=t.slice(0,n);break}}}m&&!h&&(t=e(t,1/0));var T=p.length+t.length+S.length,A=T<d?new Array(d-T+1).join(c):"";switch(m&&h&&(t=e(A+t,A.length?d-S.length:1/0),A=""),l){case"<":t=p+t+S+A;break;case"=":t=p+A+t+S;break;case"^":t=A.slice(0,T=A.length>>1)+p+t+S+A.slice(T);break;default:t=A+p+t+S;break}return o(t)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),S.toString=function(){return t+""},S}function l(t,e){var n=c((t=Bo(t),t.type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Wo(e)/3))),i=Math.pow(10,-r),o=ra[8+r/3];return function(t){return n(i*t)+o}}return{format:c,formatPrefix:l}};function oa(t){return Go=ia(t),qo=Go.format,Zo=Go.formatPrefix,Go}oa({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var aa=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Wo(e)-Wo(t))+1},sa=function(t){return Math.max(0,-Wo(Math.abs(t)))},ua=function(t,e,n,r){var i,o=Vi(t,e,n);switch(r=Bo(null==r?",f":r),r.type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Xo(o,a))||(r.precision=i),Zo(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=aa(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=sa(o))||(r.precision=i-2*("%"===r.type));break}return qo(r)};function ca(t){var e=t.domain;return t.ticks=function(t){var n=e();return Bi(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return ua(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),r=Ui(s,u,n),r>0?(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,r=Ui(s,u,n)):r<0&&(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,r=Ui(s,u,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function la(){var t=No(Io,Io);return t.copy=function(){return zo(t,la())},qi.apply(t,arguments),ca(t)}function fa(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=$i.call(e,Po),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return fa(t).unknown(e)},t=arguments.length?$i.call(t,Po):[0,1],ca(n)}var pa=function(t,e){t=t.slice();var n,r=0,i=t.length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t};function ha(t){return Math.log(t)}function da(t){return Math.exp(t)}function ma(t){return-Math.log(-t)}function va(t){return-Math.exp(-t)}function ga(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ya(t){return 10===t?ga:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function _a(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function ba(t){return function(e){return-t(-e)}}function xa(t){var e,n,r=t(ha,da),i=r.domain,o=10;function a(){return e=_a(o),n=ya(o),i()[0]<0?(e=ba(e),n=ba(n),t(ma,va)):t(ha,da),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(p=s,s=u,u=p);var c,l,f,p=e(s),h=e(u),d=null==t?10:+t,m=[];if(!(o%1)&&h-p<d){if(p=Math.round(p)-1,h=Math.round(h)+1,s>0){for(;p<h;++p)for(l=1,c=n(p);l<o;++l)if(f=c*l,!(f<s)){if(f>u)break;m.push(f)}}else for(;p<h;++p)for(l=o-1,c=n(p);l>=1;--l)if(f=c*l,!(f<s)){if(f>u)break;m.push(f)}}else m=Bi(p,h,Math.min(h-p,d)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!==typeof i&&(i=qo(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(pa(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function wa(){var t=xa(jo()).domain([1,10]);return t.copy=function(){return zo(t,wa()).base(t.base())},qi.apply(t,arguments),t}function Sa(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Ea(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Ta(t){return t<0?-t*t:t*t}function Aa(t){var e=t(Io,Io),n=1;function r(){return 1===n?t(Io,Io):.5===n?t(Ea,Ta):t(Sa(n),Sa(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},ca(e)}function Ca(){var t=Aa(jo());return t.copy=function(){return zo(t,Ca()).exponent(t.exponent())},qi.apply(t,arguments),t}function ka(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);r=new Array(i-1);while(++t<i)r[t-1]=Gi(e,t/i);return o}function o(e){return isNaN(e=+e)?t:n[Li(r,e)]}return o.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,r=0,o=t.length;r<o;++r)n=t[r],null==n||isNaN(n=+n)||e.push(n);return e.sort(ki),i()},o.range=function(t){return arguments.length?(n=to.call(t),i()):n.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return r.slice()},o.copy=function(){return ka().domain(e).range(n).unknown(t)},qi.apply(o,arguments)}function Pa(){var t,e=0,n=1,r=1,i=[.5],o=[0,1];function a(e){return e<=e?o[Li(i,e,0,r)]:t}function s(){var t=-1;i=new Array(r);while(++t<r)i[t]=((t+1)*n-(t-r)*e)/(r+1);return a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],s()):[e,n]},a.range=function(t){return arguments.length?(r=(o=to.call(t)).length-1,s()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[e,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(e){return arguments.length?(t=e,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return Pa().domain([e,n]).range(o).unknown(t)},qi.apply(ca(a),arguments)}function Ma(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[Li(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=to.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=to.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return Ma().domain(e).range(n).unknown(t)},qi.apply(i,arguments)}var Ia=new Date,Oa=new Date;function La(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return La((function(e){if(e>=e)while(t(e),!n(e))e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)while(++r<=0)while(e(t,-1),!n(t));else while(--r>=0)while(e(t,1),!n(t));}))},n&&(i.count=function(e,r){return Ia.setTime(+e),Oa.setTime(+r),t(Ia),t(Oa),Math.floor(n(Ia,Oa))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}var Ra=La((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Ra.every=function(t){return isFinite(t=Math.floor(t))&&t>0?La((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Da=Ra,za=(Ra.range,La((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}))),ja=za,Na=(za.range,1e3),Fa=6e4,Ba=36e5,Ua=864e5,Va=6048e5;function Ga(t){return La((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Fa)/Va}))}var qa=Ga(0),Za=Ga(1),Ha=Ga(2),Wa=Ga(3),Xa=Ga(4),Ya=Ga(5),Ka=Ga(6),Ja=(qa.range,Za.range,Ha.range,Wa.range,Xa.range,Ya.range,Ka.range,La((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Fa)/Ua}),(function(t){return t.getDate()-1}))),Qa=Ja,$a=(Ja.range,La((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Na-t.getMinutes()*Fa)}),(function(t,e){t.setTime(+t+e*Ba)}),(function(t,e){return(e-t)/Ba}),(function(t){return t.getHours()}))),ts=$a,es=($a.range,La((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Na)}),(function(t,e){t.setTime(+t+e*Fa)}),(function(t,e){return(e-t)/Fa}),(function(t){return t.getMinutes()}))),ns=es,rs=(es.range,La((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*Na)}),(function(t,e){return(e-t)/Na}),(function(t){return t.getUTCSeconds()}))),is=rs,os=(rs.range,La((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));os.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?La((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):os:null};var as=os;os.range;function ss(t){return La((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Va}))}var us=ss(0),cs=ss(1),ls=ss(2),fs=ss(3),ps=ss(4),hs=ss(5),ds=ss(6),ms=(us.range,cs.range,ls.range,fs.range,ps.range,hs.range,ds.range,La((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Ua}),(function(t){return t.getUTCDate()-1}))),vs=ms,gs=(ms.range,La((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));gs.every=function(t){return isFinite(t=Math.floor(t))&&t>0?La((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var ys=gs;gs.range;function _s(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function bs(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function xs(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ws(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=Is(i),l=Os(i),f=Is(o),p=Os(o),h=Is(a),d=Os(a),m=Is(s),v=Os(s),g=Is(u),y=Os(u),_={a:L,A:R,b:D,B:z,c:null,d:$s,e:$s,f:iu,H:tu,I:eu,j:nu,L:ru,m:ou,M:au,p:j,q:N,Q:Ru,s:Du,S:su,u:uu,U:cu,V:lu,w:fu,W:pu,x:null,X:null,y:hu,Y:du,Z:mu,"%":Lu},b={a:F,A:B,b:U,B:V,c:null,d:vu,e:vu,f:xu,H:gu,I:yu,j:_u,L:bu,m:wu,M:Su,p:G,q:q,Q:Ru,s:Du,S:Eu,u:Tu,U:Au,V:Cu,w:ku,W:Pu,x:null,X:null,y:Mu,Y:Iu,Z:Ou,"%":Lu},x={a:A,A:C,b:k,B:P,c:M,d:Gs,e:Gs,f:Ys,H:Zs,I:Zs,j:qs,L:Xs,m:Vs,M:Hs,p:T,q:Us,Q:Js,s:Qs,S:Ws,u:Rs,U:Ds,V:zs,w:Ls,W:js,x:I,X:O,y:Fs,Y:Ns,Z:Bs,"%":Ks};function w(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;n instanceof Date||(n=new Date(+n));while(++s<c)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=Ts[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function S(t,e){return function(n){var r,i,o=xs(1900,void 0,1),a=E(o,t,n+="",0);if(a!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=bs(xs(o.y,0,1)),i=r.getUTCDay(),r=i>4||0===i?cs.ceil(r):cs(r),r=vs.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=_s(xs(o.y,0,1)),i=r.getDay(),r=i>4||0===i?Za.ceil(r):Za(r),r=Qa.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?bs(xs(o.y,0,1)).getUTCDay():_s(xs(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,bs(o)):_s(o)}}function E(t,e,n,r){var i,o,a=0,s=e.length,u=n.length;while(a<s){if(r>=u)return-1;if(i=e.charCodeAt(a++),37===i){if(i=e.charAt(a++),o=x[i in Ts?e.charAt(a++):i],!o||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function T(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1}function A(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1}function C(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1}function k(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1}function P(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1}function M(t,n,r){return E(t,e,n,r)}function I(t,e,r){return E(t,n,e,r)}function O(t,e,n){return E(t,r,e,n)}function L(t){return a[t.getDay()]}function R(t){return o[t.getDay()]}function D(t){return u[t.getMonth()]}function z(t){return s[t.getMonth()]}function j(t){return i[+(t.getHours()>=12)]}function N(t){return 1+~~(t.getMonth()/3)}function F(t){return a[t.getUTCDay()]}function B(t){return o[t.getUTCDay()]}function U(t){return u[t.getUTCMonth()]}function V(t){return s[t.getUTCMonth()]}function G(t){return i[+(t.getUTCHours()>=12)]}function q(t){return 1+~~(t.getUTCMonth()/3)}return _.x=w(n,_),_.X=w(r,_),_.c=w(e,_),b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),{format:function(t){var e=w(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+="",!0);return e.toString=function(){return t},e}}}var Ss,Es,Ts={"-":"",_:" ",0:"0"},As=/^\s*\d+/,Cs=/^%/,ks=/[\\^$*+?|[\]().{}]/g;function Ps(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Ms(t){return t.replace(ks,"\\$&")}function Is(t){return new RegExp("^(?:"+t.map(Ms).join("|")+")","i")}function Os(t){var e={},n=-1,r=t.length;while(++n<r)e[t[n].toLowerCase()]=n;return e}function Ls(t,e,n){var r=As.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Rs(t,e,n){var r=As.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ds(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function zs(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function js(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Ns(t,e,n){var r=As.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Fs(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Bs(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Us(t,e,n){var r=As.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Vs(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Gs(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function qs(t,e,n){var r=As.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Zs(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Hs(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Ws(t,e,n){var r=As.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Xs(t,e,n){var r=As.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Ys(t,e,n){var r=As.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ks(t,e,n){var r=Cs.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Js(t,e,n){var r=As.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Qs(t,e,n){var r=As.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function $s(t,e){return Ps(t.getDate(),e,2)}function tu(t,e){return Ps(t.getHours(),e,2)}function eu(t,e){return Ps(t.getHours()%12||12,e,2)}function nu(t,e){return Ps(1+Qa.count(Da(t),t),e,3)}function ru(t,e){return Ps(t.getMilliseconds(),e,3)}function iu(t,e){return ru(t,e)+"000"}function ou(t,e){return Ps(t.getMonth()+1,e,2)}function au(t,e){return Ps(t.getMinutes(),e,2)}function su(t,e){return Ps(t.getSeconds(),e,2)}function uu(t){var e=t.getDay();return 0===e?7:e}function cu(t,e){return Ps(qa.count(Da(t)-1,t),e,2)}function lu(t,e){var n=t.getDay();return t=n>=4||0===n?Xa(t):Xa.ceil(t),Ps(Xa.count(Da(t),t)+(4===Da(t).getDay()),e,2)}function fu(t){return t.getDay()}function pu(t,e){return Ps(Za.count(Da(t)-1,t),e,2)}function hu(t,e){return Ps(t.getFullYear()%100,e,2)}function du(t,e){return Ps(t.getFullYear()%1e4,e,4)}function mu(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ps(e/60|0,"0",2)+Ps(e%60,"0",2)}function vu(t,e){return Ps(t.getUTCDate(),e,2)}function gu(t,e){return Ps(t.getUTCHours(),e,2)}function yu(t,e){return Ps(t.getUTCHours()%12||12,e,2)}function _u(t,e){return Ps(1+vs.count(ys(t),t),e,3)}function bu(t,e){return Ps(t.getUTCMilliseconds(),e,3)}function xu(t,e){return bu(t,e)+"000"}function wu(t,e){return Ps(t.getUTCMonth()+1,e,2)}function Su(t,e){return Ps(t.getUTCMinutes(),e,2)}function Eu(t,e){return Ps(t.getUTCSeconds(),e,2)}function Tu(t){var e=t.getUTCDay();return 0===e?7:e}function Au(t,e){return Ps(us.count(ys(t)-1,t),e,2)}function Cu(t,e){var n=t.getUTCDay();return t=n>=4||0===n?ps(t):ps.ceil(t),Ps(ps.count(ys(t),t)+(4===ys(t).getUTCDay()),e,2)}function ku(t){return t.getUTCDay()}function Pu(t,e){return Ps(cs.count(ys(t)-1,t),e,2)}function Mu(t,e){return Ps(t.getUTCFullYear()%100,e,2)}function Iu(t,e){return Ps(t.getUTCFullYear()%1e4,e,4)}function Ou(){return"+0000"}function Lu(){return"%"}function Ru(t){return+t}function Du(t){return Math.floor(+t/1e3)}function zu(t){return Ss=ws(t),Es=Ss.format,Ss.parse,Ss.utcFormat,Ss.utcParse,Ss}zu({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ju=1e3,Nu=60*ju,Fu=60*Nu,Bu=24*Fu,Uu=7*Bu,Vu=30*Bu,Gu=365*Bu;function qu(t){return new Date(t)}function Zu(t){return t instanceof Date?+t:+new Date(+t)}function Hu(t,e,n,r,i,o,a,s,u){var c=No(Io,Io),l=c.invert,f=c.domain,p=u(".%L"),h=u(":%S"),d=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),g=u("%b %d"),y=u("%B"),_=u("%Y"),b=[[a,1,ju],[a,5,5*ju],[a,15,15*ju],[a,30,30*ju],[o,1,Nu],[o,5,5*Nu],[o,15,15*Nu],[o,30,30*Nu],[i,1,Fu],[i,3,3*Fu],[i,6,6*Fu],[i,12,12*Fu],[r,1,Bu],[r,2,2*Bu],[n,1,Uu],[e,1,Vu],[e,3,3*Vu],[t,1,Gu]];function x(s){return(a(s)<s?p:o(s)<s?h:i(s)<s?d:r(s)<s?m:e(s)<s?n(s)<s?v:g:t(s)<s?y:_)(s)}function w(e,n,r,i){if(null==e&&(e=10),"number"===typeof e){var o=Math.abs(r-n)/e,a=Pi((function(t){return t[2]})).right(b,o);a===b.length?(i=Vi(n/Gu,r/Gu,e),e=t):a?(a=b[o/b[a-1][2]<b[a][2]/o?a-1:a],i=a[1],e=a[0]):(i=Math.max(Vi(n,r,e),1),e=s)}return null==i?e:e.every(i)}return c.invert=function(t){return new Date(l(t))},c.domain=function(t){return arguments.length?f($i.call(t,Zu)):f().map(qu)},c.ticks=function(t,e){var n,r=f(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=w(t,i,o,e),n=n?n.range(i,o+1):[],a?n.reverse():n},c.tickFormat=function(t,e){return null==e?x:u(e)},c.nice=function(t,e){var n=f();return(t=w(t,n[0],n[n.length-1],e))?f(pa(n,t)):c},c.copy=function(){return zo(c,Hu(t,e,n,r,i,o,a,s,u))},c}var Wu,Xu,Yu,Ku,Ju,Qu,$u,tc,ec,nc=function(){return qi.apply(Hu(Da,ja,qa,Qa,ts,ns,is,as,Es).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},rc=La((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),ic=(rc.range,La((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*Ba)}),(function(t,e){return(e-t)/Ba}),(function(t){return t.getUTCHours()}))),oc=(ic.range,La((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*Fa)}),(function(t,e){return(e-t)/Fa}),(function(t){return t.getUTCMinutes()})));oc.range;var ac,sc,uc,cc,lc,fc,pc,hc,dc=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,mc=(Wu={},S()(Wu,c["ScaleTypes"].LINEAR,la),S()(Wu,c["ScaleTypes"].POWER,Ca),S()(Wu,c["ScaleTypes"].LOG,wa),S()(Wu,c["ScaleTypes"].IDENTITY,fa),S()(Wu,c["ScaleTypes"].TIME,nc),S()(Wu,c["ScaleTypes"].QUANTILE,ka),S()(Wu,c["ScaleTypes"].QUANTIZE,Pa),S()(Wu,c["ScaleTypes"].THRESHOLD,Ma),S()(Wu,c["ScaleTypes"].CAT,no),Wu),vc=(Xu=Object(F["injectable"])(),Yu=Object(F["inject"])(c["TYPES"].IGlobalConfigService),Ku=Object(F["inject"])(c["TYPES"].ILogService),Xu((ec=function(){function t(){f()(this,t),T()(this,"configService",$u,this),T()(this,"logger",tc,this),this.scaleCache={},this.scaleOptions={}}return h()(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tap("FeatureScalePlugin",(function(){n.scaleOptions=t.getScaleOptions();var e=r.getLayerStyleAttributes(),i=t.getSource().data.dataArray;0!==i.length&&n.caculateScalesForAttributes(e||[],i)})),t.hooks.beforeRenderData.tap("FeatureScalePlugin",(function(){n.scaleOptions=t.getScaleOptions();var e=r.getLayerStyleAttributes(),i=t.getSource().data.dataArray;return n.caculateScalesForAttributes(e||[],i),t.layerModelNeedUpdate=!0,!0})),t.hooks.beforeRender.tap("FeatureScalePlugin",(function(){if(!t.layerModelNeedUpdate){n.scaleOptions=t.getScaleOptions();var e=r.getLayerStyleAttributes();if(e){var i=t.getSource().data.dataArray;if(0===i.length)return;var o=e.filter((function(t){return t.needRescale}));o.length&&(n.caculateScalesForAttributes(o,i),n.logger.debug("rescale finished"))}}}))}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,e){var n=this;this.scaleCache={},t.forEach((function(t){if(t.scale){var r=t.scale,i=t.name;r.names=n.parseFields(t.scale.field||[]);var o=[];r.names.forEach((function(r){o.push(n.getOrCreateScale(r,t,e))})),o.some((function(t){return t.type===c["StyleScaleType"].VARIABLE}))?(r.type=c["StyleScaleType"].VARIABLE,o.forEach((function(t){var e;if(!r.callback)if(r.values&&"text"!==r.values){var n;if("linear"===(null===(n=t.option)||void 0===n?void 0:n.type)&&r.values.length>2){var o=t.scale.ticks(r.values.length);"color"===i&&t.scale.domain(o)}t.scale.range(r.values)}else"cat"===(null===(e=t.option)||void 0===e?void 0:e.type)&&t.scale.range(t.option.domain)}))):(r.type=c["StyleScaleType"].CONSTANT,r.defaultValues=o.map((function(t,e){return t.scale(r.names[e])}))),r.scalers=o.map((function(t){return{field:t.field,func:t.scale,option:t.option}})),t.needRescale=!1}}))}},{key:"getOrCreateScale",value:function(t,e,n){[t,e.name].join("_");var r,i=null===(r=e.scale)||void 0===r?void 0:r.values,o=this.createScale(t,e.name,i,n);return o}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:Ti()(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,e,n,r){var i,o=this.scaleOptions[e]&&this.scaleOptions[e].field===t?this.scaleOptions[e]:this.scaleOptions[t],a={field:t,scale:void 0,type:c["StyleScaleType"].VARIABLE,option:o};if(!r||!r.length)return o&&o.type?a.scale=this.createDefaultScale(o):(a.scale=no([t]),a.type=c["StyleScaleType"].CONSTANT),a;var s=null===(i=r.find((function(e){return!Ci()(e[t])})))||void 0===i?void 0:i[t];if(this.isNumber(t)||Ci()(s)&&!o)a.scale=no([t]),a.type=c["StyleScaleType"].CONSTANT;else{var u=o&&o.type||this.getDefaultType(s);"text"===n&&(u=c["ScaleTypes"].CAT);var l=this.createDefaultScaleConfig(u,t,r);Object.assign(l,o),a.scale=this.createDefaultScale(l),a.option=l}return a}},{key:"getDefaultType",value:function(t){var e=c["ScaleTypes"].LINEAR;return"string"===typeof t&&(e=dc.test(t)?c["ScaleTypes"].TIME:c["ScaleTypes"].CAT),e}},{key:"createDefaultScaleConfig",value:function(t,e,n){var r={type:t},i=(null===n||void 0===n?void 0:n.map((function(t){return t[e]})))||[];return t!==c["ScaleTypes"].CAT&&t!==c["ScaleTypes"].QUANTILE?r.domain=Di(i):t===c["ScaleTypes"].CAT?r.domain=Si()(i):t===c["ScaleTypes"].QUANTILE&&(r.domain=i),r}},{key:"createDefaultScale",value:function(t){var e=t.type,n=t.domain,r=mc[e]();return n&&r.domain(n),r}}]),t}(),Qu=ec,$u=P()(Qu.prototype,"configService",[Yu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tc=P()(Qu.prototype,"logger",[Ku],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ju=Qu))||Ju);function gc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gc(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _c,bc,xc,wc,Sc,Ec,Tc=(ac=Object(F["injectable"])(),sc=Object(F["inject"])(c["TYPES"].ICameraService),uc=Object(F["inject"])(c["TYPES"].IRendererService),ac((hc=function(){function t(){f()(this,t),T()(this,"cameraService",fc,this),T()(this,"rendererService",pc,this)}return h()(t,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",(function(){t.models.forEach((function(e){e.addUniforms(yc({},t.layerModel.getAnimateUniforms()))}))}))}}]),t}(),lc=hc,fc=P()(lc.prototype,"cameraService",[sc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pc=P()(lc.prototype,"rendererService",[uc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cc=lc))||cc),Ac=(_c=Object(F["injectable"])(),_c(bc=function(){function t(){f()(this,t)}return h()(t,[{key:"apply",value:function(t){t.hooks.init.tap("LayerModelPlugin",(function(){t.prepareBuildModel(),t.buildModels(),t.styleNeedUpdate=!1})),t.hooks.beforeRenderData.tap("DataSourcePlugin",(function(){return t.prepareBuildModel(),t.clearModels(),t.buildModels(),t.layerModelNeedUpdate=!1,!1}))}}]),t}())||bc),Cc=(xc=Object(F["injectable"])(),xc(wc=function(){function t(){f()(this,t)}return h()(t,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",(function(){t.updateLayerConfig({});var e=t.getLayerConfig(),n=e.autoFit,r=e.fitBoundsOptions;n&&setTimeout((function(){t.fitBounds(r)}),100)}))}}]),t}())||wc);function kc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kc(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Mc={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Ic={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Oc={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Lc={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function Rc(t){var e={u_DirectionalLights:new Array(3).fill(Pc({},Oc)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Pc({},Lc)),u_NumOfSpotLights:0};return t&&t.length||(t=[Ic]),t.forEach((function(t,n){var r=t.type,i=void 0===r?"directional":r,o=x()(t,["type"]),a=Mc[i].lights,s=Mc[i].num,u=e[s];e[a][u]=Pc(Pc({},e[a][u]),o),e[s]++})),e}var Dc,zc,jc,Nc,Fc,Bc,Uc,Vc,Gc,qc,Zc,Hc,Wc,Xc,Yc,Kc,Jc,Qc,$c,tl,el,nl,rl,il,ol,al,sl=(Sc=Object(F["injectable"])(),Sc(Ec=function(){function t(){f()(this,t)}return h()(t,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",(function(){var e=t.getLayerConfig(),n=e.enableLighting;n&&t.models.forEach((function(t){return t.addUniforms(Pc({},Rc()))}))}))}}]),t}())||Ec),ul={NONE:0,ENCODE:1,HIGHLIGHT:2},cl=(Dc=Object(F["injectable"])(),Dc(zc=function(){function t(){f()(this,t)}return h()(t,[{key:"apply",value:function(t,e){e.rendererService;var n=e.styleAttributeService;t.hooks.init.tap("PixelPickingPlugin",(function(){var e=t.getLayerConfig(),r=e.enablePicking;n.registerStyleAttribute({name:"pickingColor",type:c["AttributeType"].Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:c["gl"].FLOAT},size:3,update:function(t,e){var n=t.id;return r?Object(D["k"])(n):[0,0,0]}}})})),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",(function(){var e=t.getLayerConfig(),n=e.enablePicking;n&&t.isVisible()&&t.models.forEach((function(t){return t.addUniforms({u_PickingStage:ul.ENCODE})}))})),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",(function(){var e=t.getLayerConfig(),n=e.enablePicking;n&&t.isVisible()&&t.models.forEach((function(t){return t.addUniforms({u_PickingStage:ul.HIGHLIGHT})}))})),t.hooks.beforeHighlight.tap("PixelPickingPlugin",(function(e){var n=t.getLayerConfig(),r=n.highlightColor,i="string"===typeof r?Object(D["r"])(r):r||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Object(D["j"])(new Uint8Array(e))}),t.models.forEach((function(t){return t.addUniforms({u_PickingStage:ul.HIGHLIGHT,u_PickingColor:e,u_HighlightColor:i.map((function(t){return 255*t}))})}))})),t.hooks.beforeSelect.tap("PixelPickingPlugin",(function(e){var n=t.getLayerConfig(),r=n.selectColor,i="string"===typeof r?Object(D["r"])(r):r||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Object(D["j"])(new Uint8Array(e))}),t.models.forEach((function(t){return t.addUniforms({u_PickingStage:ul.HIGHLIGHT,u_PickingColor:e,u_HighlightColor:i.map((function(t){return 255*t}))})}))}))}}]),t}())||zc),ll=(jc=Object(F["injectable"])(),Nc=Object(F["inject"])(c["TYPES"].ILogService),jc((Vc=function(){function t(){f()(this,t),T()(this,"logger",Uc,this)}return h()(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tap("RegisterStyleAttributePlugin",(function(){n.registerBuiltinAttributes(r)}))}},{key:"registerBuiltinAttributes",value:function(t){t.registerStyleAttribute({name:"position",type:c["AttributeType"].Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:c["gl"].FLOAT},size:3,update:function(t,e,n){return 2===n.length?[n[0],n[1],0]:[n[0],n[1],n[2]]}}}),t.registerStyleAttribute({name:"filter",type:c["AttributeType"].Attribute,descriptor:{name:"filter",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,e){var n=t.filter;return n?[1]:[0]}}}),t.registerStyleAttribute({name:"color",type:c["AttributeType"].Attribute,descriptor:{name:"a_Color",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(t,e){var n=t.color;return n&&n.length?n:[1,1,1,1]}}})}}]),t}(),Bc=Vc,Uc=P()(Bc.prototype,"logger",[Nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fc=Bc))||Fc),fl=(Gc=Object(F["injectable"])(),qc=Object(F["inject"])(c["TYPES"].ICameraService),Zc=Object(F["inject"])(c["TYPES"].ICoordinateSystemService),Hc=Object(F["inject"])(c["TYPES"].IRendererService),Gc((Qc=function(){function t(){f()(this,t),T()(this,"cameraService",Yc,this),T()(this,"coordinateSystemService",Kc,this),T()(this,"rendererService",Jc,this)}return h()(t,[{key:"apply",value:function(t){var e=this;t.hooks.beforeRender.tap("ShaderUniformPlugin",(function(){e.coordinateSystemService.refresh();var n=e.rendererService.getViewportSize(),r=n.width,i=n.height;t.models.forEach((function(n){var o;return n.addUniforms((o={},S()(o,c["CameraUniform"].ProjectionMatrix,e.cameraService.getProjectionMatrix()),S()(o,c["CameraUniform"].ViewMatrix,e.cameraService.getViewMatrix()),S()(o,c["CameraUniform"].ViewProjectionMatrix,e.cameraService.getViewProjectionMatrix()),S()(o,c["CameraUniform"].Zoom,e.cameraService.getZoom()),S()(o,c["CameraUniform"].ZoomScale,e.cameraService.getZoomScale()),S()(o,c["CameraUniform"].FocalDistance,e.cameraService.getFocalDistance()),S()(o,c["CameraUniform"].CameraPosition,e.cameraService.getCameraPosition()),S()(o,c["CoordinateUniform"].CoordinateSystem,e.coordinateSystemService.getCoordinateSystem()),S()(o,c["CoordinateUniform"].ViewportCenter,e.coordinateSystemService.getViewportCenter()),S()(o,c["CoordinateUniform"].ViewportCenterProjection,e.coordinateSystemService.getViewportCenterProjection()),S()(o,c["CoordinateUniform"].PixelsPerDegree,e.coordinateSystemService.getPixelsPerDegree()),S()(o,c["CoordinateUniform"].PixelsPerDegree2,e.coordinateSystemService.getPixelsPerDegree2()),S()(o,c["CoordinateUniform"].PixelsPerMeter,e.coordinateSystemService.getPixelsPerMeter()),S()(o,"u_ViewportSize",[r,i]),S()(o,"u_DevicePixelRatio",window.devicePixelRatio),S()(o,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),S()(o,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),o))}))}))}}]),t}(),Xc=Qc,Yc=P()(Xc.prototype,"cameraService",[qc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kc=P()(Xc.prototype,"coordinateSystemService",[Zc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jc=P()(Xc.prototype,"rendererService",[Hc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wc=Xc))||Wc),pl=($c=Object(F["injectable"])(),$c(tl=function(){function t(){f()(this,t)}return h()(t,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",(function(){t.layerModel&&t.layerModel.needUpdate()}))}}]),t}())||tl),hl=(el=Object(F["injectable"])(),nl=Object(F["inject"])(c["TYPES"].ILogService),el((al=function(){function t(){f()(this,t),T()(this,"logger",ol,this)}return h()(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tap("UpdateStyleAttributePlugin",(function(){n.initStyleAttribute(t,{styleAttributeService:r})})),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",(function(){t.layerModelNeedUpdate||n.updateStyleAtrribute(t,{styleAttributeService:r})}))}},{key:"updateStyleAtrribute",value:function(t,e){var n=this,r=e.styleAttributeService,i=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter"),a=r.getLayerStyleAttribute("shape");if(o&&o.needRegenerateVertices||a&&a.needRegenerateVertices)return t.layerModelNeedUpdate=!0,void i.forEach((function(t){return t.needRegenerateVertices=!1}));i.filter((function(t){return t.needRegenerateVertices})).forEach((function(e){r.updateAttributeByFeatureRange(e.name,t.getEncodedData(),e.featureRange.startIndex,e.featureRange.endIndex),e.needRegenerateVertices=!1,n.logger.debug("regenerate vertex attributes: ".concat(e.name," finished"))}))}},{key:"initStyleAttribute",value:function(t,e){var n=this,r=e.styleAttributeService,i=r.getLayerStyleAttributes()||[];i.filter((function(t){return t.needRegenerateVertices})).forEach((function(e){r.updateAttributeByFeatureRange(e.name,t.getEncodedData(),e.featureRange.startIndex,e.featureRange.endIndex),e.needRegenerateVertices=!1,n.logger.debug("init vertex attributes: ".concat(e.name," finished"))}))}}]),t}(),il=al,ol=P()(il.prototype,"logger",[nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rl=il))||rl);c["container"].bind(c["TYPES"].ILayerPlugin).to(xi).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(ll).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(vc).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(_i).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Cc).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(hl).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(pl).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(K).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(fl).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Tc).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(sl).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(cl).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Ac).inRequestScope()},u6S6:function(t,e,n){var r=n("6acW"),i=n("sgoq"),o=i((function(t,e,n){return e=e.toLowerCase(),t+(n?r(e):e)}));t.exports=o},uhBA:function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,n,r,o){if("function"!==typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function u(t,e){0===--t._eventsCount?t._events=new o:delete t._events[e]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,r,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,o),!0;case 6:return l.fn.call(l.context,e,n,r,o,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var p,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,r);break;default:if(!u)for(p=1,u=new Array(f-1);p<f;p++)u[p-1]=arguments[p];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==e||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,t.exports=c},ujMp:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("MON2");function i(t){if("function"===typeof t){var e=t;return e.name}if("symbol"===typeof t)return t.toString();e=t;return e}function o(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(t){var e="Object";null!==t.implementationType&&(e=l(t.implementationType)),r=r+"\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)}))),r}function a(t,e){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===e||a(t.parentRequest,e))}function s(t){function e(t,n){void 0===n&&(n=[]);var r=i(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}var n=e(t);return n.reverse().join(" --\x3e ")}function u(t){t.childRequests.forEach((function(t){if(a(t,t.serviceIdentifier)){var e=s(t);throw new Error(r.CIRCULAR_DEPENDENCY+" "+e)}u(t)}))}function c(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(t){n+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+n}return" "+t}function l(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+e}e.getServiceIdentifierAsString=i,e.listRegisteredBindingsForServiceIdentifier=o,e.circularDependencyToException=u,e.listMetadataForTarget=c,e.getFunctionName=l},"vN+2":function(t,e){function n(){}t.exports=n},"w/wX":function(t,e,n){var r=n("QqLw"),i=n("ExA7"),o="[object Set]";function a(t){return i(t)&&r(t)==o}t.exports=a},w26f:function(t,e,n){(function(e){var n=200,r="__lodash_hash_undefined__",i=1/0,o="[object Function]",a="[object GeneratorFunction]",s=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,c="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,f=c||l||Function("return this")();function p(t,e){var n=t?t.length:0;return!!n&&m(t,e,0)>-1}function h(t,e,n){var r=-1,i=t?t.length:0;while(++r<i)if(n(e,t[r]))return!0;return!1}function d(t,e,n,r){var i=t.length,o=n+(r?1:-1);while(r?o--:++o<i)if(e(t[o],o,t))return o;return-1}function m(t,e,n){if(e!==e)return d(t,v,n);var r=n-1,i=t.length;while(++r<i)if(t[r]===e)return r;return-1}function v(t){return t!==t}function g(t,e){return t.has(e)}function y(t,e){return null==t?void 0:t[e]}function _(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function b(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var x=Array.prototype,w=Function.prototype,S=Object.prototype,E=f["__core-js_shared__"],T=function(){var t=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),A=w.toString,C=S.hasOwnProperty,k=S.toString,P=RegExp("^"+A.call(C).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=x.splice,I=at(f,"Map"),O=at(f,"Set"),L=at(Object,"create");function R(t){var e=-1,n=t?t.length:0;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function D(){this.__data__=L?L(null):{}}function z(t){return this.has(t)&&delete this.__data__[t]}function j(t){var e=this.__data__;if(L){var n=e[t];return n===r?void 0:n}return C.call(e,t)?e[t]:void 0}function N(t){var e=this.__data__;return L?void 0!==e[t]:C.call(e,t)}function F(t,e){var n=this.__data__;return n[t]=L&&void 0===e?r:e,this}function B(t){var e=-1,n=t?t.length:0;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function U(){this.__data__=[]}function V(t){var e=this.__data__,n=et(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():M.call(e,n,1),!0}function G(t){var e=this.__data__,n=et(e,t);return n<0?void 0:e[n][1]}function q(t){return et(this.__data__,t)>-1}function Z(t,e){var n=this.__data__,r=et(n,t);return r<0?n.push([t,e]):n[r][1]=e,this}function H(t){var e=-1,n=t?t.length:0;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function W(){this.__data__={hash:new R,map:new(I||B),string:new R}}function X(t){return ot(this,t)["delete"](t)}function Y(t){return ot(this,t).get(t)}function K(t){return ot(this,t).has(t)}function J(t,e){return ot(this,t).set(t,e),this}function Q(t){var e=-1,n=t?t.length:0;this.__data__=new H;while(++e<n)this.add(t[e])}function $(t){return this.__data__.set(t,r),this}function tt(t){return this.__data__.has(t)}function et(t,e){var n=t.length;while(n--)if(ft(t[n][0],e))return n;return-1}function nt(t){if(!ht(t)||ut(t))return!1;var e=pt(t)||_(t)?P:u;return e.test(ct(t))}function rt(t,e,r){var i=-1,o=p,a=t.length,s=!0,u=[],c=u;if(r)s=!1,o=h;else if(a>=n){var l=e?null:it(t);if(l)return b(l);s=!1,o=g,c=new Q}else c=e?[]:u;t:while(++i<a){var f=t[i],d=e?e(f):f;if(f=r||0!==f?f:0,s&&d===d){var m=c.length;while(m--)if(c[m]===d)continue t;e&&c.push(d),u.push(f)}else o(c,d,r)||(c!==u&&c.push(d),u.push(f))}return u}R.prototype.clear=D,R.prototype["delete"]=z,R.prototype.get=j,R.prototype.has=N,R.prototype.set=F,B.prototype.clear=U,B.prototype["delete"]=V,B.prototype.get=G,B.prototype.has=q,B.prototype.set=Z,H.prototype.clear=W,H.prototype["delete"]=X,H.prototype.get=Y,H.prototype.has=K,H.prototype.set=J,Q.prototype.add=Q.prototype.push=$,Q.prototype.has=tt;var it=O&&1/b(new O([,-0]))[1]==i?function(t){return new O(t)}:dt;function ot(t,e){var n=t.__data__;return st(e)?n["string"==typeof e?"string":"hash"]:n.map}function at(t,e){var n=y(t,e);return nt(n)?n:void 0}function st(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function ut(t){return!!T&&T in t}function ct(t){if(null!=t){try{return A.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function lt(t){return t&&t.length?rt(t):[]}function ft(t,e){return t===e||t!==t&&e!==e}function pt(t){var e=ht(t)?k.call(t):"";return e==o||e==a}function ht(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function dt(){}t.exports=lt}).call(this,n("yLpj"))},wnjb:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("xfSm"),i=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){var e=Reflect.getMetadata(r.PARAM_TYPES,t),n=Reflect.getMetadata(r.TAGGED,t);return{compilerGeneratedMetadata:e,userGeneratedMetadata:n||{}}},t.prototype.getPropertiesMetadata=function(t){var e=Reflect.getMetadata(r.TAGGED_PROP,t)||[];return e},t}();e.MetadataReader=i},wrZu:function(t,e,n){var r=n("+K+b"),i=n("XYm9"),o=n("b2z7"),a=n("otv/"),s=n("yP5f"),u="[object Boolean]",c="[object Date]",l="[object Map]",f="[object Number]",p="[object RegExp]",h="[object Set]",d="[object String]",m="[object Symbol]",v="[object ArrayBuffer]",g="[object DataView]",y="[object Float32Array]",_="[object Float64Array]",b="[object Int8Array]",x="[object Int16Array]",w="[object Int32Array]",S="[object Uint8Array]",E="[object Uint8ClampedArray]",T="[object Uint16Array]",A="[object Uint32Array]";function C(t,e,n){var C=t.constructor;switch(e){case v:return r(t);case u:case c:return new C(+t);case g:return i(t,n);case y:case _:case b:case x:case w:case S:case E:case T:case A:return s(t,n);case l:return new C;case f:case d:return new C(t);case p:return o(t);case h:return new C;case m:return a(t)}}t.exports=C},xfSm:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct"},xfeJ:function(t,e){function n(t){return-1!==Function.toString.call(t).indexOf("[native code]")}t.exports=n},xiII:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("d9O0"),i=function(){function t(t,e,n,i,o){this.id=r.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i},t}();e.Request=i},xp6e:function(t,e,n){"use strict";(function(t){function r(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function o(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}function s(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}function u(t,e){return e={exports:{}},t(e,e.exports),e.exports}n.d(e,"a",(function(){return I})),n.d(e,"b",(function(){return D})),n.d(e,"c",(function(){return C})),n.d(e,"d",(function(){return R}));var c=u((function(t,e){function n(t){return t&&"number"===typeof t.length&&t.length>=0&&t.length%1===0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n,t.exports=e["default"]}));s(c);var l=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];var r=e.pop();return t.call(this,e,r)}},t.exports=e["default"]}));s(l);var f=u((function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.fallback=a,n.wrap=s;var r,i=n.hasSetImmediate="function"===typeof setImmediate&&setImmediate,o=n.hasNextTick="object"===typeof t&&"function"===typeof t.nextTick;function a(t){setTimeout(t,0)}function s(t){return function(e){var n=[],r=arguments.length-1;while(r-- >0)n[r]=arguments[r+1];return t((function(){return e.apply(void 0,n)}))}}r=i?setImmediate:o?t.nextTick:a,n.default=s(r)}));s(f);f.fallback,f.wrap,f.hasSetImmediate,f.hasNextTick;var p=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var n=i(l),r=i(f);function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return(0,h.isAsync)(t)?function(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];var r=e.pop(),i=t.apply(this,e);return a(i,r)}:(0,n.default)((function(e,n){var r;try{r=t.apply(this,e)}catch(i){return n(i)}if(r&&"function"===typeof r.then)return a(r,n);n(null,r)}))}function a(t,e){return t.then((function(t){s(e,null,t)}),(function(t){s(e,t&&t.message?t:new Error(t))}))}function s(t,e,n){try{t(e,n)}catch(i){(0,r.default)((function(t){throw t}),i)}}t.exports=e["default"]}));s(p);var h=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isAsyncIterable=e.isAsyncGenerator=e.isAsync=void 0;var n=r(p);function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return"AsyncFunction"===t[Symbol.toStringTag]}function o(t){return"AsyncGenerator"===t[Symbol.toStringTag]}function a(t){return"function"===typeof t[Symbol.asyncIterator]}function s(t){if("function"!==typeof t)throw new Error("expected a function");return i(t)?(0,n.default)(t):t}e.default=s,e.isAsync=i,e.isAsyncGenerator=o,e.isAsyncIterable=a}));s(h);h.isAsyncIterable,h.isAsyncGenerator,h.isAsync;var d=u((function(t,e){function n(t,e){if(void 0===e&&(e=t.length),!e)throw new Error("arity is undefined");function n(){var n=this,r=[],i=arguments.length;while(i--)r[i]=arguments[i];return"function"===typeof r[e-1]?t.apply(this,r):new Promise((function(i,o){r[e-1]=function(t){var e=[],n=arguments.length-1;while(n-- >0)e[n]=arguments[n+1];if(t)return o(t);i(e.length>1?e:e[0])},t.apply(n,r)}))}return Object.defineProperty(n,"name",{configurable:!0,value:"awaitable("+t.name+")"}),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n,t.exports=e["default"]}));s(d);var m=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=o(c),r=o(h),i=o(d);function o(t){return t&&t.__esModule?t:{default:t}}e.default=(0,i.default)((function(t,e,i){var o=(0,n.default)(e)?[]:{};t(e,(function(t,e,n){(0,r.default)(t)((function(t){var r,i=[],a=arguments.length-1;while(a-- >0)i[a]=arguments[a+1];i.length<2&&(r=i,i=r[0]),o[e]=i,n(t)}))}),(function(t){return i(t,o)}))}),3),t.exports=e["default"]}));s(m);var v=u((function(t,e){function n(t){function e(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];if(null!==t){var r=t;t=null,r.apply(this,e)}}return Object.assign(e,t),e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n,t.exports=e["default"]}));s(v);var g=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},t.exports=e["default"]}));s(g);var y=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var n=i(c),r=i(g);function i(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=-1,n=t.length;return function(){return++e<n?{value:t[e],key:e}:null}}function a(t){var e=-1;return function(){var n=t.next();return n.done?null:(e++,{value:n.value,key:e})}}function s(t){var e=t?Object.keys(t):[],n=-1,r=e.length;return function(){var i=e[++n];return n<r?{value:t[i],key:i}:null}}function u(t){if((0,n.default)(t))return o(t);var e=(0,r.default)(t);return e?a(e):s(t)}t.exports=e["default"]}));s(y);var _=u((function(t,e){function n(t){return function(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];if(null===t)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,e)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n,t.exports=e["default"]}));s(_);var b=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n={};e.default=n,t.exports=e["default"]}));s(b);var x=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=r(b);function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,r,i){var o=!1,a=!1,s=!1,u=0,c=0;function l(){u>=e||s||o||(s=!0,t.next().then((function(t){var e=t.value,n=t.done;if(!a&&!o){if(s=!1,n)return o=!0,void(u<=0&&i(null));u++,r(e,c,f),c++,l()}})).catch(p))}function f(t,e){if(u-=1,!a)return t?p(t):!1===t?(o=!0,void(a=!0)):e===n.default||o&&u<=0?(o=!0,i(null)):void l()}function p(t){a||(s=!1,o=!0,i(t))}l()}t.exports=e["default"]}));s(x);var w=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=s(v),r=s(y),i=s(_),o=s(x),a=s(b);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){return function(e,s,u){if(u=(0,n.default)(u),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return u(null);if((0,h.isAsyncGenerator)(e))return(0,o.default)(e,t,s,u);if((0,h.isAsyncIterable)(e))return(0,o.default)(e[Symbol.asyncIterator](),t,s,u);var c=(0,r.default)(e),l=!1,f=!1,p=0,d=!1;function m(t,e){if(!f)if(p-=1,t)l=!0,u(t);else if(!1===t)l=!0,f=!0;else{if(e===a.default||l&&p<=0)return l=!0,u(null);d||v()}}function v(){d=!0;while(p<t&&!l){var e=c();if(null===e)return l=!0,void(p<=0&&u(null));p+=1,s(e.value,e.key,(0,i.default)(m))}d=!1}v()}},t.exports=e["default"]}));s(w);var S=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=o(w),r=o(h),i=o(d);function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e,i,o){return(0,n.default)(e)(t,(0,r.default)(i),o)}e.default=(0,i.default)(a,4),t.exports=e["default"]}));s(S);var E=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=i(S),r=i(d);function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){return(0,n.default)(t,1,e,r)}e.default=(0,r.default)(o,3),t.exports=e["default"]}));s(E);var T=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var n=i(m),r=i(E);function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return(0,n.default)(r.default,t,e)}t.exports=e["default"]})),A=s(T),C=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];this.args=[],this.tasks=[]}return t.prototype.call=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return this.args=e,A(this.tasks)},t.prototype.tap=function(t,e){var n=this;this.tasks.push((function(r){e.apply(void 0,a(n.args)),r(null,t)}))},t}(),k=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=l(c),r=l(b),i=l(S),o=l(v),a=l(_),s=l(h),u=l(d);function l(t){return t&&t.__esModule?t:{default:t}}function f(t,e,n){n=(0,o.default)(n);var i=0,s=0,u=t.length,c=!1;function l(t,e){!1===t&&(c=!0),!0!==c&&(t?n(t):++s!==u&&e!==r.default||n(null))}for(0===u&&n(null);i<u;i++)e(t[i],i,(0,a.default)(l))}function p(t,e,n){return(0,i.default)(t,1/0,e,n)}function m(t,e,r){var i=(0,n.default)(t)?f:p;return i(t,(0,s.default)(e),r)}e.default=(0,u.default)(m,3),t.exports=e["default"]}));s(k);var P=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var n=i(k),r=i(m);function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return(0,r.default)(n.default,t,e)}t.exports=e["default"]})),M=s(P),I=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];this.tasks=[]}return t.prototype.promise=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return M(this.tasks)},t.prototype.tapPromise=function(t,e){var n=this;this.tasks.push((function(o){return r(n,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,e()];case 1:return n.sent(),o(null,t),[2]}}))}))}))},t}(),O=u((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=a(v),r=a(_),i=a(h),o=a(d);function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(e=(0,n.default)(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var o=0;function a(e){var n=(0,i.default)(t[o++]);n.apply(void 0,e.concat([(0,r.default)(s)]))}function s(n){var r=[],i=arguments.length-1;while(i-- >0)r[i]=arguments[i+1];if(!1!==n)return n||o===t.length?e.apply(void 0,[n].concat(r)):void a(r)}a([])}e.default=(0,o.default)(s),t.exports=e["default"]})),L=s(O),R=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];this.tasks=[]}return t.prototype.call=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return L(this.tasks)},t.prototype.tap=function(t,e){0===this.tasks.length?this.tasks.push((function(t){var n=e();t(!!n&&null,n)})):this.tasks.push((function(n,r){var i=e();r(!!i&&null,t)}))},t}(),D=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];this.tasks=[]}return t.prototype.call=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return A(this.tasks)},t.prototype.tap=function(t,e){this.tasks.push((function(n){var r=e();n(r,t)}))},t}()}).call(this,n("Q2Ig"))},yG8O:function(t,e){function n(t,e,n,r){n&&Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}t.exports=n},yHx3:function(t,e){var n=Object.prototype,r=n.hasOwnProperty;function i(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&r.call(t,"index")&&(n.index=t.index,n.input=t.input),n}t.exports=i},yLV6:function(t,e,n){var r;(function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),f="function",p=Math.round,h=Math.abs,d=Date.now;function m(t,e,n){return setTimeout(w(t,n),e)}function v(t,e,n){return!!Array.isArray(t)&&(g(t,n[e],n),!0)}function g(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s){r=0;while(r<t.length)e.call(n,t[r],r,t),r++}else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!==typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var _=y((function(t,e,n){var r=Object.keys(e),i=0;while(i<r.length)(!n||n&&t[r[i]]===s)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return _(t,e,!0)}),"merge","Use `assign`.");function x(t,e,n){var r,i=e.prototype;r=t.prototype=Object.create(i),r.constructor=t,r._super=i,n&&u(r,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function S(t,e){return typeof t==f?t.apply(e&&e[0]||s,e):t}function E(t,e){return t===s?e:t}function T(t,e,n){g(P(e),(function(e){t.addEventListener(e,n,!1)}))}function A(t,e,n){g(P(e),(function(e){t.removeEventListener(e,n,!1)}))}function C(t,e){while(t){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function P(t){return t.trim().split(/\s+/g)}function M(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);var r=0;while(r<t.length){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){var r=[],i=[],o=0;while(o<t.length){var a=e?t[o][e]:t[o];M(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function L(t,e){var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;while(o<c.length){if(n=c[o],r=n?n+i:e,r in t)return r;o++}return s}var R=1;function D(){return R++}function z(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var j=/mobile|tablet|ip(ad|hone|od)|android/i,N="ontouchstart"in i,F=L(i,"PointerEvent")!==s,B=N&&j.test(navigator.userAgent),U="touch",V="pen",G="mouse",q="kinect",Z=25,H=1,W=2,X=4,Y=8,K=1,J=2,Q=4,$=8,tt=16,et=J|Q,nt=$|tt,rt=et|nt,it=["x","y"],ot=["clientX","clientY"];function at(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){S(t.options.enable,[t])&&n.handler(e)},this.init()}function st(t){var e,n=t.options.inputClass;return e=n||(F?kt:B?zt:N?Bt:St),new e(t,ut)}function ut(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&H&&r-i===0,a=e&(X|Y)&&r-i===0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,ct(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function ct(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=pt(e)),i>1&&!n.firstMultiple?n.firstMultiple=pt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=ht(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=gt(s,u),e.distance=vt(s,u),lt(n,e),e.offsetDirection=mt(e.deltaX,e.deltaY);var c=dt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=h(c.x)>h(c.y)?c.x:c.y,e.scale=a?_t(a.pointers,r):1,e.rotation=a?yt(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,ft(n,e);var l=t.element;C(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function lt(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==H&&o.eventType!==X||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}function ft(t,e){var n,r,i,o,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=Y&&(u>Z||a.velocity===s)){var c=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,f=dt(u,c,l);r=f.x,i=f.y,n=h(f.x)>h(f.y)?f.x:f.y,o=mt(c,l),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}function pt(t){var e=[],n=0;while(n<t.pointers.length)e[n]={clientX:p(t.pointers[n].clientX),clientY:p(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:ht(e),deltaX:t.deltaX,deltaY:t.deltaY}}function ht(t){var e=t.length;if(1===e)return{x:p(t[0].clientX),y:p(t[0].clientY)};var n=0,r=0,i=0;while(i<e)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:p(n/e),y:p(r/e)}}function dt(t,e,n){return{x:e/t||0,y:n/t||0}}function mt(t,e){return t===e?K:h(t)>=h(e)?t<0?J:Q:e<0?$:tt}function vt(t,e,n){n||(n=it);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function gt(t,e,n){n||(n=it);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function yt(t,e){return gt(e[1],e[0],ot)+gt(t[1],t[0],ot)}function _t(t,e){return vt(e[0],e[1],ot)/vt(t[0],t[1],ot)}at.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(z(this.element),this.evWin,this.domHandler)}};var bt={mousedown:H,mousemove:W,mouseup:X},xt="mousedown",wt="mousemove mouseup";function St(){this.evEl=xt,this.evWin=wt,this.pressed=!1,at.apply(this,arguments)}x(St,at,{handler:function(t){var e=bt[t.type];e&H&&0===t.button&&(this.pressed=!0),e&W&&1!==t.which&&(e=X),this.pressed&&(e&X&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:G,srcEvent:t}))}});var Et={pointerdown:H,pointermove:W,pointerup:X,pointercancel:Y,pointerout:Y},Tt={2:U,3:V,4:G,5:q},At="pointerdown",Ct="pointermove pointerup pointercancel";function kt(){this.evEl=At,this.evWin=Ct,at.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(At="MSPointerDown",Ct="MSPointerMove MSPointerUp MSPointerCancel"),x(kt,at,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Et[r],o=Tt[t.pointerType]||t.pointerType,a=o==U,s=M(e,t.pointerId,"pointerId");i&H&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(X|Y)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var Pt={touchstart:H,touchmove:W,touchend:X,touchcancel:Y},Mt="touchstart",It="touchstart touchmove touchend touchcancel";function Ot(){this.evTarget=Mt,this.evWin=It,this.started=!1,at.apply(this,arguments)}function Lt(t,e){var n=I(t.touches),r=I(t.changedTouches);return e&(X|Y)&&(n=O(n.concat(r),"identifier",!0)),[n,r]}x(Ot,at,{handler:function(t){var e=Pt[t.type];if(e===H&&(this.started=!0),this.started){var n=Lt.call(this,t,e);e&(X|Y)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:t})}}});var Rt={touchstart:H,touchmove:W,touchend:X,touchcancel:Y},Dt="touchstart touchmove touchend touchcancel";function zt(){this.evTarget=Dt,this.targetIds={},at.apply(this,arguments)}function jt(t,e){var n=I(t.touches),r=this.targetIds;if(e&(H|W)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=I(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return C(t.target,u)})),e===H){i=0;while(i<o.length)r[o[i].identifier]=!0,i++}i=0;while(i<a.length)r[a[i].identifier]&&s.push(a[i]),e&(X|Y)&&delete r[a[i].identifier],i++;return s.length?[O(o.concat(s),"identifier",!0),s]:void 0}x(zt,at,{handler:function(t){var e=Rt[t.type],n=jt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:t})}});var Nt=2500,Ft=25;function Bt(){at.apply(this,arguments);var t=w(this.handler,this);this.touch=new zt(this.manager,t),this.mouse=new St(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ut(t,e){t&H?(this.primaryTouch=e.changedPointers[0].identifier,Vt.call(this,e)):t&(X|Y)&&Vt.call(this,e)}function Vt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches,i=function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)};setTimeout(i,Nt)}}function Gt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=Ft&&a<=Ft)return!0}return!1}x(Bt,at,{handler:function(t,e,n){var r=n.pointerType==U,i=n.pointerType==G;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)Ut.call(this,e,n);else if(i&&Gt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var qt=L(l.style,"touchAction"),Zt=qt!==s,Ht="compute",Wt="auto",Xt="manipulation",Yt="none",Kt="pan-x",Jt="pan-y",Qt=ee();function $t(t,e){this.manager=t,this.set(e)}function te(t){if(k(t,Yt))return Yt;var e=k(t,Kt),n=k(t,Jt);return e&&n?Yt:e||n?e?Kt:Jt:k(t,Xt)?Xt:Wt}function ee(){if(!Zt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}$t.prototype={set:function(t){t==Ht&&(t=this.compute()),Zt&&this.manager.element.style&&Qt[t]&&(this.manager.element.style[qt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return g(this.manager.recognizers,(function(e){S(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),te(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=k(r,Yt)&&!Qt[Yt],o=k(r,Jt)&&!Qt[Jt],a=k(r,Kt)&&!Qt[Kt];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&et||a&&n&nt?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ne=1,re=2,ie=4,oe=8,ae=oe,se=16,ue=32;function ce(t){this.options=u({},this.defaults,t||{}),this.id=D(),this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=ne,this.simultaneous={},this.requireFail=[]}function le(t){return t&se?"cancel":t&oe?"end":t&ie?"move":t&re?"start":""}function fe(t){return t==tt?"down":t==$?"up":t==J?"left":t==Q?"right":""}function pe(t,e){var n=e.manager;return n?n.get(t):t}function he(){ce.apply(this,arguments)}function de(){he.apply(this,arguments),this.pX=null,this.pY=null}function me(){he.apply(this,arguments)}function ve(){ce.apply(this,arguments),this._timer=null,this._input=null}function ge(){he.apply(this,arguments)}function ye(){he.apply(this,arguments)}function _e(){ce.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function be(t,e){return e=e||{},e.recognizers=E(e.recognizers,be.defaults.preset),new Se(t,e)}ce.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(v(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=pe(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return v(t,"dropRecognizeWith",this)||(t=pe(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(v(t,"requireFailure",this))return this;var e=this.requireFail;return t=pe(t,this),-1===M(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(v(t,"dropRequireFailure",this))return this;t=pe(t,this);var e=M(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<oe&&r(e.options.event+le(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=oe&&r(e.options.event+le(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=ue},canEmit:function(){var t=0;while(t<this.requireFail.length){if(!(this.requireFail[t].state&(ue|ne)))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!S(this.options.enable,[this,e]))return this.reset(),void(this.state=ue);this.state&(ae|se|ue)&&(this.state=ne),this.state=this.process(e),this.state&(re|ie|oe|se)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(he,ce,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(re|ie),i=this.attrTest(t);return r&&(n&Y||!i)?e|se:r||i?n&X?e|oe:e&re?e|ie:re:ue}}),x(de,he,{defaults:{event:"pan",threshold:10,pointers:1,direction:rt},getTouchAction:function(){var t=this.options.direction,e=[];return t&et&&e.push(Jt),t&nt&&e.push(Kt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&et?(i=0===o?K:o<0?J:Q,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?K:a<0?$:tt,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return he.prototype.attrTest.call(this,t)&&(this.state&re||!(this.state&re)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=fe(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x(me,he,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Yt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&re)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(ve,ce,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(X|Y)&&!i)this.reset();else if(t.eventType&H)this.reset(),this._timer=m((function(){this.state=ae,this.tryEmit()}),e.time,this);else if(t.eventType&X)return ae;return ue},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ae&&(t&&t.eventType&X?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),x(ge,he,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Yt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&re)}}),x(ye,he,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:et|nt,pointers:1},getTouchAction:function(){return de.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(et|nt)?e=t.overallVelocity:n&et?e=t.overallVelocityX:n&nt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&t.eventType&X},emit:function(t){var e=fe(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x(_e,ce,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Xt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&H&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=X)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||vt(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t;var s=this.count%e.taps;if(0===s)return this.hasRequireFailures()?(this._timer=m((function(){this.state=ae,this.tryEmit()}),e.interval,this),re):ae}return ue},failTimeout:function(){return this._timer=m((function(){this.state=ue}),this.options.interval,this),ue},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ae&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),be.VERSION="2.0.7",be.defaults={domEvents:!1,touchAction:Ht,enable:!0,inputTarget:null,inputClass:null,preset:[[ge,{enable:!1}],[me,{enable:!1},["rotate"]],[ye,{direction:et}],[de,{direction:et},["swipe"]],[_e],[_e,{event:"doubletap",taps:2},["tap"]],[ve]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var xe=1,we=2;function Se(t,e){this.options=u({},be.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=st(this),this.touchAction=new $t(this,this.options.touchAction),Ee(this,!0),g(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Ee(t,e){var n,r=t.element;r.style&&(g(t.options.cssProps,(function(i,o){n=L(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}function Te(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}Se.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?we:xe},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&ae)&&(i=e.curRecognizer=null);var o=0;while(o<r.length)n=r[o],e.stopped===we||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(re|ie|oe)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof ce)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(v(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(v(t,"remove",this))return this;if(t=this.get(t),t){var e=this.recognizers,n=M(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return g(P(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==s){var n=this.handlers;return g(P(t),(function(t){e?n[t]&&n[t].splice(M(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&Te(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};var r=0;while(r<n.length)n[r](e),r++}},destroy:function(){this.element&&Ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(be,{INPUT_START:H,INPUT_MOVE:W,INPUT_END:X,INPUT_CANCEL:Y,STATE_POSSIBLE:ne,STATE_BEGAN:re,STATE_CHANGED:ie,STATE_ENDED:oe,STATE_RECOGNIZED:ae,STATE_CANCELLED:se,STATE_FAILED:ue,DIRECTION_NONE:K,DIRECTION_LEFT:J,DIRECTION_RIGHT:Q,DIRECTION_UP:$,DIRECTION_DOWN:tt,DIRECTION_HORIZONTAL:et,DIRECTION_VERTICAL:nt,DIRECTION_ALL:rt,Manager:Se,Input:at,TouchAction:$t,TouchInput:zt,MouseInput:St,PointerEventInput:kt,TouchMouseInput:Bt,SingleTouchInput:Ot,Recognizer:ce,AttrRecognizer:he,Tap:_e,Pan:de,Swipe:ye,Pinch:me,Rotate:ge,Press:ve,on:T,off:A,each:g,merge:b,extend:_,assign:u,inherit:x,bindFn:w,prefixed:L});var Ae="undefined"!==typeof i?i:"undefined"!==typeof self?self:{};Ae.Hammer=be,r=function(){return be}.call(e,n,e,t),r===s||(t.exports=r)})(window,document)},yMAV:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.parentContext=t,this.rootRequest=e}return t}();e.Plan=r},yU0y:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){var t=0,e=arguments.length;while(e--)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},yXPU:function(t,e){function n(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(i,o){var a=t.apply(e,r);function s(t){n(a,i,o,s,u,"next",t)}function u(t){n(a,i,o,s,u,"throw",t)}s(void 0)}))}}t.exports=r},ycre:function(t,e,n){var r=n("711d"),i=r("length");t.exports=i},z4Hk:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("406g"),i=n("RR/i"),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=i.namedConstraint(t),new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){var e=null!==t.target&&!t.target.isNamed()&&!t.target.isTagged();return e},new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=i.taggedConstraint(t)(e),new r.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return i.typeConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return i.namedConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return i.taggedConstraint(t)(e)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=o},zEVN:function(t,e,n){var r=n("Gi0A"),i=n("sEf8"),o=n("mdPL"),a=o&&o.isMap,s=a?i(a):r;t.exports=s},zZPE:function(t,e){var n="[object Object]";function r(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function i(t,e){return function(n){return t(e(n))}}var o=Function.prototype,a=Object.prototype,s=o.toString,u=a.hasOwnProperty,c=s.call(Object),l=a.toString,f=i(Object.getPrototypeOf,Object);function p(t){return!!t&&"object"==typeof t}function h(t){if(!p(t)||l.call(t)!=n||r(t))return!1;var e=f(t);if(null===e)return!0;var i=u.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&s.call(i)==c}t.exports=h},zxMA:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e="",n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=r}}]);